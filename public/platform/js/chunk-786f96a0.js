(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-786f96a0"],{"126e":function(e,t,a){"use strict";var n={regionalAgencyList:"/new_marketing/platform.RegionalAgency/regionalAgencyList",findArea:"/new_marketing/platform.RegionalAgency/findArea",findRight:"/new_marketing/platform.RegionalAgency/findRight",findRightEdit:"/new_marketing/platform.RegionalAgency/findRightEdit",addRegionalAgency:"/new_marketing/platform.RegionalAgency/addRegionalAgency",editRegionalAgency:"/new_marketing/platform.RegionalAgency/editRegionalAgency",saveRegionalAgency:"/new_marketing/platform.RegionalAgency/saveRegionalAgency",delRegionalAgency:"/new_marketing/platform.RegionalAgency/delRegionalAgency",reduceWin:"/new_marketing/platform.RegionalAgency/reduceWin",addReduce:"/new_marketing/platform.RegionalAgency/addReduce",getTeamList1:"/new_marketing/platform.RegionalAgency/getTeamList",updatePercent:"/new_marketing/platform.RegionalAgency/updatePercent",getMarketingArtisanList:"/new_marketing/platform.MarketingArtisan/getMarketingArtisanList",getMarketingArtisanCreate:"/new_marketing/platform.MarketingArtisan/getMarketingArtisanCreate",getMarketingArtisanInfo:"/new_marketing/platform.MarketingArtisan/getMarketingArtisanInfo",getMarketingArtisanDir:"/new_marketing/platform.MarketingArtisan/getMarketingArtisanDir",getDirectorList:"/new_marketing/platform.MarketingArtisan/getDirectorList",getMarketingArtisanDel:"/new_marketing/platform.MarketingArtisan/getMarketingArtisanDel",getMarketingDirectorList:"/new_marketing/platform.MarketingDirector/getMarketingDirectorList",getMarketingDirectorCreate:"/new_marketing/platform.MarketingDirector/getMarketingDirectorCreate",getMarketingDirectorInfo:"/new_marketing/platform.MarketingDirector/getMarketingDirectorInfo",getMarketingDirectorDel:"/new_marketing/platform.MarketingDirector/getMarketingDirectorDel",getMarketingDirectorRemove:"/new_marketing/platform.MarketingDirector/getMarketingDirectorRemove",getMarketingDirectorArtisan:"/new_marketing/platform.MarketingDirector/getMarketingDirectorArtisan",getManagerList:"/new_marketing/platform.ServiceManager/serviceManagerList",addManager:"/new_marketing/platform.ServiceManager/addServiceManager",editManager:"/new_marketing/platform.ServiceManager/saveServiceManager",delNoTeamManager:"/new_marketing/platform.ServiceManager/doDelManager",getTeamMemberList:"/new_marketing/platform.ServiceManager/getTeamPerson",upgradeManager:"/new_marketing/platform.ServiceManager/doUpLevel",deleteManager:"/new_marketing/platform.ServiceManager/doDelServiceManager",demoteManager:"/new_marketing/platform.ServiceManager/doDownLevel",getAreaList:"/new_marketing/platform.Region/regionList",getClassifyPriceList:"/new_marketing/platform.Region/classPriceList",saveAreaPriceForm:"/new_marketing/platform.Region/addRegion",saveClassifyPriceForm:"/new_marketing/platform.Region/addClassPrice",deleteAreaPriceForm:"/new_marketing/platform.Region/delRegion",getAreaMealList:"/new_marketing/platform.MarketingPackage/getAreaSearchList",saveAreaMealForm:"/new_marketing/platform.MarketingPackage/editAreaPost",saveAreaMealStatus:"/new_marketing/platform.MarketingPackage/setAreaStatus",getStoreTypeList:"/new_marketing/platform.MarketingPackage/getStoreTypeList",addMeal:"/new_marketing/platform.MarketingPackage/add",getMealList:"/new_marketing/platform.MarketingPackage/getSearchList",deleteMeal:"/new_marketing/platform.MarketingPackage/del",editMeal:"/new_marketing/platform.MarketingPackage/editPost",getCommissionSearchData:"/new_marketing/platform.MarketingPersonSettle/getSearchData",getCommissionList:"/new_marketing/platform.MarketingPersonSettle/getSearchList",teamManagementList:"/new_marketing/platform.TeamManagement/teamManagementList",teamPerformance:"/new_marketing/platform.TeamManagement/teamPerformance",serviceManagerList:"/new_marketing/platform.TeamManagement/serviceManagerList",serviceManagerNoList:"/new_marketing/platform.TeamManagement/serviceManagerNoList",regionalAgentList:"/new_marketing/platform.TeamManagement/regionalAgentList",artisanList:"/new_marketing/platform.TeamManagement/artisanList",teamManagementAdd:"/new_marketing/platform.TeamManagement/teamManagementAdd",teamManagementBasic:"/new_marketing/platform.TeamManagement/teamManagementBasic",teamManagementReplace:"/new_marketing/platform.TeamManagement/teamManagementReplace",teamManagementUpgrade:"/new_marketing/platform.TeamManagement/teamManagementUpgrade",teamBusinessList:"/new_marketing/platform.TeamManagement/teamBusinessList",teamManagementDel:"/new_marketing/platform.TeamManagement/teamManagementDel",teamManagementTransfer:"/new_marketing/platform.TeamManagement/teamManagementTransfer",teamManagementDiss:"/new_marketing/platform.TeamManagement/teamManagementDiss",teamMemberAdd:"/new_marketing/platform.TeamManagement/teamMemberAdd",teamManagementEdit:"/new_marketing/platform.TeamManagement/teamManagementEdit",teamMemberEdit:"/new_marketing/platform.TeamManagement/teamMemberEdit",teamMemberCode:"/new_marketing/platform.TeamManagement/teamMemberCode",teamManagementSavage:"/new_marketing/platform.TeamManagement/teamManagementSavage",teamManagementMerchantList:"/new_marketing/platform.TeamManagement/teamManagementMerchantList",teamManagementSavageDetail:"/new_marketing/platform.TeamManagement/teamManagementSavageDetail",getCommunityOrderDetail:"/new_marketing/platform.TeamManagement/getCommunityOrderDetail",positionReviewList:"/new_marketing/platform.PositionReview/positionReviewList",getTeamList:"/new_marketing/platform.PositionReview/getTeamList",reviewAgree:"/new_marketing/platform.PositionReview/reviewAgree",reviewDisagree:"/new_marketing/platform.PositionReview/reviewDisagree",getOrderList:"/new_marketing/platform.OrderInfo/orderList",getAreaUidByProvince:"/new_marketing/platform.OrderInfo/getAreaUidByProvince",getTeamIdByAreaUid:"/new_marketing/platform.OrderInfo/getTeamIdByAreaUid",getOrderDetail:"/new_marketing/platform.OrderInfo/getOrderInfo",teamManagementMerchantTransferList:"/new_marketing/platform.TeamManagement/teamManagementMerchantTransferList",teamManagementMerchantTransferCreate:"/new_marketing/platform.TeamManagement/teamManagementMerchantTransferCreate",getMerchantList:"/new_marketing/platform.Merchant/getMerchantList",getMerchantStoreList:"/new_marketing/platform.Merchant/getMerchantStoreList",teamMembeInfo:"/new_marketing/platform.TeamManagement/teamMembeInfo",getPropertyList:"/new_marketing/platform.MarketingProperty/getPropertyList",villageTransferBusiness:"/new_marketing/platform.MarketingProperty/transferBusiness",teamMerchantOrderList:"/new_marketing/platform.TeamManagement/teamMerchantOrderList",getHousePropertyList:"/new_marketing/platform.HouseProperty/getHousePropertyList",getHousePropertyDetail:"/new_marketing/platform.HouseProperty/getHousePropertyDetail"};t["a"]=n},2894:function(e,t,a){},"61e5":function(e,t,a){"use strict";a("2894")},"7b78":function(e,t,a){"use strict";a.r(t);a("b0c0"),a("4e82");var n=function(){var e=this,t=e._self._c;return t("div",[t("a-card",{attrs:{title:"套餐管理",bordered:!1}},[t("a-form-model",{ref:"searchInfo",staticStyle:{"margin-bottom":"30px"},attrs:{layout:"inline",model:e.searchInfo,labelCol:{span:4}}},[t("a-row",{attrs:{gutter:24}},[t("a-col",{attrs:{span:9}},[t("a-form-model-item",{staticStyle:{width:"100%"},attrs:{label:"套餐名称"}},[t("a-input",{staticStyle:{width:"300px"},attrs:{placeholder:"请输入套餐名称"},model:{value:e.searchInfo.name,callback:function(t){e.$set(e.searchInfo,"name",t)},expression:"searchInfo.name"}})],1)],1),t("a-col",{attrs:{span:9}},[t("a-form-model-item",{staticStyle:{width:"100%"},attrs:{label:"创建时间"}},[t("a-range-picker",{staticStyle:{width:"300px"},attrs:{ranges:{"过去30天":[e.moment().subtract(30,"days"),e.moment()],"过去15天":[e.moment().subtract(15,"days"),e.moment()],"过去7天":[e.moment().subtract(7,"days"),e.moment()],"今日":[e.moment(),e.moment()]},format:"YYYY-MM-DD"},model:{value:e.searchInfo.time,callback:function(t){e.$set(e.searchInfo,"time",t)},expression:"searchInfo.time"}},[t("a-icon",{attrs:{slot:"suffixIcon",type:"calendar"},slot:"suffixIcon"})],1)],1)],1),t("a-col",{staticStyle:{"text-align":"right"},attrs:{span:6}},[t("a-form-model-item",[t("a-button",{attrs:{type:"primary",htmlType:"submit"},on:{click:e.searchHandle}},[e._v("查询")])],1),t("a-form-model-item",[t("a-button",{on:{click:e.clearSearch}},[e._v("重置")])],1)],1)],1)],1),t("a-button",{staticStyle:{"margin-bottom":"30px"},attrs:{type:"primary",size:"large"},on:{click:function(t){e.showAdd=!0}}},[e._v("创建套餐")]),t("a-table",{attrs:{columns:e.columns,rowKey:"id","data-source":e.mealList,pagination:e.pagination},scopedSlots:e._u([{key:"sort",fn:function(a,n){return t("div",{},[t("a-input-number",{attrs:{value:a},on:{change:function(t){return e.handleChange(t,"sort",n)}}})],1)}},{key:"action",fn:function(a,n){return t("span",{},[t("a-button",{attrs:{type:"link"},on:{click:function(t){return e.actionBtn(t,"editMeal",n)}}},[e._v("编辑")]),t("a-button",{attrs:{type:"link"},on:{click:function(t){return e.actionBtn(t,"deleteMeal",n)}}},[e._v("删除")])],1)}}])})],1),t("a-modal",{staticStyle:{"max-height":"calc(60vh + 110px)",overflow:"hidden"},attrs:{title:e.modalTitle,width:640,visible:e.showAdd,bodyStyle:"max-height:60vh;overflow:auto;"},on:{cancel:function(t){e.showAdd=!1}}},[t("a-form-model",{ref:"mealSetInfo",attrs:{model:e.mealSetInfo,rules:e.mealSetInfoRules,"label-col":{span:4,offset:0},"wrapper-col":{span:12}}},[t("a-form-model-item",{attrs:{label:"套餐名称",help:"建议1-10字符内",prop:"name"}},[t("a-input",{attrs:{placeholder:"请输入套餐名称"},model:{value:e.mealSetInfo.name,callback:function(t){e.$set(e.mealSetInfo,"name",t)},expression:"mealSetInfo.name"}})],1),t("a-form-model-item",{attrs:{label:"店铺详情","wrapper-col":{span:16},prop:"store_detail"}},[e._l(e.mealSetInfo.store_detail,(function(a,n){return t("div",{key:n},[t("a-row",{attrs:{type:"flex"}},[t("a-col",[e._v("店铺类型：")]),t("a-col",{attrs:{span:16}},[t("a-cascader",{attrs:{options:e.storeTypeList,placeholder:"请选择类型"},model:{value:a.type,callback:function(t){e.$set(a,"type",t)},expression:"item.type"}})],1),t("a-col",[e.mealSetInfo.store_detail.length>1?t("a-icon",{staticClass:"dynamic-delete-button",attrs:{type:"minus-circle-o",disabled:1===e.mealSetInfo.store_detail.length},on:{click:function(t){return e.removeStore(n)}}}):e._e()],1)],1),t("div",{staticClass:"mb-20"},[t("span",[e._v("数量：")]),t("a-input-number",{attrs:{min:0},model:{value:a.num,callback:function(t){e.$set(a,"num",t)},expression:"item.num"}})],1)],1)})),t("div",[t("a-button",{staticStyle:{color:"#1890ff","border-color":"#1890ff"},attrs:{icon:"plus"},on:{click:e.addStore}},[e._v("添加店铺")])],1)],2),t("a-form-model-item",{attrs:{label:"排序",prop:"sort"}},[t("a-input-number",{model:{value:e.mealSetInfo.sort,callback:function(t){e.$set(e.mealSetInfo,"sort",t)},expression:"mealSetInfo.sort"}})],1),t("a-form-model-item",{attrs:{label:"详情描述","wrapper-col":{span:18},prop:"remark"}},[t("a-textarea",{attrs:{placeholder:"请输入详细描述",rows:4},model:{value:e.mealSetInfo.remark,callback:function(t){e.$set(e.mealSetInfo,"remark",t)},expression:"mealSetInfo.remark"}})],1)],1),t("template",{slot:"footer"},[t("a-button",{on:{click:function(t){e.showAdd=!1}}},[e._v("取消")]),t("a-button",{attrs:{htmlType:"submit",type:"primary"},on:{click:e.saveMealSettings}},[e._v("确定")])],1)],2)],1)},r=[],i=a("5530"),o=(a("a434"),a("c1df")),m=a.n(o),s=a("126e"),g={data:function(){return{columns:[{title:"套餐名称",dataIndex:"name",align:"center"},{title:"店铺数量",dataIndex:"all_num",align:"center"},{title:"下单总数量",dataIndex:"order_count",align:"center"},{title:"排序",dataIndex:"sort",width:"10%",align:"center",scopedSlots:{customRender:"sort"}},{title:"创建时间",dataIndex:"create_time",sortDirections:["descend","ascend"],sorter:function(e,t){return m()(e.place_time).unix()-m()(t.place_time).unix()},align:"center"},{title:"操作",dataIndex:"action",scopedSlots:{customRender:"action"},align:"center"}],mealList:[],pagination:{current:1,total:0,pageSize:10,showSizeChanger:!0,showQuickJumper:!0,onChange:this.onPageChange,onShowSizeChange:this.onPageSizeChange,showTotal:function(e){return"共 ".concat(e," 条记录")}},searchInfo:{name:"",start_time:"",end_time:"",time:[]},showAdd:!1,mealSetInfo:{name:"",store_detail:[{type:[],num:0}],sort:0,remark:""},mealSetInfoRules:{name:[{required:!0,message:"请输入套餐名称！"}],store_detail:[{required:!0,message:"请添加店铺信息！"}]},store_detail:[],storeTypeList:[],modalTitle:"添加套餐"}},watch:{showAdd:{immediate:!0,handler:function(e){e||(this.modalTitle="添加套餐",this.mealSetInfo=this.$options.data().mealSetInfo)}}},created:function(){this.getStoreTypeList(),this.getList()},methods:{moment:m.a,removeStore:function(e){this.mealSetInfo.store_detail.splice(e,1)},addStore:function(){this.mealSetInfo.store_detail.push({type:[],num:0})},saveMealSettings:function(){var e=this;console.log("提交套餐信息",this.mealSetInfo);var t=this.mealSetInfo.id?"editMeal":"addMeal";this.request(s["a"][t],this.mealSetInfo).then((function(t){e.$message.success("保存成功！",1),e.showAdd=!1,e.clearSearch()}))},handleChange:function(e,t,a){var n=this;a.sort=e,this.sortTimer&&clearTimeout(this.sortTimer),this.sortTimer=setTimeout((function(){n.request(s["a"].editMeal,a).then((function(e){console.log("修改成功")}))}),500)},actionBtn:function(e,t,a){var n=this;if("editMeal"==t)return this.modalTitle="编辑套餐",this.showAdd=!0,void(this.mealSetInfo={name:a.name,store_detail:a.store_detail,sort:a.sort,remark:a.remark,id:a.id});"deleteMeal"!=t||this.$confirm({title:"你确定要删除该套餐吗？",icon:function(e){return e("a-icon",{props:{type:"close-circle",theme:"filled"},style:{color:"#f50f50"}})},onOk:function(){n.request(s["a"].deleteMeal,{id:a.id}).then((function(e){n.$message.success("删除成功！",1),n.clearSearch()}))}})},searchHandle:function(e){e.preventDefault(),this.searchInfo.time.length>0?(this.searchInfo.start_time=this.searchInfo.time[0].format("YYYY-MM-DD"),this.searchInfo.end_time=this.searchInfo.time[1].format("YYYY-MM-DD")):(this.searchInfo.start_time="",this.searchInfo.end_time=""),this.getList(!0)},clearSearch:function(){this.searchInfo=this.$options.data().searchInfo,this.getList(!0)},onPageChange:function(e,t){this.$set(this.pagination,"current",e),this.getList()},onPageSizeChange:function(e,t){this.$set(this.pagination,"pageSize",t),this.getList()},getList:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];t&&(this.$set(this.pagination,"current",1),this.$set(this.pagination,"pageSize",10));var a=Object(i["a"])({page:this.pagination.current,pageSize:this.pagination.pageSize},this.searchInfo);this.request(s["a"].getMealList,a).then((function(t){e.mealList=t.data||[],e.pagination.total=t.total}))},getStoreTypeList:function(){var e=this;this.request(s["a"].getStoreTypeList).then((function(t){e.storeTypeList=t}))}}},l=g,c=(a("61e5"),a("2877")),f=Object(c["a"])(l,n,r,!1,null,"334a55c4",null);t["default"]=f.exports}}]);