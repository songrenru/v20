(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-68513688","chunk-cf9e0b22","chunk-1a64239a","chunk-1b82d72b","chunk-2d0a310a"],{"011d":function(e,t,r){"use strict";var a={getSearchHotList:"/mall/platform.MallSearchHot/getSearchHotList",getHotRecord:"/mall/platform.MallSearchHot/getHotRecord",addOrEditSearchHot:"/mall/platform.MallSearchHot/addOrEditSearchHot",getEditSearchHot:"/mall/platform.MallSearchHot/getEditSearchHot",delSearchHot:"/mall/platform.MallSearchHot/delSearchHot",saveSort:"/mall/platform.MallSearchHot/saveSort",getGoodsList:"/mall/platform.MallPlatformGoods/getGoodsList",getMerOrStoreList:"/mall/platform.MallPlatformGoods/getMerOrStoreList",goodsCategoryList:"/mall/platform.MallGoodsCategory/goodsCategoryList",goodsSetSort:"/mall/platform.MallPlatformGoods/setSort",getGoodsListByName:"/mall/platform.MallPlatformGoods/getGoodsListByName",exportGoods:"/mall/platform.MallPlatformGoods/exportGoods",goodsSetIntegral:"/mall/platform.MallPlatformGoods/setIntegral",goodsSetCommission:"/mall/platform.MallPlatformGoods/setCommission",goodsSetVirtual:"/mall/platform.MallPlatformGoods/setVirtual",goodsSetStatus:"/mall/platform.MallPlatformGoods/setStatus",goodsSetFirst:"/mall/platform.MallPlatformGoods/setFirst",merchantGoodsEdit:"/mall/platform.mallPlatformGoods/merchantGoodsEdit",getActivityRecommendList:"/mall/platform.MallActivityRecommend/getActivityRecommendList",getLimitedRecommendList:"/mall/platform.mallActivityRecommend/getLimitedRecommendList",getBargainRecommendList:"/mall/platform.mallActivityRecommend/getBargainRecommendList",getGroupRecommendList:"/mall/platform.mallActivityRecommend/getGroupRecommendList",editLimitedRecommend:"/mall/platform.mallActivityRecommend/editLimitedRecommend",editBargainRecommend:"/mall/platform.mallActivityRecommend/editBargainRecommend",editGroupRecommend:"/mall/platform.mallActivityRecommend/editGroupRecommend",setFirstLimited:"/mall/platform.mallActivityRecommend/setFirstLimited",setFirstBargain:"/mall/platform.mallActivityRecommend/setFirstBargain",setFirstGroup:"/mall/platform.mallActivityRecommend/setFirstGroup",setSortGroup:"/mall/platform.mallActivityRecommend/setSortGroup",setSortLimited:"/mall/platform.mallActivityRecommend/setSortLimited",setSortBargain:"/mall/platform.mallActivityRecommend/setSortBargain",bannerList:"/mall/platform.mallActivityRecommend/bannerList",addOrEditBanner:"/mall/platform.mallActivityRecommend/addOrEditBanner",delBanner:"/mall/platform.mallActivityRecommend/delBanner",getReplyList:"/mall/platform.MallPlatformReply/searchReply",getReplyDetails:"/mall/platform.MallPlatformReply/getReplyDetails",delReply:"/mall/platform.MallPlatformReply/delReply",getOrderList:"/mall/platform.MallOrder/searchOrders",getOrderDetails:"/mall/platform.MallOrder/getOrderDetails",getStores:"/mall/platform.MallOrder/getStores",getMers:"/mall/platform.MallOrder/getMers",loginMer:"/mall/platform.MallOrder/loginMer",loginStore:"/mall/platform.MallOrder/loginStore",getAllArea:"/mall/platform.MallOrder/getAllArea",getDiscount:"/mall/platform.MallOrder/getDiscount",getOrderLog:"/mall/platform.MallOrder/getOrderLog",exportOrder:"/mall/platform.MallOrder/exportOrder",getList:"mall/platform.MallHomeDecorate/getList",getDel:"mall/platform.MallHomeDecorate/getDel",getEdit:"mall/platform.MallHomeDecorate/getEdit",addOrEditDecorate:"mall/platform.MallHomeDecorate/addOrEdit",getSixList:"mall/platform.MallHomeDecorate/getSixList",getSixEdit:"mall/platform.MallHomeDecorate/getSixEdit",addOrEditSixAdver:"mall/platform.MallHomeDecorate/addOrEditSixAdver",delSixAdver:"mall/platform.MallHomeDecorate/delSixAdver",getRecList:"mall/platform.MallHomeDecorate/getRecList",addOrEditRec:"mall/platform.MallHomeDecorate/addOrEditRec",getRecEdit:"mall/platform.MallHomeDecorate/getRecEdit",delRecAdver:"mall/platform.MallHomeDecorate/delRecAdver",recDisplay:"mall/platform.MallHomeDecorate/recDisplay",getActGoods:"mall/platform.MallHomeDecorate/getActGoods",addRelatedGoods:"mall/platform.MallHomeDecorate/addRelatedGoods",getUrlAndRecSwitch:"mall/platform.MallHomeDecorate/getUrlAndRecSwitch",getRelatedList:"mall/platform.MallHomeDecorate/getRelatedList",saveRelatedSort:"/mall/platform.MallHomeDecorate/saveRelatedSort",delOne:"/mall/platform.MallHomeDecorate/delOne",viewLogistics:"/mall/platform.MallOrder/viewLogistics",getPeriodicList:"/mall/platform.MallOrder/getPeriodicList",setRecommend:"/mall/platform.MallPlatformGoods/setRecommend",cancelRecommend:"/mall/platform.MallPlatformGoods/cancelRecommend",isShowReply:"/mall/platform.MallPlatformReply/isShowReply",getMallBrowse:"/mall/platform.MallBrowse/getMallBrowse",MallBrowseExport:"/mall/platform.MallBrowse/export",exportBrowseTotalExport:"/mall/platform.MallBrowse/exportBrowseTotal",getAuditGoodsList:"/mall/platform.MallPlatformGoods/getAuditGoodsList",auditGoods:"/mall/platform.MallPlatformGoods/auditGoods",loginMerchant:"/mall/platform.MallPlatformGoods/loginMerchant",orderPrintTicket:"/mall/platform.MallOrder/printOrder"};t["a"]=a},4031:function(e,t,r){"use strict";var a={getLists:"/mall/merchant.MerchantStoreMall/getStoreList",perfectedStore:"/mall/merchant.MerchantStoreMall/perfectedStore",getStoreConfigList:"/mall/merchant.MerchantStoreMall/getStoreConfigList",getShippingList:"/mall/merchant.MallShipping/getShippingList",updateShipping:"/mall/merchant.MallShipping/addShipping",changeState:"/mall/merchant.MallShipping/changeState",removeShipping:"/mall/merchant.MallShipping/del",getShippingInfo:"/mall/merchant.MallShipping/edit",getMerchantSort:"/mall/merchant.MallGoods/getMerchantSort",getMallGoods:"/mall/merchant.MallGoods/getMallGoodsSelect",getGiveList:"/mall/merchant.MallGive/getGiveList",giveAdd:"/mall/merchant.MallGive/addGive",giveChangeState:"/mall/merchant.MallGive/changeState",giveDel:"/mall/merchant.MallGive/del",getGiveInfo:"/mall/merchant.MallGive/edit",getPlatSort:"/mall/merchant.MallGoods/getPlatformSort",getStoreSort:"/mall/merchant.MallGoods/getMerchantSort",getPrepareList:"/mall/merchant.MallPrepare/getPrepareList",updatePrepare:"/mall/merchant.MallPrepare/addPrepare",prepareChangeState:"/mall/merchant.MallPrepare/changeState",removePrepare:"/mall/merchant.MallPrepare/del",getPrepareInfo:"/mall/merchant.MallPrepare/edit",getReachedList:"/mall/merchant.MallReached/getReachedList",updateReachedList:"/mall/merchant.MallReached/addReached",getReachedInfo:"/mall/merchant.MallReached/edit",reachedChangeState:"/mall/merchant.MallReached/changeState",reachedDel:"/mall/merchant.MallReached/del",addRobot:"/mall/merchant.MallGroup/addRobot",delRobot:"/mall/merchant.MallGroup/delRobot",getRobotList:"/mall/merchant.MallGroup/getRobotList",getRobotName:"/mall/merchant.MallGroup/getRobotName",getUploadImages:"/common/common.UploadFile/getUploadImages",getGoodsSort:"/mall/merchant.MallGoods/getMerchantSort",getGoodsStatus:"/mall/merchant.MallGoods/getNumbers",getGoodsList:"/mall/merchant.MallGoods/getGoodsList",changeGoodsStatus:"/mall/merchant.MallGoods/setStatusLot",setVirtualSales:"/mall/merchant.MallGoods/setVirtualSales",changeGoodsSort:"/mall/merchant.MallGoods/setSort",getGoodsSkuPrice:"/mall/merchant.MallGoods/getGoodsSkuInfo",changeGoodsPrice:"/mall/merchant.MallGoods/setGoodsSkuInfo",getPlatProps:"/mall/merchant.MallGoods/getPlatformProperties",getFreightList:"/mall/merchant.MallGoods/getfreightList",getServiceList:"/mall/merchant.MallGoods/dealService",removeGoods:"/mall/merchant.MallGoods/delGoods",updateGoods:"/mall/merchant.MallGoods/addOrEditGoods",exportGoods:"/mall/merchant.MallGoods/exportGoods",getGoodsInfo:"/mall/merchant.MallGoods/getEditGoods",getGroupList:"/mall/merchant.MallGroup/getGroupList",groupAdd:"/mall/merchant.MallGroup/addGroup",groupChangeState:"/mall/merchant.MallGroup/changeState",groupDel:"/mall/merchant.MallGroup/del",getGroupInfo:"/mall/merchant.MallGroup/editDetail",getPeriodicList:"/mall/merchant.MallPeriodic/getPeriodicList",updatePeriodic:"/mall/merchant.MallPeriodic/addPeriodic",periodicChangeState:"/mall/merchant.MallPeriodic/changeState",removePeriodic:"/mall/merchant.MallPeriodic/del",getPeriodicInfo:"/mall/merchant.MallPeriodic/edit",getBargainList:"/mall/merchant.MallBargain/getBargainList",bargainAdd:"/mall/merchant.MallBargain/addBargain",bargainChangeState:"/mall/merchant.MallBargain/changeState",bargainDel:"/mall/merchant.MallBargain/del",getBargainInfo:"/mall/merchant.MallBargain/editDetail",getMinusDiscountList:"/mall/merchant.MallFullMinusDiscount/getFullMinusDiscountList",updateMinusDiscount:"/mall/merchant.MallFullMinusDiscount/addFullMinusDiscount",minusDiscountChangeState:"/mall/merchant.MallFullMinusDiscount/changeState",removeMinusDiscount:"/mall/merchant.MallFullMinusDiscount/del",getMinusDiscountInfo:"/mall/merchant.MallFullMinusDiscount/edit",getLimitedList:"/mall/merchant.MallLimited/getLimitedList",updateLimited:"/mall/merchant.MallLimited/addLimited",limitedChangeState:"/mall/merchant.MallLimited/changeState",removeLimited:"/mall/merchant.MallLimited/del",getLimitedInfo:"/mall/merchant.MallLimited/edit",getGoodsSortList:"/mall/merchant.MallGoodsSort/getSortList",delGoodsSort:"/mall/merchant.MallGoodsSort/delSort",editGoodsSort:"/mall/merchant.MallGoodsSort/addOrEditSort",getEditSort:"/mall/merchant.MallGoodsSort/getEditSort",editSort:"/mall/merchant.MallGoodsSort/saveSort",saveStatus:"/mall/merchant.MallGoodsSort/saveStatus",getAllGoodsSort:"/mall/merchant.MallGoodsSort/getSort",getStoreList:"/mall/merchant.MallMerchantReply/getStores",getReplyList:"/mall/merchant.MallMerchantReply/searchReply",addComment:"/mall/merchant.MallMerchantReply/merchantReply",getReplyDetails:"/mall/merchant.MallMerchantReply/getReplyDetails",getShowHomePage:"/mall/merchant.MallMerchantReply/getShowHomePage",getQualityReviews:"/mall/merchant.MallMerchantReply/getQualityReviews",getShowHomePageCancel:"/mall/merchant.MallMerchantReply/getShowHomePageCancel",getQualityReviewsCancel:"/mall/merchant.MallMerchantReply/getQualityReviewsCancel",getOrderList:"/mall/merchant.MallOrder/searchOrders",getOrderDetails:"/mall/merchant.MallOrder/getOrderDetails",getCollect:"/mall/merchant.MallOrder/getCollect",getDiscount:"/mall/merchant.MallOrder/getDiscount",exportOrder:"/mall/merchant.MallOrder/exportOrder ",deleteJudge:"/mall/merchant.MallGoods/deleteJudge ",getTemplateList:"/mall/merchant.ExpressTemplate/index",getTemplateAreaList:"/mall/merchant.ExpressTemplate/ajax_area",getTemplateAreaNameList:"/mall/merchant.ExpressTemplate/get_area_name",addTemplate:"/mall/merchant.ExpressTemplate/save",editTemplate:"/mall/merchant.ExpressTemplate/edit",delTemplate:"/mall/merchant.ExpressTemplate/delete",goodsBatch:"/mall/merchant.MallGoods/goodsBatch",viewLogistics:"/mall/merchant.MallOrder/viewLogistics",orderPrintTicket:"/mall/merchant.MallOrder/printOrder",getExpress:"/mall/merchant.MallOrder/getExpress",deliverGoodsByExpress:"/mall/merchant.MallOrder/deliverGoodsByExpress"};t["a"]=a},"4e5c":function(e,t,r){},"5f66":function(e,t,r){"use strict";var a={getOrderList:"/mall/storestaff.MallOrder/getOrderList",exportOrder:"/mall/storestaff.MallOrder/exportOrder",orderTaking:"/mall/storestaff.MallOrder/orderTaking",deliverGoodsByHouseman:"/mall/storestaff.MallOrder/deliverGoodsByHouseman",staffVerify:"/mall/storestaff.MallOrder/staffVerify",postponeDelivery:"/mall/storestaff.MallOrder/postponeDelivery",agreeRefund:"/mall/storestaff.MallOrder/AgreeRefund",getExpress:"/mall/storestaff.MallOrder/getExpress",deliverGoodsByExpress:"/mall/storestaff.MallOrder/deliverGoodsByExpress",viewLogistics:"/mall/storestaff.MallOrder/viewLogistics",refuseRefund:"/mall/storestaff.MallOrder/RefuseRefund",clerkDiscount:"/mall/storestaff.MallOrder/clerkDiscount",getOrderDetails:"/mall/storestaff.MallOrder/getOrderDetails",clerkNotes:"/mall/storestaff.MallOrder/clerkNotes",getPeriodicList:"/mall/storestaff.MallOrder/getPeriodicList",downExcel:"/mall/storestaff.MallOrder/downExcel",downFailExcel:"/mall/storestaff.MallOrder/downFailExcel",uploadUrl:"/common/common.UploadFile/uploadFile",uploadExcel:"/mall/storestaff.MallOrder/uploadFile",getList:"/mall/storestaff.MallOrder/shopGoodsBatchLogList",getOrderListCopy:"/mall/storestaff.MallOrder/getOrderListCopy",getOrderDetailsCopy:"/mall/storestaff.MallOrder/getOrderDetailsCopy",orderPrintTicket:"/mall/storestaff.MallOrder/printOrder"};t["a"]=a},"93f2":function(e,t,r){"use strict";r.r(t);var a=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("a-modal",{attrs:{title:e.title,visible:e.visible,maskClosable:!1,destroyOnClose:!0,width:"60%",bodyStyle:{maxHeight:"70vh",overflowY:"auto"}},on:{cancel:e.handleCancel}},[r("a-form-model",{attrs:{model:e.formData,"label-col":e.labelCol,"wrapper-col":e.wrapperCol}},e._l(e.formData.extra_delivery,(function(t,a){return r("div",{key:t.key},[r("a-form-model-item",{attrs:{label:"快递"}},[r("div",{staticClass:"flex"},[r("a-select",{staticStyle:{width:"80%"},attrs:{placeholder:"请选择"},on:{change:function(t){return e.hanleChange(t,a)}},model:{value:t.express_id,callback:function(r){e.$set(t,"express_id",r)},expression:"item.express_id"}},e._l(e.expressOptions,(function(t){return r("a-select-option",{key:t.id},[e._v(" "+e._s(t.name)+e._s("1"==t.is_singface?"（电子面单）":"")+" ")])})),1),0!=a?r("a-button",{staticClass:"ml-10",attrs:{type:"danger"},on:{click:function(t){return e.handleExpress("del",a)}}},[e._v("删除")]):e._e()],1)]),r("a-form-model-item",{attrs:{label:"快递单号"}},[r("a-input",{staticStyle:{width:"80%"},attrs:{placeholder:"请输入快递单号"},model:{value:t.express_no,callback:function(r){e.$set(t,"express_no",r)},expression:"item.express_no"}})],1),r("a-form-model-item",{attrs:{label:"发货商品",help:"不选择，为空表示发货所有商品。"}},[r("a-select",{staticStyle:{width:"80%"},attrs:{mode:"multiple",placeholder:"请选择"},model:{value:t.order_detail_ids,callback:function(r){e.$set(t,"order_detail_ids",r)},expression:"item.order_detail_ids"}},e._l(e.goodsList,(function(t){return r("a-select-option",{key:t.id,attrs:{value:t.id}},[e._v(" "+e._s(t.show_name)+" ")])})),1)],1)],1)})),0),r("template",{slot:"footer"},[r("div",{staticClass:"flex justify-center align-center"},[r("a-button",{key:"add",staticClass:"mr-20",on:{click:function(t){return e.handleExpress("add")}}},[e._v(" 添加快递 ")]),r("a-button",{key:"back",staticClass:"mr-20",on:{click:function(t){return e.btnOpt(2)}}},[e._v(" 普通发货 ")]),r("a-button",{key:"submit",attrs:{type:"primary",disabled:e.isCanSingface},on:{click:function(t){return e.btnOpt(1)}}},[e._v(" 电子面单发货 ")])],1)])],2)},s=[],o=r("5530"),i=(r("a9e3"),r("d81d"),r("ac1f"),r("1276"),r("d3b7"),r("159b"),r("b0c0"),r("a15b"),r("5f66")),l=r("4031"),n={props:{visible:Boolean,title:String,order:Object,nowPeriodicItem:{type:Object,default:{}},fh_type:[String,Number],pageType:{type:String,default:"storestaff"}},data:function(){return{labelCol:{span:4},wrapperCol:{span:16},formData:{order_id:"",activity_type:"",periodic_order_id:"",current_periodic:"",periodic_count:"",express_type:"",express_no:"",express_id:"",express_name:"",fh_type:"1",extra_delivery:[{express_id:void 0,express_name:"",express_no:"",order_detail_ids:[],is_singface:0,key:0}]},expressOptions:[]}},computed:{goodsList:function(){var e=this.order.children||[];return e.length&&(e=e.map((function(e){return e.show_name=e.goods_name,e.sku_info&&(e.show_name=e.show_name+"(".concat(e.sku_info,")")),e}))),e},isCanSingface:function(){var e=!1;return(2==this.fh_type||this.formData.extra_delivery.length>1||1!=this.formData.extra_delivery[0]["is_singface"])&&(e=!0),e}},created:function(){this.getExpress()},methods:{getExpress:function(){var e=this,t={merchant:l["a"].getExpress,storestaff:i["a"].getExpress};this.request(t[this.pageType],{}).then((function(t){e.expressOptions=t||[],e.handleExtraDelivery()}))},handleExtraDelivery:function(){if(2==this.fh_type){this.$set(this.formData,"express_id",this.order.express_id||""),this.$set(this.formData,"express_no",this.order.express_num||""),this.$set(this.formData,"express_name",this.order.express_name||"");var e=[];if(e="periodic"==this.order.goods_activity_type&&this.nowPeriodicItem?this.nowPeriodicItem.delivery||[]:this.order.delivery||[],Array.isArray(e)&&e.length){var t=e.map((function(e,t){var r=e.order_detail_ids?e.order_detail_ids.split(","):[];return r.length&&(r=r.map((function(e){return e-0}))),{express_id:e.express_id,express_name:e.express_name,express_no:e.express_num,order_detail_ids:r,key:t}}));this.$set(this.formData,"extra_delivery",t)}else if("periodic"!=this.order.goods_activity_type&&this.order.express_id){var r=[{express_id:this.order.express_id,express_name:this.order.express_name,express_no:this.order.express_num,order_detail_ids:[],key:0}];this.$set(this.formData,"extra_delivery",r)}}console.log("this.formData",this.formData)},hanleChange:function(e,t){var r=this.formData.extra_delivery[t];r.express_id=e,this.expressOptions.forEach((function(t){t.id==e&&(r.express_name=t.name,r.is_singface=t.is_singface)})),this.$set(this.formData.extra_delivery,t,r)},btnOpt:function(e){var t=this;this.$set(this.formData,"express_type",e);var r=this.formData.extra_delivery.some((function(e){return!e.express_id}));if(r)this.$message.error("请选择快递");else{if(2==e){if(this.formData.extra_delivery.some((function(e){return!e.express_no})))return void this.$message.error("请输入快递单号");var a=/[\u4e00-\u9fa5]/;if(this.formData.extra_delivery.some((function(e){return a.test(e.express_no)})))return void this.$message.error("不能输入中文")}var s=this.formData.extra_delivery.map((function(e){return{express_id:e.express_id,express_no:e.express_no,order_detail_ids:e.order_detail_ids.length?e.order_detail_ids.join(","):"",express_name:e.express_name}})),n=this.order,d=n.order_id,c=n.goods_activity_type,m=n.order_type,p=n.current_periodic,_=n.periodic_count,f=this.nowPeriodicItem&&this.nowPeriodicItem.purchase_order_id?this.nowPeriodicItem.purchase_order_id:"";this.$set(this.formData,"order_id",d),this.$set(this.formData,"activity_type",c),"periodic"==m&&(this.$set(this.formData,"periodic_order_id",f),this.$set(this.formData,"current_periodic",p),this.$set(this.formData,"periodic_count",_)),this.$set(this.formData,"fh_type",this.fh_type);var u=Object(o["a"])(Object(o["a"])({},this.formData),{},{express_id:s[0].express_id,express_no:s[0].express_no,express_name:s[0].express_name,extra_delivery:2==e?s:[],store_id:this.order.store_id||""}),h={merchant:l["a"].deliverGoodsByExpress,storestaff:i["a"].deliverGoodsByExpress};this.request(h[this.pageType],u).then((function(e){var r="1"==t.fh_type?"订单发货成功":"快递更改成功";t.$message.success(r),t.handleCancel(),t.$emit("updateList")}))}},handleCancel:function(){this.$emit("handleCancel"),this.formData={order_id:"",activity_type:"",periodic_order_id:"",current_periodic:"",periodic_count:"",express_type:"",express_no:"",express_id:"",express_name:"",fh_type:"1",extra_delivery:[{express_id:void 0,express_name:"",express_no:"",order_detail_ids:[],is_singface:0,key:0}]}},handleExpress:function(e,t){if("add"==e){var r=this.formData.extra_delivery;r.push({express_id:void 0,express_name:"",express_no:"",order_detail_ids:[],is_singface:0,key:r.length}),this.$set(this.formData,"extra_delivery",r)}"del"==e&&this.$delete(this.formData.extra_delivery,t)}}},d=n,c=r("2877"),m=Object(c["a"])(d,a,s,!1,null,"3648c2eb",null);t["default"]=m.exports},"99a5":function(e,t,r){"use strict";r.r(t);var a=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"order-item-wrap"},[r("a-row",{staticClass:"order-item-header",attrs:{type:"flex",justify:"space-between"}},[r("a-col",{staticStyle:{"padding-top":"5px"},attrs:{span:20}},[r("div",{staticClass:"text-wrap"},[r("span",{staticClass:"mr-30"},[e._v("订单编号："+e._s(e.order.order_no))]),r("span",{staticClass:"mr-30"},[e._v("下单时间："+e._s(e.order.create_time))]),r("span",{staticClass:"mr-30"},[e._v("订单类型："+e._s(e.order.order_type_txt))])]),0!=e.order.status?r("div",{staticClass:"text-wrap",staticStyle:{"margin-top":"10px"}},[r("span",{staticClass:"mr-30"},[e._v("付款方式："+e._s(e.order.pay_type))]),e.order.verify_text?r("span",[e._v("核销方式："+e._s(e.order.verify_text))]):e._e()]):e._e()]),r("a-col",{staticStyle:{display:"flex","flex-direction":"column","align-items":"center","padding-left":"30px"},attrs:{span:3}},[r("a-button",{attrs:{type:"link",disabled:e.btnDisabled&&"order_print_ticket"==e.currentBtn.props},on:{click:e.orderPrintTicket}},[e._v("补打小票")]),r("a-button",{attrs:{type:"link"},on:{click:e.orderDetail}},[e._v(" 查看详情")])],1)],1),r("a-row",{staticClass:"order-item-content",attrs:{type:"flex",justify:"space-between"}},[r("a-col",{attrs:{span:10}},["periodic"==e.order.order_type?r("div",{staticClass:"goods-wrap"},[e._l(e.goods,(function(t,a){return r("div",{key:a,staticClass:"goods-item"},[r("a-row",{staticClass:"pt-20 pb-20 order-item-content-goods",attrs:{type:"flex",justify:"space-between",align:"middle"}},[e.order.periodic_info&&e.order.periodic_info.length?r("a-col",{attrs:{span:9}},[r("div",{staticClass:"flex align-center"},[r("a-avatar",{attrs:{shape:"square",size:64,src:t.image}}),r("div",{staticClass:"flex flex-column pl-10 pr-10 flex-1 sx-hidden"},[r("span",{staticClass:"goods-name flex-1"},[e._v(e._s(t.goods_name))]),r("span",{directives:[{name:"show",rawName:"v-show",value:t.sku_info,expression:"goodsItem.sku_info"}]},[e._v(e._s(t.sku_info))])])],1)]):r("a-col",{attrs:{span:12}},[r("div",{staticClass:"flex align-center"},[r("a-avatar",{attrs:{shape:"square",size:64,src:t.image}}),r("div",{staticClass:"flex flex-column pl-10 pr-10 flex-1 sx-hidden"},[r("span",{staticClass:"goods-name flex-1"},[e._v(e._s(t.goods_name))]),r("span",{directives:[{name:"show",rawName:"v-show",value:t.sku_info,expression:"goodsItem.sku_info"}]},[e._v(e._s(t.sku_info))])])],1)]),r("a-col",{staticClass:"text-center",attrs:{span:6}},[e._v(e._s(e.currency)+e._s(t.price))]),e.order.periodic_info&&e.order.periodic_info.length?r("a-col",{staticClass:"text-center goods-num",attrs:{span:6}},[r("span",[e._v("共"+e._s(e.order.periodic_info[0].periodic_count)+"期")]),r("a-divider",{attrs:{type:"vertical"}}),r("span",[e._v("共"+e._s(e.order.periodic_info[0].periodic_count*e.order.total_num)+"件")])],1):e.order.status>=60&&e.order.status<80?r("a-col",{staticClass:"text-center goods-num",attrs:{span:6}},[e._v(" "+e._s(t.num)+" ")]):r("a-col",{attrs:{span:6}},[r("a-row",[r("span",[e._v("共"+e._s(e.order.periodic_num)+"期")]),r("a-divider",{attrs:{type:"vertical"}}),r("span",[e._v("共"+e._s(e.order.periodic_num*e.order.total_num)+"件")])],1),r("a-row",[e._v(" 暂未到下期发货时间 ")])],1),r("a-col",{staticClass:"text-center goods-num",attrs:{span:3},on:{click:e.changeIcon}},[r("a-icon",{attrs:{type:e.icon_type,hidden:!e.order.periodic_info||e.order.periodic_info&&!e.order.periodic_info.length}})],1)],1)],1)})),e._l(e.order.periodic_info,(function(t,a){return e.order.periodic_info.length&&"down-circle"==e.icon_type?r("div",{key:t.purchase_order_id,staticClass:"goods-item"},[r("a-row",{staticClass:"pt-20 pb-20 order-item-content-goods_periodic",attrs:{type:"flex",justify:"space-between",align:"middle"}},[r("a-col",{attrs:{span:6}},[r("a-tag",{attrs:{color:"#f50"}},[e._v("第"+e._s(t.current_periodic)+"期")])],1),r("a-col",{attrs:{span:3}},[r("span",[e._v("数量X"+e._s(e.order.total_num))])]),r("a-col",{attrs:{span:10}},[r("span",[e._v(e._s(t.is_complete_txt))]),r("a-divider",{attrs:{type:"vertical"}}),r("span",[e._v("期望送达时间："+e._s(t.periodic_date))])],1),r("a-col",{attrs:{span:5}},[r("div",{staticClass:"content-item"},e._l(e.periodicBtnListArr[a],(function(a){return r("span",{key:a.props},[1==a.show?r("a-button",{style:{color:a.color},attrs:{type:"link"},on:{click:function(r){return e.btnOpt(a,t)}}},[e._v(" "+e._s(a.label)+" ")]):e._e()],1)})),0)])],1)],1):e._e()}))],2):r("div",{staticClass:"goods-wrap"},e._l(e.goods,(function(t,a){return r("div",{directives:[{name:"show",rawName:"v-show",value:t.show,expression:"goodsItem.show"}],key:a,staticClass:"goods-item"},[r("a-row",{staticClass:"pt-20 pb-20 order-item-content-goods",class:1!=a&&e.fold&&e.goods.length>1||a!=e.goods.length-1&&!e.fold?"border-bottom":"",attrs:{type:"flex",justify:"space-between",align:"middle"}},[r("a-col",{attrs:{span:12}},[r("div",{staticClass:"flex align-center"},[r("a-avatar",{attrs:{shape:"square",size:64,src:t.image}}),r("div",{staticClass:"flex flex-column pl-10 pr-10 flex-1 sx-hidden"},[r("span",{staticClass:"goods-name flex-1"},[e._v(e._s(t.goods_name))]),r("span",{directives:[{name:"show",rawName:"v-show",value:t.sku_info,expression:"goodsItem.sku_info"}]},[e._v(e._s(t.sku_info))]),1==t.is_gift?r("span",[r("a-tag",{attrs:{color:"#108ee9"}},[e._v("赠品")])],1):e._e(),t.refund_desc?r("span",e._l(t.refund_desc,(function(t,a){return r("a-tag",{key:a,attrs:{color:"red"}},[e._v(e._s(t))])})),1):e._e()])],1)]),r("a-col",{staticClass:"text-center",attrs:{span:6}},[e._v(e._s(e.currency)+e._s(t.price))]),r("a-col",{staticClass:"text-center goods-num",staticStyle:{display:"flex","flex-direction":"column"},attrs:{span:6}},[r("span",[e._v(e._s(t.num))]),r("span",{directives:[{name:"show",rawName:"v-show",value:e.goods.length>2&&1==a&&e.fold,expression:"goods.length > 2 && goodsIndex == 1 && fold"}],staticClass:"fold-btn"},[r("a-button",{key:"unfold",attrs:{type:"link"},on:{click:function(t){return e.foldMenu("unfold")}}},[e._v(" 展开"),r("a-icon",{attrs:{type:"down"}})],1)],1),r("span",{directives:[{name:"show",rawName:"v-show",value:a==e.goods.length-1&&!e.fold,expression:"goodsIndex == goods.length - 1 && !fold"}],staticClass:"fold-btn"},[r("a-button",{key:"fold",attrs:{type:"link"},on:{click:function(t){return e.foldMenu("fold")}}},[e._v(" 收起"),r("a-icon",{attrs:{type:"up"}})],1)],1)])],1)],1)})),0)]),r("a-col",{attrs:{span:14}},[r("a-row",{staticClass:"height-inherit",attrs:{type:"flex",justify:"space-between"}},[r("a-col",{attrs:{span:4}},[r("div",{staticClass:"content-item text-wrap",staticStyle:{height:"50%"}},[r("span",[e._v(e._s(e.order.username))]),r("span",[e._v(e._s(e.order.phone))])]),r("div",{staticClass:"content-item text-wrap",staticStyle:{height:"50%","border-top":"1px solid #e8e8e8"}},[e._v(" "+e._s(e.order.store_name)+" ")])]),r("a-col",{attrs:{span:4}},[r("div",{staticClass:"content-item"},[r("span",[e._v(e._s(e.order.address))])])]),r("a-col",{attrs:{span:4}},[r("div",{staticClass:"content-item"},[e.order.periodic_count&&"periodic"==e.order.order_type?r("span",[r("span",[e._v(" 共计 "+e._s(e.order.periodic_count)+" 期 ")]),e.order.refund_count_periodic?r("span",[e._v(" 退款 "),r("span",{staticClass:"cr-red"},[e._v(" "+e._s(e.order.refund_count_periodic)+" ")]),e._v(" 期 ")]):e._e()]):e._e(),r("span",[e._v("商品总价："+e._s(e.currency)+e._s(e.order.money_total))]),e.order.discount_total?r("span",{staticClass:"popover"},[r("a-popover",{attrs:{title:"",trigger:"click",getPopupContainer:function(e){return e.parentNode}},model:{value:e.discountTotalVisible,callback:function(t){e.discountTotalVisible=t},expression:"discountTotalVisible"}},[r("span",{attrs:{slot:"content"},slot:"content"},[r("a-list",{attrs:{"item-layout":"horizontal","data-source":e.discountList},scopedSlots:e._u([{key:"renderItem",fn:function(t){return t.value&&0!=t.value?r("a-list-item",{staticClass:"flex"},[r("a-badge",{attrs:{color:"red",text:t.label+"：-"+e.currency+t.value}})],1):e._e()}}],null,!0)})],1),e.order.discount_total&&0!=e.order.discount_total?r("span",{staticClass:"pointer",on:{click:function(t){e.discountTotalVisible=!e.discountTotalVisible}}},[e._v(" 总优惠 "),r("a-icon",{attrs:{type:"exclamation-circle"}}),e._v(" ： "),r("span",[e._v("-"+e._s(e.currency)+e._s(e.order.discount_total))])],1):e._e()])],1):e._e(),e.order.money_freight&&0!=e.order.money_freight?r("span",[e._v(" 运费：+"+e._s(e.currency)+e._s(e.order.money_freight)+" ")]):e._e(),e.order.bargain_price&&0!=e.order.bargain_price&&"prepare"==e.order.order_type?r("span",[e._v(" 定金"+e._s(e.currency)+e._s(e.order.bargain_price)+" "),e.order.deduct_price&&0!=e.order.deduct_price?r("span",[e._v(" 抵"+e._s(e.currency)+e._s(e.order.deduct_price)+" ")]):e._e()]):e._e(),e.order.status&&e.order.bargain_price&&0!=e.order.bargain_price&&"prepare"==e.order.order_type?r("span",{staticClass:"cr-red"},[e._v(" 已支付定金："+e._s(e.currency)+e._s(e.order.real_bargain_price)+" ")]):e._e(),r("span",{staticClass:"fw-bold popconfirm"},[0==e.order.status?r("span",{staticClass:"cr-black"},[e._v("待付款："),r("span",{staticClass:"cr-red"},[e._v(e._s(e.currency)+e._s(e.order.real_bargain_price))])]):e._e(),1==e.order.status?r("span",{staticClass:"cr-black"},[e._v("尾款待付款："),r("span",{staticClass:"cr-red"},[e._v(e._s(e.currency)+e._s(e.order.rest_price))])]):e._e(),e.order.status>=10?r("span",{staticClass:"cr-black"},[e._v("实付款："),r("span",{staticClass:"cr-red"},[e._v(e._s(e.currency)+e._s(e.order.money_real))])]):e._e(),r("a-popconfirm",{attrs:{"ok-text":"确认","cancel-text":"取消",visible:e.moneyRealVisible,getPopupContainer:function(e){return e.parentNode}},on:{confirm:e.clerkDiscountConfoirm,cancel:function(t){e.after_money="",e.moneyRealVisible=!1}}},[r("template",{slot:"title"},[r("p",[e._v("确认修改待付款金额？")]),r("p",[r("a-input-number",{staticStyle:{width:"100%"},attrs:{placeholder:"请输入",min:0},model:{value:e.after_money,callback:function(t){e.after_money=t},expression:"after_money"}})],1)]),0==e.order.status&&1==e.order.clerk_modify?r("a-icon",{staticClass:"ml-5",attrs:{type:"form"},on:{click:function(t){e.moneyRealVisible=!e.moneyRealVisible}}}):e._e()],2)],1),e.order.status>=60&&e.order.status<80&&(e.order.refund_money_periodic&&0!=e.order.refund_money_periodic||e.order.refund_money&&0!=e.order.refund_money)&&1==e.order.is_all?r("span",{staticClass:"cr-red"},[e._v(" 退款金额："+e._s(e.currency)+e._s("periodic"==e.order.order_type?e.order.refund_money_periodic:e.order.refund_money)+" ")]):e._e(),e.order.status>=60&&e.order.status<80&&(e.order.refund_money_periodic&&0!=e.order.refund_money_periodic||e.order.refund_money&&0!=e.order.refund_money)&&0==e.order.is_all?r("span",{staticClass:"cr-red"},[e._v(" 部分退款金额："+e._s(e.currency)+e._s("periodic"==e.order.order_type?e.order.refund_money_periodic:e.order.refund_money)+" ")]):e._e()])]),r("a-col",{attrs:{span:4}},[r("div",{staticClass:"content-item"},[r("span",[e._v(e._s(e.order.express_style_txt))]),1==e.order.express_style&&"periodic"!=e.order.order_type?r("span",[e._v("期望送达时间："+e._s(e.order.current_time))]):e._e()])]),r("a-col",{attrs:{span:4}},[r("div",{staticClass:"content-item"},[r("span",[r("span",[e._v(e._s(e.order.status_txt||"---"))])]),e.order.express_current_time?r("span",{staticClass:"cr-red"},[e._v(" "+e._s(e.moment(e.order.express_current_time).format("YYYY.MM.DD"))+"送达 ")]):e._e(),10==e.order.status&&e.order.send_time&&"prepare"==e.order.order_type?r("span",{staticClass:"cr-red"},[e._v(" 发货时间："+e._s(e.moment(e.order.send_time).format("YYYY.MM.DD"))+" ")]):e._e()])]),r("a-col",{attrs:{span:4}},[e.isHasBtn||"periodic"==e.order.goods_activity_type&&e.order.status>=60&&e.order.status<80?r("div",{staticClass:"content-item"},e._l(e.btnList,(function(t){return r("span",{key:t.props},[1==t.show?r("a-button",{style:{color:t.color},attrs:{type:"link",disabled:e.btnDisabled&&e.currentBtn.props==t.props},on:{click:function(r){return e.btnOpt(t)}}},[e._v(" "+e._s(t.label)+" ")]):e._e()],1)})),0):r("div",{staticClass:"content-item"},[e._v("---")])])],1)],1)],1),e.order.clerk_remark&&""!=e.order.clerk_remark?r("a-row",{staticClass:"clerk_remark"},[e._v(" 店员备注："+e._s(e.order.clerk_remark)+" ")]):e._e(),"express_btn"==e.currentBtn.props?r("deliverGoods",{attrs:{visible:e.deliverGoodsVisible,title:e.currentBtn.title,order:e.order,nowPeriodicItem:e.nowPeriodicItem,fh_type:1,pageType:"storestaff"},on:{handleCancel:function(t){e.deliverGoodsVisible=!1,e.currentBtn=""},updateList:e.updateList}}):e._e(),"trajectory_btn"==e.currentBtn.props||"logistics_btn"==e.currentBtn.props?r("logistics",{attrs:{visible:e.logisticsVisible,title:e.currentBtn.title,order:e.order,nowPeriodicItem:e.nowPeriodicItem,pageType:"storestaff"},on:{handleCancel:function(t){e.logisticsVisible=!1,e.currentBtn=""}}}):e._e(),"refuse_refund_btn"==e.currentBtn.props?r("refuseRefundCopy",{attrs:{visible:e.refuseRefundVisible,title:e.currentBtn.title,order:e.order,nowPeriodicItem:e.nowPeriodicItem},on:{handleCancel:function(t){e.refuseRefundVisible=!1,e.currentBtn=""},updateList:e.updateList}}):e._e()],1)},s=[],o=(r("a9e3"),r("d81d"),r("4de4"),r("d3b7"),r("c1df")),i=r.n(o),l=r("5f66"),n=r("93f2"),d=r("d0d3"),c=r("ec449"),m={props:{order:Object,tabStatus:[Number,String]},components:{deliverGoods:n["default"],logistics:d["default"],refuseRefundCopy:c["default"]},data:function(){return{fold:!0,discountTotalVisible:!1,goods:[],discountList:[{label:"平台优惠券优惠金额",value:"",props:"discount_system_coupon"},{label:"商家优惠券优惠金额",value:"",props:"discount_merchant_coupon"},{label:"商家会员卡优惠金额",value:"",props:"discount_merchant_card"},{label:"平台会员等级优惠金额",value:"",props:"discount_system_level"},{label:"店员优惠金额",value:"",props:"discount_clerk_money"},{label:"参加活动优惠金额",value:"",props:"discount_act_money"}],btnList:[{label:"接单",props:"take_btn",show:"0",action:"",tips:"是否确定接单？",success:"接单成功",api:"orderTaking",color:"#1890ff"},{label:"骑手配送",props:"hoseman_btn",show:"0",action:"",tips:"是否确定骑手配送？",success:"订单已转至骑手配送！",api:"deliverGoodsByHouseman",color:"#1890ff"},{label:"店员核销",props:"clerk_btn",show:"0",action:"confirm",tips:"是否确定核销？",success:"该订单已核销",api:"staffVerify",color:"#1890ff"},{label:"快递发货",props:"express_btn",show:"0",action:"modal",title:"发货",color:"#1890ff"},{label:"查看物流",props:"logistics_btn",show:"0",action:"modal",title:"查看物流",color:"#1890ff"},{label:"顺延配送",props:"postpone_btn",show:"0",action:"confirm",tips:"是否确定顺延配送？",success:"该订单已顺延配送",api:"postponeDelivery",color:"rgb(250, 173, 20)"},{label:"骑手轨迹",props:"trajectory_btn",show:"0",action:"modal",title:"骑手轨迹",color:"#1890ff"},{label:"同意退款",props:"agree_refund_btn",show:"0",action:"confirm",tips:"是否确定同意退款？",success:"同意退款成功",api:"agreeRefund",color:"#1890ff"},{label:"拒绝退款",props:"refuse_refund_btn",show:"0",action:"modal",title:"拒绝退款",color:"rgb(250, 173, 20)"}],currentBtn:"",deliverGoodsVisible:!1,logisticsVisible:!1,refuseRefundVisible:!1,moneyRealVisible:!1,after_money:"",isHasBtn:0,isHasPeriodicBtn:[],periodicBtnListArr:[],currency:"￥",icon_type:"right-circle",nowPeriodicItem:[],btnDisabled:!1}},watch:{order:function(){this.initGoods(),this.initDiscountList(),this.initBtnList(),this.initPeriodicBtnList()}},mounted:function(){this.initGoods(),this.initDiscountList(),this.initBtnList(),this.initPeriodicBtnList()},methods:{moment:i.a,foldMenu:function(e){"unfold"==e?(this.fold=!1,this.goods=this.goods.map((function(e,t){return e.show=!0,e}))):(this.fold=!0,this.initGoods())},initGoods:function(){this.goods=this.order&&this.order.children?this.order.children:[],this.goods.length&&(this.goods=this.goods.map((function(e,t){return e.show=!(t>1),e})))},initDiscountList:function(){var e=this;this.discountList=this.discountList.map((function(t){return e.order&&(t.value=e.order[t.props]),t}))},initBtnList:function(){var e=this;this.btnList=this.btnList.map((function(t){return t.show=e.order.button[t.props],(70==e.order.status&&("logistics_btn"==t.props||"trajectory_btn"==t.props)||e.order.status<60&&"periodic"==e.order.goods_activity_type)&&(t.show=0),t})),this.isHasBtn=this.btnList.filter((function(e){return 1==e.show})).length},initPeriodicBtnList:function(){var e=this;if(this.order.periodic_info)for(var t=function(t){var r=[{label:"接单",props:"take_btn",show:"0",action:"",tips:"是否确定接单？",success:"接单成功",api:"orderTaking",color:"#1890ff"},{label:"骑手配送",props:"hoseman_btn",show:"0",action:"",tips:"是否确定骑手配送？",success:"订单已转至骑手配送！",api:"deliverGoodsByHouseman",color:"#1890ff"},{label:"店员核销",props:"clerk_btn",show:"0",action:"confirm",tips:"是否确定核销？",success:"该订单已核销",api:"staffVerify",color:"#1890ff"},{label:"快递发货",props:"express_btn",show:"0",action:"modal",title:"发货",color:"#1890ff"},{label:"查看物流",props:"logistics_btn",show:"0",action:"modal",title:"查看物流",color:"#1890ff"},{label:"顺延配送",props:"postpone_btn",show:"0",action:"confirm",tips:"是否确定顺延配送？",success:"该订单已顺延配送",api:"postponeDelivery",color:"rgb(250, 173, 20)"},{label:"骑手轨迹",props:"trajectory_btn",show:"0",action:"modal",title:"骑手轨迹",color:"#1890ff"},{label:"同意退款",props:"agree_refund_btn",show:"0",action:"confirm",tips:"是否确定同意退款？",success:"同意退款成功",api:"agreeRefund",color:"#1890ff"},{label:"拒绝退款",props:"refuse_refund_btn",show:"0",action:"modal",title:"拒绝退款",color:"rgb(250, 173, 20)"}];e.periodicBtnListArr[t]=r.map((function(r){return r.show=e.order.periodic_info[t].button[r.props],r}))},r=0;r<this.order.periodic_info.length;r++)t(r)},btnOpt:function(e){var t=this,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.currentBtn=e;var a=this.currentBtn,s=a.api,o=void 0===s?"":s,i=(a.success,a.tips),l=void 0===i?"":i,n=a.action,d=void 0===n?"":n,c=a.props,m=void 0===c?"":c;d||o&&this.btnRequest(this.order,this.currentBtn,r),"confirm"==d&&this.$confirm({title:l||"提醒",content:"",okText:"确认",cancelText:"取消",onOk:function(){o&&t.btnRequest(t.order,t.currentBtn,r)},onCancel:function(){t.currentBtn=""},class:"test"}),"modal"==d&&("express_btn"==m?this.deliverGoodsVisible=!0:"trajectory_btn"==m||"logistics_btn"==m?this.logisticsVisible=!0:"refuse_refund_btn"==m&&(this.refuseRefundVisible=!0),this.nowPeriodicItem=r)},btnRequest:function(e,t){var r=this,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[];this.btnDisabled=!0;var s=this.currentBtn,o=s.api,i=void 0===o?"":o,n=s.success,d=void 0===n?"":n,c=(s.tips,s.action,s.props),m=void 0===c?"":c,p=e.order_id,_=e.refund_id,f=e.is_all,u=e.order_type,h=e.status,g={order_id:p},v=["postpone_btn","take_btn","agree_refund_btn","hoseman_btn"];"periodic"==u&&-1!=v.indexOf(m)&&(g.periodic_order_id=a.purchase_order_id,g.current_periodic=a.current_periodic,g.periodic_count=a.periodic_count),h>=60&&h<70&&-1!=v.indexOf(m)&&(g.refund_id=_,g.is_all=f),this.request(l["a"][i],g).then((function(e){r.$message.success(d),r.updateList(),r.btnDisabled=!1})).catch((function(e){r.btnDisabled=!1}))},clerkDiscountConfoirm:function(){var e=this,t=["",null,void 0,"null","undefined"];if(-1==t.indexOf(this.after_money)){var r={order_id:this.order.order_id,before_money:this.order.money_real,after_money:this.after_money};this.request(l["a"].clerkDiscount,r).then((function(t){e.$message.success("修改成功"),e.after_money="",e.moneyRealVisible=!1,e.updateItem(e.order.order_id)}))}else this.$message.error("请输入修改后的金额")},updateList:function(){this.$emit("getOrderList")},updateItem:function(e){this.$emit("updateItem",{order_id:e})},orderDetail:function(){var e=this.order,t=e.order_id,r=void 0===t?"":t,a=e.periodic_order_id,s=void 0===a?"":a,o=e.order_type,i=e.refund_id,l=void 0===i?"":i,n={order_id:r,tabStatus:this.tabStatus};s&&"periodic"==o&&(n.periodic_order_id=s),l&&(n.refund_id=l);var d=this.$router.resolve({path:"/storestaff/storestaff.mall/mall/orderDetailCopy",query:n});window.open(d.href,"_blank")},changeIcon:function(){this.icon_type="down-circle"==this.icon_type?"right-circle":"down-circle"},orderPrintTicket:function(){var e=this;this.currentBtn||(this.currentBtn={}),this.$set(this.currentBtn,"props","order_print_ticket");var t={order_id:this.order.order_id};this.btnDisabled=!0,this.request(l["a"].orderPrintTicket,t).then((function(t){e.$message.success("打印成功"),e.btnDisabled=!1})).catch((function(){e.btnDisabled=!1}))}}},p=m,_=(r("eb30"),r("2877")),f=Object(_["a"])(p,a,s,!1,null,"098fa576",null);t["default"]=f.exports},ce73:function(e,t,r){},d0d3:function(e,t,r){"use strict";r.r(t);var a=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("a-modal",{attrs:{title:e.title,visible:e.visible,maskClosable:!1,footer:null,width:"60%",bodyStyle:{maxHeight:"80vh",overflowY:"auto",paddingTop:e.extraDelivery.length>1?"10px":"24px"}},on:{ok:e.handleCancel,cancel:e.handleCancel}},[e.rider_name?r("span",[r("span",[e._v("骑手："+e._s(e.rider_name))]),r("a-divider",{attrs:{type:"virticle"}}),r("span",[e._v("骑手号码："+e._s(e.rider_phone))]),r("a-divider")],1):e._e(),e.order&&1==e.order.express_style?[e.noData?r("a-empty",{attrs:{image:e.simpleImage}},[r("span",{attrs:{slot:"description"},slot:"description"},[e._v("暂无骑手轨迹")])]):r("a-timeline",{attrs:{pending:e.pending,reverse:!0}},e._l(e.logistics,(function(t,a){return r("a-timeline-item",{key:a},[r("p",{staticClass:"mb-0"},[e._v(e._s(e.moment(t.time).format("YYYY-MM-DD HH:mm")))]),r("span",[e._v(e._s(t.context))])])})),1)]:e._e(),e.order&&2==e.order.express_style?[e.noData?r("a-empty",{attrs:{image:e.simpleImage}},[r("span",{attrs:{slot:"description"},slot:"description"},[e._v("暂无物流信息")])]):[e.periodicInfo.length?r("div",{staticClass:"flex align-center",class:[{"mb-20":1==e.extraDelivery.length}]},[r("span",{staticClass:"ant-form-item-label"},[e._v("配送周期：")]),r("a-select",{staticStyle:{width:"200px"},attrs:{placeholder:"请选择"},on:{change:function(t){return e.handleChange(t)}},model:{value:e.currentPeriodic,callback:function(t){e.currentPeriodic=t},expression:"currentPeriodic"}},e._l(e.periodicInfo,(function(t){return r("a-select-option",{key:t.current_periodic},[e._v(" 第"+e._s(t.current_periodic)+"期 ")])})),1)],1):e._e(),1==e.extraDelivery.length?[r("div",{staticClass:"text-wrap mb-20"},[r("span",{staticClass:"mr-20"},[e._v("物流名称："+e._s(e.extraDelivery[0]["express_name"]||"---"))]),r("span",[e._v("物流单号："+e._s(e.extraDelivery[0]["express_num"]||"---"))])]),e.extraDelivery[0]["goods_detail"]?r("div",{staticClass:"text-wrap mb-20 flex"},[r("span",[e._v("包含商品：")]),r("div",{staticClass:"flex flex-1",staticStyle:{"flex-wrap":"wrap"}},e._l(e.extraDelivery[0]["goods_detail"],(function(t,a){return r("div",{key:a,staticClass:"ml-10 mb-10 flex flex-column"},[r("img",{staticStyle:{width:"50px",height:"50px"},attrs:{src:t.image,alt:""}}),r("span",{staticClass:"no-wrap",staticStyle:{"max-width":"50px"},attrs:{title:t.name}},[e._v(e._s(t.name))])])})),0)]):e._e(),r("div",{staticStyle:{"max-height":"52vh","overflow-y":"auto","padding-top":"10px"}},[e.extraDelivery[0].logistics&&e.extraDelivery[0].logistics.data&&e.extraDelivery[0].logistics.data.length?r("a-timeline",{attrs:{pending:e.pending,reverse:!0}},e._l(e.extraDelivery[0].logistics.data,(function(t,a){return r("a-timeline-item",{key:a},[r("p",{staticClass:"mb-0"},[e._v(e._s(e.moment(t.time).format("YYYY-MM-DD HH:mm")))]),r("span",[e._v(e._s(t.context))])])})),1):r("p",[e._v(e._s(e.extraDelivery[0].logistics.stateMessage||"暂无物流信息"))])],1)]:e._e(),e.extraDelivery.length>1?[r("a-tabs",{on:{change:e.tabsChange},model:{value:e.activeKey,callback:function(t){e.activeKey=t},expression:"activeKey"}},e._l(e.extraDelivery,(function(t,a){return r("a-tab-pane",{key:a,attrs:{tab:"包裹"+(a+1)}},[r("div",{staticClass:"text-wrap mb-20"},[r("span",{staticClass:"mr-20"},[e._v("物流名称："+e._s(t.express_name||"---"))]),r("span",[e._v("物流单号："+e._s(t.express_num||"---"))])]),t.goods_detail?r("div",{staticClass:"text-wrap mb-20 flex"},[r("span",[e._v("包含商品：")]),r("div",{staticClass:"flex flex-1",staticStyle:{"flex-wrap":"wrap"}},e._l(t.goods_detail,(function(t,a){return r("div",{key:a,staticClass:"ml-10 mb-10 flex flex-column"},[r("img",{staticStyle:{width:"50px",height:"50px"},attrs:{src:t.image,alt:""}}),r("span",{staticClass:"no-wrap",staticStyle:{"max-width":"50px"},attrs:{title:t.name}},[e._v(e._s(t.name))])])})),0)]):e._e(),r("div",{staticStyle:{"max-height":"52vh","overflow-y":"auto","padding-top":"10px"}},[t.logistics&&t.logistics.data&&t.logistics.data.length?r("a-timeline",{attrs:{pending:e.pending,reverse:!0}},e._l(t.logistics.data,(function(t,a){return r("a-timeline-item",{key:a},[r("p",{staticClass:"mb-0"},[e._v(e._s(e.moment(t.time).format("YYYY-MM-DD HH:mm")))]),r("span",[e._v(e._s(t.context))])])})),1):r("p",[e._v(e._s(t.logistics.stateMessage||"暂无物流信息"))])],1)])})),1)]:e._e()]]:e._e()],2)},s=[],o=(r("06f4"),r("fc25")),i=(r("16c9"),r("387a")),l=(r("b64b"),r("7db0"),r("d3b7"),r("8bbf")),n=r.n(l),d=r("011d"),c=r("5f66"),m=r("4031"),p=r("c1df"),_=r.n(p);n.a.use(i["a"]),n.a.use(o["a"]);var f={props:{visible:Boolean,title:String,order:Object,pageType:{type:String,default:"platform"},nowPeriodicItem:[Object]},data:function(){return{logistics:[],pending:!1,simpleImage:"",rider_name:"",rider_phone:"",noData:!1,extraDelivery:[],activeKey:0,periodicInfo:[],currentPeriodic:void 0}},beforeCreate:function(){this.simpleImage=o["a"].PRESENTED_IMAGE_SIMPLE},mounted:function(){(20==this.order.status||this.nowPeriodicItem&&20==this.nowPeriodicItem.is_complete)&&(this.pending="正在配送中..."),"periodic"!=this.order.order_type||this.nowPeriodicItem&&(!this.nowPeriodicItem||Object.keys(this.nowPeriodicItem).length)?this.viewLogistics():this.getOrderDetail(this.order.order_id)},methods:{moment:_.a,viewLogistics:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",r=this.order,a=r.order_id,s=r.order_type,o=r.express_style,i={platform:d["a"].viewLogistics,merchant:m["a"].viewLogistics,storestaff:c["a"].viewLogistics};"periodic"!=s||t||(t=this.nowPeriodicItem?this.nowPeriodicItem.purchase_order_id||"":this.order.periodic_order_id||""),this.request(i[this.pageType],{order_id:a,periodic_order_id:t,order_type:s,express_style:o}).then((function(t){t?(1==o&&(e.logistics=t.list||[],e.rider_name=t.rider_name,e.rider_phone=t.rider_phone,e.noData=!e.logistics.length),2==o&&(e.extraDelivery=t||[],e.noData=!e.extraDelivery.length)):1===t.errCode&&e.$message.warn(t.errMsg)}))},handleCancel:function(){this.activeKey=0,this.$emit("handleCancel")},tabsChange:function(e){this.activeKey=e},getOrderDetail:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";if(t){var r={platform:d["a"].getOrderDetails,merchant:m["a"].getOrderDetails,storestaff:c["a"].getOrderDetailsCopy};this.request(r[this.pageType],{order_id:t,periodic_order_id:this.order.periodic_order_id,refund_id:this.order.refund_id,noTip:!0}).then((function(t){e.periodicInfo=t.periodic_info||[],e.periodicInfo.length&&(e.currentPeriodic=e.periodicInfo[0]["current_periodic"],e.viewLogistics(e.periodicInfo[0]["purchase_order_id"]))}))}},handleChange:function(e){var t=this;this.currentPeriodic=e;var r=this.periodicInfo.find((function(e){return e.current_periodic==t.currentPeriodic}));this.viewLogistics(r.purchase_order_id)}}},u=f,h=(r("f5c6"),r("2877")),g=Object(h["a"])(u,a,s,!1,null,"11505fa1",null);t["default"]=g.exports},eb30:function(e,t,r){"use strict";r("ce73")},ec449:function(e,t,r){"use strict";r.r(t);var a=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",[r("a-modal",{attrs:{title:e.title,visible:e.visible,maskClosable:!1},on:{ok:e.handleOk,cancel:e.handleCancel}},[r("a-form-model",{attrs:{model:e.formData,"label-col":e.labelCol,"wrapper-col":e.wrapperCol}},[r("a-form-model-item",{attrs:{label:""}},[r("a-input",{staticStyle:{height:"200px",resize:"none"},attrs:{type:"textarea",autosize:"",placeholder:"请输入拒绝理由"},model:{value:e.formData.reason,callback:function(t){e.$set(e.formData,"reason",t)},expression:"formData.reason"}})],1)],1)],1)],1)},s=[],o=r("5f66"),i={props:{visible:Boolean,title:String,nowPeriodicItem:Object,order:Object},data:function(){return{labelCol:{span:0},wrapperCol:{span:24},formData:{order_id:"",reason:"",status:""},expressOptions:[]}},created:function(){},methods:{handleOk:function(){var e=this;this.formData.reason?(this.$set(this.formData,"order_id",this.order.order_id),this.$set(this.formData,"status",this.order.status),this.$set(this.formData,"refund_id",this.order.refund_id),this.request(o["a"].refuseRefund,this.formData).then((function(t){e.$message.success("操作成功"),e.$emit("handleCancel"),e.$emit("updateList")}))):this.$message.error("请输入拒绝理由")},handleCancel:function(){this.$emit("handleCancel"),Object.assign(this.$data,this.$options.data())}}},l=i,n=r("2877"),d=Object(n["a"])(l,a,s,!1,null,"4be55bde",null);t["default"]=d.exports},f5c6:function(e,t,r){"use strict";r("4e5c")}}]);