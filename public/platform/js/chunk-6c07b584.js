(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-6c07b584","chunk-2d0b6a79","chunk-2d0b6a79"],{"0d74":function(e,t,a){"use strict";a.r(t);var i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:" pt-20 pl-20 pr-20 pb-20  br-10"},[a("a-spin",{attrs:{spinning:e.confirmLoading}},[a("a-tabs",{attrs:{"default-active-key":"loans"}},[a("a-tab-pane",{key:"loans",attrs:{tab:e.tabName}})],1),a("a-form-model",{ref:"ruleForm",attrs:{model:e.formData,"label-col":e.labelCol,"wrapper-col":e.wrapperCol}},[a("a-card",{attrs:{bordered:!1}},[a("a-form-model-item",{attrs:{label:"楼盘名称:",colon:!1,prop:"title",rules:[{required:!0,message:"楼盘名称不能为空",trigger:["blur"]}]}},[a("a-input",{staticStyle:{width:"300px"},attrs:{maxLength:100,placeholder:"请输入名称"},model:{value:e.formData.title,callback:function(t){e.$set(e.formData,"title",t)},expression:"formData.title"}})],1),a("a-form-model-item",{attrs:{label:"楼盘平均价格:",colon:!1,prop:"price",help:"元/平方米",rules:[{required:!0,message:"楼盘平均价格不能为空",trigger:["blur"]}]}},[a("a-input",{staticStyle:{width:"300px"},attrs:{maxLength:100,placeholder:"请输入楼盘平均价格,单位元/平方米"},model:{value:e.formData.price,callback:function(t){e.$set(e.formData,"price",t)},expression:"formData.price"}})],1),a("a-form-model-item",{attrs:{label:"楼盘面积:",colon:!1,prop:"acreage",rules:[{required:!0,message:"楼盘面积不能为空",trigger:["blur"]}]}},[a("a-input",{staticStyle:{width:"300px"},attrs:{maxLength:100,placeholder:"请输入楼盘面积"},model:{value:e.formData.acreage,callback:function(t){e.$set(e.formData,"acreage",t)},expression:"formData.acreage"}})],1),a("a-form-model-item",{attrs:{label:"地址",required:""}},[a("a-cascader",{staticStyle:{width:"300px"},attrs:{options:e.formData.areas,placeholder:"选择",value:e.sel_areas},on:{change:e.onChangeArea}})],1),a("a-form-model-item",{attrs:{label:"详细地址:",colon:!1,prop:"title",rules:[{required:!0,message:"详细地址不能为空",trigger:["blur"]}]}},[a("a-input",{staticStyle:{width:"300px"},attrs:{maxLength:100,placeholder:"请输入详细地址"},model:{value:e.formData.address,callback:function(t){e.$set(e.formData,"address",t)},expression:"formData.address"}})],1),a("a-form-model-item",{attrs:{label:"经纬度:",colon:!1,required:""}},[a("a-row",{staticStyle:{"margin-bottom":"20px"}},[a("a-col",{attrs:{span:15}},[a("a-input",{staticStyle:{width:"200px"},attrs:{disabled:!0,value:e.formData.longlat,placeholder:"请选择位置"}}),e._v(" "),a("a",{staticStyle:{"margin-left":"5px"},on:{click:function(t){return e.$refs.mapPointModel.selectPoint()}}},[e._v("地图选点")])],1)],1)],1),a("a-form-model-item",{attrs:{label:"楼盘咨询电话:",colon:!1,prop:"phone",rules:[{required:!0,message:"楼盘咨询电话不能为空",trigger:["blur"]}]}},[a("a-input",{staticStyle:{width:"300px"},attrs:{maxLength:100,placeholder:"请输入"},model:{value:e.formData.phone,callback:function(t){e.$set(e.formData,"phone",t)},expression:"formData.phone"}})],1),a("a-form-model-item",{attrs:{label:"上传标题图片",required:"",help:"只能上传一张"}},[a("a-row",[a("a-input",{attrs:{hidden:""},model:{value:e.formData.cover_image,callback:function(t){e.$set(e.formData,"cover_image",t)},expression:"formData.cover_image"}}),[a("div",{staticClass:"clearfix"},[a("a-upload",{attrs:{action:e.action,name:e.uploadName,data:{upload_dir:e.upload_dir},"list-type":"picture-card","file-list":e.fileList1},on:{preview:e.handlePreview1,change:e.handleChange}},[a("a-icon",{attrs:{type:"plus"}}),a("div",{staticClass:"ant-upload-text"},[e._v("上传图片")])],1),a("a-modal",{attrs:{visible:e.previewVisible1,footer:null},on:{cancel:e.handleCancel1}},[a("img",{staticStyle:{width:"100%"},attrs:{alt:"example",src:e.previewImage}})])],1)]],2)],1),a("a-form-model-item",{attrs:{label:"上传详情轮播图",required:""}},[a("a-row",[a("a-input",{attrs:{hidden:""},model:{value:e.formData.images,callback:function(t){e.$set(e.formData,"images",t)},expression:"formData.images"}}),[a("div",{staticClass:"clearfix"},[a("a-upload",{attrs:{action:e.action,name:e.uploadName,data:{upload_dir:e.upload_dir},"list-type":"picture-card","file-list":e.fileList},on:{preview:e.handlePreview,change:e.handleChange1}},[a("a-icon",{attrs:{type:"plus"}}),a("div",{staticClass:"ant-upload-text"},[e._v("上传图片")])],1),a("a-modal",{attrs:{visible:e.previewVisible,footer:null},on:{cancel:e.handleCancel}},[a("img",{staticStyle:{width:"100%"},attrs:{alt:"example",src:e.previewImage}})])],1)]],2)],1),a("a-form-model-item",{attrs:{label:"楼盘详情:",colon:!1,required:""}},[a("a-row",{staticStyle:{"margin-bottom":"20px"}},[a("a-col",{attrs:{span:24}},[a("rich-text",{attrs:{info:e.formData.content},on:{"update:info":function(t){return e.$set(e.formData,"content",t)}}})],1)],1)],1)],1)],1),a("div",{staticClass:"page-header"},[a("a-button",{staticClass:"ml-20 mt-20 mb-20",attrs:{type:"primary"},on:{click:function(t){return e.handleSubmit()}}},[e._v("提交")])],1)],1),a("map-point",{ref:"mapPointModel",on:{loadRefresh:e.setLongLat}})],1)},r=[],s=a("1da1"),o=(a("96cf"),a("d3b7"),a("b0c0"),a("a434"),a("a15b"),a("f9e9")),n=a("ea7a"),l=a("884f"),c=a("6625"),m=a.n(c);function d(e){return new Promise((function(t,a){var i=new FileReader;i.readAsDataURL(e),i.onload=function(){return t(i.result)},i.onerror=function(e){return a(e)}}))}var u={name:"SaleBuildingEdit",components:{RichText:l["a"],mapPoint:n["default"],VueUeditorWrap:m.a},props:{upload_dir:{type:String,default:""}},data:function(){return{title:this.L("新建门票"),labelCol:{xs:{span:24},sm:{span:3}},wrapperCol:{xs:{span:24},sm:{span:16}},visible:!1,confirmLoading:!1,previewVisible1:!1,previewVisible:!1,previewImage:"",previewImage1:"",sel_areas:[],fileList1:[],fileList:[],tabName:"新建楼盘",form:this.$form.createForm(this),action:"/v20/public/index.php/common/common.UploadFile/uploadPictures",uploadName:"reply_pic",formData:{acreage:void 0,houses_id:0,longlat:"",title:"",price:void 0,long:void 0,lat:void 0,province_id:0,city_id:0,area_id:0,address:"",phone:"",cover_image:"",images:"",content:"",areas:[]},ueConfig:{enableAutoSave:!1,autoSyncData:!1,autoHeightEnabled:!1,initialFrameHeight:350,initialFrameWidth:"100%",serverUrl:"/v20/public/static/UEditor/php/controller.php",UEDITOR_HOME_URL:"/v20/public/static/UEditor/"}}},watch:{"$route.query.houses_id":function(e){e>0?(this.formData.houses_id=e,this.tabName="编辑楼盘",this.getEditInfo()):(this.tabName="新增楼盘",this.getDetail())}},mounted:function(){this.formData.houses_id=this.$route.query.houses_id,this.form=this.$form.createForm(this),this.formData.houses_id>0?this.getEditInfo():this.getDetail()},activated:function(){this.formData.houses_id=this.$route.query.houses_id,this.form=this.$form.createForm(this),this.formData.houses_id>0?this.getEditInfo():this.getDetail()},methods:{onChangeArea:function(e){this.formData.province_id=e[0],this.formData.city_id=e[1],this.formData.area_id=e[2],this.sel_areas=[e[0],e[1],e[2]]},setLongLat:function(e){this.formData.longlat=e,this.$set(this.formData,"longlat",e)},handlePreview:function(e){var t=this;return Object(s["a"])(regeneratorRuntime.mark((function a(){return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:if(e.url||e.preview){a.next=4;break}return a.next=3,d(e.originFileObj);case 3:e.preview=a.sent;case 4:t.previewImage=e.url||e.preview,t.previewVisible=!0;case 6:case"end":return a.stop()}}),a)})))()},handlePreview1:function(e){var t=this;return Object(s["a"])(regeneratorRuntime.mark((function a(){return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:if(e.url||e.preview){a.next=4;break}return a.next=3,d(e.originFileObj);case 3:e.preview=a.sent;case 4:t.previewImage=e.url||e.preview,t.previewVisible1=!0;case 6:case"end":return a.stop()}}),a)})))()},handleChange:function(e){var t=e.fileList;if(this.fileList1=t,t.length>0){var a=t.length-1;"done"==this.fileList1[a].status&&(this.formData.cover_image=this.fileList1[a].response.data,console.log(this.fileList1[a].response.data,"this.fileList1[len].thumbUrl"),this.fileList1[0].uid="logo",this.fileList1[0].name="logo_1",this.fileList1[0].status="done",this.fileList1[0].url=this.fileList1[a].response.data,t.length>1&&this.fileList1.splice(0,a))}else this.formData.cover_image=""},handleChange1:function(e){var t=e.fileList;this.fileList=t;for(var a=[],i=0;i<this.fileList.length;i++)"done"==this.fileList[i].status&&(void 0!==this.fileList[i].url?a.push(this.fileList[i].url):a.push(this.fileList[i].response.data));a.length>0&&(this.formData.images=a.join(","))},handleCancel1:function(){this.previewVisible1=!1},handleCancel:function(){this.previewVisible=!1},handleSubmit:function(){var e=this;return this.formData.title?this.formData.price?this.formData.acreage?""==this.formData.longlat?(this.$message.error("请选择经纬度"),!1):this.formData.province_id&&this.formData.city_id&&this.formData.area_id?void 0==this.formData.address||""==this.formData.address?(this.$message.error("请输入详细地址"),!1):void 0==this.formData.cover_image||""==this.formData.cover_image?(this.$message.error("请上传标题图片"),!1):void 0==this.formData.phone||""==this.formData.phone?(this.$message.error("请输入楼盘咨询电话"),!1):void 0==this.formData.images||""==this.formData.images?(this.$message.error("请上传详情轮播图"),!1):void 0==this.formData.content||""==this.formData.content?(this.$message.error("请输入楼盘详情"),!1):void this.request(o["a"].editHouseFloor,this.formData).then((function(t){e.$message.success("保存成功！"),e.formData.houses_id=0,setTimeout((function(){e.$message.destroy(),e.confirmLoading=!1,e.$router.push({path:"/life_tools/platform.LifeTools/saleBuildingList"})}),1500)})).catch((function(t){e.confirmLoading=!1})):(this.$message.error("请选择地址"),!1):(this.$message.error("请输入楼盘面积"),!1):(this.$message.error("请输入楼盘价格"),!1):(this.$message.error("请输入楼盘名称"),!1)},getEditInfo:function(){var e=this;this.request(o["a"].getHousesFloorMsg,{houses_id:this.formData.houses_id}).then((function(t){if(e.formData=t.list,e.formData.areas=t.areas,t.list.long&&t.list.lat?e.formData.longlat=t.list.long+","+t.list.lat:e.formData.longlat="",e.fileList1=[],e.fileList=[],t.list.swiper_image.length>0)for(var a=0;a<t.list.swiper_image.length;a++){var i={uid:a,name:"image_"+a,status:"done",url:t.list.swiper_image[a]};e.fileList.push(i)}if(t.list.cover_image){var r={uid:"logo",name:"logo_1",status:"done",url:t.list.cover_image};e.fileList1.push(r)}e.sel_areas=[t.list.province_id,t.list.city_id,t.list.area_id]}))},getDetail:function(){var e=this;this.formData={acreage:void 0,houses_id:0,longlat:"",title:"",price:void 0,long:void 0,lat:void 0,province_id:0,city_id:0,area_id:0,address:"",phone:"",cover_image:"",images:"",content:"",areas:[]},this.fileList1=[],this.fileList=[],this.sel_areas=[],this.request(o["a"].getHousesFloorMsg,{houses_id:0}).then((function(t){e.formData.areas=t.areas}))}}},h=u,f=(a("f1a3"),a("2877")),p=Object(f["a"])(h,i,r,!1,null,"55ecdd56",null);t["default"]=p.exports},"1da1":function(e,t,a){"use strict";a.d(t,"a",(function(){return r}));a("d3b7");function i(e,t,a,i,r,s,o){try{var n=e[s](o),l=n.value}catch(c){return void a(c)}n.done?t(l):Promise.resolve(l).then(i,r)}function r(e){return function(){var t=this,a=arguments;return new Promise((function(r,s){var o=e.apply(t,a);function n(e){i(o,r,s,n,l,"next",e)}function l(e){i(o,r,s,n,l,"throw",e)}n(void 0)}))}}},c2f4:function(e,t,a){},f1a3:function(e,t,a){"use strict";a("c2f4")}}]);