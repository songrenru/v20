(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-be88b4a2","chunk-2d0b6a79","chunk-8fe1928c","chunk-2d0b6a79","chunk-2d0b3786"],{"07ca":function(t,e,a){"use strict";var i={getCommentList:"/grow_grass/platform.GrowGrassArticleReply/getCommentList",updateGrowGrassArticleReply:"/grow_grass/platform.GrowGrassArticleReply/updateGrowGrassArticleReply",getCategoryList:"/grow_grass/api.Category/getCategoryList",getCategoryEdit:"/grow_grass/api.Category/getCategoryEdit",getCategoryDetail:"/grow_grass/api.Category/getCategoryDetail",getCategoryDel:"/grow_grass/api.Category/getCategoryDel",getCategorySort:"/grow_grass/api.Category/getCategorySort",getCategoryClass:"/grow_grass/api.Category/getCategoryClass",getArticleLists:"/grow_grass/api.Article/getArticleLists",getEditArticle:"/grow_grass/api.Article/getEditArticle",getArticleDetails:"/grow_grass/api.Article/getArticleDetails",getArticleCategoryDetails:"/grow_grass/api.Article/getArticleCategoryDetails",getArticle:"/grow_grass/api.Article/getArticleEditInfo"};e["a"]=i},"09c8":function(t,e,a){"use strict";a.r(e);var i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"ant-pro-page-header-wrap-children-content",staticStyle:{margin:"24px 0 0"}},[a("div",{staticStyle:{float:"left","font-size":"26px","line-height":"30px"}},[t._v("话题管理")]),a("a-button",{staticStyle:{"margin-left":"15px"},attrs:{type:"primary"},on:{click:function(e){return t.add(t.category_id)}}},[a("a-icon",{attrs:{type:"plus"}}),t._v("添加话题")],1),a("a-form-model",{staticStyle:{float:"right","margin-bottom":"30px"},attrs:{layout:"inline",model:t.searchForm}},[a("a-form-model-item",[a("a-select",{staticStyle:{width:"115px"},model:{value:t.searchForm.cat_id,callback:function(e){t.$set(t.searchForm,"cat_id",e)},expression:"searchForm.cat_id"}},t._l(t.catList,(function(e){return a("a-select-option",{key:e.cat_id,attrs:{cat_id:e.cat_id}},[t._v(t._s(e.cat_name)+" ")])})),1)],1),a("a-form-model-item",[a("a-select",{staticStyle:{width:"115px"},model:{value:t.searchForm.status,callback:function(e){t.$set(t.searchForm,"status",e)},expression:"searchForm.status"}},[a("a-select-option",{attrs:{value:-1}},[t._v(" 话题状态")]),a("a-select-option",{attrs:{value:0}},[t._v(" 关闭")]),a("a-select-option",{attrs:{value:1}},[t._v(" 正常")])],1)],1),a("a-form-model-item",{attrs:{label:""}},[a("a-input",{staticStyle:{width:"160px"},attrs:{placeholder:"请输入话题名称"},model:{value:t.searchForm.content,callback:function(e){t.$set(t.searchForm,"content",e)},expression:"searchForm.content"}})],1),a("a-form-model-item",[a("a-button",{staticClass:"ml-20",attrs:{type:"primary",icon:"search"},on:{click:function(e){return t.submitForm(!0)}}},[t._v(" 查询")])],1)],1),a("div",{staticStyle:{height:"30px"}}),a("a-card",{attrs:{bordered:!1}},[a("a-table",{staticStyle:{"min-height":"700px"},attrs:{columns:t.columns,"data-source":t.data,rowKey:"category_id",pagination:t.pagination},scopedSlots:t._u([{key:"sort",fn:function(e,i){return a("span",{},[a("a-input-number",{staticStyle:{width:"100px"},attrs:{min:0,step:"1"},on:{blur:function(a){return t.handleSortChange(e,i.category_id)}},model:{value:i.sort,callback:function(e){t.$set(i,"sort",e)},expression:"record.sort"}})],1)}},{key:"status",fn:function(e){return a("span",{},[0==e?a("a-badge",{attrs:{status:"default",text:"关闭"}}):t._e(),1==e?a("a-badge",{attrs:{status:"success",text:"正常"}}):t._e()],1)}},{key:"action",fn:function(e,i){return a("span",{},[[a("a",{on:{click:function(e){return t.$refs.createModal.edit(i.category_id)}}},[t._v("编辑")]),a("a-divider",{attrs:{type:"vertical"}})],a("a",{on:{click:function(e){return t.delOne(i.category_id)}}},[t._v("删除")])],2)}}])}),a("category-manage-edit",{ref:"createModal",on:{loaddata:t.getList}})],1)],1)},r=[],n=a("5530"),o=a("7a28"),s=a("07ca"),l={name:"GroupSearchHotList",components:{CategoryManageEdit:o["default"]},data:function(){return{catList:[],searchForm:{name:"",cat_id:"-1",status:-1},columns:[{title:"话题名称",dataIndex:"name",key:"name",scopedSlots:{customRender:"name"}},{title:"排序",dataIndex:"sort",key:"sort",scopedSlots:{customRender:"sort"}},{title:"发布数",dataIndex:"article_num",key:"article_num"},{title:"查看数",dataIndex:"views_num",scopedSlots:{customRender:"views_num"}},{title:"评论数",dataIndex:"reply_num",key:"reply_num"},{title:"关联分类",dataIndex:"cat_name",scopedSlots:{customRender:"cat_name"}},{title:"最后修改时间",dataIndex:"last_time",key:"last_time"},{title:"话题状态",dataIndex:"status",key:"status",scopedSlots:{customRender:"status"}},{title:"操作",dataIndex:"action",key:"action",scopedSlots:{customRender:"action"}}],data:[],category_id:"",pagination:{current:1,total:0,pageSize:10,showSizeChanger:!0,onChange:this.onPageChange,onShowSizeChange:this.onPageSizeChange,showTotal:function(t){return"共 ".concat(t," 条记录")}}}},created:function(){this.getList({is_search:!1})},activated:function(){this.category_id=this.$route.query.category_id,this.getList({is_search:!1})},mounted:function(){},watch:{"$route.query.category_id":function(){this.category_id=this.$route.query.category_id,this.getList(this.category_id)}},methods:{getList:function(t){var e=this,a=Object(n["a"])({},this.searchForm);delete a.time,1==t.is_search?(a.page=1,this.$set(this.pagination,"current",1)):(a.page=this.pagination.current,this.$set(this.pagination,"current",this.pagination.current)),this.pagination.total>0&&Math.ceil(this.pagination.total/this.pagination.pageSize)<a.page&&(this.pagination.current=0,a.page=1),1==t.is_page&&(a.page=1),a.pageSize=this.pagination.pageSize,this.request(s["a"].getCategoryList,a).then((function(a){e.data=a.list,e.catList=a.catList,1==t.is_del&&0==a.list_count&&(e.getList({is_search:!1,is_page:!0}),e.pagination.current=1),e.$set(e.pagination,"total",a.count)}))},submitForm:function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],e=Object(n["a"])({},this.searchForm);delete e.time,e.is_search=t,e.tablekey=1,this.getList(e)},onPageChange:function(t,e){this.$set(this.pagination,"current",t),this.submitForm()},onPageSizeChange:function(t,e){this.$set(this.pagination,"pageSize",e),this.submitForm()},handleSortChange:function(t,e){var a=this;this.request(s["a"].getCategorySort,{id:e,sort:t}).then((function(t){a.getList({is_search:!1})}))},add:function(t){this.$refs.createModal.add(t)},btnClick:function(){alert(2)},delOne:function(t){var e=this;this.$confirm({title:"提示",content:"确定删除吗？",onOk:function(){e.request(s["a"].getCategoryDel,{id:t}).then((function(t){e.getList({is_search:!1,is_del:!0})}))},onCancel:function(){}})}}},c=l,d=a("2877"),u=Object(d["a"])(c,i,r,!1,null,"753b03d2",null);e["default"]=u.exports},"1da1":function(t,e,a){"use strict";a.d(e,"a",(function(){return r}));a("d3b7");function i(t,e,a,i,r,n,o){try{var s=t[n](o),l=s.value}catch(c){return void a(c)}s.done?e(l):Promise.resolve(l).then(i,r)}function r(t){return function(){var e=this,a=arguments;return new Promise((function(r,n){var o=t.apply(e,a);function s(t){i(o,r,n,s,l,"next",t)}function l(t){i(o,r,n,s,l,"throw",t)}s(void 0)}))}}},2909:function(t,e,a){"use strict";a.d(e,"a",(function(){return l}));var i=a("6b75");function r(t){if(Array.isArray(t))return Object(i["a"])(t)}a("a4d3"),a("e01a"),a("d3b7"),a("d28b"),a("3ca3"),a("ddb0"),a("a630");function n(t){if("undefined"!==typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}var o=a("06c5");function s(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function l(t){return r(t)||n(t)||Object(o["a"])(t)||s()}},"7a28":function(t,e,a){"use strict";a.r(e);var i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("a-modal",{attrs:{title:t.title,width:840,visible:t.visible,confirmLoading:t.confirmLoading},on:{ok:t.handleSubmit,cancel:t.handleCancel}},[a("a-spin",{attrs:{spinning:t.confirmLoading}},[a("a-form",{attrs:{form:t.form}},[a("a-form-item",{attrs:{label:"话题名称",labelCol:t.labelCol,wrapperCol:t.wrapperCol}},[a("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["name",{initialValue:t.detail.name,rules:[{required:!0,max:10,message:"限10字以内，必填"}]}],expression:"[\n            'name',\n            { initialValue: detail.name, rules: [{ required: true, max: 10, message: '限10字以内，必填' }] },\n          ]"}]})],1),a("a-form-item",{attrs:{label:"话题描述",labelCol:t.labelCol,wrapperCol:t.wrapperCol}},[a("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["description",{initialValue:t.detail.description,rules:[{required:!0,max:30,message:"限30字以内，必填"}]}],expression:"[\n            'description',\n            { initialValue: detail.description, rules: [{ required: true, max: 30, message: '限30字以内，必填' }] },\n          ]"}]})],1),a("a-form-item",{attrs:{label:"排序",labelCol:t.labelCol,wrapperCol:t.wrapperCol,help:"值越大越靠前"}},[a("a-input-number",{directives:[{name:"decorator",rawName:"v-decorator",value:["sort",{initialValue:t.detail.sort}],expression:"['sort', { initialValue: detail.sort }]"}],attrs:{min:0}})],1),a("a-form-model-item",{attrs:{label:"图片",colon:!1,labelCol:t.labelCol,wrapperCol:t.wrapperCol}},[a("div",{staticClass:"clearfix"},[a("a-upload",{attrs:{name:"reply_pic",action:t.uploadImg,"list-type":"picture-card","file-list":t.imgUploadList,multiple:!0},on:{preview:t.handlePreview,change:t.handleImgChange}},[t.imgUploadList.length<1?a("div",[a("a-icon",{attrs:{type:"plus"}}),a("div",{staticClass:"ant-upload-text"},[t._v("上传图片")])],1):t._e()]),a("a-modal",{attrs:{visible:t.previewVisible,footer:null},on:{cancel:t.handleImgCancel}},[a("img",{staticStyle:{width:"100%"},attrs:{alt:"example",src:t.previewImage}})])],1)]),a("a-form-item",{attrs:{label:"关联分类",labelCol:t.labelCol,wrapperCol:t.wrapperCol}},[a("a-select",{directives:[{name:"decorator",rawName:"v-decorator",value:["cat_id",{initialValue:t.detail.cat_id}],expression:"['cat_id', { initialValue: detail.cat_id }]"}],staticStyle:{width:"115px"}},t._l(t.catList,(function(e){return a("a-select-option",{key:e.cat_id,attrs:{cat_id:e.cat_id}},[t._v(t._s(e.cat_name)+" ")])})),1)],1),a("a-form-item",{attrs:{label:"话题状态",labelCol:t.labelCol,wrapperCol:t.wrapperCol}},[a("a-radio-group",{directives:[{name:"decorator",rawName:"v-decorator",value:["status",{initialValue:t.detail.status}],expression:"['status', { initialValue: detail.status }]"}],attrs:{name:"status",min:0}},[a("a-radio",{attrs:{value:1}},[t._v(" 正常 ")]),a("a-radio",{attrs:{value:0}},[t._v(" 关闭 ")])],1)],1)],1)],1)],1)},r=[],n=a("53ca"),o=a("2909"),s=a("1da1"),l=(a("96cf"),a("d3b7"),a("d81d"),a("b0c0"),a("a4d3"),a("e01a"),a("4e82"),a("7b3f")),c=a("07ca");function d(t){return new Promise((function(e,a){var i=new FileReader;i.readAsDataURL(t),i.onload=function(){return e(i.result)},i.onerror=function(t){return a(t)}}))}var u={data:function(){return{catList:[],previewVisible:!1,previewImage:"",imgUploadList:[],uploadImg:"/v20/public/index.php"+l["a"].uploadImg+"?upload_dir=/group",title:"添加话题",labelCol:{xs:{span:24},sm:{span:7}},wrapperCol:{xs:{span:24},sm:{span:13}},visible:!1,confirmLoading:!1,form:this.$form.createForm(this),detail:{id:0,name:"",description:"",sort:"",img:[],cat_id:0,status:1},cat_id:0,id:0,status:1}},mounted:function(){},methods:{handleImgCancel:function(){this.previewVisible=!1},handlePreview:function(t){var e=this;return Object(s["a"])(regeneratorRuntime.mark((function a(){return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:if(t.url||t.preview){a.next=4;break}return a.next=3,d(t.originFileObj);case 3:t.preview=a.sent;case 4:e.previewImage=t.url||t.preview,e.previewVisible=!0;case 6:case"end":return a.stop()}}),a)})))()},handleImgChange:function(t){var e=this,a=Object(o["a"])(t.fileList);console.log(a),this.imgUploadList=a;var i=[];this.imgUploadList.map((function(a){if("done"===a.status&&"1000"==a.response.status){var r=a.response.data;i.push(r.full_url),e.$set(e.detail,"img",i)}else"error"===t.file.status&&e.$message.error("".concat(t.file.name," 上传失败！"))}))},add:function(){this.visible=!0,this.imgUploadList=[],this.id=0,this.title="添加话题",this.getCategoryClass(),this.detail={id:0,name:"",description:"",sort:"",img:[],cat_id:"0",status:1}},edit:function(t){this.visible=!0,this.id=t,this.getCategoryClass(),this.getEditInfo(t),this.title="编辑话题"},handleSubmit:function(){var t=this,e=this.form.validateFields;this.confirmLoading=!0,e((function(e,a){e?t.confirmLoading=!1:(a.id=t.id,a.img=t.detail.img,console.log(a),t.request(c["a"].getCategoryEdit,a).then((function(e){t.id>0?t.$message.success("编辑成功"):t.$message.success("添加成功"),setTimeout((function(){t.form=t.$form.createForm(t),t.visible=!1,t.confirmLoading=!1,t.$emit("loaddata",t.cat_id)}),1500)})).catch((function(e){t.confirmLoading=!1})))}))},handleCancel:function(){var t=this;this.visible=!1,setTimeout((function(){t.id="0",t.form=t.$form.createForm(t)}),500)},getCategoryClass:function(){var t=this;this.request(c["a"].getCategoryClass,{type:1}).then((function(e){t.catList=e}))},getEditInfo:function(t){var e=this;this.request(c["a"].getCategoryDetail,{category_id:this.id}).then((function(t){if(console.log(t.showMethod),e.img=t.img,e.showMethod=t.showMethod,e.detail={category_id:t.category_id,name:t.name,description:t.description,join_num:t.join_num,views_num:t.views_num,img:t.img,cat_id:t.cat_id,sort:t.sort,status:t.status},t.img){e.imgUploadList=[];for(var a=0;a<t.img.length;a++){var i={uid:a,name:"img_"+a,status:"done",url:t.img[a]};e.imgUploadList.push(i)}}"object"==Object(n["a"])(t.detail)&&(e.detail=t.detail),console.log("detail",e.detail)}))}}},g=u,m=a("2877"),p=Object(m["a"])(g,i,r,!1,null,null,null);e["default"]=p.exports},"7b3f":function(t,e,a){"use strict";var i={uploadImg:"/common/common.UploadFile/uploadImg"};e["a"]=i}}]);