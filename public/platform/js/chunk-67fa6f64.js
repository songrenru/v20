(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-67fa6f64","chunk-8447ee56","chunk-2d0b6a79","chunk-2d0b6a79","chunk-2d0b3786"],{"0b52":function(t,e,a){"use strict";a.r(e);var i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("a-modal",{attrs:{width:1200,title:"抄表记录",visible:t.visible_record,maskClosable:!1,"confirm-loading":t.confirmLoading},on:{cancel:t.handleCancel}},[a("div",{staticClass:"message-suggestions-list-box"},[a("div",{staticClass:"search-box",staticStyle:{"margin-top":"20px","margin-left":"5px"}},[a("a-row",{staticStyle:{"margin-bottom":"20px"},attrs:{gutter:48}},[a("a-col",{staticStyle:{"padding-right":"0px"},attrs:{md:8,sm:24}},[a("label",{staticStyle:{"margin-top":"5px"}},[t._v("房间：")]),a("a-cascader",{staticClass:"cascader_style margin_left_10",attrs:{options:t.options,"load-data":t.loadDataFunc,placeholder:"请选择房间","change-on-select":""},on:{change:t.setVisionsFunc},model:{value:t.room_id,callback:function(e){t.room_id=e},expression:"room_id"}})],1),a("a-col",{staticClass:"padding-tp10",staticStyle:{"padding-left":"5px","padding-right":"1px",width:"470px"},attrs:{md:8,sm:24}},[a("label",{staticStyle:{"margin-top":"5px"}},[t._v("时间筛选：")]),a("a-range-picker",{staticStyle:{width:"325px"},attrs:{allowClear:!0},on:{change:t.dateChange}},[a("a-icon",{attrs:{slot:"suffixIcon",type:"calendar"},slot:"suffixIcon"})],1)],1),a("a-col",{staticStyle:{"padding-left":"0px","padding-right":"1px",width:"90px"},attrs:{md:2,sm:24}},[a("a-button",{attrs:{type:"primary",icon:"search"},on:{click:function(e){return t.searchList()}}},[t._v(" 查询 ")])],1),a("a-col",{attrs:{md:2,sm:24}},[a("a-button",{attrs:{type:"primary"},on:{click:function(e){return t.printList()}}},[t._v("Excel导出")])],1),a("a-col",{attrs:{md:2,sm:24}},[a("a-button",{attrs:{type:"primary"},on:{click:function(e){return t.$refs.createUploadModal.add(t.charge_name,t.project_id)}}},[t._v("导入")])],1)],1)],1),a("br"),a("a-table",{staticClass:"components-table-demo-nested",attrs:{columns:t.columns,"data-source":t.data,pagination:t.pagination,loading:t.loading},on:{change:t.table_change}})],1)]),a("meter-upload",{ref:"createUploadModal",attrs:{height:800,width:500},on:{ok:t.handleOks}})],1)},n=[],o=a("2909"),s=a("1da1"),r=(a("96cf"),a("ac1f"),a("841c"),a("d81d"),a("b0c0"),a("d3b7"),a("7db0"),a("a0e0")),l=a("ca00"),c=a("d2cd"),d=[{title:"住址",dataIndex:"address",key:"address",scopedSlots:{customRender:"room_position"}},{title:"姓名",dataIndex:"name",key:"name"},{title:"电话",dataIndex:"phone",key:"phone"},{title:"单价（元）",dataIndex:"unit_price",key:"unit_price"},{title:"倍率",dataIndex:"rate",key:"rate"},{title:"抄表时间",dataIndex:"add_time_txt",key:"add_time_txt"},{title:"起度",dataIndex:"start_ammeter",key:"start_ammeter"},{title:"止度",dataIndex:"last_ammeter",key:"last_ammeter"},{title:"操作人",dataIndex:"realname",key:"realname"},{title:"备注",dataIndex:"note",key:"note"}],u=[],h={components:{meterUpload:c["default"]},data:function(){return{visible_record:!1,confirmLoading:!1,data:u,columns:d,options:[],pagination:{pageSize:10,total:10},loading:!1,charge_name:"",project_id:0,page:1,room_id:0,date_time:[],tokenName:"",sysName:""}},activated:function(){var t=Object(l["i"])(location.hash);t?(this.tokenName=t+"_access_token",this.sysName=t):this.sysName="village"},methods:{dateChange:function(t,e){this.date_time=e,console.log("dateString",this.date_time)},get:function(t,e){this.charge_name=t,this.project_id=e,this.getList(t,e),this.getSingleListByVillage(),this.visible_record=!0},printList:function(){var t=this;this.loading=!0,this.request(r["a"].printRecordList,{charge_name:this.charge_name,room_id:this.room_id,date_time:this.date_time,tokenName:this.tokenName}).then((function(e){window.location.href=e.url,t.loading=!1}))},handleCancel:function(){this.visible_record=!1},table_change:function(t){console.log("e",t),t.current&&t.current>0&&(this.page=t.current,this.getList(this.charge_name,this.project_id))},getList:function(t,e){var a=this;this.request(r["a"].getMeterReadingRecord,{charge_name:t,project_id:e,page:this.page,room_id:this.room_id,date_time:this.date_time,tokenName:this.tokenName,single_id:this.single_id,floor_id:this.floor_id,layer_id:this.layer_id}).then((function(t){a.pagination.total=t.count?t.count:0,a.pagination.pageSize=t.total_limit?t.total_limit:10,a.data=t.list,a.loading=!1}))},searchList:function(){console.log("search",this.search),this.getList(this.charge_name,this.project_id)},getSingleListByVillage:function(){var t=this;this.request(r["a"].getSingleListByVillage,{tokenName:this.tokenName}).then((function(e){if(console.log("+++++++Single",e),e){var a=[];e.map((function(t){a.push({label:t.name,value:t.id,isLeaf:!1})})),t.options=a}}))},getFloorList:function(t){var e=this;return new Promise((function(a){e.request(r["a"].getFloorList,{pid:t,tokenName:e.tokenName}).then((function(t){console.log("+++++++Single",t),console.log("resolve",a),a(t)}))}))},getLayerList:function(t){var e=this;return new Promise((function(a){e.request(r["a"].getLayerList,{pid:t,tokenName:e.tokenName}).then((function(t){console.log("+++++++Single",t),t&&a(t)}))}))},getVacancyList:function(t){var e=this;return new Promise((function(a){e.request(r["a"].getVacancyList,{pid:t,tokenName:e.tokenName}).then((function(t){console.log("+++++++Single",t),t&&a(t)}))}))},loadDataFunc:function(t){return Object(s["a"])(regeneratorRuntime.mark((function e(){var a;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:a=t[t.length-1],a.loading=!0,setTimeout((function(){a.loading=!1}),100);case 3:case"end":return e.stop()}}),e)})))()},setVisionsFunc:function(t){var e=this;return Object(s["a"])(regeneratorRuntime.mark((function a(){var i,n,s,r,l,c,d,u,h,f,p,m;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:if(1!==t.length){a.next=12;break}return i=Object(o["a"])(e.options),a.next=4,e.getFloorList(t[0]);case 4:n=a.sent,console.log("res",n),s=[],n.map((function(t){return s.push({label:t.name,value:t.id,isLeaf:!1}),i["children"]=s,!0})),i.find((function(e){return e.value===t[0]}))["children"]=s,e.options=i,a.next=39;break;case 12:if(2!==t.length){a.next=24;break}return a.next=15,e.getLayerList(t[1]);case 15:r=a.sent,l=Object(o["a"])(e.options),c=[],r.map((function(t){return c.push({label:t.name,value:t.id,isLeaf:!1}),!0})),d=l.find((function(e){return e.value===t[0]})),d.children.find((function(e){return e.value===t[1]}))["children"]=c,e.options=l,a.next=39;break;case 24:if(3!==t.length){a.next=38;break}return a.next=27,e.getVacancyList(t[2]);case 27:u=a.sent,h=Object(o["a"])(e.options),f=[],u.map((function(t){return f.push({label:t.name,value:t.id,isLeaf:!0}),!0})),p=h.find((function(e){return e.value===t[0]})),m=p.children.find((function(e){return e.value===t[1]})),m.children.find((function(e){return e.value===t[2]}))["children"]=f,e.options=h,console.log("_this.options",e.options),a.next=39;break;case 38:4===t.length&&console.log("_this.room_id+++",_this.room_id);case 39:case"end":return a.stop()}}),a)})))()}}},f=h,p=a("2877"),m=Object(p["a"])(f,i,n,!1,null,"9e75925a",null);e["default"]=m.exports},"1da1":function(t,e,a){"use strict";a.d(e,"a",(function(){return n}));a("d3b7");function i(t,e,a,i,n,o,s){try{var r=t[o](s),l=r.value}catch(c){return void a(c)}r.done?e(l):Promise.resolve(l).then(i,n)}function n(t){return function(){var e=this,a=arguments;return new Promise((function(n,o){var s=t.apply(e,a);function r(t){i(s,n,o,r,l,"next",t)}function l(t){i(s,n,o,r,l,"throw",t)}r(void 0)}))}}},2909:function(t,e,a){"use strict";a.d(e,"a",(function(){return l}));var i=a("6b75");function n(t){if(Array.isArray(t))return Object(i["a"])(t)}a("a4d3"),a("e01a"),a("d3b7"),a("d28b"),a("3ca3"),a("ddb0"),a("a630");function o(t){if("undefined"!==typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}var s=a("06c5");function r(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function l(t){return n(t)||o(t)||Object(s["a"])(t)||r()}},3117:function(t,e,a){"use strict";a("8238")},8238:function(t,e,a){},d2cd:function(t,e,a){"use strict";a.r(e);var i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("a-modal",{attrs:{title:t.title,width:300,visible:t.visibleUpload,maskClosable:!1,confirmLoading:t.confirmLoading,footer:null},on:{cancel:t.handleCancel}},[a("a-spin",{attrs:{spinning:t.confirmLoading,height:800}},[a("div",[a("span",[t._v("示例表格")]),a("a",{staticStyle:{"margin-left":"20px"},attrs:{href:"/static/file/village/meter/addMeter.xls",target:"_blank"}},[t._v("点击下载")])]),a("div",{staticStyle:{"border-bottom":"1px solid #dad8d8","border-top":"1px solid #dad8d8","margin-top":"20px"}},[a("span",[t._v("导入Excel")]),a("a-upload",{attrs:{name:"file","file-list":t.avatarFileList,action:t.upload,headers:t.headers,"before-upload":t.beforeUploadFile},on:{change:t.handleChangeUpload}},[a("a-button",{staticStyle:{margin:"20px   20px  10px"},attrs:{type:"primary"}},[a("a-icon",{attrs:{type:"upload"}}),t._v(" 导入 ")],1)],1)],1),t.show?a("div",{staticStyle:{"margin-top":"20px"}},[a("span",[t._v("导入失败")]),a("a",{staticStyle:{"margin-left":"20px"},attrs:{href:t.url,target:"_blank"}},[t._v("点击下载带入失败数据表格")])]):t._e()])],1)},n=[],o=a("a0e0"),s=a("ca00"),r={data:function(){return{upload:"/v20/public/index.php"+o["a"].uploadMeterFiles+"?upload_dir=/house/excel/meterUpload",avatarFileList:[],headers:{authorization:"authorization-text"},visibleUpload:!1,confirmLoading:!1,title:"导入",url:"",show:!1,fileloading:!1,data_arr:[],tokenName:"",sysName:"",charge_name:"",project_id:0}},activated:function(){var t=Object(s["i"])(location.hash);t?(this.tokenName=t+"_access_token",this.sysName=t):this.sysName="village"},methods:{add:function(t,e){this.title="导入",this.visibleUpload=!0,this.url=window.location.host+"/v20/runtime/demo.xlsx",this.avatarFileList=[],this.charge_name=t,this.project_id=e},beforeUploadFile:function(t){var e=t.size/1024/1024<20;return e?this.fileloading?(this.$message.warning("当前还有文件上传中，请等候上传完成!"),!1):e:(this.$message.error("上传图片最大支持20MB!"),!1)},handleChangeUpload:function(t){var e=this;if(console.log("########",t),t.file&&!t.file.status&&this.fileloading)return!1;if("uploading"===t.file.status){if(this.fileloading)return!1;this.fileloading=!0,this.avatarFileList=t.fileList}if("uploading"!==t.file.status&&(this.fileloading=!1,console.log(t.file,t.fileList)),"done"==t.file.status&&t.file&&t.file.response){var a=t.file.response;if(1e3===a.status)this.data_arr.push(a.data),console.log("data_arr",this.data_arr),this.avatarFileList=t.fileList,console.log("--------",a.data.url),this.request(o["a"].exportMeter,{tokenName:this.tokenName,file:a.data.url,charge_name:this.charge_name}).then((function(t){t.error?(e.$parent.getList(e.charge_name,e.project_id),e.$message.success("上传成功")):window.location.href=t.data})),this.visibleUpload=!1;else for(var i in this.$message.error(t.file.response.msg),this.avatarFileList=[],t.fileList)if(t.fileList[i]){var n=t.fileList[i];console.log("info_1",n),n&&n.response&&1e3===n.response.status&&this.avatarFileList.push(n)}}if("removed"==t.file.status&&t.file){var s=t.file.response;if(s&&1e3===s.status)for(var i in this.data_arr=[],t.fileList)if(t.fileList[i]){var r=t.fileList[i];r&&r.response&&1e3===r.response.status&&this.data_arr.push(r.response.data)}this.avatarFileList=t.fileList,console.log("data_arr1",this.data_arr)}},handleCancel:function(){this.visibleUpload=!1}}},l=r,c=(a("3117"),a("2877")),d=Object(c["a"])(l,i,n,!1,null,"21c34c8b",null);e["default"]=d.exports}}]);