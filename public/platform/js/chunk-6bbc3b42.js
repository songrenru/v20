(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-6bbc3b42","chunk-26a700ea","chunk-d20649e8"],{"026a":function(e,t,a){},"1ce9":function(e,t,a){"use strict";a("b6f3")},"1da1":function(e,t,a){"use strict";a.d(t,"a",(function(){return o}));a("d3b7");function i(e,t,a,i,o,r,s){try{var n=e[r](s),l=n.value}catch(c){return void a(c)}n.done?t(l):Promise.resolve(l).then(i,o)}function o(e){return function(){var t=this,a=arguments;return new Promise((function(o,r){var s=e.apply(t,a);function n(e){i(s,o,r,n,l,"next",e)}function l(e){i(s,o,r,n,l,"throw",e)}n(void 0)}))}}},2909:function(e,t,a){"use strict";a.d(t,"a",(function(){return l}));var i=a("6b75");function o(e){if(Array.isArray(e))return Object(i["a"])(e)}a("a4d3"),a("e01a"),a("d3b7"),a("d28b"),a("3ca3"),a("ddb0"),a("a630");function r(e){if("undefined"!==typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}var s=a("06c5");function n(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function l(e){return o(e)||r(e)||Object(s["a"])(e)||n()}},"2b69":function(e,t,a){"use strict";a.r(t);var i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("a-modal",{attrs:{visible:e.dialogVisible,title:"选择店铺",centered:"",maskClosable:!1,width:600},on:{ok:e.chooseStoreOk,cancel:e.chooseStoreCancel}},[[a("a-form-model",{attrs:{layout:"inline",model:e.modalSearchForm,"label-col":{span:2},"wrapper-col":{span:22}}},[a("a-row",[a("a-col",{staticClass:"mr-10",attrs:{span:10}},[a("a-cascader",{attrs:{"field-names":{label:"area_name",value:"area_id",children:"children"},options:e.areaList,placeholder:"请选择省市区"},on:{change:e.onAreaChange},model:{value:e.searchForm.areaList,callback:function(t){e.$set(e.searchForm,"areaList",t)},expression:"searchForm.areaList"}})],1),a("a-col",{staticClass:"mr-20",attrs:{span:10}},[a("a-input",{attrs:{placeholder:"输入店铺名称"},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.selectStoreList()}},model:{value:e.modalSearchForm.keyword,callback:function(t){e.$set(e.modalSearchForm,"keyword",t)},expression:"modalSearchForm.keyword"}})],1),a("a-col",{attrs:{span:2}},[a("a-button",{attrs:{type:"primary"},on:{click:function(t){return e.selectStoreList()}}},[e._v(" 查询 ")])],1)],1)],1),e.modalTableData?[a("a-checkbox",{staticStyle:{"padding-left":"7px",margin:"10px 0 5px"},attrs:{indeterminate:e.indeterminate,checked:e.checkAll},on:{change:function(t){return e.onCheckAllChange(t)}}},[e._v("全选")]),a("a-row",[a("a-col",{staticStyle:{"font-size":"20px","padding-left":"7px"},attrs:{span:24}},e._l(e.modalTableData,(function(t,i){return a("a-col",{key:t.store_id,staticStyle:{"line-height":"40px"},attrs:{span:24}},[t.showRow?a("div",[a("a-checkbox",{key:i,attrs:{value:t.store_id,checked:-1!=e.grouplList1.indexOf(t.store_id)},on:{change:function(a){return e.getStoreId(a,t)}}},[e._v(" "+e._s(t.name)+" ")]),t.package_list&&t.package_list.length?[a("a-col",{attrs:{span:24}},[a("a-radio-group",{attrs:{name:"radioGroup"},on:{change:function(a){return e.onExpandedRowChange(a,t)}},model:{value:e.radio_check,callback:function(t){e.radio_check=t},expression:"radio_check"}},e._l(t.package_list,(function(t){return a("a-radio",{key:t.id,attrs:{value:t.id}},[e._v(" "+e._s(t.name)+" ")])})),1)],1)]:e._e()],2):e._e()])})),1)],1),a("a-row",{staticClass:"text-right"},[[a("a-pagination",{attrs:{total:e.total,"show-less-items":"",hideOnSinglePage:""},on:{change:e.pageChange},model:{value:e.modalSearchForm.page,callback:function(t){e.$set(e.modalSearchForm,"page",t)},expression:"modalSearchForm.page"}})]],2)]:e._e()]],2)],1)},o=[],r=(a("d3b7"),a("159b"),a("b0c0"),a("a434"),a("a9e3"),a("4de4"),a("d81d"),a("c740"),a("a15b"),a("4b77")),s=a("da05"),n=a("290c"),l={components:{ARow:n["a"],ACol:s["b"]},props:{visible:{type:Boolean,default:!1},storeIdArr:{type:[Array,Object],default:function(){}}},watch:{visible:function(e,t){this.checkAll=!1,this.indeterminate=!1,this.grouplList1=[],this.storeIds=[],this.dialogVisible=e,this.getAllArea(),this.selectStoreList()}},mounted:function(){this.dialogVisible=this.visible,this.getAllArea(),this.selectStoreList()},data:function(){return{checkAll:!0,indeterminate:!0,radio_check:[],total:0,grouplList1:[],showHeader:!1,dialogVisible:!1,areaList:[],searchForm:{storeIdArray:[],areaList:[]},storeIds:[],modalSearchForm:{province_id:"",city_id:"",area_id:"",keyword:"",page:1},columns:[{dataIndex:"name",slots:{title:"name"},align:"center"}],modalTableData:[],curStoreList:[],modalSelectedRowKeys:[],expandedRowKeys:[]}},methods:{onCheckAllChange:function(e){var t=this;e.target.checked?(this.checkAll=!0,this.indeterminate=!0,this.modalTableData.forEach((function(e){e.show=!0,-1==t.grouplList1.indexOf(e.store_id)&&(t.grouplList1.push(e.store_id),t.storeIds.push({store_id:e.store_id,package_id:"",name:e.name}))}))):(this.modalTableData.forEach((function(e){e.show=!1;var a=t.grouplList1.indexOf(e.store_id);a>-1&&(t.grouplList1.splice(a,1),t.storeIds.splice(a,1))})),this.checkAll=!1,this.indeterminate=!1)},pageChange:function(e,t){this.modalSearchForm.page=e,this.modalTableData=this.modalTableDataGet(this.modalTableData,this.modalSearchForm.page)},getStoreId:function(e,t){if(e.target.checked)this.grouplList1.push(e.target.value),this.storeIds.push({store_id:t.store_id,package_id:"",name:t.name}),t.show=!0;else{var a=this.grouplList1.indexOf(e.target.value);a>-1&&(this.grouplList1.splice(a,1),this.storeIds.splice(a,1)),t.show=!1}this.grouplList1.length==this.modalTableData.length?(this.indeterminate=!0,this.checkAll=!0):(this.indeterminate=!1,this.checkAll=!1)},modalTableDataGet:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:10,i=[];if(e&&e.length){var o=(Number(t)-1)*a,r=Number(t)*a-1>this.total?this.total:Number(t)*a-1;i=e.filter((function(e,t){return e.showRow=!1,t>=o&&t<=r&&(e.showRow=!0),e}))}return i},selectStoreList:function(){var e=this,t={province_id:this.modalSearchForm.province_id,city_id:this.modalSearchForm.city_id,area_id:this.modalSearchForm.area_id,keyword:this.modalSearchForm.keyword,page:0};this.request(r["a"].getMerchantStoreList,t).then((function(t){if(t.list&&t.list.length?e.modalTableData=e.modalTableDataGet(t.list,e.modalSearchForm.page):e.modalTableData=[],e.total=t.total,0==e.storeIdArr.length)e.modalTableData.forEach((function(t){var a=e.grouplList1.indexOf(t.store_id);-1==a&&(e.grouplList1.push(t.store_id),e.storeIds.push({store_id:t.store_id,package_id:"",name:t.name}))})),e.checkAll=!0,e.indeterminate=!0;else{var a=0;e.storeIdArr.forEach((function(t){var i=e.grouplList1.indexOf(t.store_id);-1==i&&(e.grouplList1.push(t.store_id),e.storeIds.push({store_id:t.store_id,package_id:t.package_id,name:t.name})),e.modalTableData=e.modalTableData.map((function(e){return t.store_id==e.store_id&&(e.show=!0,a+=1),e}))})),a!=e.modalTableData.length?(e.checkAll=!1,e.indeterminate=!1):(e.checkAll=!0,e.indeterminate=!0)}}))},getAllArea:function(){var e=this;this.request(r["a"].getAllArea).then((function(t){e.areaList=t}))},onAreaChange:function(e){this.modalSearchForm.province_id=e[0],this.modalSearchForm.city_id=e[1],this.modalSearchForm.area_id=e[2],this.selectStoreList()},onExpandedRowChange:function(e,t){var a=t.store_id,i=e.target.value,o=this.storeIds.findIndex((function(e){return e.store_id==a}));o>-1?this.storeIds[o].package_id=i:(this.storeIds.push({store_id:a,package_id:i||"",name:t.name}),this.radio_check.push(i))},chooseStoreOk:function(){this.$set(this.searchForm,"storeIdArray",this.grouplList1);var e=[],t="";this.modalTableData&&this.modalTableData.length?this.storeIds.forEach((function(a){e.push(a.name),t=e.filter((function(e){return e})).join(",")})):this.storeIds=[],this.$emit("submit",{storeName:t,storeIds:this.storeIds}),this.chooseStoreCancel()},chooseStoreCancel:function(){this.modalTableData=[],this.dialogVisible=!1,this.$emit("update:visible",this.dialogVisible),this.$set(this.modalSearchForm,"keyword",""),this.$set(this.modalSearchForm,"page",1),this.$set(this.modalSearchForm,"province_id",""),this.$set(this.modalSearchForm,"city_id",""),this.$set(this.modalSearchForm,"area_id",""),this.$set(this.searchForm,"areaList",[])},onModalSelectChange:function(e){var t=this;this.expandedRowKeys=e,this.storeIds=[],this.modalSelectedRowKeys=e,this.modalSelectedRowKeys.forEach((function(e){t.storeIds.push({store_id:e,package_id:""})}))}}},c=l,m=(a("c46b"),a("2877")),p=Object(m["a"])(c,i,o,!1,null,"6e2d32d5",null);t["default"]=p.exports},4928:function(e,t,a){"use strict";a.r(t);var i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("a-form-model-item",{staticClass:"mb-10",attrs:{label:"标签组",labelCol:{span:3}}},[a("a-radio-group",{on:{change:e.goodsTagGroupChange},model:{value:e.labelGroup,callback:function(t){e.labelGroup=t},expression:"labelGroup"}},e._l(e.goodsTagGroupList,(function(t,i){return a("a-radio",{key:i,staticStyle:{"margin-bottom":"20px"},attrs:{value:t.id,disabled:!t.id}},[a("a-input",{staticStyle:{width:"100px"},attrs:{placeholder:"标签名"},on:{blur:function(a){return e.addLabelOpt(a,"1",t)},change:function(t){return e.addLabelChange()}},model:{value:t.name,callback:function(a){e.$set(t,"name",a)},expression:"groupItem.name"}})],1)})),1),a("a-button",{staticClass:"cr-primary",staticStyle:{padding:"0 10px","border-color":"#1890ff"},attrs:{icon:"plus"},on:{click:e.addTagGroup}},[e._v(" 新增 ")])],1),e.showTags?a("a-form-model-item",{attrs:{label:"标签",labelCol:{span:3}}},[a("a-checkbox-group",{on:{change:e.goodsTagChange},model:{value:e.labelIds,callback:function(t){e.labelIds=t},expression:"labelIds"}},e._l(e.goodsTagList,(function(t,i){return a("a-checkbox",{key:i,staticStyle:{"margin-bottom":"20px"},attrs:{value:t.id}},[a("a-input",{staticStyle:{width:"100px"},attrs:{placeholder:"标签名"},on:{blur:function(a){return e.addLabelOpt(a,"2",t)},change:function(t){return e.addLabelChange()}},model:{value:t.name,callback:function(a){e.$set(t,"name",a)},expression:"item.name"}})],1)})),1),a("a-button",{staticClass:"cr-primary",staticStyle:{padding:"0 10px","border-color":"#1890ff"},attrs:{icon:"plus"},on:{click:e.addTag}},[e._v(" 新增 ")])],1):e._e()],1)},o=[],r=(a("d3b7"),a("159b"),a("498a"),a("4b77")),s={props:{labelInfo:{type:[String,Object],default:""}},data:function(){return{labelGroup:this.labelInfo&&this.labelInfo.labelGroup?this.labelInfo.labelGroup:"",labelIds:this.labelInfo&&this.labelInfo.labelIds?this.labelInfo.labelIds:[],goodsTagGroupList:[],currentTagGroupIndex:0,showTags:!(!this.labelInfo||!this.labelInfo.labelGroup),goodsTagList:[],labelInfoForm:[],checkAddLabelChange:!1}},watch:{labelInfo:{immediate:!0,handler:function(e){e&&(e.labelGroup&&(this.showTags=!0,this.getGoodsTagList()),this.$set(this,"labelGroup",e.labelGroup||""),this.$set(this,"labelIds",e.labelIds||[]))}},labelGroup:{immediate:!0,handler:function(e){e&&this.getGoodsTagList()}}},mounted:function(){this.getLabelList()},methods:{addTagGroup:function(){this.goodsTagGroupList.push({id:"",name:"",child:[]})},addTag:function(){var e=this;this.goodsTagGroupList.length&&this.goodsTagGroupList.forEach((function(t,a){t.id==e.labelGroup&&(t.child||(t.child=[]),t.child.push({id:"",name:""}),e.$set(e.goodsTagGroupList,a,t),e.getGoodsTagList())}))},goodsTagGroupChange:function(e){this.showTags=!0;var t=e.target.value;this.currentTagGroupIndex=t,this.labelInfoForm=this.labelInfoForm?this.labelInfoForm:{},this.$set(this.labelInfoForm,"labelGroup",e.target.value),this.$emit("getLabelGroup",this.labelInfoForm),this.getGoodsTagList()},getGoodsTagList:function(){var e=this;this.goodsTagGroupList.length&&this.goodsTagGroupList.forEach((function(t){t.id==e.labelGroup&&(e.goodsTagList=t.child)}))},goodsTagChange:function(e){console.log(e,"labelIds==labelIds==labelIds"),this.$set(this.labelInfoForm,"labelIds",e),this.$emit("getLabelGroup",this.labelInfoForm)},getLabelList:function(){var e=this;this.request(r["a"].getLabelList).then((function(t){e.goodsTagGroupList=t.list,!e.labelGroup&&e.goodsTagGroupList&&e.goodsTagGroupList.length&&(e.labelGroup=e.goodsTagGroupList[0]["id"],e.getGoodsTagList())}))},addLabelOpt:function(e,t,a){var i=this;if(a.id&&""==e.target.value.trim())return this.$message.error("请输入标签名称"),void this.$emit("checkLabelReslut");if(""!=e.target.value.trim()&&this.checkAddLabelChange){var o={name:e.target.value,fid:"2"==t?this.labelGroup:"",id:a.id};this.request(r["a"].addLabel,o).then((function(e){i.checkAddLabelChange=!1,a.id||i.getLabelList()})).catch((function(e){i.checkAddLabelChange=!1}))}},addLabelChange:function(){this.checkAddLabelChange=!0}}},n=s,l=a("2877"),c=Object(l["a"])(n,i,o,!1,null,"48b66c74",null);t["default"]=c.exports},"4b77":function(e,t,a){"use strict";var i,o=a("ade3"),r=(i={addLabel:"/group/merchant.goods/addLabel",getLabelList:"/group/merchant.goods/getLabelList",getMerchantStoreList:"/group/merchant.goods/getMerchantStoreList",getAllArea:"/common/common.area/getAllArea",getGoodsCashingDetail:"/group/merchant.goods/getGoodsCashingDetail",getGroupEditInfo:"/group/merchant.goods/getGroupEditInfo"},Object(o["a"])(i,"getGoodsCashingDetail","/group/merchant.goods/getGoodsCashingDetail"),Object(o["a"])(i,"saveCashingGoods","/group/merchant.goods/submitCashing"),Object(o["a"])(i,"saveNomalGoods","/group/merchant.goods/saveNomalGoods"),Object(o["a"])(i,"getGoodsNormalDetail","/group/merchant.goods/getGoodsNormalDetail"),Object(o["a"])(i,"getGoodsList","/group/merchant.goods/getGoodsList"),Object(o["a"])(i,"courseAppoint","/group/merchant.Goods/courseAppoint"),Object(o["a"])(i,"getCourseAppointDetail","/group/merchant.Goods/getCourseAppointDetail"),Object(o["a"])(i,"setStoreRecommend","/group/merchant.goods/setStoreRecommend"),Object(o["a"])(i,"getStoreRecommend","/group/merchant.goods/getStoreRecommend"),Object(o["a"])(i,"getGoodsOrderList","/group/merchant.goods/getGoodsOrderList"),Object(o["a"])(i,"saveBookingAppoint","/group/merchant.Goods/saveBookingAppoint"),Object(o["a"])(i,"showBookingAppoint","/group/merchant.Goods/showBookingAppoint"),Object(o["a"])(i,"getStoreList","/group/merchant.AppointManage/getStoreList"),Object(o["a"])(i,"getGiftMsg","/group/merchant.AppointManage/getGiftMsg"),Object(o["a"])(i,"updateAppointGift","/group/merchant.AppointManage/updateAppointGift"),Object(o["a"])(i,"getAppointArriveList","/group/merchant.AppointManage/getAppointArriveList"),Object(o["a"])(i,"updateAppointArriveStatus","/group/merchant.AppointManage/updateAppointArriveStatus"),Object(o["a"])(i,"getGoodsOrderDetail","/group/merchant.goods/getGoodsOrderDetail"),Object(o["a"])(i,"orderExportUrl","/group/merchant.goods/exportOrder"),Object(o["a"])(i,"noteInfo","/group/merchant.goods/noteInfo"),Object(o["a"])(i,"orderDetail","/group/merchant.goods/orderDetail"),Object(o["a"])(i,"updateOrderNote","/group/merchant.goods/updateOrderNote"),Object(o["a"])(i,"getRatioList","/group/merchant.goods/getRatioList"),i);t["a"]=r},"7b3f":function(e,t,a){"use strict";var i={uploadImg:"/common/common.UploadFile/uploadImg"};t["a"]=i},b6f3:function(e,t,a){},c46b:function(e,t,a){"use strict";a("026a")},f093:function(e,t,a){"use strict";a.r(t);var i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"page"},[a("a-page-header",{staticClass:"page-header",attrs:{title:"添加商品"}}),a("a-form-model",{ref:"ruleForm",attrs:{model:e.formData,"label-col":e.labelCol,"wrapper-col":e.wrapperCol}},[a("a-tabs",{attrs:{activeKey:e.activeKey},on:{change:e.onTabChange}},[a("a-tab-pane",{key:"1",attrs:{tab:"基本信息"}},[a("a-card",{attrs:{bordered:!1}},[a("a-form-model-item",{attrs:{label:"商品类型",colon:!1,help:"默认一张，最大支持500张"}},[a("a-radio-group",{attrs:{defaultValue:e.formData.tuan_type},model:{value:e.formData.tuan_type,callback:function(t){e.$set(e.formData,"tuan_type",t)},expression:"formData.tuan_type"}},[a("a-radio",{attrs:{value:2}},[e._v(" 实物商品 ")]),a("a-radio",{attrs:{value:0}},[a("span",[e._v("团购券，生成")]),a("a-input-number",{attrs:{min:1,max:500,precision:0},model:{value:e.formData.pass_num,callback:function(t){e.$set(e.formData,"pass_num",t)},expression:"formData.pass_num"}}),a("span",[e._v("份券码")])],1)],1)],1),a("a-form-model-item",{attrs:{label:"商品标题",colon:!1,help:"限100字",prop:"name",rules:[{required:!0,message:"商品标题不能为空",trigger:["blur"]}]}},[a("a-input",{staticStyle:{width:"300px"},attrs:{maxLength:100,placeholder:"请输入商品标题"},model:{value:e.formData.name,callback:function(t){e.$set(e.formData,"name",t)},expression:"formData.name"}})],1),2==e.formData.tuan_type?a("a-form-model-item",{attrs:{label:"是否支持邮寄",colon:!1}},[a("a-radio-group",{attrs:{defaultValue:e.formData.open_express},model:{value:e.formData.open_express,callback:function(t){e.$set(e.formData,"open_express",t)},expression:"formData.open_express"}},e._l(e.mailTypeList,(function(t){return a("a-radio",{key:t.value,attrs:{value:t.value}},[e._v(e._s(t.label))])})),1)],1):e._e(),a("a-form-model-item",{attrs:{label:"商品名称",colon:!1,wrapperCol:{span:6},prop:"s_name",rules:[{required:!0,message:"商品名称不能为空",trigger:["blur"]},{required:!0,message:"商品名称最多20个字符",max:20,trigger:["blur"]}]}},[a("a-input",{attrs:{maxLength:20,placeholder:"请输入商品名称"},model:{value:e.formData.s_name,callback:function(t){e.$set(e.formData,"s_name",t)},expression:"formData.s_name"}})],1),a("a-form-model-item",{attrs:{label:"商品标签",colon:!1,help:"店铺主页中用于切换查看不同商品标签"}},[a("add-goods-tags",{attrs:{labelInfo:{labelGroup:e.formData.label_group||"",labelIds:e.formData.label_ids||[]}},on:{getLabelGroup:e.getLabelId,checkLabelReslut:function(t){e.checkLabelReslut=!1}}})],1),a("a-form-model-item",{attrs:{label:"原价",colon:!1,wrapperCol:{span:6},prop:"old_price",rules:{required:!0,message:"请输入商品原价",trigger:["blur"]}}},[a("a-input-number",{staticStyle:{width:"100%"},attrs:{precision:2,placeholder:"请输入商品原价"},model:{value:e.formData.old_price,callback:function(t){e.$set(e.formData,"old_price",t)},expression:"formData.old_price"}})],1),a("a-form-model-item",{attrs:{label:"团购价",colon:!1,wrapperCol:{span:18},prop:"price",rules:{required:!0,message:"请输入商品团购价",trigger:["blur"]}}},[a("a-row",[a("a-col",{attrs:{span:8}},[a("a-input-number",{staticStyle:{width:"100%"},attrs:{precision:2,placeholder:"请输入商品团购价"},model:{value:e.formData.price,callback:function(t){e.$set(e.formData,"price",t)},expression:"formData.price"}})],1),a("a-col",{attrs:{span:10}},[a("a-radio-group",{staticStyle:{"margin-left":"20px"},attrs:{"default-value":e.formData.is_invoice},model:{value:e.formData.is_invoice,callback:function(t){e.$set(e.formData,"is_invoice",t)},expression:"formData.is_invoice"}},e._l(e.isInvoiceList,(function(t){return a("a-radio",{key:t.value,attrs:{value:t.value}},[e._v(" "+e._s(t.label)+" ")])})),1)],1)],1)],1),a("a-form-model-item",{attrs:{label:"图片",colon:!1,help:"第一张将做为主图片！最多上传5张图片！图片建议为900*500",prop:"image",rules:{required:!0,message:"请上传团购图片",trigger:["blur"]}}},[a("div",{staticClass:"clearfix"},[a("a-upload",{attrs:{name:"reply_pic",action:e.uploadImg,"list-type":"picture-card","file-list":e.imgUploadList,multiple:!0},on:{preview:e.handlePreview,change:e.handleImgChange}},[e.imgUploadList.length<5?a("div",[a("a-icon",{attrs:{type:"plus"}}),a("div",{staticClass:"ant-upload-text"},[e._v("上传图片")])],1):e._e()]),a("a-modal",{attrs:{visible:e.previewVisible,footer:null},on:{cancel:e.handleImgCancel}},[a("img",{staticStyle:{width:"100%"},attrs:{alt:"example",src:e.previewImage}})])],1)]),a("a-form-model-item",{attrs:{label:"团购开始时间",colon:!1,help:"到了团购开始时间，商品才会显示！",prop:"begin_time",rules:{required:!0,message:"请选择团购开始时间",trigger:["blur","change"]}}},[a("a-date-picker",{staticStyle:{width:"280px"},attrs:{placeholder:"请选择时间","show-time":"",format:"YYYY-MM-DD HH:mm:ss",value:e.date_moment(e.formData.begin_time,e.dateFormat),allowClear:!0,"disabled-date":e.disabledStartDate,getCalendarContainer:function(e){return e.parentNode}},on:{change:e.beginTimeChange}})],1),a("a-form-model-item",{attrs:{label:"团购结束时间",colon:!1,help:"超过团购结束时间，商品不再显示售卖！",prop:"end_time",rules:{required:!0,message:"请选择团购结束时间",trigger:["blur","change"]}}},[a("a-date-picker",{staticStyle:{width:"280px"},attrs:{placeholder:"请选择时间","show-time":"",format:"YYYY-MM-DD HH:mm:ss",value:e.date_moment(e.formData.end_time,e.dateFormat),"disabled-date":e.disabledEndDate,allowClear:!0,getCalendarContainer:function(e){return e.parentNode}},on:{change:e.endTimeChange}})],1),a("a-form-model-item",{attrs:{label:"团购券有效期",colon:!1,prop:"deadline_time"}},[a("a-radio-group",{attrs:{defaultValue:e.formData.effective_type},on:{change:function(){e.formData.deadline_time=""}},model:{value:e.formData.effective_type,callback:function(t){e.$set(e.formData,"effective_type",t)},expression:"formData.effective_type"}},[a("a-radio",{staticStyle:{"margin-right":"0"},attrs:{value:0}},[e._v(" 固定时间 ")]),a("a-date-picker",{attrs:{placeholder:"请选择时间","show-time":"",allowClear:!0,format:"YYYY-MM-DD HH:mm:ss",value:0==e.formData.effective_type?e.date_moment(e.formData.deadline_time,e.dateFormat):null,getCalendarContainer:function(e){return e.parentNode}},on:{change:e.deadlineTimeChange}}),a("a-radio",{staticStyle:{"margin-left":"30px"},attrs:{value:1}},[a("span",[e._v("购买后")]),1==e.formData.effective_type?a("a-input-number",{attrs:{min:1,max:999},model:{value:e.formData.deadline_time,callback:function(t){e.$set(e.formData,"deadline_time",t)},expression:"formData.deadline_time"}}):a("a-input-number"),a("span",[e._v("天后到期")])],1)],1)],1),a("a-form-model-item",{attrs:{label:"提前取消设置",colon:!1}},[a("a-radio-group",{attrs:{defaultValue:e.formData.cancel_type},model:{value:e.formData.cancel_type,callback:function(t){e.$set(e.formData,"cancel_type",t)},expression:"formData.cancel_type"}},[a("a-radio",{attrs:{value:0}},[e._v(" 不可取消 ")]),a("a-radio",{attrs:{value:1}},[a("span",[e._v("支持取消，到期前")]),1==e.formData.cancel_type?a("a-input-number",{attrs:{min:1},model:{value:e.formData.cancel_hours,callback:function(t){e.$set(e.formData,"cancel_hours",t)},expression:"formData.cancel_hours"}}):a("a-input-number",{attrs:{min:1}}),a("span",[e._v("小时")])],1),a("a-radio",{attrs:{value:2}},[e._v(" 随时取消 ")])],1)],1),a("a-form-model-item",{attrs:{label:"使用时间限制",colon:!1}},[a("a-select",{staticStyle:{width:"300px"},attrs:{"default-value":e.formData.is_general},model:{value:e.formData.is_general,callback:function(t){e.$set(e.formData,"is_general",t)},expression:"formData.is_general"}},e._l(e.generalList,(function(t){return a("a-select-option",{key:t.value},[e._v(" "+e._s(t.label)+" ")])})),1),a("a-radio-group",{staticStyle:{"margin-left":"20px"},on:{change:e.appointTypeChange},model:{value:e.appoint_type,callback:function(t){e.appoint_type=t},expression:"appoint_type"}},[a("a-radio",{attrs:{value:0}},[e._v(" 无需预约 ")]),a("a-radio",{attrs:{value:1}},[a("span",[e._v("提前预约")]),1==e.appoint_type?a("a-input-number",{attrs:{min:0,max:99},model:{value:e.formData.appoint_time,callback:function(t){e.$set(e.formData,"appoint_time",t)},expression:"formData.appoint_time"}}):e._e(),1==e.appoint_type?a("a-select",{staticStyle:{width:"100px"},model:{value:e.formData.appoint_time_type,callback:function(t){e.$set(e.formData,"appoint_time_type",t)},expression:"formData.appoint_time_type"}},e._l(e.appointTimeTypelist,(function(t){return a("a-select-option",{key:t.value,attrs:{value:t.value}},[e._v(" "+e._s(t.label)+" ")])})),1):e._e()],1)],1)],1),a("a-form-model",{attrs:{model:e.formData,"label-col":e.labelCol,"wrapper-col":e.wrapperCol}},[a("a-form-model-item",{attrs:{label:"适用店铺",colon:!1}},[a("span",[e._v(e._s(e.storeStrName||"未选择店铺"))]),a("span",{staticClass:"cr-primary ml-20 pointer",on:{click:e.selectStore}},[e._v("设置")])])],1),a("choose-store",{attrs:{visible:e.selectStoreVisible,storeIdArr:e.formData.store_ids},on:{"update:visible":function(t){e.selectStoreVisible=t},submit:e.onStoreSelect}}),e.formData.store_ids&&1==e.formData.store_ids.length?a("div",[a("a-form-model-item",{attrs:{label:"调价区间",colon:!1,prop:"price_range",help:"该区间表示，分销员进行分销调价的范围；不填写则表示该商品分销时不支持调价"}},[a("a-input-number",{staticStyle:{margin:"-5px 0"},attrs:{formatter:function(e){return("￥ "+e).replace(/\B(?=(\d{3})+(?!\d))/g,",")},parser:function(e){return e.replace(/\￥\s?|(,*)/g,"")},min:0},model:{value:e.formData.price_range_low,callback:function(t){e.$set(e.formData,"price_range_low",t)},expression:"formData.price_range_low"}}),a("span",{staticClass:"cr-99 ml-10 mr-10"},[e._v("—")]),a("a-input-number",{staticStyle:{margin:"-5px 0"},attrs:{formatter:function(e){return("￥ "+e).replace(/\B(?=(\d{3})+(?!\d))/g,",")},parser:function(e){return e.replace(/\￥\s?|(,*)/g,"")},min:0},model:{value:e.formData.price_range_height,callback:function(t){e.$set(e.formData,"price_range_height",t)},expression:"formData.price_range_height"}})],1),a("a-form-model-item",{attrs:{label:"统一分销比例",colon:!1,wrapperCol:{span:4},prop:"marketing_ratio",help:"分销员统一的分销比例"}},[a("a-input-number",{attrs:{min:0,max:100},model:{value:e.formData.marketing_ratio,callback:function(t){e.$set(e.formData,"marketing_ratio",t)},expression:"formData.marketing_ratio"}}),e._v(" % ")],1),e._l(e.formData.ratio_list,(function(t,i){return a("a-form-model-item",{key:t.id,attrs:{prop:"ratio_list."+i+".id",label:" ",colon:!1}},[a("a-select",{staticStyle:{width:"160px"},attrs:{placeholder:"选择分销员"},model:{value:t.id,callback:function(a){e.$set(t,"id",a)},expression:"item.id"}},e._l(e.getMarketingMemberOptions(t.id),(function(t){return a("a-select-option",{key:t.id},[e._v(" "+e._s(t.name)+" ")])})),1),a("span",{staticClass:"ml-20 mr-10"},[e._v("比例")]),a("a-input-number",{attrs:{min:0,max:100},model:{value:t.ratio,callback:function(a){e.$set(t,"ratio",a)},expression:"item.ratio"}}),e._v(" % ")],1)})),e.marketingMemberList.length&&e.formData.ratio_list.length!=e.marketingMemberList.length?a("a-form-model-item",{attrs:{label:" ",colon:!1}},[a("a-button",{staticStyle:{padding:"0"},attrs:{type:"link"},on:{click:function(t){return e.addRatioList()}}},[e._v("+分销员单独设置")])],1):e._e()],2):e._e(),a("a-form-model-item",{attrs:{label:"商品详情",colon:!1}},[a("span",{staticClass:"cr-primary pointer",on:{click:e.insertTab}},[e._v("插入套餐表格")]),a("rich-text",{attrs:{info:e.formData.content},on:{"update:info":function(t){return e.$set(e.formData,"content",t)}}})],1),a("a-modal",{attrs:{title:"输入插入表格行数",width:400,maskClosable:!1},on:{ok:e.onTableOk,cancel:e.onTableCancel},model:{value:e.modalTable,callback:function(t){e.modalTable=t},expression:"modalTable"}},[a("a-input",{model:{value:e.tableLineNum,callback:function(t){e.tableLineNum=t},expression:"tableLineNum"}})],1)],1)],1),a("a-tab-pane",{key:"2",attrs:{tab:"规格/数量","force-render":""}},[a("a-divider",{staticStyle:{height:"10px","background-color":"#eef0f3",margin:"0"}}),a("a-card",{attrs:{bordered:!1}},[a("p",{staticClass:"fs-16"},[e._v("规格设置")]),a("a-divider",{staticStyle:{margin:"10px 0"}}),a("p",{staticClass:"fs-12"},[e._v(" 说明：可为团购商品的规格设置一个价格、库存、同一ID最多购买数量、同一ID每天最多购买数量、同一ID每次最少购买数量。团购规格适用于普通团购，但是当团购类型为其他的时候、规格失效！ ")]),a("div",{staticClass:"flex justify-center align-center text-center mt-20 fw-bold spec-tab"},e._l(e.specTabList,(function(t,i){return a("div",{key:i,staticStyle:{width:"100%"}},[t.tip?a("a-tooltip",{staticClass:"pointer text-wrap",staticStyle:{"max-width":"120px",display:"inline-block"}},[e._v(" "+e._s(t.title)+" "),a("template",{slot:"title"},[e._v(" "+e._s(t.tip))]),a("a-icon",{attrs:{type:"question-circle"}})],2):a("div",{staticClass:"flex flex-1 justify-center align-center text-wrap",staticStyle:{"max-width":"120px"}},[e._v(" "+e._s(t.title)+" ")])],1)})),0),e.formData.spec_list&&e.formData.spec_list.length?a("div",e._l(e.formData.spec_list,(function(t,i){return a("div",{key:i,staticClass:"flex justify-center align-center text-center",staticStyle:{width:"90%",height:"50px",position:"relative"}},[a("div",{staticClass:"flex-1"},[a("a-input",{staticStyle:{width:"60%"},attrs:{maxLength:6},model:{value:t.specifications_name,callback:function(a){e.$set(t,"specifications_name",a)},expression:"singleSpec.specifications_name"}})],1),a("div",{staticClass:"flex-1"},[a("a-input-number",{staticStyle:{width:"60%"},attrs:{min:0,precision:2},model:{value:t.price,callback:function(a){e.$set(t,"price",a)},expression:"singleSpec.price"}})],1),a("div",{staticClass:"flex-1"},[a("a-input-number",{staticStyle:{width:"60%"},attrs:{min:0,precision:2},model:{value:t.price_range_low,callback:function(a){e.$set(t,"price_range_low",a)},expression:"singleSpec.price_range_low"}})],1),a("div",{staticClass:"flex-1"},[a("a-input-number",{staticStyle:{width:"60%"},attrs:{min:0,precision:2},model:{value:t.price_range_height,callback:function(a){e.$set(t,"price_range_height",a)},expression:"singleSpec.price_range_height"}})],1),a("div",{staticClass:"flex-1"},[a("a-input-number",{staticStyle:{width:"60%"},attrs:{min:0,precision:2},model:{value:t.old_price,callback:function(a){e.$set(t,"old_price",a)},expression:"singleSpec.old_price"}})],1),a("div",{staticClass:"flex-1"},[a("a-input-number",{staticStyle:{width:"60%"},attrs:{min:0,precision:0},model:{value:t.count_num,callback:function(a){e.$set(t,"count_num",a)},expression:"singleSpec.count_num"}})],1),a("div",{staticClass:"flex-1"},[a("a-input-number",{staticStyle:{width:"60%"},attrs:{min:0,precision:0},model:{value:t.once_max,callback:function(a){e.$set(t,"once_max",a)},expression:"singleSpec.once_max"}})],1),a("div",{staticClass:"flex-1"},[a("a-input-number",{staticStyle:{width:"60%"},attrs:{min:0,precision:0},model:{value:t.once_max_day,callback:function(a){e.$set(t,"once_max_day",a)},expression:"singleSpec.once_max_day"}})],1),a("div",{staticClass:"flex-1"},[a("a-input-number",{staticStyle:{width:"60%"},attrs:{min:1,precision:0},model:{value:t.once_min,callback:function(a){e.$set(t,"once_min",a)},expression:"singleSpec.once_min"}})],1),a("div",{staticClass:"singleSpecDel pointer",on:{click:function(a){return e.delCurSpec(t,i)}}},[e._v("删除")])])})),0):e._e(),a("div",{staticClass:"flex justify-center align-center",staticStyle:{width:"100%",height:"60px"}},[a("a-button",{staticClass:"cr-primary fs-16",staticStyle:{padding:"0 30px","border-color":"#1890ff"},attrs:{icon:"plus"},on:{click:e.addSpecGroup}},[e._v("新增")])],1)],1),a("a-divider",{staticStyle:{height:"10px","background-color":"#eef0f3"}}),a("a-card",{attrs:{bordered:!1}},[a("span",{staticClass:"fs-16 pb-10 pr-20",staticStyle:{height:"24px"}},[e._v("数量设置")]),a("a-divider",{staticStyle:{margin:"10px 0"}}),a("a-form-model-item",{attrs:{label:"商品总数量",colon:!1,labelCol:{span:3},help:"如果设置商品规格，则以规格数量为准"}},[a("a-radio-group",{attrs:{defaultValue:e.count_num_type},on:{change:e.countNumTypeChange},model:{value:e.count_num_type,callback:function(t){e.count_num_type=t},expression:"count_num_type"}},[a("a-radio",{attrs:{value:0}},[e._v(" 不限 ")]),a("a-radio",{attrs:{value:1}},[a("span",[e._v("有限")]),a("a-input-number",{directives:[{name:"show",rawName:"v-show",value:"1"==e.count_num_type,expression:"count_num_type == '1'"}],staticStyle:{"margin-left":"20px",width:"100px"},attrs:{min:1,precision:0,placeholder:"请输入"},model:{value:e.formData.count_num,callback:function(t){e.$set(e.formData,"count_num",t)},expression:"formData.count_num"}})],1)],1)],1),a("a-form-model-item",{attrs:{label:"ID最多购买数量",colon:!1,labelCol:{span:3}}},[a("a-radio-group",{attrs:{defaultValue:e.once_max_type},on:{change:e.onceMaxTypeChange},model:{value:e.once_max_type,callback:function(t){e.once_max_type=t},expression:"once_max_type"}},[a("a-radio",{attrs:{value:0}},[e._v(" 不限 ")]),a("a-radio",{attrs:{value:1}},[a("span",[e._v("有限")]),a("a-input-number",{directives:[{name:"show",rawName:"v-show",value:"1"==e.once_max_type,expression:"once_max_type == '1'"}],staticStyle:{"margin-left":"20px",width:"100px"},attrs:{min:1,precision:0,placeholder:"请输入"},model:{value:e.formData.once_max,callback:function(t){e.$set(e.formData,"once_max",t)},expression:"formData.once_max"}})],1)],1)],1),a("a-form-model-item",{attrs:{label:"ID每天最多购买数量",colon:!1,labelCol:{span:3},help:"一个ID每天最多购买数量，会受“ID最多购买数量”配置项限制"}},[a("a-radio-group",{attrs:{defaultValue:e.once_max_day_type},on:{change:e.onceMaxDayTypeChange},model:{value:e.once_max_day_type,callback:function(t){e.once_max_day_type=t},expression:"once_max_day_type"}},[a("a-radio",{attrs:{value:0}},[e._v(" 不限 ")]),a("a-radio",{attrs:{value:1}},[a("span",[e._v("有限")]),a("a-input-number",{directives:[{name:"show",rawName:"v-show",value:"1"==e.once_max_day_type,expression:"once_max_day_type == '1'"}],staticStyle:{"margin-left":"20px",width:"100px"},attrs:{min:1,precision:0,placeholder:"请输入"},model:{value:e.formData.once_max_day,callback:function(t){e.$set(e.formData,"once_max_day",t)},expression:"formData.once_max_day"}})],1)],1)],1),a("a-form-model-item",{attrs:{label:"一次最少购买数量",colon:!1,labelCol:{span:3},help:"购买数量低于此设定的不允许参团"}},[a("a-radio-group",{attrs:{defaultValue:e.once_min_type},on:{change:e.onceMinTypeChange},model:{value:e.once_min_type,callback:function(t){e.once_min_type=t},expression:"once_min_type"}},[a("a-radio",{attrs:{value:0}},[e._v(" 不限 ")]),a("a-radio",{attrs:{value:1}},[a("span",[e._v("有限")]),a("a-input-number",{directives:[{name:"show",rawName:"v-show",value:"1"==e.once_min_type,expression:"once_min_type == '1'"}],staticStyle:{"margin-left":"20px",width:"100px"},attrs:{min:1,placeholder:"请输入",precision:0},model:{value:e.formData.once_min,callback:function(t){e.$set(e.formData,"once_min",t)},expression:"formData.once_min"}})],1)],1)],1)],1),a("a-divider",{staticStyle:{height:"10px","background-color":"#eef0f3"}}),a("a-card",{attrs:{bordered:!1}},[a("p",{staticClass:"fs-16"},[e._v("库存扣减方式")]),a("a-divider",{staticStyle:{margin:"10px 0"}}),a("a-form-model-item",{attrs:{label:" ",colon:!1,labelCol:{span:3}}},[a("a-radio-group",{attrs:{defaultValue:e.formData.stock_reduce_method},model:{value:e.formData.stock_reduce_method,callback:function(t){e.$set(e.formData,"stock_reduce_method",t)},expression:"formData.stock_reduce_method"}},[a("a-radio",{staticStyle:{margin:"10px 20px 20px 0"},attrs:{value:0}},[e._v(" 支付成功后减库存 ")]),a("span",{staticStyle:{"font-size":"10px"}},[e._v("可能会出现售出的数量大于商品数量")]),a("br"),a("a-radio",{attrs:{value:1}},[e._v(" 下单成功后减库存 ")]),a("span",{staticStyle:{"font-size":"10px"}},[e._v("可能会出现大量下单但是没有支付时库存已经没有了，但是如果20分钟后还是没有买单的话系统自动回滚库存")])],1)],1)],1),a("a-divider",{staticStyle:{height:"10px","background-color":"#eef0f3"}}),a("a-card",{attrs:{bordered:!1}},[a("span",{staticClass:"fs-16 pb-10 pr-20",staticStyle:{height:"24px"}},[e._v("拼团人数设置")]),a("span",{staticClass:"fs-12"},[e._v("拼团开启后，规格属性设置无效")]),a("a-divider",{staticStyle:{margin:"10px 0"}}),a("a-form-model-item",{attrs:{label:"拼团人数设置",colon:!1,labelCol:{span:3},help:"若设置拼团，人数最少两人"}},[a("a-radio-group",{attrs:{defaultValue:e.pin_type,disabled:!!e.formData.is_start},model:{value:e.pin_type,callback:function(t){e.pin_type=t},expression:"pin_type"}},[a("a-radio",{attrs:{value:0}},[e._v(" 不拼团 ")]),a("a-radio",{attrs:{value:1}},[a("span",[e._v("拼团")]),a("a-input-number",{directives:[{name:"show",rawName:"v-show",value:"1"==e.pin_type,expression:"pin_type == '1'"}],staticStyle:{"margin-left":"20px",width:"80px"},attrs:{min:2,precision:0,placeholder:"请输入",disabled:!!e.formData.is_start},model:{value:e.formData.pin_num,callback:function(t){e.$set(e.formData,"pin_num",t)},expression:"formData.pin_num"}})],1)],1)],1),a("a-form-model-item",{attrs:{label:"团购优惠比例",colon:!1,labelCol:{span:3},help:"团长优惠（百分比0-100） 0为免费，100为原价"}},[a("a-input-number",{staticStyle:{width:"100px"},attrs:{min:0,max:100,placeholder:"请输入",disabled:!!e.formData.is_start},model:{value:e.formData.start_discount,callback:function(t){e.$set(e.formData,"start_discount",t)},expression:"formData.start_discount"}}),a("span",[e._v("%")])],1),a("a-form-model-item",{attrs:{label:"团购每次最多可购买数量",colon:!1,labelCol:{span:3},help:"团购每次最多可购买数量，默认是一份"}},[a("a-input-number",{staticStyle:{width:"100px"},attrs:{min:1,precision:0,placeholder:"请输入",disabled:!!e.formData.is_start},model:{value:e.formData.start_max_num,callback:function(t){e.$set(e.formData,"start_max_num",t)},expression:"formData.start_max_num"}})],1),a("a-form-model-item",{attrs:{label:"成团后退款手续费比例",colon:!1,labelCol:{span:3},help:"手续费将按单价百分比（0-100）收取，设置为100（成团前所有参团人也不可退）则不允许退款"}},[a("a-input-number",{staticStyle:{width:"100px"},attrs:{min:0,max:100,placeholder:"请输入"},model:{value:e.formData.group_refund_fee,callback:function(t){e.$set(e.formData,"group_refund_fee",t)},expression:"formData.group_refund_fee"}})],1),a("a-form-model-item",{attrs:{label:"成团有效期",colon:!1,labelCol:{span:3},help:"有效期内未成团团购不能取消订单，单位：小时"}},[a("a-input-number",{staticStyle:{width:"100px"},attrs:{min:0,placeholder:"请输入"},model:{value:e.formData.pin_effective_time,callback:function(t){e.$set(e.formData,"pin_effective_time",t)},expression:"formData.pin_effective_time"}})],1),a("p",{staticStyle:{"margin-left":"100px"}},[e._v(" 拼团人数设置后，团购按拼团的逻辑走，如果当前团购有组团购在进行则不能设置 ")])],1)],1),a("a-tab-pane",{key:"3",attrs:{tab:"其他设置","force-render":""}},[a("a-divider",{staticStyle:{height:"10px","background-color":"#eef0f3",margin:"0"}}),a("a-card",{attrs:{bordered:!1}},[a("span",{staticClass:"fs-16 pb-10 pr-20",staticStyle:{height:"24px"}},[e._v("补充信息")]),a("a-divider",{staticStyle:{margin:"10px 0"}}),a("a-form-model-item",{attrs:{label:"商品简介",colon:!1,labelCol:{span:3},help:"限100字"}},[a("a-input",{staticStyle:{width:"300px"},attrs:{maxLength:100,placeholder:"请输入商品简介"},model:{value:e.formData.intro,callback:function(t){e.$set(e.formData,"intro",t)},expression:"formData.intro"}})],1),a("a-form-model-item",{attrs:{label:"团购专页分类",colon:!1,labelCol:{span:3}}},[a("a-select",{staticStyle:{width:"200px"},attrs:{placeholder:"一级分类"},on:{change:e.handleGroupCategoryChange},model:{value:e.formData.cat_fid,callback:function(t){e.$set(e.formData,"cat_fid",t)},expression:"formData.cat_fid"}},e._l(e.groupCategoryList,(function(t){return a("a-select-option",{key:t.sort_id},[e._v(" "+e._s(t.sort_name)+" ")])})),1),a("a-select",{staticStyle:{width:"200px","margin-left":"20px"},attrs:{placeholder:"二级分类"},model:{value:e.formData.cat_id,callback:function(t){e.$set(e.formData,"cat_id",t)},expression:"formData.cat_id"}},e._l(e.currentGroupCat.children,(function(t){return a("a-select-option",{key:t.sort_id},[e._v(" "+e._s(t.sort_name)+" ")])})),1)],1),a("a-form-model-item",{attrs:{label:"是否支持自动核销",colon:!1,labelCol:{span:3},"wrapper-col":{span:18},help:"选择支持，则用户付款该团购商品后该订单自动核销，无需店员操作核销动作；自动核销只支持团购商品归属为一个店铺，如果归属为多个店铺，则默认核销第一个店铺。"}},[a("a-radio-group",{attrs:{defaultValue:e.formData.auto_check},model:{value:e.formData.auto_check,callback:function(t){e.$set(e.formData,"auto_check",t)},expression:"formData.auto_check"}},[a("a-radio",{attrs:{value:0}},[e._v(" 不支持 ")]),a("a-radio",{attrs:{value:1}},[e._v(" 支持 ")])],1)],1)],1),a("a-divider",{staticStyle:{height:"10px","background-color":"#eef0f3"}}),a("a-card",{attrs:{bordered:!1}},[a("p",{staticClass:"fs-16"},[e._v("会员优惠")]),a("a-divider",{staticStyle:{margin:"10px 0"}}),a("p",{staticClass:"fs-12"},[e._v(" 说明：必须设置一个会员等级优惠类型和优惠类型对应的数值，我们将结合优惠类型和所填的数量来计算该商品会员等级的优惠幅度！ ")]),e._l(e.levelInfoList,(function(t){return a("div",{key:t.lid},[a("a-form-model-item",{attrs:{label:t.lname,colon:!1,labelCol:{span:3}}},[a("span",{staticClass:"mr-10"},[e._v("优惠类型")]),a("a-select",{staticClass:"mr-20",staticStyle:{width:"150px"},model:{value:t.type,callback:function(a){e.$set(t,"type",a)},expression:"item.type"}},e._l(e.levelList,(function(t){return a("a-select-option",{key:t.type},[e._v(" "+e._s(t.title)+" ")])})),1),a("a-input-number",{staticStyle:{"margin-left":"20px",width:"200px"},attrs:{placeholder:"请输入对应优惠金额",min:0,precision:2},model:{value:t.vv,callback:function(a){e.$set(t,"vv",a)},expression:"item.vv"}})],1)],1)}))],2),a("a-divider",{staticStyle:{height:"10px","background-color":"#eef0f3"}}),a("a-card",{attrs:{bordered:!1}},[a("p",{staticClass:"fs-16"},[e._v("其他设置")]),a("a-divider",{staticStyle:{margin:"10px 0"}}),a("a-card",{attrs:{bordered:!1}},[a("span",{staticStyle:{"margin-left":"60px"}},[a("strong",[e._v("套餐设置")])]),a("a-form-model-item",{attrs:{label:"本团购套餐标签",colon:!1,labelCol:{span:3}}},[a("a-input",{staticStyle:{width:"300px"},attrs:{placeholder:"请输入标签名称"},model:{value:e.formData.tagname,callback:function(t){e.$set(e.formData,"tagname",t)},expression:"formData.tagname"}})],1),a("a-form-model-item",{attrs:{label:"选择加入套餐",colon:!1,labelCol:{span:3}}},[a("a-select",{staticStyle:{width:"300px"},on:{change:e.onPackagesChange},model:{value:e.formData.packageid,callback:function(t){e.$set(e.formData,"packageid",t)},expression:"formData.packageid"}},e._l(e.packagesList,(function(t){return a("a-select-option",{key:t.id,attrs:{value:t.id}},[e._v(" "+e._s(t.title)+" ")])})),1)],1)],1),a("a-card",{attrs:{bordered:!1}},[a("span",{staticStyle:{"margin-left":"60px"}},[a("strong",[e._v("运费模板")])]),a("a-form-model-item",{attrs:{label:"选择运费模板",colon:!1,labelCol:{span:3}}},[a("a-select",{staticStyle:{width:"300px"},on:{change:e.onExpTemChange},model:{value:e.formData.express_template_id,callback:function(t){e.$set(e.formData,"express_template_id",t)},expression:"formData.express_template_id"}},e._l(e.expressList,(function(t){return a("a-select-option",{key:t.id,attrs:{value:t.id}},[e._v(" "+e._s(t.name)+" ")])})),1)],1),a("a-form-model-item",{attrs:{label:"其他区域运费",colon:!1,labelCol:{span:3}}},[a("a-input-number",{staticStyle:{width:"300px"},attrs:{placeholder:"请输入运费"},model:{value:e.formData.express_fee,callback:function(t){e.$set(e.formData,"express_fee",t)},expression:"formData.express_fee"}})],1)],1),a("a-card",{attrs:{bordered:!1}},[a("span",{staticStyle:{"margin-left":"60px"}},[a("strong",[e._v("到店自提")])]),a("a-form-model-item",{attrs:{label:"到店自提",colon:!1,labelCol:{span:3}}},[a("a-radio-group",{on:{change:function(t){return e.onPickInStoreChange(e.formData.pick_in_store)}},model:{value:e.formData.pick_in_store,callback:function(t){e.$set(e.formData,"pick_in_store",t)},expression:"formData.pick_in_store"}},[a("a-radio",{attrs:{value:1}},[e._v(" 开启 ")]),a("a-radio",{staticStyle:{"margin-right":"10px"},attrs:{value:0}},[e._v(" 关闭 ")]),a("span",{staticStyle:{"font-size":"10px"}},[e._v("没有设置其他到店自提地点，默认自提点为团购的店铺")])],1)],1)],1),a("a-card",{attrs:{bordered:!1}},[a("span",{staticStyle:{"margin-left":"60px"}},[a("strong",[e._v("绑定插件")])]),a("a-form-model-item",{staticStyle:{"margin-bottom":"10px"},attrs:{label:"绑定插件",colon:!1,labelCol:{span:3}}},[a("a-select",{staticStyle:{width:"300px"},on:{change:e.onTradeTypeChange},model:{value:e.formData.trade_type,callback:function(t){e.$set(e.formData,"trade_type",t)},expression:"formData.trade_type"}},e._l(e.tradeTypeList,(function(t){return a("a-select-option",{key:t.value,attrs:{value:t.value}},[e._v(" "+e._s(t.label)+" ")])})),1)],1),"appoint"==e.formData.trade_type?a("a-form-model-item",{attrs:{label:"选择预约",labelCol:{span:3}}},[a("a-select",{staticStyle:{width:"300px"},on:{change:e.onAppointPlugChange},model:{value:e.formData.appoint_id,callback:function(t){e.$set(e.formData,"appoint_id",t)},expression:"formData.appoint_id"}},e._l(e.appointList,(function(t){return a("a-select-option",{key:t.appoint_id,attrs:{value:t.appoint_id}},[e._v(" "+e._s(t.appoint_name)+" ")])})),1)],1):e._e(),"hotel"==e.formData.trade_type?a("a-form-model-item",{attrs:{label:"绑定分类",labelCol:{span:3}}},[a("a-checkbox-group",{on:{change:e.onHotelPlugChange},model:{value:e.formData.trade_info,callback:function(t){e.$set(e.formData,"trade_info",t)},expression:"formData.trade_info"}},e._l(e.hotelList,(function(t){return a("a-checkbox",{key:t.cat_id,attrs:{value:t.cat_id}},[e._v(" "+e._s(t.cat_name)+" ")])})),1)],1):e._e()],1),a("a-card",{attrs:{bordered:!1}},[a("span",{staticStyle:{"margin-left":"60px"}},[a("strong",[e._v("状态设置")])]),a("a-form-model-item",{attrs:{label:"团购状态",colon:!1,labelCol:{span:3}}},[a("a-radio-group",{attrs:{defaultValue:1},on:{change:function(t){return e.onStatusChange(e.formData.status)}},model:{value:e.formData.status,callback:function(t){e.$set(e.formData,"status",t)},expression:"formData.status"}},[a("a-radio",{attrs:{value:"1"}},[e._v(" 开启 ")]),a("a-radio",{staticStyle:{"margin-right":"10px"},attrs:{value:"0"}},[e._v(" 关闭 ")]),a("span",{staticStyle:{"font-size":"10px"}},[e._v("为了方便用户能查找到以前的订单，团购无法删除！")])],1)],1)],1)],1)],1)],1)],1),a("div",{staticClass:"page-header"},[a("a-button",{staticClass:"ml-20 mt-20 mb-20",attrs:{type:"primary"},on:{click:function(t){return e.submitForm()}}},[e._v(" 保存 ")])],1)],1)},o=[],r=a("2909"),s=a("1da1"),n=(a("96cf"),a("d3b7"),a("159b"),a("a434"),a("b0c0"),a("99af"),a("a9e3"),a("a15b"),a("d81d"),a("ac1f"),a("1276"),a("25f0"),a("498a"),a("4de4"),a("caad"),a("2532"),a("7b3f")),l=a("4b77"),c=a("6ec1"),m=a("2b69"),p=a("4928"),d=a("c1df"),u=a.n(d);function f(e){return new Promise((function(t,a){var i=new FileReader;i.readAsDataURL(e),i.onload=function(){return t(i.result)},i.onerror=function(e){return a(e)}}))}var h={components:{RichText:c["a"],ChooseStore:m["default"],AddGoodsTags:p["default"]},data:function(){return{activeKey:"1",labelCol:{span:4},wrapperCol:{span:14},groupGoodsInfo:"",selectStoreVisible:!1,formData:{group_id:"",tuan_type:2,open_express:0,s_name:"",label_group:"",label_ids:[],pass_num:0,goods_label_group:"",old_price:"",price:"",price_range_low:0,price_range_height:0,marketing_ratio:0,ratio_list:[],is_invoice:1,begin_time:"",end_time:"",effective_type:0,deadline_time:"",cancel_type:0,cancel_hours:"",is_general:0,appoint_time:0,appoint_time_type:0,store_ids:[],content:"",spec_list:[],count_num:"",once_max:"",once_max_day:"",once_min:"",stock_reduce_method:0,pin_num:2,start_discount:0,start_max_num:"1",group_refund_fee:"0",pin_effective_time:"0",name:"",intro:"",auto_check:0,leveloff_list:[],tagname:"",packageid:"",express_template_id:"",express_fee:"",pick_in_store:1,trade_type:"",trade_info:[],appoint_id:"",status:"1"},tempData:{count_num:0,once_max:0,once_max_day:0,once_min:0},appoint_type:0,dateFormat:"YYYY-MM-DD HH:mm:ss",currentIndex:0,previewVisible:!1,previewImage:"",imgUploadList:[],uploadImg:"/v20/public/index.php"+n["a"].uploadImg+"?upload_dir=/group",mailTypeList:[{value:0,label:"不支持邮寄"},{value:1,label:"支持邮寄"}],isInvoiceList:[{value:1,label:"提供发票"},{value:0,label:"不提供发票"}],generalList:[{value:0,label:"周末、法定节假日通用"},{value:1,label:"周末不能使用"},{value:2,label:"法定节假日不能使用"},{value:3,label:"周末、法定节假日不能通用"}],appointTimeTypelist:[{value:0,label:"天"},{value:1,label:"小时"}],specTabList:[{title:"规格名称",tip:"仅限6位长度"},{title:"价格",tip:"如果填写规格则必填。最多支持2位小数！"},{title:"调价区间最低价",tip:"选填。"},{title:"调价区间最高价",tip:"选填。"},{title:"原价",tip:"选填。最多支持2位小数"},{title:"库存",tip:"0表示不限制，否则产品会出现“已卖光”状态！"},{title:"同一ID最多购买数量",tip:"同一个ID最多购买数量，0表示不限制！请填写大于等于零的值！"},{title:"同一ID每天最多购买数量",tip:"同一ID每天最多购买数量，0表示不限制！请填写大于等于零的值！"},{title:"同一ID每次最少购买数量",tip:"同一ID每次最少购买数量，购买数量低于此设定的不允许参团！请填写大于等于1的值！"}],count_num_type:0,once_max_type:0,once_max_day_type:0,once_min_type:0,pin_type:0,storeStrName:"",groupCategoryList:[],currentGroupCat:{children:[]},levelInfoList:[],levelList:[{type:0,title:"无优惠"},{type:1,title:"百分比（%）"},{type:2,title:"立减"}],packagesList:[{id:0,title:"不加入任何套餐"}],expressList:[{id:0,name:"不选择运费模板"}],tradeTypeList:[{value:"",label:"不绑定插件"},{value:"appoint",label:"预约模块"},{value:"hotel",label:"酒店模块"}],appointList:[{appoint_name:"请选择",appoint_id:0}],hotelList:[],modalTable:!1,tableLineNum:"",checkLabelReslut:!0,canSave:!0,marketingMemberList:[]}},watch:{$route:function(e){"/merchant/merchant.group/goodsEdit"==e.path&&(e.query.group_id?this.getGoodsNormalDetail():Object.assign(this.$data,this.$options.data()))}},mounted:function(){this.activeKey="1",this.getGroupEditInfo(),this.onTradeTypeChange(""),this.$route.query.group_id?this.getGoodsNormalDetail():Object.assign(this.$data,this.$options.data())},activated:function(){this.activeKey="1",this.getGroupEditInfo(),this.onTradeTypeChange(""),this.$route.query.group_id?this.getGoodsNormalDetail():Object.assign(this.$data,this.$options.data())},methods:{moment:u.a,onTabChange:function(e){this.activeKey=e},disabledStartDate:function(e){var t=this.formData.end_time;return e&&t?e.valueOf()>t.valueOf():e&&e<u()().subtract(1,"days")},disabledEndDate:function(e){var t=this.formData.begin_time;return t?t.valueOf()>=e.valueOf():e&&e<u()().subtract(1,"days")},date_moment:function(e,t){return e?u()(e,t):null},handleImgCancel:function(){this.previewVisible=!1},handlePreview:function(e){var t=this;return Object(s["a"])(regeneratorRuntime.mark((function a(){return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:if(e.url||e.preview){a.next=4;break}return a.next=3,f(e.originFileObj);case 3:e.preview=a.sent;case 4:t.previewImage=e.url||e.preview,t.previewVisible=!0;case 6:case"end":return a.stop()}}),a)})))()},handleImgChange:function(e){var t=this,a=Object(r["a"])(e.fileList),i=[];this.imgUploadList=a,a.forEach((function(a,o){if("done"===a.status)if(a.response&&"1000"==a.response.status||a.url){var r="";a.response&&a.response.data?r=a.response.data.full_url:a.url&&(r=a.url),r&&i.push(r),t.$set(t.formData,"image",i),t.formData=JSON.parse(JSON.stringify(t.formData))}else t.imgUploadList.splice(o,1),t.$message.error(a.response.msg||"上传失败！");else"error"===e.file.status&&(t.imgUploadList.splice(o,1),t.$message.error("".concat(e.file.name," 上传失败！")))}))},beginTimeChange:function(e,t){this.formData.begin_time=t},endTimeChange:function(e,t){var a=u()(this.formData.begin_time).valueOf(),i=u()(t).valueOf();i<a?this.$message.error("活动结束时间必须大于活动开始时间！"):this.formData.end_time=t},deadlineTimeChange:function(e,t){var a=u()(this.formData.end_time).valueOf(),i=u()(t).valueOf();i<a&&0==this.formData.effective_type?this.$message.error("团购券有效期必须大于活动结束时间！"):this.formData.deadline_time=t},appointTypeChange:function(e){0==e.target.value&&(this.formData.appoint_time=0)},addSpecGroup:function(){this.currentIndex=this.formData.spec_list.length;var e=this.formData.spec_list||[];e.push({specifications_id:"",specifications_name:"",price:"",price_range_low:0,price_range_height:0,old_price:"",count_num:"",sale_count:"",once_max:"",once_max_day:"",once_min:""}),this.$set(this.formData,"spec_list",e)},delCurSpec:function(e,t){var a=this.formData.spec_list||[];a.length&&a.splice(t,1),this.$set(this.formData,"spec_list",a)},getLabelId:function(e){var t=e.labelGroup,a=e.labelIds;this.formData.label_group=t,this.formData.label_ids=a},getGroupEditInfo:function(){var e=this;this.request(l["a"].getGroupEditInfo).then((function(t){t.packages_list.length&&(e.packagesList=e.packagesList.concat(t.packages_list),e.$route.query.group_id||e.$set(e.formData,"packageid",e.packagesList[0].id)),t.group_category_list.length&&(e.groupCategoryList=t.group_category_list,e.$set(e.formData,"cat_fid",e.groupCategoryList[0].sort_id),e.handleGroupCategoryChange(e.groupCategoryList[0].sort_id)),t.express_list&&t.express_list.length&&(e.expressList=e.expressList.concat(t.express_list),e.$route.query.group_id||e.$set(e.formData,"express_template_id",e.expressList[0].id)),t.appoint_list&&t.appoint_list.length&&(e.appointList=e.appointList.concat(t.appoint_list)),t.hotel_list&&t.hotel_list.length&&(e.hotelList=t.hotel_list),t.user_level.length&&(e.levelInfoList=t.user_level)}))},handleGroupCategoryChange:function(e){for(var t in this.groupCategoryList){var a=this.groupCategoryList[t];if(a.sort_id==e)return this.$set(this,"currentGroupCat",a),void(a.children&&a.children.length?this.$set(this.formData,"cat_id",a.children[0].sort_id):this.$set(this.formData,"cat_id",void 0))}},onPackagesChange:function(e){this.formData.packageid=e},onExpTemChange:function(e){this.formData.express_template_id=e},onPickInStoreChange:function(e){this.formData.pick_in_store=e},onTradeTypeChange:function(e){this.formData.trade_type=e},onAppointPlugChange:function(e){this.formData.appoint_id=e},onHotelPlugChange:function(e){this.formData.trade_info=e},onStatusChange:function(e){this.formData.status=e},selectStore:function(){this.selectStoreVisible=!this.selectStoreVisible},insertTab:function(){this.modalTable=!0},onTableOk:function(){for(var e='<tr class="firstRow">\n                    <td width="102" valign="top" style="word-break: break-all;">套餐内容<br /></td>\n                    <td width="102" valign="top" style="word-break: break-all;">单价<br /></td>\n                    <td width="102" valign="top" style="word-break: break-all;">数量/规格</td>\n                    <td width="102" valign="top" style="word-break: break-all;">小计</td>\n                  </tr>',t='<tr>\n                    <td width="102" valign="top" style="word-break: break-all;">内容1</td>\n                    <td width="102" valign="top" style="word-break: break-all;">￥</td>\n                    <td width="102" valign="top" style="word-break: break-all;">1份</td>\n                    <td width="102" valign="top" style="word-break: break-all;">￥</td>\n                  </tr>',a='<td width="102" valign="top" style="word-break: break-all;" rowspan="1" colspan="4">\n                      <p style="text-align: right;">价值：￥&nbsp; &nbsp;&nbsp; &nbsp;团购价：￥</p>\n                     </td>',i=0;i<this.tableLineNum;i++)e+=t;var o=e+a;this.formData.content&&(o=this.formData.content+e+a),this.$set(this.formData,"content",o),this.modalTable=!1},onTableCancel:function(){this.modalTable=!1},getGoodsNormalDetail:function(){var e=this,t={group_id:this.$route.query.group_id};1*this.$route.query.group_id>0&&this.request(l["a"].getGoodsNormalDetail,t).then((function(t){if(e.formData.tuan_type=t.tuan_type,e.formData.pass_num=t.pass_num,e.formData.open_express=t.open_express,e.formData.s_name=t.s_name,e.formData.old_price=Number(t.old_price),e.formData.price=Number(t.price),e.formData.price_range_low=Number(t.price_range_low)||0,e.formData.price_range_height=Number(t.price_range_height)||0,e.formData.marketing_ratio=t.marketing_ratio||0,e.formData.ratio_list=t.ratio_list||[],e.formData.is_invoice=t.is_invoice,e.formData.is_start=t.is_start,e.formData.image=t.image||[],t.image){for(var a=[],i=0;i<t.image.length;i++){var o={uid:i,name:"image_"+i,status:"done",url:t.image[i]};a.push(o)}e.imgUploadList=a}if(e.formData.begin_time=t.begin_time,e.formData.end_time=t.end_time,e.formData.effective_type=t.effective_type,e.formData.deadline_time=t.deadline_time,e.formData.cancel_type=t.cancel_type,1==t.cancel_type&&(e.formData.cancel_hours=t.cancel_hours),0==t.appoint_time?(e.appoint_type=0,e.formData.appoint_time=0):(e.appoint_type=1,e.formData.appoint_time_type=t.appoint_time_type,e.formData.appoint_time=t.appoint_time),t.store.ids){var r=t.store.ids?t.store.ids:[],s=t.store.detail?t.store.detail:[],n=[];r.forEach((function(t){s.forEach((function(a){t.store_id==a.store_id&&(n.push(a.name),t.name=a.name,e.storeStrName=n.join(","))}))})),e.$set(e.formData,"store_ids",r),1==r.length&&e.getMarketingMemberList()}e.formData.content=decodeURIComponent(t.content),e.formData.spec_list=t.spec_list,0==t.count_num?e.count_num_type=0:e.count_num_type=1,e.tempData.count_num=t.count_num,e.formData.count_num=Number(t.count_num)||0,0==t.once_max?e.once_max_type=0:e.once_max_type=1,e.tempData.once_max=t.once_max,e.formData.once_max=Number(t.once_max)||0,0==t.once_max_day?e.once_max_day_type=0:e.once_max_day_type=1,e.tempData.once_max_day=t.once_max_day,e.formData.once_max_day=Number(t.once_max_day)||0,0==t.once_min?e.once_min_type=0:e.once_min_type=1,e.tempData.once_min=t.once_min,e.formData.once_min=Number(t.once_min)||0,e.formData.stock_reduce_method=t.stock_reduce_method,0==t.pin_num?e.pin_type=0:(e.pin_type=1,e.formData.pin_num=Number(t.pin_num)||2),e.formData.start_discount=t.start_discount,e.formData.start_max_num=t.start_max_num,e.formData.group_refund_fee=t.group_refund_fee,e.formData.pin_effective_time=t.pin_effective_time,e.formData.name=t.name,e.formData.intro=t.intro,t.cat_fid&&(e.formData.cat_fid=t.cat_fid,t.cat_id&&(e.formData.cat_id=t.cat_id)),e.formData.auto_check=Number(t.auto_check),e.levelInfoList=t.leveloff_list||[],e.formData.tagname=t.tagname,e.formData.packageid=t.packageid,e.formData.express_template_id=t.express_template_id,e.formData.express_fee=t.express_fee,e.formData.pick_in_store=Number(t.pick_in_store),e.formData.trade_type=0==t.trade_type?"":t.trade_type,e.formData.appoint_id=t.appoint_id,e.formData.trade_info=t.trade_info?t.trade_info.split(",").map((function(e){return Number(e)})):[],e.formData.label_group=t.label_group||"",e.formData.label_ids=t.label_ids&&t.label_ids.length?t.label_ids.map((function(e){return Number(e)})):[],e.formData.status=t.status.toString(),e.formData=JSON.parse(JSON.stringify(e.formData))}))},onStoreSelect:function(e){this.selectStoreVisible=!1;var t=e.storeName,a=e.storeIds;this.storeStrName=t,this.formData.store_ids=a,this.$set(this.formData,"ratio_list",[]),this.getMarketingMemberList()},submitForm:function(){var e=this;if(this.canSave){if(2==this.formData.tuan_type&&this.formData.pass_num&&this.$set(this.formData,"pass_num",0),!this.formData.s_name.trim())return this.$message.error("请输入商品名称！"),this.activeKey="1",!1;if(_(this.formData.old_price))return this.$message.error("请输入商品原价！"),this.activeKey="1",!1;if(_(this.formData.price))return this.$message.error("请输入商品团购价！"),this.activeKey="1",!1;if(!_(this.formData.old_price)&&!_(this.formData.price)&&Number(this.formData.price)>Number(this.formData.old_price))return this.$message.error("商品团购价不能大于商品原价！"),this.activeKey="1",!1;if(!this.formData.image||this.formData.image&&!this.formData.image.length)return this.$message.error("请上传图片！"),this.activeKey="1",!1;if(_(this.formData.begin_time))return this.$message.error("请选择团购开始时间！"),this.activeKey="1",!1;if(_(this.formData.end_time))return this.$message.error("请选择团购开始时间！"),this.activeKey="1",!1;if(this.validateDeadlineTime()){if(1==this.formData.cancel_type&&_(this.formData.cancel_hours))return this.$message.error("请输入可提前取消时长！"),this.activeKey="1",!1;if(1==this.appoint_type&&_(this.formData.appoint_time))return this.$message.error("请输入可提前预约时长！"),this.activeKey="1",!1;if(!this.formData.store_ids.length)return this.$message.error("请选择适用店铺！"),this.activeKey="1",!1;if(this.formData.store_ids&&1==this.formData.store_ids.length){if(0!=Number(this.formData.price_range_low)||0!=Number(this.formData.price_range_height)){if(Number(this.formData.price_range_height)<Number(this.formData.price_range_low))return this.$message.error("调价区间最高价不能小于调价区间最低价"),this.activeKey="1",!1;if(Number(this.formData.price)<Number(this.formData.price_range_low))return this.$message.error("价格不能小于调价区间最低价"),this.activeKey="1",!1;if(Number(this.formData.price)>Number(this.formData.price_range_height))return this.$message.error("价格不能大于调价区间最高价"),this.activeKey="1",!1}if(Number(this.formData.marketing_ratio)<0||Number(this.formData.marketing_ratio)>100)return this.$message.error("统一分销比例必须在0-100之间"),this.activeKey="1",!1;var t=this.formData.ratio_list||[];if(t.length){t=t.filter((function(e){return e.id}));var a=t.every((function(e){return Number(e.ratio)>=0&&Number(e.ratio)<=100}));if(!a)return this.$message.error("分销员分销比例必须在0-100之间"),this.activeKey="1",!1}}else this.$set(this.formData,"price_range_low",0),this.$set(this.formData,"price_range_height",0),this.$set(this.formData,"marketing_ratio",0),this.$set(this.formData,"ratio_list",[]);if(!this.checkLabelReslut)return this.activeKey="1",!1;if(this.validateSpecList())return this.formData.leveloff_list=this.levelInfoList,_(this.formData.count_num)&&this.$set(this.formData,"count_num",0),0==this.pin_type&&this.$set(this.formData,"pin_num",0),_(this.formData.name)?(this.$message.error("请输入商品标题！"),this.activeKey="3",!1):!_(this.formData.name)&&this.formData.name.length>100?(this.$message.error("商品标题限100字！"),this.activeKey="3",!1):void this.$refs.ruleForm.validate((function(t){if(!t)return!1;e.canSave=!1;var a={};for(var i in e.formData)a[i]="content"==i?e.formData.content:"ratio_list"==i?e.formData.ratio_list.filter((function(e){return e.id})):e.formData[i];a["group_id"]=e.$route.query.group_id||"",a["trade_info"]=e.formData.trade_info&&e.formData.trade_info.length?e.formData.trade_info.join(","):"",e.request(l["a"].saveNomalGoods,a).then((function(t){e.activeKey="1",e.$route.query.group_id||Object.assign(e.$data,e.$options.data()),e.$message.success("提交成功！",2,(function(){e.$router.push({path:"/merchant/merchant.group/groupList"}),e.$message.destroy(),e.canSave=!0}))})).catch((function(t){e.canSave=!0}))}))}}},validateDeadlineTime:function(){var e=!0;if(""===this.formData.deadline_time)this.$message.error("请选择团购券有效期"),this.activeKey="1",e=!1;else if(0==this.formData.effective_type&&this.formData.end_time){var t=u()(this.formData.end_time).valueOf(),a=u()(this.formData.deadline_time).valueOf();a<t&&(this.$message.error("团购券有效期必须大于活动结束时间"),e=!1,this.activeKey="1")}return e},validateSpecList:function(){var e=!0,t=this.formData.spec_list||[];if(t.length)for(var a=0;a<t.length;a++){var i=t[a].specifications_name.trim()||"",o=Number(t[a].price)||0;if(!i){e=!1,this.$message.error("请输入商品规格名称");break}if(!o){e=!1,this.activeKey="2",this.$message.error("请输入商品规格价格");break}if(Number(t[a].price_range_low)>0){if(Number(t[a].price_range_low)>Number(t[a].price)){e=!1,this.$message.error("调价区间最高价不能小于调价区间最低价");break}if(Number(t[a].price_range_low)>Number(t[a].price)){e=!1,this.$message.error("价格不能小于调价区间最低价");break}if(Number(t[a].price_range_height)<Number(t[a].price)){e=!1,this.$message.error("价格不能大于调价区间最高价");break}}}return e},getMarketingMemberList:function(){var e=this;this.request(l["a"].getRatioList,{store_id:this.formData.store_ids[0].store_id}).then((function(t){t.ratio_list&&Array.isArray(t.ratio_list)&&t.ratio_list.length?e.marketingMemberList=t.ratio_list:e.marketingMemberList=[]}))},addRatioList:function(){var e=this.formData.ratio_list||[];e.push({id:void 0,ratio:Number(this.formData.marketing_ratio)}),this.$set(this.formData,"ratio_list",e)},getMarketingMemberOptions:function(e){var t=this.formData.ratio_list.map((function(e){return e.id}));return t=t.filter((function(t){return t!=e})),this.marketingMemberList.filter((function(e){return!t.includes(e.id)}))},countNumTypeChange:function(e){0==e.target.value?this.formData.count_num=0:this.formData.count_num=0==this.tempData.count_num?1:this.tempData.count_num},onceMaxTypeChange:function(e){0==e.target.value?this.formData.once_max=0:this.formData.once_max=0==this.tempData.once_max?1:this.tempData.once_max},onceMaxDayTypeChange:function(e){0==e.target.value?this.formData.once_max_day=0:this.formData.once_max_day=0==this.tempData.once_max_day?1:this.tempData.once_max_day},onceMinTypeChange:function(e){0==e.target.value?this.formData.once_min=0:this.formData.once_min=0==this.tempData.once_min?1:this.tempData.once_min}}};function _(e){return"undefined"===typeof e||null===e||""===e}var g=h,b=(a("1ce9"),a("2877")),v=Object(b["a"])(g,i,o,!1,null,"2aac32ac",null);t["default"]=v.exports}}]);