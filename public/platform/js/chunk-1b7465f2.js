(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-1b7465f2"],{"0772":function(t,e,a){"use strict";a.r(e);var i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("a-modal",{attrs:{title:t.title,width:300,visible:t.visibleUpload,maskClosable:!1,confirmLoading:t.confirmLoading},on:{cancel:t.handleCancel}},[a("a-spin",{attrs:{spinning:t.confirmLoading,height:800}},[a("div",[a("span",[t._v("示例表格")]),a("a",{staticStyle:{"margin-left":"20px"},attrs:{href:"/static/file/village/meter/demo.xlsx",target:"_blank"}},[t._v("点击下载")])]),a("div",{staticStyle:{"border-bottom":"1px solid #dad8d8","border-top":"1px solid #dad8d8","margin-top":"20px"}},[a("span",[t._v("导入Excel")]),a("a-upload",{attrs:{name:"file","file-list":t.avatarFileList,action:t.upload,headers:t.headers},on:{change:t.handleChangeUpload}},[a("a-button",{staticStyle:{margin:"20px   20px  10px"},attrs:{type:"primary"}},[a("a-icon",{attrs:{type:"upload"}}),t._v(" 导入 ")],1)],1)],1),t.show?a("div",{staticStyle:{"margin-top":"20px"}},[a("span",[t._v("导入失败")]),a("a",{staticStyle:{"margin-left":"20px"},attrs:{href:t.url,target:"_blank"}},[t._v("点击下载带入失败数据表格")])]):t._e()])],1)},n=[],s=(a("b0c0"),a("1a83")),c={data:function(){return{upload:"/v20/public/index.php"+s["a"].uploadFile+"?upload_dir=/house/excel/meterUpload",avatarFileList:[],headers:{authorization:"authorization-text"},visibleUpload:!1,confirmLoading:!1,title:"导入",url:"",show:!1}},methods:{add:function(){this.title="导入",this.visibleUpload=!0,this.url=window.location.host+"/v20/runtime/demo.xlsx",this.avatarFileList=[]},handleChangeUpload:function(t){var e=this;"uploading"!==t.file.status&&console.log(t.file,t.fileList),"done"===t.file.status?(console.log("done",t.file),""==t.file.response.data?this.$message.success("".concat(t.file.name," 上传成功.")):window.location.href=t.file.response.data.url,setTimeout((function(){e.visibleUpload=!1,e.confirmLoading=!1,e.$emit("ok")}),1500)):"error"===t.file.status&&this.$message.error("".concat(t.file.name," 上传失败.")),this.avatarFileList=t.fileList,console.log("avatarFileList",t.fileList)},handleCancel:function(){this.visibleUpload=!1}}},l=c,r=(a("3ed6"),a("0c7c")),o=Object(r["a"])(l,i,n,!1,null,"452876d5",null);e["default"]=o.exports},"1a27":function(t,e,a){},"27dc":function(t,e,a){"use strict";a("7398")},3546:function(t,e,a){"use strict";a("96c8")},"3ed6":function(t,e,a){"use strict";a("1a27")},7398:function(t,e,a){},9510:function(t,e,a){"use strict";a.r(e);var i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"message-suggestions-list-box"},[a("div",{staticClass:"search-box",staticStyle:{"border-style":"solid","border-width":"1px","border-color":"#e8e6e6"}},[a("a-row",{attrs:{gutter:48}},[a("a-col",{staticStyle:{"padding-left":"24px","padding-right":"1px",width:"140px"},attrs:{md:8,sm:24}},[a("a-select",{staticStyle:{width:"105px"},attrs:{"default-value":"0",placeholder:"请选择省"},on:{change:t.handleChange},model:{value:t.search.province,callback:function(e){t.$set(t.search,"province",e)},expression:"search.province"}},[a("a-select-option",{attrs:{value:"0"}},[t._v(" 全部省 ")]),t._l(t.province_list,(function(e,i){return a("a-select-option",{key:i,attrs:{value:e.area_id}},[t._v(" "+t._s(e.area_name)+" ")])}))],2)],1),a("a-col",{staticStyle:{"padding-left":"1px","padding-right":"1px",width:"128px"},attrs:{md:8,sm:24}},[a("a-select",{staticStyle:{width:"115px"},attrs:{"default-value":"0",placeholder:"请选择市"},on:{change:t.handleChange1},model:{value:t.search.city,callback:function(e){t.$set(t.search,"city",e)},expression:"search.city"}},[a("a-select-option",{attrs:{value:"0"}},[t._v(" 全部市 ")]),t._l(t.city_list,(function(e,i){return a("a-select-option",{key:i,attrs:{value:e.id}},[t._v(" "+t._s(e.name)+" ")])}))],2)],1),a("a-col",{staticStyle:{"padding-left":"1px","padding-right":"1px",width:"128px"},attrs:{md:8,sm:24}},[a("a-select",{staticStyle:{width:"115px"},attrs:{"default-value":"0",placeholder:"请选择区"},on:{change:t.handleChange2},model:{value:t.search.area,callback:function(e){t.$set(t.search,"area",e)},expression:"search.area"}},[a("a-select-option",{attrs:{value:"0"}},[t._v(" 全部区 ")]),t._l(t.area_list,(function(e,i){return a("a-select-option",{key:i,attrs:{value:e.id}},[t._v(" "+t._s(e.name)+" ")])}))],2)],1),a("a-col",{staticStyle:{"padding-left":"1px","padding-right":"1px",width:"128px"},attrs:{md:8,sm:24}},[a("a-select",{staticStyle:{width:"117px"},attrs:{"default-value":"0",placeholder:"请选择街道"},on:{change:t.handleChange3},model:{value:t.search.street,callback:function(e){t.$set(t.search,"street",e)},expression:"search.street"}},[a("a-select-option",{attrs:{value:"0"}},[t._v(" 全部街道 ")]),t._l(t.street_list,(function(e,i){return a("a-select-option",{key:i,attrs:{value:e.id}},[t._v(" "+t._s(e.name)+" ")])}))],2)],1),a("a-col",{staticStyle:{"padding-left":"1px","padding-right":"1px",width:"124px"},attrs:{md:8,sm:24}},[a("a-select",{staticStyle:{width:"117px"},attrs:{"default-value":"0",placeholder:"请选择社区"},on:{change:t.handleChange4},model:{value:t.search.community,callback:function(e){t.$set(t.search,"community",e)},expression:"search.community"}},[a("a-select-option",{attrs:{value:"0"}},[t._v(" 全部社区 ")]),t._l(t.community_list,(function(e,i){return a("a-select-option",{key:i,attrs:{value:e.id}},[t._v(" "+t._s(e.name)+" ")])}))],2)],1),a("a-col",{staticStyle:{"padding-left":"5px","padding-right":"1px",width:"130px"},attrs:{md:8,sm:24}},[a("a-select",{staticStyle:{width:"116px"},attrs:{"default-value":"0",placeholder:"请选择小区"},on:{change:t.handleChange5},model:{value:t.search.village,callback:function(e){t.$set(t.search,"village",e)},expression:"search.village"}},[a("a-select-option",{attrs:{value:"0"}},[t._v(" 全部小区 ")]),t._l(t.village_list,(function(e,i){return a("a-select-option",{key:i,attrs:{value:e.id}},[t._v(" "+t._s(e.name)+" ")])}))],2)],1),a("a-col",{staticStyle:{"padding-left":"1px","padding-right":"1px",width:"128px"},attrs:{md:8,sm:24}},[a("a-select",{staticStyle:{width:"117px"},attrs:{"default-value":"0",placeholder:"请选择楼栋"},on:{change:t.handleChange6},model:{value:t.search.single,callback:function(e){t.$set(t.search,"single",e)},expression:"search.single"}},[a("a-select-option",{attrs:{value:"0"}},[t._v(" 全部楼栋 ")]),t._l(t.single_list,(function(e,i){return a("a-select-option",{key:i,attrs:{value:e.id}},[t._v(" "+t._s(e.name)+" ")])}))],2)],1),a("a-col",{staticStyle:{"padding-left":"1px","padding-right":"1px",width:"128px"},attrs:{md:8,sm:24}},[a("a-select",{staticStyle:{width:"117px"},attrs:{"default-value":"0",placeholder:"请选择单元"},on:{change:t.handleChange7},model:{value:t.search.floor,callback:function(e){t.$set(t.search,"floor",e)},expression:"search.floor"}},[a("a-select-option",{attrs:{value:"0"}},[t._v(" 全部单元 ")]),t._l(t.floor_list,(function(e,i){return a("a-select-option",{key:i,attrs:{value:e.id}},[t._v(" "+t._s(e.name)+" ")])}))],2)],1),a("a-col",{staticStyle:{"padding-left":"1px","padding-right":"1px",width:"128px"},attrs:{md:8,sm:24}},[a("a-select",{staticStyle:{width:"117px"},attrs:{"default-value":"0",placeholder:"请选择楼层"},on:{change:t.handleChange8},model:{value:t.search.layer,callback:function(e){t.$set(t.search,"layer",e)},expression:"search.layer"}},[a("a-select-option",{attrs:{value:"0"}},[t._v(" 全部楼层 ")]),t._l(t.layer_list,(function(e,i){return a("a-select-option",{key:i,attrs:{value:e.id}},[t._v(" "+t._s(e.name)+" ")])}))],2)],1),a("a-col",{staticStyle:{"padding-left":"1px","padding-right":"1px",width:"260px"},attrs:{md:8,sm:24}},[a("a-select",{staticStyle:{width:"117px"},attrs:{"default-value":"0",placeholder:"请选择房间"},model:{value:t.search.vacancy,callback:function(e){t.$set(t.search,"vacancy",e)},expression:"search.vacancy"}},[a("a-select-option",{attrs:{value:"0"}},[t._v(" 全部房间 ")]),t._l(t.vacancy_list,(function(e,i){return a("a-select-option",{key:i,attrs:{value:e.id}},[t._v(" "+t._s(e.name)+" ")])}))],2)],1),a("a-col",{staticStyle:{"padding-left":"1px","padding-right":"1px",width:"260px"},attrs:{md:8,sm:24}},[a("a-input-group",{attrs:{compact:""}},[a("label",{staticStyle:{"margin-top":"15px","margin-left":"22px"}},[t._v("电表名称：")]),a("a-input",{staticStyle:{width:"60%","margin-top":"10px"},model:{value:t.search.electric_name,callback:function(e){t.$set(t.search,"electric_name",e)},expression:"search.electric_name"}})],1)],1),a("a-col",{staticStyle:{"padding-left":"1px","padding-right":"1px",width:"400px"},attrs:{md:8,sm:24}},[a("label",{staticStyle:{"margin-top":"5px"}},[t._v("所属集中器：")]),a("a-select",{staticStyle:{width:"300px","padding-top":"10px"},attrs:{"default-value":"0",placeholder:"请选择所属集中器"},model:{value:t.search.group_name,callback:function(e){t.$set(t.search,"group_name",e)},expression:"search.group_name"}},t._l(t.group_list,(function(e,i){return a("a-select-option",{key:i,attrs:{value:e.id}},[t._v(" "+t._s(e.group_name)+" ")])})),1)],1),a("a-col",{staticStyle:{"padding-left":"1px","padding-right":"24px","padding-top":"10px"},attrs:{md:2,sm:2}},[a("a-button",{attrs:{type:"primary",icon:"search"},on:{click:function(e){return t.searchList()}}},[t._v(" 查询 ")])],1)],1)],1),a("div",{staticClass:"table-operator",staticStyle:{"padding-left":"24px","padding-top":"10px"}},[a("a-button",{staticStyle:{"margin-right":"10px"},attrs:{type:"primary",icon:"plus"},on:{click:function(e){return t.$refs.createModal.add()}}},[t._v("添加")]),a("a-button",{staticStyle:{"margin-right":"10px"},attrs:{type:"primary"},on:{click:function(e){return t.$refs.createUploadModal.add()}}},[a("a-icon",{attrs:{type:"upload"}}),t._v("导入")],1)],1),a("a-table",{staticClass:"components-table-demo-nested",attrs:{columns:t.columns,"data-source":t.data,pagination:t.pagination},on:{change:t.table_change},scopedSlots:t._u([{key:"begin_num",fn:function(e,i){return a("span",{},[a("a",{on:{click:function(e){return t.$refs.createRealtimeModal.edit(i.id)}}},[t._v(" "+t._s(e)+" ")])])}},{key:"status",fn:function(e,i){return a("span",{},[a("div",{class:"正常"===e?"txt-green":"txt-red"},[t._v(" "+t._s(e)+" ")])])}},{key:"action",fn:function(e,i){return a("span",{},[a("a",{on:{click:function(e){return t.$refs.createModal.edit(i.id)}}},[t._v("修改设备")]),a("a-divider",{attrs:{type:"vertical"}}),"open"!=i.swicth&&"true"!=i.disabled?a("a-popconfirm",{staticClass:"ant-dropdown-link",attrs:{title:"确认开闸?","ok-text":"是","cancel-text":"否"},on:{confirm:function(e){return t.switch11(i.id,"open")},cancel:t.cancel}},[a("a",{attrs:{href:"#"}},[t._v("开闸")]),a("a-divider",{attrs:{type:"vertical"}})],1):t._e(),"open"==i.swicth&&"true"!=i.disabled?a("a-popconfirm",{staticClass:"ant-dropdown-link",attrs:{title:"确认关闸?","ok-text":"是","cancel-text":"否"},on:{confirm:function(e){return t.switch11(i.id,"close")},cancel:t.cancel}},[a("a",{attrs:{href:"#"}},[t._v("关闸")]),a("a-divider",{attrs:{type:"vertical"}})],1):t._e(),a("a-popconfirm",{staticClass:"ant-dropdown-link",attrs:{title:"确认删除?","ok-text":"是","cancel-text":"否"},on:{confirm:function(e){return t.deleteConfirm(i.id)},cancel:t.cancel}},[a("a",{attrs:{href:"#"}},[t._v("删除设备")]),a("a-divider",{attrs:{type:"vertical"}})],1),a("a-popconfirm",{staticClass:"ant-dropdown-link",attrs:{title:"确认手动抄表?","ok-text":"是","cancel-text":"否"},on:{confirm:function(e){return t.meterReading(i.id)},cancel:t.cancel}},[a("a",{attrs:{href:"#"}},[t._v("手动抄表")]),a("a-divider",{attrs:{type:"vertical"}})],1)],1)}}])}),a("electric-info",{ref:"createModal",attrs:{height:800,width:1500},on:{ok:t.handleOks}}),a("electric-upload",{ref:"createUploadModal",attrs:{height:800,width:500},on:{ok:t.handleOks}}),a("electric-realtime",{ref:"createRealtimeModal",attrs:{height:800,width:1500},on:{ok:t.handleOks}})],1)},n=[],s=a("ade3"),c=(a("ac1f"),a("841c"),a("1a83")),l=a("dcd4"),r=a("0772"),o=a("e84e"),d=[{title:"电表名称",dataIndex:"electric_name",key:"electric_name"},{title:"所属集中器",dataIndex:"group_name",key:"group_name"},{title:"所属房间",dataIndex:"village_address",key:"village_address"},{title:"剩余电量",dataIndex:"remaining_capacity",key:"remaining_capacity"},{title:"用电量",dataIndex:"begin_num",key:"begin_num",scopedSlots:{customRender:"begin_num"}},{title:"状态",dataIndex:"status",key:"status",width:"8%",scopedSlots:{customRender:"status"}},{title:"操作",key:"action",dataIndex:"",scopedSlots:{customRender:"action"}}],u={name:"electricList",components:{electricInfo:l["default"],electricUpload:r["default"],electricRealtime:o["default"]},data:function(){var t;return t={data:[],reply_content:"",pagination:{pageSize:10,total:10},search_data:[],search:{page:1},form:this.$form.createForm(this),visible:!1,columns:d,page:1,province_list:[],city_list:[],area_list:[],street_list:[],community_list:[],village_list:[],single_list:[],floor_list:[],layer_list:[],vacancy_list:[],areas:[],streetarr:[],singlearr:[],layerarr:[],communityarr:[],villagearr:[]},Object(s["a"])(t,"singlearr",[]),Object(s["a"])(t,"floorarr",[]),Object(s["a"])(t,"layerarr",[]),Object(s["a"])(t,"vacancyarr",[]),Object(s["a"])(t,"group_list",[]),t},activated:function(){this.getElectricList(),this.getAreaList(),this.getGroupList()},methods:{getElectricList:function(){var t=this;this.search["page"]=this.page,this.request(c["a"].meterElectricList,this.search).then((function(e){console.log("res",e),t.pagination.total=e.count?e.count:0,t.pagination.pageSize=e.total_limit?e.total_limit:10,t.data=e.list}))},getAreaList:function(){var t=this;this.request(c["a"].getAreasList,{pid:0,type:1}).then((function(e){t.province_list=e})).catch((function(e){t.confirmLoading=!1}))},getGroupList:function(){var t=this;this.request(c["a"].meterElectricGroupList).then((function(e){t.group_list=e.list})).catch((function(e){t.confirmLoading=!1}))},handleChange:function(t){var e=this;this.request(c["a"].getAreasList,{pid:t,type:2}).then((function(t){e.city_list=t})).catch((function(t){e.confirmLoading=!1}))},handleChange1:function(t){var e=this;this.request(c["a"].getAreasList,{pid:t,type:3}).then((function(t){e.area_list=t})).catch((function(t){e.confirmLoading=!1}))},handleChange2:function(t){var e=this;this.request(c["a"].getCommunityList,{pid:t,type:0}).then((function(t){e.street_list=t})).catch((function(t){e.confirmLoading=!1}))},handleChange3:function(t){var e=this;this.request(c["a"].getCommunityList,{pid:t,type:1}).then((function(t){e.community_list=t})).catch((function(t){e.confirmLoading=!1}))},handleChange4:function(t){var e=this;this.request(c["a"].getVillageList,{pid:t,type:2}).then((function(t){e.village_list=t})).catch((function(t){e.confirmLoading=!1}))},handleChange5:function(t){var e=this;this.request(c["a"].getSingleList,{pid:t}).then((function(t){e.single_list=t})).catch((function(t){e.confirmLoading=!1}))},handleChange6:function(t){var e=this;this.request(c["a"].getFloorList,{pid:t}).then((function(t){e.floor_list=t})).catch((function(t){e.confirmLoading=!1}))},handleChange7:function(t){var e=this;this.request(c["a"].getLayerList,{pid:t}).then((function(t){e.layer_list=t})).catch((function(t){e.confirmLoading=!1}))},handleChange8:function(t){var e=this;this.request(c["a"].getVacancyList,{pid:t}).then((function(t){e.vacancy_list=t})).catch((function(t){e.confirmLoading=!1}))},cancel:function(){},searchList:function(){console.log("search",this.search),this.getElectricList()},resetList:function(){console.log("search",this.search),console.log("search_data",this.search_data),this.search={key_val:"phone",value:"",status:"",date:[],page:1},this.search_data=[],this.getOrderList()},table_change:function(t){console.log("e",t),t.current&&t.current>0&&(this.page=t.current,this.getElectricList())},handleOks:function(){this.getElectricList()},deleteConfirm:function(t){var e=this;this.request(c["a"].meterElectricDelete,{electric_id:t}).then((function(t){e.getElectricList(),e.$message.success("删除成功")}))},meterReading:function(t){var e=this;this.request(c["a"].meterReading,{electric_id:t}).then((function(t){e.getElectricList(),e.$message.success("指令下发成功")}))},switch11:function(t,e){var a=this;this.request(c["a"].switch,{electric_id:t,switch_type:e}).then((function(t){a.getElectricList(),a.$message.success("指令下发成功")}))}}},h=u,p=(a("3546"),a("0c7c")),g=Object(p["a"])(h,i,n,!1,null,"9153da90",null);e["default"]=g.exports},"96c8":function(t,e,a){},e84e:function(t,e,a){"use strict";a.r(e);var i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("a-modal",{attrs:{width:"1000px",footer:null,maskClosable:!1,title:"用电量详情"},model:{value:t.bindVisible,callback:function(e){t.bindVisible=e},expression:"bindVisible"}},[a("div",{staticClass:"package-list ant-pro-page-header-wrap-children-content",staticStyle:{margin:"0 0 0"}},[a("a-card",{attrs:{bordered:!1}},[a("div",{staticClass:"search-box",staticStyle:{"margin-bottom":"10px"}},[a("a-row",{attrs:{gutter:48}},[a("a-col",{staticStyle:{"padding-left":"24px","padding-right":"1px",width:"400px"},attrs:{md:8,sm:24}},[a("label",[t._v("时间：")]),a("a-range-picker",{staticStyle:{width:"250px"},on:{change:t.onChange},model:{value:t.time,callback:function(e){t.time=e},expression:"time"}})],1),a("a-col",{staticStyle:{"padding-left":"1px","padding-right":"24px"},attrs:{md:2,sm:2}},[a("a-button",{attrs:{type:"primary",icon:"search"},on:{click:function(e){return t.searchList()}}},[t._v(" 查询 ")])],1)],1)],1),a("div",[a("span",[t._v("当前电表数："+t._s(t.begin_num))])]),a("div",[a("span",[t._v("总用电量："+t._s(t.electric_count))])]),a("div",[a("span",[t._v("单位：kW.h")])]),a("a-table",{attrs:{columns:t.columns,rowKey:"id","data-source":t.list,pagination:t.pagination,loading:t.loading},on:{change:t.tableChange},scopedSlots:t._u([{key:"name",fn:function(e){return[t._v(" "+t._s(e.first)+" "+t._s(e.last)+" ")]}}])})],1)],1)])},n=[],s=(a("ac1f"),a("841c"),a("1a83")),c=[{title:"时间",dataIndex:"time",key:"time"},{title:"用电量",dataIndex:"num",key:"num"}],l={name:"electricRealtime",data:function(){return{list:[],electric_count:0,begin_num:0,end_num:0,sortedInfo:null,pagination:{pageSize:10,total:10},search:{page:1},page:1,search_data:[],id:0,uid:0,columns:c,loading:!1,bindVisible:!1,confirmLoading:!1,visible:!1,time:[]}},computed:{},methods:{tableChange:function(t){t.current&&t.current>0&&(this.page=t.current,this.getMeterReadingList())},edit:function(t){this.id=t,console.log("id",t),this.bindVisible=!0,this.bindVisible=!0,this.getMeterReadingList()},getMeterReadingList:function(){var t=this;this.request(s["a"].MeterReadingList,{electric_id:this.id,time:this.time,page:this.page}).then((function(e){t.list=e.list,t.begin_num=e.begin_num,t.electric_count=e.electric_count,t.pagination.total=e.count?e.count:0,t.pagination.pageSize=e.total_limit?e.total_limit:10,console.log("list",e)})).catch((function(e){t.confirmLoading=!1}))},onChange:function(t,e){console.log(t,e)},handleCandel:function(){this.visible=!1},cancel1:function(){},searchList:function(){console.log("search",this.search),this.getMeterReadingList()}}},r=l,o=(a("27dc"),a("0c7c")),d=Object(o["a"])(r,i,n,!1,null,"cd0916c4",null);e["default"]=d.exports}}]);