(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-dd2dd86a"],{"1f05":function(t,e,i){},"8e1c":function(t,e,i){},"8eec":function(t,e,i){"use strict";i("1f05")},aa28:function(t,e,i){"use strict";i.r(e);var a=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("a-modal",{attrs:{title:t.title,width:900,visible:t.visible,maskClosable:!1,confirmLoading:t.confirmLoading},on:{ok:t.handleSubmit,cancel:t.handleCancel}},[i("a-spin",{attrs:{spinning:t.confirmLoading,height:800}},[i("a-form",{staticClass:"prepaid_info",attrs:{form:t.form}},[i("a-form-item",{attrs:{label:"",labelCol:t.labelCol,wrapperCol:t.wrapperCol,required:!0}},[i("span",{staticClass:"label_col ant-form-item-required"},[t._v("预缴时间选择")]),i("a-select",{directives:[{name:"decorator",rawName:"v-decorator",value:["post.cycle",{initialValue:t.post.cycle,rules:[{required:!0,message:t.L("请选择预缴时间！")}]}],expression:"['post.cycle',{ initialValue: post.cycle, rules: [{ required: true, message: L('请选择预缴时间！') }] }]"}],staticStyle:{width:"300px"},attrs:{disabled:t.is_disabled},on:{change:t.handleChangeCycle}},t._l(t.cycle_info,(function(e,a){return i("a-select-option",{key:a,attrs:{value:e.key}},[t._v(" "+t._s(e.value)+" ")])})),1),t.cycle_txt_status?i("a-input-number",{directives:[{name:"decorator",rawName:"v-decorator",value:["post.cycle_param",{initialValue:t.post.cycle_param}],expression:"['post.cycle_param',{ initialValue: post.cycle_param}]"}],staticStyle:{width:"130px","margin-left":"10px"},attrs:{disabled:t.is_disabled,min:1,placeholder:"请输入时间数"}}):t._e(),t._v("   "+t._s(t.bill_date_str)+" ")],1),i("a-form-item",{attrs:{label:"",labelCol:t.labelCol,wrapperCol:t.wrapperCol}},[i("span",{staticClass:"label_col ant-form-item-required"},[t._v("优惠模式")]),i("a-select",{directives:[{name:"decorator",rawName:"v-decorator",value:["post.type",{initialValue:t.post.type,rules:[{required:!0,message:t.L("请选择优惠模式！")}]}],expression:"['post.type',{ initialValue: post.type, rules: [{ required: true, message: L('请选择优惠模式！') }] }]"}],staticStyle:{width:"300px"},on:{change:t.discountType}},t._l(t.type_info,(function(e,a){return i("a-select-option",{key:a,attrs:{value:e.key}},[t._v(" "+t._s(e.value)+" ")])})),1)],1),t.type_1?i("a-form-item",{attrs:{label:"",required:!0,labelCol:t.labelCol,wrapperCol:t.wrapperCol,extra:"以百分比计算，请输入0-100。例如输入80，则按80%进行收取，即预缴2个月100元，则折扣后仅需缴纳80元，优惠掉20元"}},[i("a-col",{attrs:{span:18}},[i("span",{staticClass:"label_col ant-form-item-required"},[t._v("折扣率")]),i("a-input-number",{directives:[{name:"decorator",rawName:"v-decorator",value:["post.rate",{initialValue:t.post.rate,rules:[{required:!0,message:t.L("请输入折扣率！")}]}],expression:"['post.rate',{ initialValue: post.rate, rules: [{ required: true, message: L('请输入折扣率！') }] }] "}],staticStyle:{width:"110px"},attrs:{min:0,max:100,formatter:function(t){return t+" %"},placeholder:"请输入折扣率"}})],1),i("a-col",{attrs:{span:6}})],1):t._e(),t.type_2?i("a-form-item",{attrs:{label:"",labelCol:t.labelCol,wrapperCol:t.wrapperCol,required:!0}},[i("span",{staticClass:"label_col ant-form-item-required"},[t._v("赠送时间")]),i("a-select",{directives:[{name:"decorator",rawName:"v-decorator",value:["post.give_cycle_param",{initialValue:t.post.give_cycle_param}],expression:"['post.give_cycle_param',{ initialValue: post.give_cycle_param }]"}],staticStyle:{width:"100px"},on:{change:t.handleChange}},[t._v("> "),t._l(t.give_cycle_param_info,(function(e,a){return i("a-select-option",{key:a,attrs:{value:e.key}},[t._v(" "+t._s(e.value)+" ")])}))],2),t.give_cycle_txt_status?i("a-input-number",{directives:[{name:"decorator",rawName:"v-decorator",value:["post.give_cycle_txt",{initialValue:t.post.give_cycle_txt}],expression:"['post.give_cycle_txt',{ initialValue: post.give_cycle_txt}]"}],staticStyle:{width:"130px","margin-left":"10px"},attrs:{min:1,max:100,placeholder:"请输入赠送时间"}}):t._e(),t._v("   "+t._s(t.bill_date_str)+" ")],1):t._e(),t.type_3?i("a-form-item",{attrs:{label:"",labelCol:t.labelCol,wrapperCol:t.wrapperCol,extra:"类似于线下送礼物时候的备注，比如缴费统一赠送小礼品之类的"}},[i("a-col",{attrs:{span:18}},[i("span",{staticClass:"label_col"},[t._v("自定义文本")]),i("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["post.custom_txt",{initialValue:t.post.custom_txt,rules:[{required:!0,message:t.L("请输入自定义文本！")}]}],expression:"['post.custom_txt',{ initialValue: post.custom_txt ,rules: [{ required: true, message: L('请输入自定义文本！') }]}]"}],staticStyle:{width:"300px"},attrs:{maxLength:30,placeholder:"请输入"}})],1),i("a-col",{attrs:{span:6}})],1):t._e(),i("a-form-item",{attrs:{label:"",labelCol:t.labelCol,wrapperCol:t.wrapperCol}},[i("span",{staticClass:"label_col"},[t._v("状态")]),i("a-radio-group",{directives:[{name:"decorator",rawName:"v-decorator",value:["post.status",{initialValue:t.post.status}],expression:"['post.status', {initialValue:post.status}]"}]},[i("a-radio",{attrs:{value:1}},[t._v(" 开启 ")]),i("a-radio",{attrs:{value:2}},[t._v(" 禁止 ")])],1)],1)],1)],1)],1)},s=[],r=i("a0e0"),o=(i("567c"),{components:{},data:function(){return{title:"新建",labelCol:{xs:{span:24},sm:{span:7}},wrapperCol:{xs:{span:24},sm:{span:13}},confirmLoading:!1,form:this.$form.createForm(this),cycle_info:[],type_info:[],give_cycle_param_info:[],visible:!1,post:{id:0,type:"",status:"",rate:"",cycle:"",give_cycle_param:"",give_cycle_txt:"",custom_txt:"",cycle_param:""},give_cycle_txt_status:!1,cycle_txt_status:!1,is_disabled:!1,type_1:!1,type_2:!1,type_3:!1,type_4:!1,bill_date_set:2,bill_date_str:"月"}},mounted:function(){},methods:{handleChange:function(t){this.give_cycle_txt_status=11==t},discountType:function(t){switch(this.type_1=this.type_2=this.type_3=!1,t){case 1:this.type_1=!0;break;case 2:this.type_2=!0;break;case 3:this.type_3=!0;break}},handleChangeCycle:function(t){this.cycle_txt_status=11==t},add:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,i=arguments.length>1?arguments[1]:void 0;this.charge_rule_id=e,this.bill_date_set=i,1==i?this.bill_date_str="日":2==i?this.bill_date_str="月":3==i&&(this.bill_date_str="年"),this.title="添加预缴时间",this.visible=!0,this.is_disabled=!1,this.type_1=!1,this.type_2=!1,this.type_3=!1,this.type_4=!1,this.post={id:0,type:"",status:1,rate:"",cycle:"",give_cycle_param:"",give_cycle_txt:"",custom_txt:"",cycle_param:""},this.give_cycle_txt_status=!1,this.cycle_txt_status=!1,this.request(r["a"].getPrepaidCycle,{charge_rule_id:this.charge_rule_id}).then((function(e){t.cycle_info=e.cycle,t.type_info=e.type,t.give_cycle_param_info=e.give_cycle}))},edit:function(t,e){var i=this;this.bill_date_set=e,1==e?this.bill_date_str="日":2==e?this.bill_date_str="月":3==e&&(this.bill_date_str="年"),this.title="编辑预缴周期",this.visible=!0,this.is_disabled=!1,this.post.id=t,this.imgUrl="",this.getEditInfo(),this.type_1=!1,this.type_2=!1,this.type_3=!1,this.type_4=!1,this.request(r["a"].getPrepaidCycle,{charge_rule_id:this.charge_rule_id}).then((function(t){i.cycle_info=t.cycle,i.type_info=t.type,i.give_cycle_param_info=t.give_cycle}))},handleSubmit:function(){var t=this,e=this.form.validateFields;this.confirmLoading=!0,e((function(e,i){if(e)t.confirmLoading=!1;else{var a=r["a"].ChargePrepaidAdd;t.post.id>0?(a=r["a"].ChargePrepaidSub,i.post.id=t.post.id):i.post.charge_rule_id=t.charge_rule_id,t.request(a,i.post).then((function(e){t.post.id>0?t.$message.success("编辑成功"):t.$message.success("添加成功"),setTimeout((function(){t.form=t.$form.createForm(t),t.visible=!1,t.confirmLoading=!1,console.log(123),t.$emit("ok")}),1500),console.log(345)})).catch((function(e){t.confirmLoading=!1}))}}))},handleCancel:function(){var t=this;this.visible=!1,setTimeout((function(){t.post.id=0,t.form=t.$form.createForm(t)}),500)},getEditInfo:function(){var t=this;this.confirmLoading=!0,this.request(r["a"].ChargePrepaidEdit,{id:this.post.id}).then((function(e){switch(t.post={id:e.id,type:e.type,rate:e.rate,cycle:e.cycle,cycle_param:e.cycle_param,give_cycle_param:e.give_cycle_param,give_cycle_txt:e.give_cycle_txt,custom_txt:e.custom_txt,status:e.status},e.type){case 1:t.type_1=!0;break;case 2:t.type_2=!0;break;case 3:t.type_3=!0;break}t.is_disabled=e.is_disabled,t.give_cycle_txt_status=e.give_cycle_txt_status,t.cycle_txt_status=e.cycle_txt_status,t.confirmLoading=!1,e.charge_rule_id>0&&(t.bill_date_str=e.bill_create_set)}))}}}),l=o,n=(i("d55e"),i("2877")),c=Object(n["a"])(l,a,s,!1,null,"d2b6c064",null);e["default"]=c.exports},d55e:function(t,e,i){"use strict";i("8e1c")},f51e:function(t,e,i){"use strict";i.r(e);var a=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("a-modal",{attrs:{title:t.title,width:1200,footer:null,visible:t.visible,maskClosable:!1,confirmLoading:t.confirmLoading},on:{cancel:t.handleCancel}},[i("div",{staticClass:"message-suggestions-list-box"},[t.isShow?i("div",{staticClass:"add-box"},[i("a-row",{attrs:{gutter:48}},[1==t.is_grapefruit_prepaid?i("a-col",{staticStyle:{"margin-bottom":"20px"},attrs:{md:8,sm:24}},[i("a-button",{attrs:{type:"primary"},on:{click:function(e){return t.$refs.discountAddModel.add(t.charge_rule_id,t.bill_date_set,t.charge_project_id)}}},[t._v(" 创建 ")])],1):i("a-col",{staticStyle:{"margin-bottom":"20px"},attrs:{md:8,sm:24}},[i("a-button",{attrs:{type:"primary"},on:{click:function(e){return t.$refs.PopupAddModel.add(t.charge_rule_id,t.bill_date_set)}}},[t._v(" 添加 ")])],1)],1)],1):t._e(),t.is_grapefruit_prepaid<1?i("a-table",{staticClass:"components-table-demo-nested",attrs:{columns:t.columns,"data-source":t.data,pagination:t.pagination,loading:t.loading},on:{change:t.table_change},scopedSlots:t._u([{key:"status",fn:function(e,a){return i("span",{},[2==a.status?i("div",{staticStyle:{color:"red"}},[t._v("禁止")]):t._e(),1==a.status?i("div",{staticStyle:{color:"#1890ff"}},[t._v("开启")]):t._e(),4==a.status?i("div",{staticStyle:{color:"red"}},[t._v("已删除")]):t._e()])}},{key:"standard",fn:function(e,a){return i("span",{},[i("a",[t._v("绑定")])])}},{key:"action",fn:function(e,a){return i("span",{},[t.isShow?i("a",{on:{click:function(e){return t.$refs.PopupEditModel.edit(a.id,t.bill_date_set,t.charge_rule_id)}}},[t._v("编辑")]):t._e(),t.isShow?t._e():i("a",{staticStyle:{color:"#CCCCCC"}},[t._v("编辑")]),t.isShow?i("a-popconfirm",{staticClass:"ant-dropdown-link",staticStyle:{"margin-left":"20px"},attrs:{title:"确认删除?","ok-text":"是","cancel-text":"否"},on:{confirm:function(e){return t.deleteConfirm(a.id)},cancel:t.cancel}},[i("a",{attrs:{href:"#"}},[t._v("删除")])]):t._e()],1)}}],null,!1,2484826166)}):t._e(),1==t.is_grapefruit_prepaid?i("a-table",{staticClass:"components-table-demo-nested",attrs:{columns:t.columns2,"data-source":t.data2,pagination:t.pagination,loading:t.loading},on:{change:t.table_change},scopedSlots:t._u([{key:"action_opt",fn:function(e,a){return i("span",{},[i("a",{on:{click:function(e){return t.$refs.discountAddModel.edit(a.id,t.charge_rule_id,t.bill_date_set,t.charge_project_id)}}},[t._v("编辑")]),i("a-popconfirm",{staticClass:"ant-dropdown-link",staticStyle:{"margin-left":"20px"},attrs:{title:"确认删除?","ok-text":"是","cancel-text":"否"},on:{confirm:function(e){return t.deleteConfirm(a.id)},cancel:t.cancel}},[i("a",{attrs:{href:"#"}},[t._v("删除")])])],1)}}],null,!1,489034095)}):t._e(),i("discountPrepaidInfo",{ref:"discountAddModel",on:{ok:t.addActive}}),i("discountPrepaidInfo",{ref:"discountAddModel",on:{ok:t.editActive}}),i("prepaidInfo",{ref:"PopupAddModel",on:{ok:t.addActive}}),i("prepaidInfo",{ref:"PopupEditModel",on:{ok:t.editActive}})],1)])},s=[],r=(i("ac1f"),i("841c"),i("a0e0")),o=i("aa28"),l=i("9e6a"),n=[{title:"预缴时间",dataIndex:"cycle",key:"cycle"},{title:"优惠模式",dataIndex:"type_txt",key:"type_txt"},{title:"添加时间",dataIndex:"add_time",key:"add_time"},{title:"状态",dataIndex:"status",key:"status",scopedSlots:{customRender:"status"}},{title:"操作",dataIndex:"operation",key:"operation",scopedSlots:{customRender:"action"}}],c=[],d=[{title:"预缴类型",dataIndex:"discount_type_str",key:"discount_type_str"},{title:"预缴时长",dataIndex:"xcontent",key:"xcontent"},{title:"预缴到期时间",dataIndex:"expire_time_str",key:"expire_time_str"},{title:"最后编辑时间",dataIndex:"update_time_str",key:"update_time_str"},{title:"操作",dataIndex:"",key:"",scopedSlots:{customRender:"action_opt"}}],_=[],p={name:"prepaidList",filters:{},components:{prepaidInfo:o["default"],discountPrepaidInfo:l["default"]},data:function(){var t=this;return{reply_content:"",pagination:{current:1,pageSize:10,total:10,showSizeChanger:!0,pageSizeOptions:["10","20","50","100"],showTotal:function(t){return"共 ".concat(t," 条")},onShowSizeChange:function(e,i){return t.onTableChange(e,i)},onChange:function(e,i){return t.onTableChange(e,i)}},search:{keyword:"",page:1},form:this.$form.createForm(this),visible:!1,loading:!1,data:c,data2:_,columns:n,columns2:d,title:"",confirmLoading:!1,charge_rule_id:"",bill_date_set:2,isShow:!0,is_grapefruit_prepaid:0,ids:[],charge_project_id:0}},methods:{List:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:2,a=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,r=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0;this.title="预缴时间",this.charge_project_id=r,this.loading=!0,1==e&&this.$set(this.pagination,"current",1),console.log("is_grapefruit_prepaid",s),this.bill_date_set=i,this.charge_rule_id=t,void 0!=s&&s>0?(this.isShow=!1,this.is_grapefruit_prepaid=s,this.title="预缴优惠管理",this.getDiscountList()):(this.isShow=a,this.getList())},getDiscountList:function(){var t=this;this.search["bill_date_set"]=this.bill_date_set,this.search["charge_rule_id"]=this.charge_rule_id,this.search["charge_project_id"]=this.charge_project_id,this.search["page"]=this.pagination.current,this.search["limit"]=this.pagination.pageSize,this.request(r["a"].getChargePrepaidDiscountList,this.search).then((function(e){t.pagination.total=e.count?e.count:0,t.pagination.pageSize=e.total_limit?e.total_limit:10,t.data2=e.list,void 0!=e.count&&e.count>0?t.isShow=!1:t.isShow=!0,t.loading=!1,t.confirmLoading=!1,t.visible=!0}))},getList:function(){var t=this;this.search["bill_date_set"]=this.bill_date_set,this.search["charge_rule_id"]=this.charge_rule_id,this.search["charge_project_id"]=this.charge_project_id,this.search["page"]=this.pagination.current,this.search["limit"]=this.pagination.pageSize,this.isShow||(this.search["type"]="del_detail"),this.request(r["a"].ChargePrepaidList,this.search).then((function(e){t.pagination.total=e.count?e.count:0,t.pagination.pageSize=e.total_limit?e.total_limit:10,t.data=e.list,t.is_grapefruit_prepaid=e.is_grapefruit_prepaid?e.is_grapefruit_prepaid:0,t.loading=!1,t.confirmLoading=!1,t.visible=!0}))},onTableChange:function(t,e){this.pagination.current=t,this.pagination.pageSize=e,this.loading=!0,this.is_grapefruit_prepaid>0?this.getDiscountList():this.getList(),console.log("onTableChange==>",t,e)},handleCancel:function(){var t=this;this.visible=!1,setTimeout((function(){t.id="0",t.form=t.$form.createForm(t)}),500)},cancel:function(){},deleteConfirm:function(t){var e=this,i=this;i.is_grapefruit_prepaid>0?this.request(r["a"].chargePrepaidDiscountDel,{id:t}).then((function(t){e.getDiscountList(),i.$message.success("删除成功")})):this.request(r["a"].ChargePrepaidDel,{id:t}).then((function(t){e.getList(),i.$message.success("删除成功")}))},addActive:function(t){this.loading=!0,t&&this.ids.push(t),this.is_grapefruit_prepaid>0?this.getDiscountList():this.getList()},editActive:function(t){this.loading=!0,this.is_grapefruit_prepaid>0?this.getDiscountList():this.getList()},table_change:function(t){console.log("e",t),t.current&&t.current>0&&(this.$set(this.pagination,"current",t.current),this.loading=!0,this.is_grapefruit_prepaid>0?this.getDiscountList():this.getList())}}},u=p,h=(i("8eec"),i("2877")),g=Object(h["a"])(u,a,s,!1,null,null,null);e["default"]=g.exports}}]);