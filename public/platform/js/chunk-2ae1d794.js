(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2ae1d794"],{"3e1a":function(i,s,t){"use strict";t.r(s);var o=function(){var i=this,s=i.$createElement,t=i._self._c||s;return t("div",{staticClass:"body_cashier_container"},[t("div",{staticClass:"details_container"},[t("div",{staticClass:"title_bar"},[t("div",{staticClass:"title_text"},[i._v(i._s(i.L("请选择某个规格来进行估清")))])]),t("a-spin",{staticClass:"changecolor",staticStyle:{height:"75%"},attrs:{spinning:i.loadingdata,indicator:i.indicator,size:"large"}}),t("div",{staticClass:"details_content"},[t("div",{staticClass:"slider_content"},[t("div",{staticClass:"food_details_info"},[t("div",{staticClass:"foodname"},[t("div",{staticClass:"left_name"},[i._v(i._s(i.pageinfo.product_name))]),t("div",{staticClass:"right_price"},[t("span",[i._v(i._s(i.L("库存:")))]),i._v(" "+i._s(i.is_show?-1==i.pageinfo.stock_num?i.L("不限"):i.pageinfo.stock_num:-1==i.nowpriceinfo.stock_num?i.L("不限"):i.nowpriceinfo.stock_num)+" ")])]),t("div",{staticClass:"food_spec_container"},[t("div",{staticClass:"food_spec_list"},[t("div",{staticStyle:{width:"100%"}},[t("div",{staticClass:"foodspec_items",staticStyle:{"align-items":"center"}},[t("div",{staticClass:"left_spec_keyname"},[i._v(i._s(i.L("是否沽清全部"))+"：")]),t("div",{staticClass:"specList"},[t("a-switch",{attrs:{disabled:1==i.pageinfo.spec_stock_type,"checked-children":i.L("是"),"un-checked-children":i.L("否"),"default-checked":""},on:{change:i.switchChange}}),1==i.pageinfo.spec_stock_type?t("span",{staticStyle:{color:"red","margin-left":"10px"}},[i._v("继承库存商品只能全部估清所有规格库存")]):i._e()],1)]),i.is_show?i._e():i._l(i.pageinfo.spec_list,(function(s,o){return t("div",{key:o,staticClass:"foodspec_items"},[t("div",{staticClass:"left_spec_keyname"},[i._v(i._s(s.name)+"：")]),t("div",{staticClass:"specList"},i._l(s.list,(function(s,n){return t("div",{key:n,staticClass:"spec_items",class:s.ischeck?"spec_items_active":"",on:{click:function(s){return i.selectspec(o,n)}}},[i._v(" "+i._s(s.name)+" ")])})),0)])}))],2)])])])])]),t("div",{staticClass:"bottom_bar"},[t("div",{staticClass:"cancel_btn",on:{click:i.cancelfnc}},[i._v(i._s(i.L("取消")))]),t("div",{staticClass:"confirm_btn",on:{click:i.addConfirm}},[i._v(i._s(i.confirm_btn_title))])])],1)])},n=[],e=(t("d81d"),t("d3b7"),t("159b"),t("4de4"),t("b0c0"),{data:function(){var i=this.$createElement;return{animateshow:!1,productId:"",loadingdata:!0,indicator:i("a-icon",{attrs:{type:"loading-3-quarters","font-size":"30px",spin:!0}}),pageinfo:"",nowpriceinfo:{},nowspec:"",nowformat:"",nowSpecStatus:1,uniqueness_number:"",productParam:[],allGoodsList:[],otherpage:"",is_show:!0,confirm_btn_title:this.L("估清")}},props:{multiSpecificationInfo:{type:Object,default:function(){return null}}},watch:{nowspec:function(i,s){"_"==i.substr(i.length-1,1)&&(this.nowspec=i.substring(0,i.length-1))},nowformat:function(i,s){"_"==i.substr(i.length-1,1)&&(this.nowformat=i.substring(0,i.length-1))}},created:function(){this.getfoodDetails()},methods:{setConfirmBtnTitle:function(){!this.is_show&&this.nowpriceinfo&&"0"==this.nowpriceinfo.stock_num?this.confirm_btn_title=this.L("置满"):this.confirm_btn_title=this.L("估清")},switchChange:function(i){this.is_show=i,this.setConfirmBtnTitle()},addConfirm:function(){var i={nowspec:this.nowspec,nowpriceinfo:this.nowpriceinfo,is_show:this.is_show};this.$emit("multiSpecificationEstimation",i)},cancelfnc:function(){this.$emit("cancelValuation")},getfoodDetails:function(i){var s=this;console.log(this.multiSpecificationInfo),this.request("/foodshop/storestaff.goods/goodsDetail",{product_id:this.multiSpecificationInfo.product_id,type:this.multiSpecificationInfo.goodsType||1}).then((function(i){s.loadingdata=!1,console.log(i,"----------------------商品详情---------------------"),s.pageinfo=JSON.parse(JSON.stringify(i)),s.pageinfo.allSelect=[],s.initList()}))},initList:function(){this.pageinfo.subsidiary_piece.length>0&&this.pageinfo.subsidiary_piece.map((function(i){i.has_select=""})),console.log(this.pageinfo),this.pageinfo.has_spec||this.pageinfo.has_format||(this.nowpriceinfo=this.pageinfo,this.nowpriceinfo.price=this.nowpriceinfo.product_price),this.pageinfo.has_spec&&!this.pageinfo.has_format&&(this.nowSpecStatus=1,this.initdataSpec()),!this.pageinfo.has_spec&&this.pageinfo.has_format&&(this.nowSpecStatus=2,this.initdataFormat()),this.pageinfo.has_spec&&this.pageinfo.has_format&&(this.nowSpecStatus=3,this.initdataBoth())},initdataSpec:function(){var i=this;console.log("只有规格的商品进来了"),this.pageinfo.spec_list.map((function(s,t){s.list.map((function(s,t){s.ischeck=!1,0==t&&(s.ischeck=!0,i.nowspec=i.nowspec+s.id_+"_")}))})),this.$nextTick((function(){console.log(i.nowspec),i.nowpriceinfo=JSON.parse(JSON.stringify(i.pageinfo.list[i.nowspec])),i.setConfirmBtnTitle()}))},initdataFormat:function(){var i=this;console.log("只有属性的商品进来了"),this.pageinfo.properties_list.forEach((function(s,t){s.lists=[],1==s.num?s.val.forEach((function(t,o){var n={ischeck:!1};n.name=t,n.id=o,n.list_id=s.id_,0==o&&(n.ischeck=!0,i.nowformat=i.nowformat+s.id_+"_"+n.id+"_"),s.lists.push(n)})):s.val.forEach((function(i,t){var o={ischeck:!1};o.name=i,o.id=t,o.list_id=s.id_,s.lists.push(o)}))})),this.$nextTick((function(){console.log(i.nowformat),i.nowpriceinfo=JSON.parse(JSON.stringify(i.pageinfo)),i.nowpriceinfo.counts=0,i.nowpriceinfo.price=i.nowpriceinfo.product_price,console.log(i.nowpriceinfo)}))},initdataBoth:function(){var i=this;console.log("规格和属性都有的商品进来了"),this.pageinfo.spec_list.map((function(s,t){s.list.map((function(s,t){s.ischeck=!1,0==t&&(s.ischeck=!0,i.nowspec=i.nowspec+s.id_+"_")}))})),this.pageinfo.properties_list.forEach((function(i,s){i.lists=[],i.val.forEach((function(s,t){var o={ischeck:!1};o.name=s,o.id=t,o.list_id=i.id_,i.lists.push(o)}))})),this.$nextTick((function(){i.nowpriceinfo=JSON.parse(JSON.stringify(i.pageinfo.list[i.nowspec])),i.setConfirmBtnTitle(),i.updataformat(),console.log(i.pageinfo)}))},updataformat:function(){var i=this;this.pageinfo.properties_list.forEach((function(s,t){i.nowpriceinfo.properties.forEach((function(t,o){t.id_==s.id_&&(1==t.num?s.lists.forEach((function(t,o){0==o?(t.ischeck=!0,i.nowformat=i.nowformat+s.id_+"_"+t.id+"_"):t.ischeck=!1})):s.lists.forEach((function(s,t){s.ischeck=!1,i.nowformat=""})))})),i.$set(i.pageinfo.properties_list,t,s)}))},getselectInfo:function(i){console.log(this.pageinfo.subsidiary_piece)},selectspec:function(i,s){var t=this;this.nowspec="",this.nowformat="",this.pageinfo.spec_list.forEach((function(o,n){i==n&&(o.list.forEach((function(i,t){i.ischeck=s==t})),t.$set(t.pageinfo.spec_list,n,o))})),this.$nextTick((function(){t.getnowspecFnc("spec")}))},getnowspecFnc:function(i){1==this.nowSpecStatus&&this.onlySpecchange(),2==this.nowSpecStatus&&this.onlyFormatchange(),3==this.nowSpecStatus&&(this.nowspec="",this.nowformat="",this.bothHas(i))},onlySpecchange:function(){var i=this;this.pageinfo.spec_list.forEach((function(s,t){s.list.forEach((function(s,t){s.ischeck&&(i.nowspec=i.nowspec+s.id_+"_")}))})),this.$nextTick((function(){i.nowpriceinfo=JSON.parse(JSON.stringify(i.pageinfo.list[i.nowspec])),i.setConfirmBtnTitle(),i.$emit("selectpro",i.nowpriceinfo)}))},onlyFormatchange:function(){var i=this;this.nowformat="",this.nowspec="",this.pageinfo.properties_list.forEach((function(s,t){s.lists.forEach((function(t,o){t.ischeck&&(i.nowformat=i.nowformat+s.id_+"_"+t.id+"_")}))})),this.$nextTick((function(){console.log(i.nowformat),console.log(i.nowpriceinfo)}))},bothHas:function(i){var s=this;this.pageinfo.spec_list.forEach((function(i,t){i.list.forEach((function(i,t){i.ischeck&&(s.nowspec=s.nowspec+i.id_+"_")}))})),this.pageinfo.properties_list.forEach((function(i,t){i.lists.forEach((function(t,o){t.ischeck&&(s.nowformat=s.nowformat+i.id_+"_"+t.id+"_")}))})),this.$nextTick((function(){s.nowpriceinfo=JSON.parse(JSON.stringify(s.pageinfo.list[s.nowspec])),s.nowpriceinfo.formatList=[],s.setConfirmBtnTitle(),s.$emit("selectpro",s.nowpriceinfo),"spec"==i&&s.updataformat()}))},selectpro:function(i,s){var t=this;3==this.nowSpecStatus?this.pageinfo.properties_list.forEach((function(o,n){i==n&&(console.log(i),t.nowpriceinfo.properties.forEach((function(i,e){if(i.id_==o.id_){if(1==i.num)console.log(i),o.lists.forEach((function(i,t){i.ischeck=s==t}));else if(i.num>1){var c=o.lists.filter((function(i){return i.ischeck}));o.lists.forEach((function(o,n){s==n&&(o.ischeck?o.ischeck=!1:c.length<i.num?o.ischeck=!0:t.$message.error(t.L("该属性最多可选X1个",{X1:c.length})+"!"))}))}else o.lists.forEach((function(i,t){s==t&&(i.ischeck=!i.ischeck),console.log(111)}));t.$set(t.pageinfo.properties_list,n,o)}})))})):this.pageinfo.properties_list.forEach((function(o,n){if(console.log(i),i==n){if(1==o.num)o.lists.forEach((function(i,t){i.ischeck=s==t}));else if(o.num>1){var e=o.lists.filter((function(i){return i.ischeck}));console.log(e),o.lists.forEach((function(i,t){s==t&&(i.ischeck?i.ischeck=!1:e.length<o.num&&(i.ischeck=!0))}))}else o.lists.forEach((function(i,t){s==t&&(i.ischeck=!i.ischeck)}));t.$set(t.pageinfo.properties_list,n,o)}})),this.getnowspecFnc()},getuniqueness:function(){var i=this;this.uniqueness_number=this.productId+"_",this.pageinfo.spec_list&&this.pageinfo.spec_list.length&&this.pageinfo.spec_list.forEach((function(s,t){s.list.forEach((function(t,o){if(t.ischeck){var n={type:"spec"};n.name=t.name,n.spec_id=s.id_,n.id=t.id_,i.uniqueness_number+=s.id_+"_"+t.id_+"_",i.productParam.push(n)}}))})),this.pageinfo.properties_list&&this.pageinfo.properties_list.length&&this.pageinfo.properties_list.forEach((function(s,t){console.log(s);var o={type:"properties",data:[]};s.lists.forEach((function(t,n){if(t.ischeck){var e={};e.id=t.id,e.list_id=s.id_,e.name=t.name,i.uniqueness_number+=s.id_+"_"+t.id+"_",o.data.push(e)}})),i.productParam.push(o)})),this.pageinfo.subsidiary_piece&&this.pageinfo.subsidiary_piece.length&&this.pageinfo.subsidiary_piece.forEach((function(s,t){s.goods.forEach((function(s,t){s.counts>0&&(s.has_spec||s.has_format||(i.uniqueness_number+=s.product_id+"_",i.uniqueness_number+=s.counts+"_"),s.has_spec&&!s.has_format&&s.allSelect.forEach((function(t,o){t.counts>0&&(i.uniqueness_number+=s.product_id+"_",t.spec.forEach((function(s,t){i.uniqueness_number+=s.spec_val_sid+"_"+s.spec_val_id+"_"})),i.uniqueness_number+=t.counts+"_")})),!s.has_spec&&s.has_format&&s.allSelect.forEach((function(t,o){t.formatList.length>0&&t.formatList.forEach((function(t,o){t.counts>0&&(i.uniqueness_number+=s.product_id+"_",t.specId?i.uniqueness_number+=t.specId+"_"+t.counts+"_":i.uniqueness_number+=t.counts+"_",console.log(i.uniqueness_number))}))})),s.has_spec&&s.has_format&&(console.log(s,"全都有的附属菜"),s.allSelect.forEach((function(t,o){t.counts>0&&(i.uniqueness_number+=s.product_id+"_",t.spec.forEach((function(s,t){i.uniqueness_number+=s.spec_val_sid+"_"+s.spec_val_id+"_"})),i.uniqueness_number+=t.counts+"_"),t.formatList.length>0&&t.formatList.forEach((function(t,o){t.counts>0&&(i.uniqueness_number+=s.product_id+"_",t.spec.forEach((function(s,t){i.uniqueness_number+=s.spec_val_sid+"_"+s.spec_val_id+"_"})),i.uniqueness_number+=t.specId+"_"+t.counts+"_")}))}))))}))})),console.log(this.uniqueness_number)},getproductParam:function(){var i=this;console.log("getproductParam"),console.log(this.pageinfo.subsidiary_piece,"subsidiary_piece"),this.pageinfo.subsidiary_piece&&this.pageinfo.subsidiary_piece.length&&this.pageinfo.subsidiary_piece.forEach((function(s,t){s.goods.forEach((function(s,t){if(s.counts>0){if(!s.has_spec&&!s.has_format){console.log(s,"什么都没有的菜品");var o={};i.pageinfo.is_package_goods&&(o.package_id=i.pageinfo.product_id),o.productId=s.product_id,o.productName=s.product_name,o.productPrice=s.product_price,o.count=s.counts,o.host_goods_id=i.pageinfo.is_subsidiary_goods?i.pageinfo.product_id:"",o.uniqueness_number=i.uniqueness_number,o.productParam=[],i.allGoodsList.push(o)}s.has_spec&&!s.has_format&&(console.log(s,"只有规格的商品"),s.allSelect.forEach((function(t,o){if(t.counts>0){var n={};n.productId=s.product_id,n.productName=s.product_name,n.productPrice=t.price,n.count=t.counts,n.host_goods_id=i.pageinfo.product_id,n.uniqueness_number=i.uniqueness_number,n.productParam=[],t.spec.forEach((function(i,s){var t={type:"spec"};t.name=i.spec_val_name,t.spec_id=i.spec_val_sid,t.id=i.spec_val_id,n.productParam.push(t),console.log(n)})),i.allGoodsList.push(n)}}))),!s.has_spec&&s.has_format&&(console.log(s,"只有属性的商品"),s.allSelect.forEach((function(t,o){t.formatList&&t.formatList.forEach((function(t,o){if(t.counts>0){var n={};n.productId=s.product_id,n.productName=s.product_name,n.productPrice=s.product_price,n.count=t.counts,n.host_goods_id=i.pageinfo.product_id,n.uniqueness_number=i.uniqueness_number,n.productParam=[],t.counts>0&&t.selectformat&&t.selectformat.forEach((function(i,s){var t={type:"properties",data:[]};i.forEach((function(i){var s={};s.id=i.id,s.list_id=i.list_id,s.name=i.name,t.data.push(s)})),n.productParam.push(t)})),i.allGoodsList.push(n)}}))}))),s.has_spec&&s.has_format&&(console.log(s,"啥都有的附属菜"),s.allSelect.forEach((function(t,o){if(t.counts>0){var n={};n.productName=s.product_name,n.productId=s.product_id,n.productPrice=t.price,n.count=t.counts,n.host_goods_id=i.pageinfo.product_id,n.uniqueness_number=i.uniqueness_number,n.productParam=[],t.spec.forEach((function(i,s){var t={type:"spec"};t.name=i.spec_val_name,t.spec_id=i.spec_val_sid,t.id=i.spec_val_id,n.productParam.push(t),console.log(n)})),i.allGoodsList.push(n)}t.formatList&&t.formatList.forEach((function(t,o){if(t.counts>0){var n={};n.productId=s.product_id,n.productName=s.product_name,n.productPrice=t.price,n.count=t.counts,n.host_goods_id=i.pageinfo.product_id,n.uniqueness_number=i.uniqueness_number,n.productParam=[],t.spec.forEach((function(i,s){var t={type:"spec"};t.name=i.spec_val_name,t.spec_id=i.spec_val_sid,t.id=i.spec_val_id,n.productParam.push(t),console.log(n)})),t.selectformat&&t.selectformat.forEach((function(i,s){if(i){var t={type:"properties",data:[]};i.forEach((function(i){var s={};s.id=i.id,s.list_id=i.list_id,s.name=i.name,t.data.push(s)})),n.productParam.push(t)}})),i.allGoodsList.push(n)}}))})))}}))}))},saveInfo:function(i){var s=this;this.pageinfo.subsidiary_piece.forEach((function(t,o){t.id_sp==i.id_sp&&(t=i,s.$set(s.pageinfo.subsidiary_piece,o,t))}))},addanimate:function(){var i=this;this.loadingdata=!0,this.pageinfo="",this.nowspec="",this.nowformat="",this.getfoodDetails(),this.animateshow=!0,setTimeout((function(){i.animateshow=!1}),500)}}}),c=e,a=(t("a6c9"),t("0c7c")),r=Object(a["a"])(c,o,n,!1,null,"6b012ad0",null);s["default"]=r.exports},a6c9:function(i,s,t){"use strict";t("b39d")},b39d:function(i,s,t){}}]);