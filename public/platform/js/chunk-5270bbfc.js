(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-5270bbfc","chunk-34fd56e3","chunk-2d0dd3b1"],{"2fa1":function(t,e,a){"use strict";a.r(e);var i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"package-list ant-pro-page-header-wrap-children-content",staticStyle:{margin:"24px 0 0"}},[a("a-collapse",{attrs:{accordion:""}},[a("a-collapse-panel",{key:"1",attrs:{header:"操作说明"}},[a("p",[t._v(" 新版收费生效后，抄表录入统一由水电燃气收费项的收费标准进行管理设置，移动端及后台录入抄表数据交互不变，所有的抄表记录及生成的账单数据可汇总查询。"),a("br"),t._v(" 1、仅展示当前有正在生效的收费标准的收费项目，若没有，则该页为空白页；"),a("br"),t._v(" 2、收费项目在物业管理平台设置；"),a("br"),t._v(" 3、在抄表管理支持户录入抄表单和导入抄表单。"),a("br")])])],1),a("a-card",{attrs:{bordered:!1}},[a("a-table",{attrs:{columns:t.columns,"data-source":t.list,pagination:t.pagination},on:{change:t.tableChange},scopedSlots:t._u([{key:"director_manage",fn:function(e,i){return a("span",{},[a("a",{on:{click:function(e){return t.$refs.directorModel.get(i.project_id)}}},[t._v("负责人管理")])])}},{key:"action",fn:function(e,i){return a("span",{},[a("a",{on:{click:function(e){return t.$refs.addMeter.add(i.project_name,i.rule_name,i.unit_price,i.rate,i.charge_type,i.rule_id,i.project_id)}}},[t._v("录入用量")]),a("a-divider",{attrs:{type:"vertical"}}),a("a",{on:{click:function(e){return t.$refs.recordModel.get(i.charge_name,i.project_id)}}},[t._v("抄表记录")]),a("a-divider",{attrs:{type:"vertical"}}),a("a",{on:{click:function(e){return t.setMeterReading(i)}}},[t._v("抄表设置")])],1)}}])})],1),a("meter-director-list",{ref:"directorModel"}),a("meter-record-list",{ref:"recordModel"}),a("add-meter",{ref:"addMeter",on:{getMeterProject:t.getMeterProject}}),a("a-modal",{attrs:{title:"编辑缴费周期",width:500,visible:t.mRvisible,maskClosable:!1,confirmLoading:t.confirmLoading},on:{ok:t.handleMrSubmit,cancel:t.handleMrCancel}},[a("a-form-model",{attrs:{labelCol:t.labelCol,wrapperCol:t.wrapperCol}},[a("a-form-model-item",{attrs:{label:"缴费时间"}},[t._v(" 每月 "),a("a-input-number",{staticStyle:{width:"100px"},attrs:{placeholder:"缴费时间",min:0,max:30},model:{value:t.mday,callback:function(e){t.mday=e},expression:"mday"}}),t._v(" 号进行抄表 "),a("span",{staticStyle:{color:"red"}},[t._v("*必填项（0表示关闭缴费时间）")])],1)],1)],1)],1)},n=[],o=(a("7d24"),a("dfae")),r=a("a0e0"),s=a("99a6"),l=a("0b52"),c=a("b794"),d=a("ca00"),u={components:{MeterDirectorList:s["default"],MeterRecordList:l["default"],addMeter:c["default"],"a-collapse":o["a"],"a-collapse-panel":o["a"].Panel},data:function(){var t=this;return{labelCol:{span:6},wrapperCol:{span:16},list:[],pagination:{current:1,pageSize:10,total:10,showSizeChanger:!0,pageSizeOptions:["10","20","50","100"],showTotal:function(t){return"共 ".concat(t," 条")},onShowSizeChange:function(e,a){return t.onTableChange(e,a)},onChange:function(e,a){return t.onTableChange(e,a)}},page:1,tokenName:"",sysName:"",confirmLoading:!1,mday:0,mRvisible:!1,mRrecord:{}}},mounted:function(){var t=Object(d["i"])(location.hash);t?(this.tokenName=t+"_access_token",this.sysName=t):this.sysName="village",this.getMeterProject()},computed:{columns:function(){var t=[{title:"收费项目",dataIndex:"project_name",key:"project_name"},{title:"收费所属类别",dataIndex:"subject_name",key:"subject_name"},{title:"当前生效标准",dataIndex:"rule_name",key:"rule_name"},{title:"负责人管理",dataIndex:"",key:"director_manage",scopedSlots:{customRender:"director_manage"}},{title:"操作",key:"action",dataIndex:"",scopedSlots:{customRender:"action"}}];return t}},methods:{getMeterProject:function(){var t=this;this.request(r["a"].getMeterProject,{page:this.page,limit:this.pagination.pageSize,tokenName:this.tokenName}).then((function(e){console.log("res",e),t.list=e.list,t.pagination.total=e.count?e.count:0,t.pagination.pageSize=e.total_limit?e.total_limit:10}))},onTableChange:function(t,e){this.page=t,this.pagination.current=t,this.pagination.pageSize=e,this.getMeterProject()},setMeterReading:function(t){this.mRrecord=t,this.mday=t.mday,this.mRvisible=!0},handleMrSubmit:function(){var t=this;if(this.mday>30||this.mday<0)return this.$message.error("缴费时间,请设置在0到30之间的数字"),!1;this.request(r["a"].setMeterReadingDay,{mday:this.mday,project_id:this.mRrecord.project_id,subject_id:this.mRrecord.subject_id,tokenName:this.tokenName}).then((function(e){t.$message.success("保存成功！"),t.getMeterProject(),t.handleMrCancel()}))},handleMrCancel:function(){this.mRvisible=!1,this.mRrecord={},this.mday=0},tableChange:function(t){t.current&&t.current>0&&(this.page=t.current,this.getMeterProject())}}},p=u,h=a("0c7c"),m=Object(h["a"])(p,i,n,!1,null,"fd8b48e8",null);e["default"]=m.exports},8102:function(t,e,a){"use strict";a.r(e);var i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("a-modal",{attrs:{width:1e3,title:t.title,visible:t.visible_director,maskClosable:!1,"confirm-loading":t.confirmLoading},on:{cancel:t.handleCancel,ok:t.handleOk}},[a("a-spin",{attrs:{spinning:t.confirmLoading,height:800}},[a("a-form",{attrs:{form:t.form}},[a("a-form-item",{attrs:{label:"负责人",labelCol:t.labelCol,wrapperCol:t.wrapperCol}},[a("a-select",{staticStyle:{width:"30%"},attrs:{placeholder:"请选择"},on:{change:t.select_director},model:{value:t.name,callback:function(e){t.name=e},expression:"name"}},t._l(t.work_list,(function(e){return a("a-select-option",{key:e},[t._v(" "+t._s(e.name)+" ")])})),1)],1),a("a-form-item",{attrs:{label:"负责人手机号",labelCol:t.labelCol,wrapperCol:t.wrapperCol}},[a("a-col",{attrs:{span:18}},[a("a-input",{staticStyle:{width:"300px"},attrs:{maxLength:10,disabled:"disabled"},model:{value:t.phone,callback:function(e){t.phone=e},expression:"phone"}})],1),a("a-col",{attrs:{span:6}})],1),a("a-form-item",{attrs:{label:"提醒时间",labelCol:t.labelCol,wrapperCol:t.wrapperCol}},[a("span",[t._v("将在")]),t._v("   "),a("a-select",{staticStyle:{width:"120px"},attrs:{"default-value":"1"},model:{value:t.day,callback:function(e){t.day=e},expression:"day"}},[a("a-select-option",{attrs:{value:1}},[t._v(" 01 ")]),a("a-select-option",{attrs:{value:2}},[t._v(" 02 ")]),a("a-select-option",{attrs:{value:3}},[t._v(" 03 ")]),a("a-select-option",{attrs:{value:4}},[t._v(" 04 ")]),a("a-select-option",{attrs:{value:5}},[t._v(" 05 ")]),a("a-select-option",{attrs:{value:6}},[t._v(" 06 ")]),a("a-select-option",{attrs:{value:7}},[t._v(" 07 ")]),a("a-select-option",{attrs:{value:8}},[t._v(" 08 ")]),a("a-select-option",{attrs:{value:9}},[t._v(" 09 ")]),a("a-select-option",{attrs:{value:10}},[t._v(" 10 ")]),a("a-select-option",{attrs:{value:11}},[t._v(" 11 ")]),a("a-select-option",{attrs:{value:12}},[t._v(" 12 ")]),a("a-select-option",{attrs:{value:13}},[t._v(" 13 ")]),a("a-select-option",{attrs:{value:14}},[t._v(" 14 ")]),a("a-select-option",{attrs:{value:15}},[t._v(" 15 ")]),a("a-select-option",{attrs:{value:16}},[t._v(" 16 ")]),a("a-select-option",{attrs:{value:17}},[t._v(" 17 ")]),a("a-select-option",{attrs:{value:18}},[t._v(" 18 ")]),a("a-select-option",{attrs:{value:19}},[t._v(" 19 ")]),a("a-select-option",{attrs:{value:20}},[t._v(" 20 ")]),a("a-select-option",{attrs:{value:21}},[t._v(" 21 ")]),a("a-select-option",{attrs:{value:22}},[t._v(" 22 ")]),a("a-select-option",{attrs:{value:23}},[t._v(" 23 ")]),a("a-select-option",{attrs:{value:24}},[t._v(" 24 ")]),a("a-select-option",{attrs:{value:25}},[t._v(" 25 ")]),a("a-select-option",{attrs:{value:26}},[t._v(" 26 ")]),a("a-select-option",{attrs:{value:27}},[t._v(" 27 ")]),a("a-select-option",{attrs:{value:28}},[t._v(" 28 ")]),a("a-select-option",{attrs:{value:29}},[t._v(" 29 ")]),a("a-select-option",{attrs:{value:30}},[t._v(" 30 ")])],1),a("span",[t._v("日")]),a("a-time-picker",{attrs:{format:"HH:mm",value:t.moment(t.dateDay,"HH:mm")},on:{change:t.onChange}}),a("span",[t._v("发送模板消息给工作人员")])],1),a("a-form-item",{attrs:{label:"状态",labelCol:t.labelCol,wrapperCol:t.wrapperCol,required:!0}},[a("a-col",{attrs:{span:18}},[a("a-radio-group",{model:{value:t.status,callback:function(e){t.status=e},expression:"status"}},[a("a-radio",{attrs:{value:1}},[t._v("正常")]),a("a-radio",{attrs:{value:2}},[t._v("禁止")])],1)],1)],1)],1)],1)],1)},n=[],o=(a("b0c0"),a("c1df")),r=a.n(o),s=a("a0e0"),l=a("ca00"),c={data:function(){return{visible_director:!1,labelCol:{xs:{span:24},sm:{span:7}},wrapperCol:{xs:{span:24},sm:{span:13}},confirmLoading:!1,form:this.$form.createForm(this),project_id:0,dateFormat:"YYYY-MM-DD",dateDay:"09:00",day:1,title:"添加负责人",work_list:[],worker_id:"",phone:"",status:1,time:"2021-7-30",name:"",id:0,tokenName:"",sysName:""}},methods:{onChange:function(t,e){null==t&&(e="00:00"),this.dateDay=e,this.$forceUpdate()},select_director:function(t){this.phone=t.phone,this.worker_id=t.wid,this.name=t.name},moment:r.a,add:function(t){var e=Object(l["i"])(location.hash);e?(this.tokenName=e+"_access_token",this.sysName=e):this.sysName="village",this.title="添加负责人",this.project_id=t,this.getWorkers(),this.visible_director=!0,this.id=0},edit:function(t,e){var a=Object(l["i"])(location.hash);a?(this.tokenName=a+"_access_token",this.sysName=a):this.sysName="village",this.title="编辑负责人",this.project_id=t,this.id=e,this.getWorkers(),this.getWorkerInfo(),this.visible_director=!0},getWorkerInfo:function(){var t=this;this.request(s["a"].getWorkerInfo,{id:this.id,tokenName:this.tokenName}).then((function(e){t.status=e.status,t.name=e.name,t.phone=e.phone,t.worker_id=e.worker_id,t.dateDay=e.dateDay,t.day=e.day}))},getWorkers:function(){var t=this;this.request(s["a"].getWorkers,{tokenName:this.tokenName}).then((function(e){t.work_list=e}))},handleCancel:function(){this.visible_director=!1},handleOk:function(){var t=this;this.id>0?this.request(s["a"].saveMeterDirector,{id:this.id,worker_id:this.worker_id,name:this.name,phone:this.phone,status:this.status,dateDay:this.dateDay,day:this.day,tokenName:this.tokenName}).then((function(e){t.$message.success("修改成功"),t.$emit("getMeterDirectorList"),t.visible_director=!1})):this.request(s["a"].addMeterDirector,{project_id:this.project_id,worker_id:this.worker_id,name:this.name,phone:this.phone,status:this.status,dateDay:this.dateDay,day:this.day,tokenName:this.tokenName}).then((function(e){t.$message.success("添加成功"),t.$emit("getMeterDirectorList"),t.visible_director=!1}))}}},d=c,u=a("0c7c"),p=Object(u["a"])(d,i,n,!1,null,"d0a07172",null);e["default"]=p.exports},"99a6":function(t,e,a){"use strict";a.r(e);var i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("a-drawer",{attrs:{width:1e3,title:"负责人列表",visible:t.visible,maskClosable:!1,"confirm-loading":t.confirmLoading},on:{close:t.handleCancel}},[a("div",{staticClass:"package-list ant-pro-page-header-wrap-children-content",staticStyle:{margin:"24px 0 0"}},[a("a-button",{staticClass:"margin_top_20",attrs:{type:"primary"},on:{click:function(e){return t.$refs.addDirectorModel.add(t.project_id)}}},[t._v(" 添加 ")]),a("a-card",{attrs:{bordered:!1}},[a("a-table",{attrs:{columns:t.columns,"data-source":t.list,pagination:t.pagination},on:{change:t.tableChange},scopedSlots:t._u([{key:"action",fn:function(e,i){return a("span",{},[a("a",{on:{click:function(e){return t.$refs.addDirectorModel.edit(t.project_id,i.id)}}},[t._v("修改")]),a("a-divider",{attrs:{type:"vertical"}}),a("a-popconfirm",{staticClass:"ant-dropdown-link",staticStyle:{"margin-left":"10px"},attrs:{title:"确认删除?","ok-text":"是","cancel-text":"否"},on:{confirm:function(e){return t.del_director(i.id)}}},[a("a",[t._v("删除")])])],1)}},{key:"status",fn:function(e,i){return a("span",{},[1==i.status?a("span",{staticStyle:{color:"dodgerblue"}},[t._v("正常")]):a("span",{staticStyle:{color:"red"}},[t._v("禁止")])])}}])})],1),a("add-director",{ref:"addDirectorModel",on:{getMeterDirectorList:t.getMeterDirectorList}})],1)])},n=[],o=a("a0e0"),r=a("8102"),s=a("ca00"),l={components:{AddDirector:r["default"]},data:function(){var t=this;return{visible:!1,confirmLoading:!1,list:[],pagination:{current:1,pageSize:10,total:10,showSizeChanger:!0,pageSizeOptions:["10","20","50","100"],showTotal:function(t){return"共 ".concat(t," 条")},onShowSizeChange:function(e,a){return t.onTableChange(e,a)},onChange:function(e,a){return t.onTableChange(e,a)}},page:1,project_id:0,tokenName:"",sysName:""}},mounted:function(){var t=Object(s["i"])(location.hash);t?(this.tokenName=t+"_access_token",this.sysName=t):this.sysName="village"},computed:{columns:function(){var t=[{title:"负责人姓名",dataIndex:"name",key:"name"},{title:"负责人手机号",dataIndex:"phone",key:"phone"},{title:"提醒时间",dataIndex:"notice_time_txt",key:"notice_time_txt"},{title:"添加时间",dataIndex:"add_time_txt",key:"add_time_txt"},{title:"状态",dataIndex:"status",scopedSlots:{customRender:"status"}},{title:"操作",key:"action",dataIndex:"",scopedSlots:{customRender:"action"}}];return t}},created:function(){},methods:{del_director:function(t){var e=this;this.request(o["a"].delMeterDirector,{id:t,tokenName:this.tokenName}).then((function(t){e.$message.success("删除成功"),e.getMeterDirectorList()}))},get:function(t){this.project_id=t,this.getMeterDirectorList(),this.visible=!0},getMeterDirectorList:function(){var t=this;this.request(o["a"].getMeterDirectorList,{page:this.page,limit:this.pagination.pageSize,project_id:this.project_id,tokenName:this.tokenName}).then((function(e){console.log("res",e),t.list=e.list,t.pagination.total=e.count?e.count:0,t.pagination.pageSize=e.total_limit?e.total_limit:10}))},onTableChange:function(t,e){this.page=t,this.pagination.current=t,this.pagination.pageSize=e,this.getMeterDirectorList(),console.log("onTableChange==>",t,e)},tableChange:function(t){t.current&&t.current>0&&(this.page=t.current,this.getMeterDirectorList())},handleCancel:function(){this.visible=!1}}},c=l,d=a("0c7c"),u=Object(d["a"])(c,i,n,!1,null,"559e47a8",null);e["default"]=u.exports}}]);