(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-41ca8670","chunk-3969b952","chunk-17930014","chunk-e64d175e"],{"2a4e":function(t,e,i){},"2b23":function(t,e,i){"use strict";i("9a85")},"2e92":function(t,e,i){"use strict";i.r(e);var a=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("a-drawer",{attrs:{title:t.title,width:1200,visible:t.visible,maskClosable:!1,confirmLoading:t.loading},on:{close:t.handleCancel}},[i("div",{staticStyle:{"background-color":"white"}},["park_new"!=t.charge_type?i("span",{staticClass:"page_top"},[t._v(" 1、列表展示当前收费标准名称已经绑定的所有房间/车位信息；"),i("br"),t._v(" 2、通过在房产的房间筛选楼栋、单元、楼层、房间信息进行查询绑定对象；"),i("br"),t._v(" 3、通过在车场的所属车库、车位号筛选功能，查询车辆绑定对象；"),i("br"),i("span",{staticStyle:{color:"red"}},[t._v(" 注意：全选框只能选中当前页的所有绑定对象，如需选中绑定对象，需要每页都选中全选框绑定 ")])]):i("span",{staticClass:"page_top"},[t._v(" 1、列表展示当前收费标准名称已经绑定的所有车位信息；"),i("br"),t._v(" 2、通过在车场的所属车库、车位号筛选功能，查询车辆绑定对象；"),i("br"),i("span",{staticStyle:{color:"red"}},[t._v(" 注意：全选框只能选中当前页的所有绑定对象，如需选中绑定对象，需要每页都选中全选框绑定 ")])]),i("a-tabs",{attrs:{active:t.active},on:{change:t.callback}},["park_new"!=t.charge_type?i("a-tab-pane",{key:"1",attrs:{tab:"房产"}},[i("div",{staticClass:"order-list-box"},[i("div",{staticClass:"search-box",staticStyle:{display:"flex"}},[i("label",{staticStyle:{"margin-top":"5px"}},[t._v("房间：")]),i("a-cascader",{staticClass:"cascader_style margin_left_10",attrs:{options:t.options,"load-data":t.loadDataFunc,placeholder:"请选择房间","change-on-select":""},on:{change:t.setVisionsFunc},model:{value:t.search.vacancy,callback:function(e){t.$set(t.search,"vacancy",e)},expression:"search.vacancy"}}),i("a-button",{staticStyle:{"margin-left":"10px"},attrs:{type:"primary",icon:"search"},on:{click:function(e){return t.searchList()}}},[t._v(" 查询 ")]),i("a-button",{staticStyle:{"margin-left":"10px"},on:{click:function(e){return t.clearList()}}},[t._v(" 清空 ")])],1),i("div",{staticClass:"table-operator",staticStyle:{margin:"10px 1px 10px"}},[i("a-button",{attrs:{type:"primary"},on:{click:function(e){return t.$refs.AddBindModel.add(t.rule_id,"1")}}},[t._v("绑定房间")]),i("a-button",{staticStyle:{"margin-left":"10px"},attrs:{type:"primary"},on:{click:function(e){return t.$refs.AddVacancyModel.add(t.rule_id,"bind_room")}}},[t._v("批量绑定")]),i("a-button",{staticStyle:{"margin-left":"10px"},attrs:{type:"primary"},on:{click:function(e){return t.$refs.OrderLogModel.add(t.rule_id,"1")}}},[t._v("查看账单生成结果")]),i("a-popconfirm",{staticClass:"ant-dropdown-link",staticStyle:{"margin-left":"10px"},attrs:{title:"确认解绑?","ok-text":"是","cancel-text":"否"},on:{confirm:function(e){return t.unbindAll(1)},cancel:t.cancel}},[i("a-button",{attrs:{type:"primary"}},[t._v("批量解绑")])],1)],1),i("a-table",{staticClass:"components-table-demo-nested",attrs:{columns:t.columns,"data-source":t.data,"row-selection":t.rowSelection,rowKey:"id",pagination:t.pagination},on:{change:t.table_change},scopedSlots:t._u([{key:"action",fn:function(e,a){return i("span",{},[i("a-popconfirm",{staticClass:"ant-dropdown-link",attrs:{title:"确认解绑?","ok-text":"是","cancel-text":"否"},on:{confirm:function(e){return t.bind(a.id,1)},cancel:t.cancel}},[i("a",{attrs:{href:"#"}},[t._v("解绑")])])],1)}}],null,!1,598916438)})],1)]):t._e(),t.no_paking_bind?t._e():i("a-tab-pane",{key:"2",attrs:{tab:"车场","force-render":""}},[i("div",{staticClass:"order-list-box"},[i("div",{staticClass:"search-box",staticStyle:{display:"flex"}},[i("label",{staticStyle:{"margin-top":"5px"}},[t._v("所属车库：")]),i("a-select",{staticStyle:{width:"200px","margin-left":"10px"},attrs:{"default-value":"0",placeholder:"请选择车库"},model:{value:t.search1.garage_id,callback:function(e){t.$set(t.search1,"garage_id",e)},expression:"search1.garage_id"}},[i("a-select-option",{attrs:{value:0}},[t._v(" 全部 ")]),t._l(t.garage_list,(function(e,a){return i("a-select-option",{key:a,attrs:{value:e.garage_id}},[t._v(" "+t._s(e.garage_num)+" ")])}))],2),i("label",{staticStyle:{"margin-top":"5px","margin-left":"10px"}},[t._v("车位号：")]),i("a-input",{staticStyle:{width:"200px","margin-left":"10px"},attrs:{placeholder:"请输入车位号"},model:{value:t.search1.position_num,callback:function(e){t.$set(t.search1,"position_num",e)},expression:"search1.position_num"}}),i("a-button",{staticStyle:{"margin-left":"10px"},attrs:{type:"primary",icon:"search"},on:{click:function(e){return t.searchList()}}},[t._v(" 查询 ")]),i("a-button",{staticStyle:{"margin-left":"10px"},on:{click:function(e){return t.clearList()}}},[t._v(" 清空 ")])],1),i("div",{staticClass:"table-operator",staticStyle:{margin:"10px 1px 10px"}},[i("a-button",{attrs:{type:"primary"},on:{click:function(e){return t.$refs.AddBindModel.add(t.rule_id,"2",t.charge_type)}}},[t._v("绑定车位")]),"park_new"==t.charge_type?i("a-button",{staticStyle:{"margin-left":"10px"},attrs:{type:"primary"},on:{click:function(e){return t.$refs.AddVacancyModel.add(t.rule_id,"bind_car")}}},[t._v("批量绑定")]):t._e(),i("a-button",{staticStyle:{"margin-left":"10px"},attrs:{type:"primary"},on:{click:function(e){return t.$refs.OrderLogModel.add(t.rule_id,"2")}}},[t._v("查看账单生成结果")]),i("a-popconfirm",{staticClass:"ant-dropdown-link",staticStyle:{"margin-left":"10px"},attrs:{title:"确认解绑?","ok-text":"是","cancel-text":"否"},on:{confirm:function(e){return t.unbindAll(2)},cancel:t.cancel}},[i("a-button",{attrs:{type:"primary"}},[t._v("批量解绑")])],1)],1),i("a-table",{staticClass:"components-table-demo-nested",attrs:{columns:t.columns1,"data-source":t.data1,"row-selection":t.rowSelection1,rowKey:"id",pagination:t.pagination1},on:{change:t.table_change1},scopedSlots:t._u([{key:"action",fn:function(e,a){return i("span",{},[i("a-popconfirm",{staticClass:"ant-dropdown-link",attrs:{title:"确认解绑?","ok-text":"是","cancel-text":"否"},on:{confirm:function(e){return t.bind(a.id,2)},cancel:t.cancel}},[i("a",{attrs:{href:"#"}},[t._v("解绑")])])],1)}}],null,!1,2108261493)})],1)])],1),i("addBindList",{ref:"AddBindModel",on:{ok:t.bindOk}}),i("order-log-list",{ref:"OrderLogModel",on:{ok:t.bindOk}}),i("addVacancyBind",{ref:"AddVacancyModel",on:{ok:t.bindOk}})],1)])},n=[],s=i("2909"),o=i("c7eb"),r=i("1da1"),l=(i("ac1f"),i("841c"),i("d81d"),i("b0c0"),i("d3b7"),i("7db0"),i("4de4"),i("a0e0")),c=i("f7de"),d=i("307f"),u=i("9642"),p=[{title:"楼号",dataIndex:"single_name",key:"single_name"},{title:"单元名称",dataIndex:"floor_name",key:"floor_name"},{title:"层号",dataIndex:"layer_name",key:"layer_name"},{title:"房间号",dataIndex:"room",key:"room"},{title:"收费周期",dataIndex:"cycle",key:"cycle"},{title:"账单生成时间",dataIndex:"order_add_time",key:"order_add_time"},{title:"账单生成周期模式",dataIndex:"date_status",key:"date_status"},{title:"操作",key:"action",dataIndex:"",scopedSlots:{customRender:"action"}}],h=[{title:"车位号",dataIndex:"position_num",key:"position_num"},{title:"所属车库",dataIndex:"garage_num",key:"garage_num"},{title:"收费周期",dataIndex:"cycle",key:"cycle"},{title:"账单生成时间",dataIndex:"order_add_time",key:"order_add_time"},{title:"账单生成周期模式",dataIndex:"date_status",key:"date_status"},{title:"操作",key:"action",dataIndex:"",scopedSlots:{customRender:"action"}}],g={name:"bingList",data:function(){var t=this;return{title:"绑定",key:1,active:1,data:[],data1:[],rule_id:0,pagination:{current:1,pageSize:10,total:10,showSizeChanger:!0,pageSizeOptions:["10","20","50","100"],showTotal:function(t){return"共 ".concat(t," 条")},onShowSizeChange:function(e,i){return t.onTableChange(e,i)},onChange:function(e,i){return t.onTableChange(e,i)}},pagination1:{current:1,pageSize:10,total:10,showSizeChanger:!0,pageSizeOptions:["10","20","50","100"],showTotal:function(t){return"共 ".concat(t," 条")},onShowSizeChange:function(e,i){return t.onTableChange1(e,i)},onChange:function(e,i){return t.onTableChange1(e,i)}},search_data:[],search:{page:1},search_data1:[],search1:{page:1},form:this.$form.createForm(this),visible:!1,loading:!1,columns:p,columns1:h,page:1,page1:1,position_id:[],vacancy_id:[],village_list:[],single_list:[],floor_list:[],layer_list:[],vacancy_list:[],garage_list:[],options:[],selectedRowKeys:[],selectedRowKeys1:[],charge_type:"",recordObj:{},no_paking_bind:!1}},components:{OrderLogList:u["default"],addBindList:c["default"],addVacancyBind:d["default"]},computed:{rowSelection:function(){return{selectedRowKeys:this.selectedRowKeys,onChange:this.onSelectChange}},rowSelection1:function(){return{selectedRowKeys:this.selectedRowKeys1,onChange:this.onSelectChange1}}},methods:{list:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};console.log("record",i),this.title="绑定【"+i.charge_number_name+"-"+i.project_name+"-"+i.charge_name+"】",this.recordObj=i,this.charge_type=e,"park_new"==this.charge_type&&(this.key=2),"public_water"!=this.charge_type&&"public_electric"!=this.charge_type||(this.no_paking_bind=!0),this.loading=!0,this.visible=!0,this.rule_id=t,this.page=1,this.page1=1,this.search["page"]=1,this.search1["page"]=1,this.active=1,this.selectedRowKeys=[],this.selectedRowKeys1=[],this.vacancy_id=[],this.position_id=[],this.getBindList(),this.getGarageList(),this.getSingleListByVillage()},getBindList:function(){var t=this,e={};1==this.key?(this.search["page"]=this.page,this.search["limit"]=this.pagination.pageSize,this.search.bind_type=this.key,this.search.rule_id=this.rule_id,e=this.search):(this.search1["page"]=this.page1,this.search1["limit"]=this.pagination1.pageSize,this.search1.bind_type=this.key,this.search1.rule_id=this.rule_id,e=this.search1),"park_new"==this.charge_type&&(this.search.bind_type=2),this.request(l["a"].standardBindList,e).then((function(e){console.log("res",e),t.selectedRowKeys=[],t.selectedRowKeys1=[],t.vacancy_id=[],t.position_id=[],1==t.key?(t.pagination.total=e.count?e.count:0,t.pagination.pageSize=e.total_limit?e.total_limit:0,t.data=e.list):(t.pagination1.total=e.count?e.count:0,t.pagination1.pageSize=e.total_limit?e.total_limit:0,t.data1=e.list)}))},getGarageList:function(){var t=this;this.request(l["a"].garageList).then((function(e){console.log("garage_list",e),t.garage_list=e})).catch((function(e){t.loading=!1}))},clearList:function(){this.search={page:1,vacancy:""},this.search1={page:1,position_num:"",garage_id:0},this.getBindList()},getSingleListByVillage:function(){var t=this;this.request(l["a"].getSingleListByVillage).then((function(e){if(console.log("+++++++Single",e),e){var i=[];e.map((function(t){i.push({label:t.name,value:t.id,isLeaf:!1})})),t.options=i}}))},getFloorList:function(t){var e=this;return new Promise((function(i){e.request(l["a"].getFloorList,{pid:t}).then((function(t){console.log("+++++++Single",t),console.log("resolve",i),i(t)}))}))},getLayerList:function(t){var e=this;return new Promise((function(i){e.request(l["a"].getLayerList,{pid:t}).then((function(t){console.log("+++++++Single",t),t&&i(t)}))}))},getVacancyList:function(t){var e=this;return new Promise((function(i){e.request(l["a"].getVacancyList,{pid:t}).then((function(t){console.log("+++++++Single",t),t&&i(t)}))}))},loadDataFunc:function(t){return Object(r["a"])(Object(o["a"])().mark((function e(){var i;return Object(o["a"])().wrap((function(e){while(1)switch(e.prev=e.next){case 0:i=t[t.length-1],i.loading=!0,setTimeout((function(){i.loading=!1}),100);case 3:case"end":return e.stop()}}),e)})))()},setVisionsFunc:function(t){var e=this;return Object(r["a"])(Object(o["a"])().mark((function i(){var a,n,r,l,c,d,u,p,h,g,f,_;return Object(o["a"])().wrap((function(i){while(1)switch(i.prev=i.next){case 0:if(1!==t.length){i.next=12;break}return a=Object(s["a"])(e.options),i.next=4,e.getFloorList(t[0]);case 4:n=i.sent,console.log("res",n),r=[],n.map((function(t){return r.push({label:t.name,value:t.id,isLeaf:!1}),a["children"]=r,!0})),a.find((function(e){return e.value===t[0]}))["children"]=r,e.options=a,i.next=36;break;case 12:if(2!==t.length){i.next=24;break}return i.next=15,e.getLayerList(t[1]);case 15:l=i.sent,c=Object(s["a"])(e.options),d=[],l.map((function(t){return d.push({label:t.name,value:t.id,isLeaf:!1}),!0})),u=c.find((function(e){return e.value===t[0]})),u.children.find((function(e){return e.value===t[1]}))["children"]=d,e.options=c,i.next=36;break;case 24:if(3!==t.length){i.next=36;break}return i.next=27,e.getVacancyList(t[2]);case 27:p=i.sent,h=Object(s["a"])(e.options),g=[],p.map((function(t){return g.push({label:t.name,value:t.id,isLeaf:!0}),!0})),f=h.find((function(e){return e.value===t[0]})),_=f.children.find((function(e){return e.value===t[1]})),_.children.find((function(e){return e.value===t[2]}))["children"]=g,e.options=h,console.log("_this.options",e.options);case 36:case"end":return i.stop()}}),i)})))()},bindOk:function(t,e){console.log("rule_id",t),this.key=e,this.active=e,this.rule_id=t,this.getBindList(),this.selectedRowKeys=[],this.selectedRowKeys1=[],this.vacancy_id=[],this.position_id=[]},bind:function(t,e){var i=this;console.log("type",e),console.log("id",t),this.request(l["a"].delStandardBind,{bind_id:t}).then((function(t){console.log("res",t),i.key=e,i.getBindList(),i.selectedRowKeys=[],i.selectedRowKeys1=[],i.vacancy_id=[],i.position_id=[]}))},unbindAll:function(t){var e=this;1==t?0==this.selectedRowKeys.length?this.$message.error("请勾选需解绑的房间"):this.selectedRowKeys.filter((function(i,a){e.request(l["a"].delStandardBind,{bind_id:i}).then((function(i){console.log("res",i),e.key=t,e.getBindList(),delete e.selectedRowKeys[a]}))})):0==this.selectedRowKeys1.length?this.$message.error("请勾选需解绑的车位"):this.selectedRowKeys1.filter((function(i,a){e.request(l["a"].delStandardBind,{bind_id:i}).then((function(i){console.log("res",i),e.key=t,e.getBindList(),delete e.selectedRowKeys1[a]}))}))},handleCancel:function(){var t=this;this.selectedRowKeys=[],this.selectedRowKeys1=[],this.vacancy_id=[],this.position_id=[],this.visible=!1,this.no_paking_bind=!1,setTimeout((function(){t.rule_id="0",t.form=t.$form.createForm(t)}),500)},cancel:function(){},callback:function(t){this.key=t,this.getBindList(),console.log(t)},onSelectChange:function(t,e){console.log("selectedRowKeys: ".concat(t),"selectedRows: ",e),this.vacancy_id=e,this.selectedRowKeys=t,console.log("villagess",this.vacancy_id)},onSelectChange1:function(t,e){console.log("selectedRowKeys: ".concat(t),"selectedRows: ",e),this.position_id=e,this.selectedRowKeys1=t,console.log("villagess",this.position_id)},searchList:function(){console.log("search",this.search),this.page=1,this.page1=1,this.getBindList()},onTableChange:function(t,e){this.page=t,this.pagination.current=t,this.pagination.pageSize=e,this.getBindList(),console.log("onTableChange==>",t,e)},onTableChange1:function(t,e){this.page1=t,this.pagination1.current=t,this.pagination1.pageSize=e,this.getBindList(),console.log("onTableChange==>",t,e)},table_change:function(t){console.log("e",t),t.current&&t.current>0&&(this.page=t.current,this.data=[],this.getBindList())},table_change1:function(t){console.log("e",t),t.current&&t.current>0&&(this.page1=t.current,this.data1=[],this.getBindList())}}},f=g,_=(i("bb7e"),i("0c7c")),m=Object(_["a"])(f,a,n,!1,null,null,null);e["default"]=m.exports},"307f":function(t,e,i){"use strict";i.r(e);var a=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("a-modal",{attrs:{title:t.title,width:950,visible:t.visible,maskClosable:!1,confirmLoading:t.confirmLoading},on:{ok:function(e){return t.handleSubmit(t.bind_type)},cancel:t.handleCancel}},[i("span",{staticClass:"page_top"},[i("span",{staticClass:"notice"},[t._v(" 注意："),i("br"),t._v(" 1、在绑定车库时，默认选中车库内所有车位号数据"),i("br")])]),i("a-spin",{attrs:{spinning:t.confirmLoading,height:800}},[i("a-form",{attrs:{form:t.form}},[t._l(t.index_row,(function(e,a){return t.loadingLayer&&"bind_room"==t.bind_type?i("div",{staticClass:"form_box"},[i("a-row",{staticStyle:{"margin-left":"1px"},attrs:{gutter:48}},[i("a-col",{staticStyle:{"padding-left":"1px","padding-right":"1px",width:"250px"},attrs:{md:8,sm:24}},[i("label",{staticStyle:{"margin-top":"5px"}},[t._v("选择楼栋：")]),i("a-select",{staticStyle:{width:"170px"},attrs:{placeholder:"请选择楼栋"},on:{change:function(i){return t.singleChange(e.single_id,a)}},model:{value:e.single_id,callback:function(i){t.$set(e,"single_id",i)},expression:"item.single_id"}},[i("a-select-option",{attrs:{value:0}},[t._v(" 请选择楼栋 ")]),t._l(t.single,(function(e,a){return i("a-select-option",{key:a,attrs:{value:e.id}},[t._v(" "+t._s(e.name)+" ")])}))],2)],1),i("a-col",{staticStyle:{"padding-right":"1px",width:"270px"},attrs:{md:8,sm:24}},[i("label",{staticStyle:{"margin-top":"5px"}},[t._v("对应单元：")]),i("a-select",{staticStyle:{width:"170px"},attrs:{placeholder:"请选择单元"},on:{change:function(i){return t.singleFloorChange(e.single_id,e.floor_id,a)}},model:{value:e.floor_id,callback:function(i){t.$set(e,"floor_id",i)},expression:"item.floor_id"}},[i("a-select-option",{attrs:{value:0}},[t._v(" 请选择单元 ")]),t._l(t.floor[e.single_id],(function(e,a){return i("a-select-option",{key:a,attrs:{value:e.floor_id}},[t._v(" "+t._s(e.name)+" ")])}))],2)],1),i("a-col",{staticStyle:{"padding-right":"1px",width:"330px"},attrs:{md:9,sm:24}},[i("label",{staticStyle:{"margin-top":"5px"}},[t._v("对应楼层：")]),i("a-select",{staticStyle:{width:"220px"},attrs:{placeholder:"请选择楼层",mode:"multiple"},model:{value:e.layer_id,callback:function(i){t.$set(e,"layer_id",i)},expression:"item.layer_id"}},t._l(t.layer[e.floor_id],(function(e,a){return i("a-select-option",{key:a,attrs:{value:e.id}},[t._v(" "+t._s(e.name)+" ")])})),1)],1),a>0?i("a-col",{staticClass:"icon_1",staticStyle:{"padding-right":"1px","padding-left":"1px"},on:{click:function(e){return t.del_row(a)}}},[i("a-icon",{attrs:{type:"minus"}})],1):t._e()],1)],1):t._e()})),t._l(t.index_row,(function(e,a){return t.loadingLayer&&"bind_car"==t.bind_type?i("div",{staticClass:"form_box"},[i("a-row",{staticStyle:{"margin-left":"1px"},attrs:{gutter:48}},[i("a-col",{staticStyle:{"padding-left":"1px","padding-right":"1px",width:"500px"},attrs:{md:8,sm:24}},[i("label",{staticStyle:{"margin-top":"5px"}},[t._v("选择车库：")]),i("a-select",{staticStyle:{width:"200px"},attrs:{"default-value":"0",placeholder:"请选择车库"},model:{value:t.garage_ids[a],callback:function(e){t.$set(t.garage_ids,a,e)},expression:"garage_ids[index]"}},t._l(t.garage_list,(function(e,a){return i("a-select-option",{key:a,attrs:{value:e.garage_id}},[t._v(" "+t._s(e.garage_num)+" ")])})),1)],1),a>0?i("a-col",{staticClass:"icon_1",staticStyle:{"padding-right":"1px","padding-left":"1px"},on:{click:function(e){return t.del_row(a)}}},[i("a-icon",{attrs:{type:"minus"}})],1):t._e()],1)],1):t._e()})),i("div",{staticClass:"icon_1 margin_top_10",on:{click:t.add_row}},[i("a-icon",{attrs:{type:"plus"}})],1)],2),i("addBindInfo",{ref:"AddBindModel",on:{ok:t.bindOk}})],1)],1)},n=[],s=(i("a434"),i("a0e0")),o=i("b74f"),r="",l={data:function(){return{title:"新建",labelCol:{xs:{span:24},sm:{span:7}},wrapperCol:{xs:{span:24},sm:{span:13}},index_row:[{id:0,single_id:0,floor_id:0,layer_id:[]}],single_id:0,layer_id:0,layer:[],single:[],confirmLoading:!1,form:this.$form.createForm(this),visible:!1,loadingLayer:!1,rule_id:0,rule_info:[],address:r,garage_list:[],bind_type:"",floor:[],floor_id:0,garage_ids:[]}},components:{addBindInfo:o["default"]},mounted:function(){this.getGarageList()},methods:{add:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";this.title="确定绑定",this.visible=!0,this.loadingLayer=!0,this.layer=[],this.single=[],this.bind_type=e,this.index_row=[{id:0,single_id:0,floor_id:0,layer_id:[]}],this.confirmLoading=!1,this.rule_id=t,this.getSingle(),this.getRuleInfo()},add_row:function(){var t={id:0,single_id:0,floor_id:0,layer_id:[]};this.index_row.push(t)},getSingle:function(){var t=this;this.request(s["a"].getSingleListByVillage).then((function(e){console.log("resSingle",e),t.single=e}))},getRuleInfo:function(){var t=this;this.request(s["a"].getRuleInfo,{rule_id:this.rule_id}).then((function(e){t.rule_info=e,console.log("rule_info",e)}))},getGarageList:function(){var t=this;this.request(s["a"].garageList).then((function(e){console.log("garage_list",e),t.garage_list=e}))},del_row:function(t){console.log("index",t),this.index_row.splice(t,1),"bind_car"==this.bind_type&&(this.garage_ids[t]="")},singleChange:function(t,e){var i=this;if(console.log("Selected: ".concat(t)),this.index_row[e].layer_id=[],this.index_row[e].floor_id=0,t<1)return console.log("singleChange=============layer",this.layer),console.log("singleChange=============index_row",this.index_row),!1;this.loadingLayer=!1,this.request(s["a"].getFloorList,{pid:t}).then((function(e){i.floor[t]=e,console.log("floor1",i.floor),i.loadingLayer=!0,i.$forceUpdate()}))},singleFloorChange:function(t,e,i){var a=this;this.index_row[i].layer_id=[],this.loadingLayer=!1,this.floor_id=1*e,console.log("index_row",this.index_row,"floor_id",e),this.request(s["a"].getLayerSingleList,{pid:t,single_id:t,floor_id:e}).then((function(t){console.log("resLayer",t),a.layer[a.floor_id]=t,a.loadingLayer=!0}))},bindCar:function(){var t=this,e={};e.rule_id=this.rule_id,e.garage_id=this.garage_ids,this.request(s["a"].addBindAllPosition,e).then((function(e){t.$message.success("绑定成功"),setTimeout((function(){t.form=t.$form.createForm(t),t.garage_ids=[],t.visible=!1,t.loading=!1,t.$emit("ok",t.rule_id,"1")}),1500)})),console.log(this.garage_ids)},addBind:function(){var t=this,e={bind_type:2};e.rule_id=this.rule_id,e.pigcms_arr=this.index_row,this.confirmLoading=!0,this.request(s["a"].addStandardBind,e).then((function(e){if(console.log("resx",e),1e3==e.status&&e.msg)t.$message.error(e.msg),t.confirmLoading=!1;else if(e.err_count){var i="绑定失败"+e.err_count+"个";e.errMsgStr?i=i+"【错误："+e.errMsgStr+"】":e.errMsgArr&&e.errMsgArr[0]&&e.errMsgArr[0]["msg"]&&(i=i+"【错误："+e.errMsgArr[0]["msg"]+"】"),t.$message.warning(i),e.success_count?(t.$message.warning("绑定成功"+e.success_count+"个"),setTimeout((function(){t.confirmLoading=!1,t.form=t.$form.createForm(t),t.visible=!1,t.loading=!1,t.$emit("ok",t.rule_id,"1")}),1500)):t.confirmLoading=!1}else{var a="绑定成功";e.msg&&(a=e.msg),t.$message.success(a),setTimeout((function(){t.confirmLoading=!1,t.form=t.$form.createForm(t),t.visible=!1,t.loading=!1,t.$emit("ok",t.rule_id,"1")}),1500)}}))},handleSubmit:function(t){if(console.log("index_row111",this.index_row),1==this.rule_info.is_show)this.$refs.AddBindModel.add(2,this.rule_info,this.index_row,[]);else{var e=this;this.$confirm({title:"是否确认绑定?",okText:"确定",okType:"danger",cancelText:"取消",onOk:function(){"bind_car"==t?e.bindCar():e.addBind()}})}},handleCancel:function(){var t=this;this.visible=!1,this.confirmLoading=!1,setTimeout((function(){t.form=t.$form.createForm(t)}),500)},bindOk:function(){this.form=this.$form.createForm(this),this.visible=!1,this.loading=!1,this.$emit("ok",this.rule_id,"1")}}},c=l,d=(i("b21f"),i("2b23"),i("0c7c")),u=Object(d["a"])(c,a,n,!1,null,"7e4b322c",null);e["default"]=u.exports},"44a8":function(t,e,i){"use strict";i.r(e);var a=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("a-modal",{attrs:{title:t.title,width:900,visible:t.visible,maskClosable:!1,confirmLoading:t.confirmLoading},on:{ok:t.handleSubmit,cancel:t.handleCancel}},[i("a-spin",{attrs:{spinning:t.confirmLoading,height:800}},[i("a-form",{staticClass:"project_info",attrs:{form:t.form}},[0==t.post.id?i("a-form-item",{attrs:{label:"",labelCol:t.labelCol,wrapperCol:t.wrapperCol,required:!0}},[i("span",{staticClass:"label_col ant-form-item-required"},[t._v("所属收费科目")]),i("a-select",{directives:[{name:"decorator",rawName:"v-decorator",value:["post.subject_id",{rules:[{required:!0,message:t.L("请选择收费科目！")}]}],expression:"['post.subject_id',{rules: [{ required: true, message: L('请选择收费科目！') }] }]"}],staticStyle:{width:"300px !important"},attrs:{placeholder:"请选择所属收费科目"},on:{change:t.handleChange}},t._l(t.sensitive_info,(function(e,a){return i("a-select-option",{key:a,attrs:{value:e.id+","+e.status+","+e.type}},[t._v(" "+t._s(e.name)+" ")])})),1)],1):i("a-form-item",{attrs:{label:"",labelCol:t.labelCol,wrapperCol:t.wrapperCol}},[i("span",{staticClass:"label_col"},[t._v("所属收费科目")]),i("span",[t._v(" "+t._s(t.post.subject_name))])]),i("a-form-item",{attrs:{label:"",required:!0,labelCol:t.labelCol,wrapperCol:t.wrapperCol}},[i("a-col",{attrs:{span:30}},[i("span",{staticClass:"label_col ant-form-item-required"},[t._v("收费项目名称")]),i("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["post.name",{initialValue:t.post.name,rules:[{required:!0,message:t.L("请输入名称！")}]}],expression:"['post.name',{ initialValue: post.name, rules: [{ required: true, message: L('请输入名称！') }] }]"}],staticStyle:{width:"300px"},attrs:{maxLength:30,placeholder:"请输入名称"}})],1),i("a-col",{attrs:{span:6}})],1),i("a-form-item",{attrs:{label:"",labelCol:t.labelCol,wrapperCol:t.wrapperCol,required:!0}},[i("span",{staticClass:"label_col ant-form-item-required"},[t._v("收费项目图标")]),i("a-upload",{directives:[{name:"decorator",rawName:"v-decorator",value:["post.img",{initialValue:t.post.img,rules:[{required:!0,message:t.L("请上传图片！")}]}],expression:"['post.img',{ initialValue: post.img,rules: [{ required: true, message: L('请上传图片！') }]}]"}],staticClass:"avatar-uploader",attrs:{name:"img","list-type":"picture-card","show-upload-list":!1,action:t.upload_url,"before-upload":t.beforeUpload},on:{change:t.imgChange}},[t.imgUrl?i("img",{staticClass:"imgname",attrs:{src:t.imgUrl,alt:"img"}}):i("div",[i("a-icon",{attrs:{type:t.uploadLoading?"uploadLoading":"plus"}}),i("div",{staticClass:"ant-upload-text"},[t._v(" 上传 ")])],1)]),i("span",[t._v("建议尺寸：80*80px")])],1),t.typeStatus&&"park_new"!=t.feeType&&"pile"!=t.feeType?i("a-form-item",{attrs:{label:"",labelCol:t.labelCol,wrapperCol:t.wrapperCol}},[i("a-col",{attrs:{span:30}},[i("span",{staticClass:"label_col"},[t._v("收费模式")]),i("a-radio-group",{attrs:{disabled:t.is_disabled},on:{change:t.chargingMode},model:{value:t.post.type,callback:function(e){t.$set(t.post,"type",e)},expression:"post.type"}},[i("a-radio",{attrs:{value:1}},[t._v("一次性费用")]),"qrcode"!=t.feeType?i("a-radio",{attrs:{value:2}},[t._v("周期性费用")]):t._e(),t.type_show?i("a-radio",{attrs:{value:3}},[t._v("押金")]):t._e()],1)],1)],1):t._e(),1===t.post.type||"park_new"==t.feeType||"pile"==t.feeType?i("a-form-item",{attrs:{label:"",labelCol:t.labelCol,wrapperCol:t.wrapperCol}},[i("a-col",{attrs:{span:30}},[i("span",{staticClass:"label_col"},[t._v("一次性费用退款期限")]),t._v(" 收款后 "),i("a-input-number",{directives:[{name:"decorator",rawName:"v-decorator",value:["post.refund_period",{initialValue:t.post.refund_period}],expression:"['post.refund_period',{ initialValue: post.refund_period }]"}],staticStyle:{width:"120px"},attrs:{max:9999,placeholder:"请输入天数",precision:0,min:0}}),t._v(" (天)内可进行退款 "),i("a-tooltip",{attrs:{placement:"right"}},[i("template",{slot:"title"},[i("span",[t._v("获取收费设置已缴账单退款期限，已缴账单缴费时间超过该天数则不能进行退款，不填或0则默认不能进行退款,最大填写9999。")])]),i("span",{staticClass:"help-icon"},[t._v("?")])],2)],1),i("a-col",{attrs:{span:6}})],1):t._e(),t.type_show?i("a-form-item",{attrs:{label:"",labelCol:t.labelCol,wrapperCol:t.wrapperCol}},[i("a-col",{attrs:{span:30}},[i("span",{staticClass:"label_col"},[t._v("押金费用退款期限")]),t._v(" 收款后 "),i("a-input-number",{directives:[{name:"decorator",rawName:"v-decorator",value:["post.refund_period",{initialValue:t.post.refund_period}],expression:"['post.refund_period',{ initialValue: post.refund_period }]"}],staticStyle:{width:"120px"},attrs:{max:9999,placeholder:"请输入天数",precision:0,min:0}}),t._v(" (天)后可进行退款 "),i("a-tooltip",{attrs:{placement:"right"}},[i("template",{slot:"title"},[i("span",[t._v("获取收费设置已缴账单退款期限，已缴账单缴费时间超过该天数才能进行退款（不填或默认值的情况），填写后以在押金选项设置的值为准")])]),i("span",{staticClass:"help-icon"},[t._v("?")])],2)],1),i("a-col",{attrs:{span:6}})],1):t._e(),i("a-form-item",{attrs:{label:"",labelCol:t.labelCol,wrapperCol:t.wrapperCol}},[i("span",{staticClass:"label_col"},[t._v("状态")]),i("a-radio-group",{directives:[{name:"decorator",rawName:"v-decorator",value:["post.status",{initialValue:t.post.status}],expression:"['post.status', {initialValue:post.status}]"}]},[i("a-radio",{attrs:{value:1}},[t._v(" 开启 ")]),i("a-radio",{attrs:{value:2}},[t._v(" 关闭 ")])],1)],1)],1)],1)],1)},n=[],s=(i("b0c0"),i("a0e0")),o=i("567c");function r(t,e){var i=new FileReader;i.addEventListener("load",(function(){return e(i.result)})),i.readAsDataURL(t)}var l={components:{},data:function(){return{title:"新建",labelCol:{xs:{span:24},sm:{span:7}},wrapperCol:{xs:{span:24},sm:{span:13}},confirmLoading:!1,form:this.$form.createForm(this),sensitive_info:[],visible:!1,type_show:!1,post:{id:0,type:1,refund_period:0,status:"",name:"",subject_id:"",subject_name:"",img:""},uploadLoading:!1,upload_url:"/v20/public/index.php/"+o["a"].uploadMeeting,imgUrl:"",typeStatus:!1,is_disabled:!1,min_refund_period:0,feeType:""}},mounted:function(){},methods:{handleChange:function(t){var e=this,i=t.split(",");this.typeStatus=i[1]>0,"deposit_new"==i[2]?(this.type_show=!0,this.post.type=3,this.is_disabled=!0):(this.type_show=!1,this.is_disabled=!1,this.post.type=1),console.log("type_1",this.post.type),this.feeType=i[2],this.request(s["a"].ChargeProjectIcon,{type:i[2]}).then((function(t){e.imgUrl=t,e.post.img=t}))},imgChange:function(t){var e=this;"uploading"!==t.file.status?"done"===t.file.status&&(r(t.file.originFileObj,(function(t){e.imgUrl=t,e.uploadLoading=!1})),1e3===t.file.response.status&&(this.post.img=t.file.response.data)):this.uploadLoading=!0},beforeUpload:function(t){var e="image/jpeg"===t.type||"image/png"===t.type;e||this.$message.error("图片仅支持png/jpg");var i=t.size/1024/1024<2;return i||this.$message.error("图片必须小于2MB"),e&&i},add:function(){var t=this;this.title="添加",this.visible=!0,this.post={id:0,type:2,status:1,refund_period:0,name:"",subject_id:"",subject_name:"",img:""},this.typeStatus=!1,this.imgUrl="",this.is_disabled=!1,this.type_show=!1,this.chargeSetInfo(),this.request(s["a"].getChargeSubject).then((function(e){t.sensitive_info=e}))},edit:function(t){var e=this;this.title="编辑",this.visible=!0,this.post.id=t,this.imgUrl="",this.typeStatus=!1,this.is_disabled=!0,this.type_show=!1,this.getEditInfo(),this.request(s["a"].getChargeSubject).then((function(t){e.sensitive_info=t}))},delete:function(t){},handleSubmit:function(){var t=this,e=this.form.validateFields;this.confirmLoading=!0,e((function(e,i){if(e)t.confirmLoading=!1;else{var a=s["a"].ChargeProjectAdd;if(t.post.id>0)a=s["a"].ChargeProjectSub,i.post.id=t.post.id;else{var n=i.post.subject_id.split(",");i.post.subject_id=n[0]}if(i.post.refund_period>0&&i.post.refund_period<t.min_refund_period)return t.$message.error("退款期限不能小于收费设置的退款期限"),t.confirmLoading=!1,!1;i.post.type=t.post.type,i.post.img=t.post.img,"park_new"!=t.feeType&&"pile"!=t.feeType||(i.post.type=1),t.request(a,i.post).then((function(e){t.post.id>0?t.$message.success("编辑成功"):t.$message.success("添加成功"),setTimeout((function(){t.form=t.$form.createForm(t),t.visible=!1,t.confirmLoading=!1,console.log(123),t.$emit("ok")}),1500),console.log(345)})).catch((function(e){t.confirmLoading=!1}))}}))},handleCancel:function(){var t=this;this.visible=!1,setTimeout((function(){t.post.id=0,t.feeType="",t.form=t.$form.createForm(t)}),500)},getEditInfo:function(){var t=this;this.request(s["a"].ChargeProjectEdit,{id:this.post.id}).then((function(e){t.post={id:e.id,type:e.type,status:e.status,name:e.name,subject_name:e.subject_name,refund_period:e.refund_period,img:e.img},3===e.type&&(t.type_show=!0),t.typeStatus=e.typeStatus,t.imgUrl=e.img,t.chargeSetInfo()}))},chargingMode:function(t){this.post.type=t.target.value},chargeSetInfo:function(){var t=this;this.request(s["a"].chargeSetInfo).then((function(e){0!==e.length&&(t.min_refund_period=e.refund_term,console.log(t.post.refund_period),console.log(t.min_refund_period),t.post.refund_period>0&&t.post.refund_period<t.min_refund_period&&(t.$notification["warning"]({message:"注意",description:"当前退款期限小于收费设置的退款期限，已自动更新当前退款期限。"}),t.post.refund_period=t.min_refund_period))}))}}},c=l,d=(i("831e"),i("0c7c")),u=Object(d["a"])(c,a,n,!1,null,"76cabbea",null);e["default"]=u.exports},5355:function(t,e,i){"use strict";i.r(e);var a=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("a-modal",{attrs:{title:t.title,width:800,visible:t.visible,maskClosable:!1,confirmLoading:t.confirmLoading},on:{ok:function(e){return t.handleSubmit()},cancel:t.handleCancel}},[i("span",{staticClass:"page_top"},[i("span",{staticClass:"notice"},[t._v(" 注意："),i("br"),t._v(" 1、需要先在收费标准绑定页面，绑定房间数据。绑定成功后在进行操作生成账单"),i("br"),t._v(" 2、手动生成账单是给已绑定该收费标准的房间，批量生成待缴账单"),i("br")])]),i("a-spin",{attrs:{spinning:t.confirmLoading,height:800}},[i("div",[t._v("请点击确定按钮给已绑定房间的【"+t._s(t.charge_name)+"】标准生成账单")])])],1)},n=[],s=(i("a434"),i("a0e0")),o={data:function(){return{title:"新建",labelCol:{xs:{span:24},sm:{span:7}},wrapperCol:{xs:{span:24},sm:{span:13}},index_row:[{id:0}],single_id:0,floor_id:0,floor:[],single:[],confirmLoading:!1,form:this.$form.createForm(this),visible:!1,loadingLayer:!1,rule_id:0,rule_info:[],bind_type:"",charge_name:""}},components:{},mounted:function(){},methods:{add:function(t,e){this.title="给已绑定该标准的房间手动批量生成账单",e&&(this.title="给已绑定【"+e+"】手动批量生成账单"),this.charge_name=e,this.visible=!0,this.loadingLayer=!0,this.single=[],this.floor_id=0,this.floor=[],this.single_id=0,this.index_row=[{id:0,single_id:0,floor_id:[]}],this.confirmLoading=!1,this.rule_id=t,this.getSingle(),this.getRuleInfo()},add_row:function(){if(this.index_row.length>=5)return this.$message.error("最多每次添加5条数据操作"),!1;var t={id:0,single_id:0,floor_id:[]};this.index_row.push(t)},getSingle:function(){var t=this;this.request(s["a"].getSingleListByVillage).then((function(e){console.log("resSingle",e),t.single=e}))},getRuleInfo:function(){var t=this;this.request(s["a"].getRuleInfo,{rule_id:this.rule_id}).then((function(e){t.rule_info=e,console.log("rule_info",e)}))},del_row:function(t){t>0&&this.index_row.splice(t,1)},singleChange:function(t,e){var i=this;if(console.log("value: ".concat(t)),console.log("index: ".concat(e)),this.index_row[e].floor_id=[],t<1)return!1;console.log("floor0",this.floor),this.loadingLayer=!1,this.request(s["a"].getFloorList,{pid:t}).then((function(e){i.floor[t]=e,console.log("floor1",i.floor),i.loadingLayer=!0,i.$forceUpdate()}))},addBind:function(){var t=this,e={};e.rule_id=this.rule_id,e.create_order=1,e.single_data=this.index_row,this.confirmLoading=!0,this.request(s["a"].standardCreateManyOrderByRuleId,e).then((function(e){if(console.log("resx",e),1e3==e.status&&e.msg)t.$message.error(e.msg),t.confirmLoading=!1;else{var i="操作成功！";i=e.standard_bind_count<1?"此标准还没有绑定房间！":"已成功生成"+e.ordercount+"个待缴账单",t.$message.success(i),setTimeout((function(){t.confirmLoading=!1,t.form=t.$form.createForm(t),t.visible=!1,t.loading=!1,t.$emit("ok",t.rule_id)}),1500)}}))},handleSubmit:function(t){var e=this;this.$confirm({title:"是否确定手动批量生成账单?",okText:"确定",okType:"danger",cancelText:"取消",onOk:function(){e.addBind()},onCancel:function(){}})},handleCancel:function(){var t=this;this.visible=!1,this.index_row=[{id:0,single_id:0,floor_id:[]}],this.floor=[],this.confirmLoading=!1,setTimeout((function(){t.form=t.$form.createForm(t)}),500)}}},r=o,l=(i("69d9"),i("abf8"),i("0c7c")),c=Object(l["a"])(r,a,n,!1,null,"7d8b802f",null);e["default"]=c.exports},"5d94":function(t,e,i){},"5fbb":function(t,e,i){},"69d9":function(t,e,i){"use strict";i("2a4e")},8090:function(t,e,i){},"831e":function(t,e,i){"use strict";i("8090")},"95f9":function(t,e,i){"use strict";i.r(e);var a=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"message-suggestions-list-box"},[i("div",{staticClass:"search-box"},[i("div",{staticClass:"message-tips-box"},[i("a-collapse",{attrs:{accordion:""}},[i("a-collapse-panel",{key:"1",attrs:{header:"操作说明"}},[i("p",[t._v(" 在收费项目管理模块，需根据物业后台添加的收费科目创建所需的收费项目，并且根据收费项目创建不同的收费标准，收费标准支持多种收费模式设置，每个收费标准可单独或批量绑定到房间/车位。"),i("br"),t._v(" 1、在收费项目管理模块，创建收费项目时没有收费科目选项。需要到【物业平台】去创建收费科目。"),i("br"),t._v(" 2、在创建好收费项目，进入【收费标准管理】页面创建收费标准。"),i("br"),t._v(" 3、在创建收费标准时，进入【预缴周期管理】页面创建预缴周期。"),i("br"),t._v(" 4、在创建好的收费标准，进入【绑定费用对象】页面绑定房间/车位信息，每个收费标准可单独或批量绑定到房间/车位。"),i("br"),t._v(" 5、删除收费标准时，会将该收费标准对应已绑定的房间和车场解除绑定，以及对应的未缴费账单会变更为作废账单。"),i("br"),i("br"),t._v(" 例：当前有收费标准名称为【水费】和【电费】两个收费标准，当删除收费标准名称为【水费】的收费标准时，仅作废【水费】对应的未缴费账单，【电费】对应的未缴费账单不会被作废"),i("br"),t._v(" 再比如水费有高层和底层区别，在创建高层水费和底层水费标准的时候，在不同的收费项目下创建收费标准， 在创建的收费标准来绑定楼层、房间。比如建议一个高层水费和底层水费项目 ")])])],1)],1),i("a-row",{attrs:{gutter:48}},[i("a-col",{attrs:{md:8,sm:24}},[i("a-input-group",{attrs:{compact:""}},[i("p",{staticStyle:{"margin-top":"5px"}},[t._v("项目名称：")]),i("a-input",{staticStyle:{width:"70%"},model:{value:t.search.keyword,callback:function(e){t.$set(t.search,"keyword",e)},expression:"search.keyword"}})],1)],1),i("a-col",{attrs:{md:2,sm:24}},[i("a-button",{attrs:{type:"primary",icon:"search"},on:{click:function(e){return t.searchList()}}},[t._v(" 查询 ")])],1),i("a-col",{attrs:{md:2,sm:24}},[i("a-button",{on:{click:function(e){return t.resetList()}}},[t._v("重置")])],1),t.oldVersion?i("a-button",{staticClass:"lbsf",attrs:{type:"primary"},on:{click:function(e){return t.jumpTo()}}},[t._v(" 老版收费管理 ")]):t._e()],1)],1),i("div",{staticClass:"add-box"},[i("a-row",{attrs:{gutter:48}},[1==t.role_additem?i("a-col",{attrs:{md:8,sm:24}},[i("a-button",{attrs:{type:"primary"},on:{click:function(e){return t.$refs.PopupAddModel.add()}}},[t._v(" 添加 ")])],1):t._e()],1)],1),i("a-table",{staticClass:"components-table-demo-nested",attrs:{columns:t.columns,"data-source":t.data,pagination:t.pagination,loading:t.loading},on:{change:t.table_change},scopedSlots:t._u([{key:"status",fn:function(e,a){return i("span",{},[2==a.status?i("div",{staticStyle:{color:"red"}},[t._v("关闭")]):t._e(),1==a.status?i("div",{staticStyle:{color:"#1890ff"}},[t._v("开启")]):t._e()])}},{key:"standard",fn:function(e,a){return i("span",{},[1==t.role_manageitem?i("a",{on:{click:function(e){return t.changeVisible(a.id,1,a.subject,a.charge_type)}}},[t._v("管理")]):t._e()])}},{key:"action",fn:function(e,a){return i("span",{},["qrcode"==a.charge_type?i("span",{staticClass:"pointer cr-primary",on:{click:function(e){return t.checkQrcode(a.qrcode)}}},[t._v("收费二维码")]):t._e(),"qrcode"==a.charge_type?i("span",[t._v(" | ")]):t._e(),1==t.role_edititem?i("a",{on:{click:function(e){return t.$refs.PopupEditModel.edit(a.id)}}},[t._v("编辑")]):t._e(),1==t.role_edititem&&1==t.role_delitem?i("span",[t._v(" | ")]):t._e(),1==t.role_delitem?i("a-popconfirm",{staticClass:"ant-dropdown-link",attrs:{title:"确认删除该收费项目?","ok-text":"确认删除","cancel-text":"取消"},on:{confirm:function(e){return t.deleteConfirm(a.id)},cancel:t.cancel}},[i("a",{attrs:{href:"#"}},[t._v("删除")])]):t._e()],1)}}])}),i("a-drawer",{attrs:{title:t.drawerTitle,width:"85%",visible:t.visible,"body-style":{paddingBottom:"80px"}},on:{close:t.onClose}},[t.visible?i("ruleList",{ref:"ruleModel",on:{ok:t.ruleList}}):t._e()],1),i("a-modal",{attrs:{title:"收费二维码",centered:"",footer:null},model:{value:t.qrcodeVisible,callback:function(e){t.qrcodeVisible=e},expression:"qrcodeVisible"}},[i("img",{staticClass:"qrcode-img",attrs:{src:t.qrcodeImg}})]),i("projectInfo",{ref:"PopupAddModel",on:{ok:t.addActive}}),i("projectInfo",{ref:"PopupEditModel",on:{ok:t.editActive}})],1)},n=[],s=(i("7d24"),i("dfae")),o=(i("ac1f"),i("841c"),i("a0e0")),r=i("44a8"),l=i("b855"),c=[{title:"项目ID",dataIndex:"id",key:"id"},{title:"收费项目名称",dataIndex:"name",key:"name"},{title:"所属收费科目",dataIndex:"subject",key:"subject"},{title:"收费模式",dataIndex:"type_txt",key:"type_txt"},{title:"收费标准管理",dataIndex:"start_end_time_txt",key:"start_end_time_txt",scopedSlots:{customRender:"standard"}},{title:"状态",dataIndex:"status",key:"status",scopedSlots:{customRender:"status"}},{title:"操作",dataIndex:"operation",key:"operation",scopedSlots:{customRender:"action"}}],d=[],u={name:"projectList",filters:{},components:{projectInfo:r["default"],ruleList:l["default"],"a-collapse":s["a"],"a-collapse-panel":s["a"].Panel},data:function(){var t=this;return{reply_content:"",pagination:{current:1,pageSize:10,total:10,showSizeChanger:!0,pageSizeOptions:["10","20","50","100"],showTotal:function(t){return"共 ".concat(t," 条")},onShowSizeChange:function(e,i){return t.onTableChange(e,i)},onChange:function(e,i){return t.onTableChange(e,i)}},search:{keyword:"",page:1},form:this.$form.createForm(this),visible:!1,loading:!1,data:d,columns:c,oldVersion:"",drawerTitle:"",role_additem:0,role_delitem:0,role_edititem:0,role_manageitem:0,qrcodeVisible:!1,qrcodeImg:""}},activated:function(){this.getList(1)},methods:{jumpTo:function(){var t=this.oldVersion;window.open(t)},onTableChange:function(t,e){this.pagination.current=t,this.pagination.pageSize=e,this.getList(),console.log("onTableChange==>",t,e)},getList:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;this.loading=!0,1==e&&this.$set(this.pagination,"current",1),this.search["page"]=this.pagination.current,this.search["limit"]=this.pagination.pageSize,this.request(o["a"].ChargeProjectList,this.search).then((function(e){t.pagination.total=e.count?e.count:0,t.pagination.pageSize=e.total_limit?e.total_limit:10,t.data=e.list,t.loading=!1,t.oldVersion=e.oldVersion,void 0!=e.role_additem?(t.role_additem=e.role_additem,t.role_delitem=e.role_delitem,t.role_edititem=e.role_edititem,t.role_manageitem=e.role_manageitem):(t.role_additem=1,t.role_delitem=1,t.role_edititem=1,t.role_manageitem=1)}))},addActive:function(t){this.getList(1)},editActive:function(t){this.getList()},ruleList:function(){this.getList()},table_change:function(t){var e=this;console.log("e",t),t.current&&t.current>0&&(e.$set(e.pagination,"current",t.current),e.getList())},searchList:function(){console.log("search",this.search),this.$set(this.pagination,"current",1),this.getList()},resetList:function(){this.$set(this.pagination,"current",1),this.search={keyword:"",page:1},this.getList()},cancel:function(){},deleteConfirm:function(t){var e=this;this.title="删除",this.request(o["a"].deleteProjectId,{id:t}).then((function(t){e.getList(),e.$message.success("删除成功!")}))},onClose:function(){this.visible=!1},changeVisible:function(t,e,i,a){var n=this;this.drawerTitle=i,this.charge_type=a,this.visible=!0,setTimeout((function(){n.$refs.ruleModel.List(t,e,a)}),500)},checkQrcode:function(t){this.qrcodeImg=t,this.qrcodeVisible=!0}}},p=u,h=(i("bbce"),i("0c7c")),g=Object(h["a"])(p,a,n,!1,null,"a895ec52",null);e["default"]=g.exports},9642:function(t,e,i){"use strict";i.r(e);var a=function(){var t=this,e=t.$createElement,i=t._self._c||e;return t.visible?i("a-drawer",{attrs:{title:t.title,width:900,visible:t.visible,maskClosable:!1,confirmLoading:t.loading},on:{close:t.handleCancel}},[i("div",{staticStyle:{"background-color":"white","padding-bottom":"50px"}},[i("div",{staticClass:"order-list-box"},[i("a-table",{staticClass:"components-table-demo-nested",attrs:{columns:t.columns,"data-source":t.data,pagination:t.pagination}})],1)])]):t._e()},n=[],s=(i("ac1f"),i("841c"),i("a0e0"),i("b74f")),o=[{title:"房间号/车位号",dataIndex:"numbers",key:"numbers"},{title:"生成时间",dataIndex:"time",key:"time"},{title:"生成结果",dataIndex:"status",key:"status"},{title:"失败原因",dataIndex:"fail_reason",key:"fail_reason"}],r={name:"OrderLogList",data:function(){var t=this;return{title:"查看账单生成结果",ruleInfo:"",is_show:1,show:!0,dataId:1,data:[],rule_id:0,pagination:{current:1,pageSize:10,total:10,showSizeChanger:!0,pageSizeOptions:["10","20","50","100"],showTotal:function(t){return"共 ".concat(t," 条")},onShowSizeChange:function(e,i){return t.onTableChange(e,i)},onChange:function(e,i){return t.onTableChange(e,i)}},search_data:[],search:{page:1},form:this.$form.createForm(this),visible:!1,loading:!1,columns:o,page:1}},components:{addBindInfo:s["default"]},mounted:function(){this.key=1},computed:{rowSelection:function(){return{selectedRowKeys:this.selectedRowKeys,onChange:this.onSelectChange}}},methods:{add:function(t,e){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";console.log("key==============>",e),this.loading=!1,this.visible=!0,this.rule_id=t,this.page=1,this.search["page"]=1,console.log("key",this.key),this.data=[],this.charge_type=i,console.log("this.charge_type======>",this.charge_type),this.getAddBindList()},getAddBindList:function(){var t=this;this.search["page"]=this.page,this.search["limit"]=this.pagination.pageSize,this.search.rule_id=this.rule_id,this.request("community/village_api.Cashier/getAutoOrderLogList",this.search).then((function(e){console.log("res1=============>",e),t.pagination.total=e.count?e.count:0,t.pagination.pageSize=e.total_limit?e.total_limit:0,t.data=e.list}))},handleCancel:function(){var t=this;this.visible=!1,setTimeout((function(){t.rule_id="0",t.form=t.$form.createForm(t)}),500)},cancel:function(){},onTableChange:function(t,e){this.page=t,this.pagination.current=t,this.pagination.pageSize=e,this.getAddBindList(),console.log("onTableChange==>",t,e)}}},l=r,c=(i("ccc3"),i("0c7c")),d=Object(c["a"])(l,a,n,!1,null,"42b0d838",null);e["default"]=d.exports},"9a85":function(t,e,i){},abf8:function(t,e,i){"use strict";i("fe25")},ad1b:function(t,e,i){},b21f:function(t,e,i){"use strict";i("5fbb")},b45e:function(t,e,i){"use strict";i("ad1b")},b65a:function(t,e,i){},b855:function(t,e,i){"use strict";i.r(e);var a=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"ruleListBox"},[i("a-alert",{staticStyle:{"margin-bottom":"15px","margin-top":"-10px"},attrs:{message:"",type:"info"}},[i("div",{attrs:{slot:"description"},slot:"description"},[i("div",[t._v("删除收费标准时，会将该收费标准对应已绑定的房间和车场解除绑定，以及对应的未缴费账单会变为作废账单。")]),i("div",[t._v("例如：当前有收费标准名称为[水费]和[电费]两个收费标准，当删除收费标准名称为[水费]的收费标准时，仅作废[水费]对应的未缴费账单，[电费]对应的未缴费账单不会被作废")])])]),i("div",{staticClass:"message-suggestions-list-box"},[i("div",{staticClass:"search-box"},[i("a-row",{attrs:{gutter:48}},[i("a-col",{attrs:{md:9,sm:24}},[i("a-input-group",{attrs:{compact:""}},[i("p",{staticStyle:{"margin-top":"5px"}},[t._v("收费标准名称：")]),i("a-input",{staticStyle:{width:"70%"},model:{value:t.search.keyword,callback:function(e){t.$set(t.search,"keyword",e)},expression:"search.keyword"}})],1)],1),i("a-col",{attrs:{md:2,sm:24}},[i("a-button",{attrs:{type:"primary",icon:"search"},on:{click:function(e){return t.searchList()}}},[t._v(" 查询 ")])],1),i("a-col",{attrs:{md:2,sm:24}},[i("a-button",{on:{click:function(e){return t.resetList()}}},[t._v("重置")])],1)],1)],1),i("div",{staticClass:"add-box"},[i("a-row",{attrs:{gutter:48}},[i("a-col",{attrs:{md:8,sm:24}},[i("a-button",{attrs:{type:"primary"},on:{click:function(e){return t.$refs.PopupAddModel.add(t.charge_project_id,"normal",t.charge_type,0)}}},[t._v(" 添加 ")]),t.pagination.total>0&&("public_water"==t.charge_type||"public_electric"==t.charge_type)?i("a-button",{staticStyle:{"margin-left":"25px"},attrs:{type:"primary"},on:{click:function(e){return t.copyAndAddNewRule()}}},[t._v(" 从选中收费标准复制 ")]):t._e()],1)],1)],1),i("a-table",{staticClass:"components-table-demo-nested",attrs:{columns:t.columns,"data-source":t.data,pagination:t.pagination,loading:t.loading,"row-key":function(t){return t.id},"row-selection":t.rowSelection},on:{change:t.table_change},scopedSlots:t._u([{key:"status",fn:function(e,a){return i("span",{},[2==a.status?i("div",{staticStyle:{color:"red"}},[t._v("关闭")]):t._e(),1==a.status?i("div",{staticStyle:{color:"#1890ff"}},[t._v("开启")]):t._e()])}},{key:"standard",fn:function(e,a){return i("span",{},[3!=a.fees_type_status&&"qrcode"!=a.charge_type?i("a",{on:{click:function(e){return t.bindFunc(a)}}},[t._v("绑定")]):t._e(),"qrcode"==a.charge_type?i("span",[t._v("--")]):t._e()])}},{key:"action",fn:function(e,a){return i("span",{},[3!=a.fees_type_status&&1==a.rule_to_order_btn?i("a",{staticStyle:{"margin-right":"15px"},on:{click:function(e){return t.$refs.addVacancyBindToOrder.add(a.id,a.charge_name)}}},[t._v("手动生成账单")]):t._e(),i("a",{on:{click:function(e){return t.$refs.PopupEditModel.edit(a.id)}}},[t._v("编辑")]),i("a-popconfirm",{staticClass:"ant-dropdown-link",staticStyle:{"margin-left":"20px",width:"225px"},attrs:{title:"删除时会影响已绑定的信息和未缴费账单，确认删除?","cancel-text":"否","ok-text":"是"},on:{confirm:function(e){return t.deleteConfirm(a.id)},cancel:t.cancel}},[i("a",{attrs:{href:"#"}},[t._v("删除")])])],1)}}])}),i("ruleInfo",{ref:"PopupAddModel",on:{ok:t.addRule}}),i("ruleInfo",{ref:"PopupEditModel",on:{ok:t.editRule}}),i("bindList",{ref:"BindModel",on:{ok:t.bindOk}}),i("addVacancyBindOrder",{ref:"addVacancyBindToOrder",on:{ok:t.bindOk}})],1)],1)},n=[],s=(i("ac1f"),i("841c"),i("a0e0")),o=i("78bd"),r=i("2e92"),l=i("5355"),c=[{title:"标准ID",dataIndex:"id",key:"id"},{title:"收费标准名称",dataIndex:"charge_name",key:"charge_name"},{title:"收费标准生效时间",dataIndex:"charge_valid_time",key:"charge_valid_time"},{title:"计费模式",dataIndex:"fees_type",key:"fees_type"},{title:"账单生成周期设置",dataIndex:"bill_create_set",key:"bill_create_set"},{title:"账单欠费模式",dataIndex:"bill_arrears_set",key:"bill_arrears_set"},{title:"生成账单模式",dataIndex:"bill_type",key:"bill_type"},{title:"是否支持预缴",dataIndex:"is_prepaid",key:"is_prepaid"},{title:"未入住房屋折扣",dataIndex:"not_house_rate",key:"not_house_rate"},{title:"绑定费用对象",dataIndex:"bddx",key:"bddx",scopedSlots:{customRender:"standard"}},{title:"操作",dataIndex:"operation",key:"operation",scopedSlots:{customRender:"action"}}],d=[],u={name:"ruleList",filters:{},components:{ruleInfo:o["default"],bindList:r["default"],addVacancyBindOrder:l["default"]},data:function(){var t=this;return{reply_content:"",pagination:{current:1,pageSize:10,total:10,showSizeChanger:!0,pageSizeOptions:["10","20","50","100"],showTotal:function(t){return"共 ".concat(t," 条")},onShowSizeChange:function(e,i){return t.onTableChange(e,i)},onChange:function(e,i){return t.onTableChange(e,i)}},search:{keyword:"",page:1},form:this.$form.createForm(this),visible:!1,loading:!1,data:d,columns:c,title:"",confirmLoading:!1,charge_project_id:"",charge_type:"",selected_rule_id:0}},computed:{rowSelection:function(){var t=this;return"public_water"==this.charge_type||"public_electric"==this.charge_type?{type:"radio",onChange:function(e,i){console.log("selectedRowKeys",e),t.selected_rule_id=1*e},onSelect:function(t,e,i,a){console.log("record,",t,"selected",e)}}:null}},methods:{List:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";this.title="收费标准管理",this.loading=!0,1==i&&this.$set(this.pagination,"current",1),e>0&&(this.charge_project_id=e,this.search["charge_project_id"]=e),a&&(this.charge_type=a),this.search["page"]=this.pagination.current,this.search["limit"]=this.pagination.pageSize,this.request(s["a"].ChargeRuleList,this.search).then((function(e){console.log("收费标准===============",e),t.pagination.total=e.count?e.count:0,t.pagination.pageSize=e.total_limit?e.total_limit:10,t.data=e.list,t.loading=!1,t.confirmLoading=!0,t.visible=!0}))},onTableChange:function(t,e){this.pagination.current=t,this.pagination.pageSize=e,this.List(),console.log("onTableChange==>",t,e)},copyAndAddNewRule:function(){if(!this.selected_rule_id||this.selected_rule_id<1)return this.$message.error("请选择一条数据来复制"),!1;this.$refs.PopupAddModel.add(this.charge_project_id,"normal",this.charge_type,this.selected_rule_id)},handleCancel:function(){var t=this;this.visible=!1,setTimeout((function(){t.id="0",t.form=t.$form.createForm(t)}),500)},addRule:function(t){this.List(this.charge_project_id,1)},editRule:function(t){this.List()},bindOk:function(t){this.List()},cancel:function(){},deleteConfirm:function(t){var e=this;this.request(s["a"].ChargeRuleDel,{id:t}).then((function(t){e.List(e.charge_project_id,1),e.$message.success("删除成功")}))},ruleList:function(t){this.List()},prepaidList:function(t){this.List()},table_change:function(t){console.log("e",t),t.current&&t.current>0&&(this.$set(this.pagination,"current",t.current),this.List())},delInfo:function(t){var e=this;this.$confirm({title:"你确定要删除该活动信息?",content:"该活动一旦删除不可恢复，且相关报名信息将失效",okText:"确定",okType:"danger",cancelText:"取消",onOk:function(){e.request(s["a"].delVolunteerActivity,{activity_id:t.activity_id}).then((function(t){e.$message.success("删除成功！"),e.List()}))},onCancel:function(){console.log("Cancel")}})},searchList:function(){console.log("search",this.search),this.$set(this.pagination,"current",1),this.List()},resetList:function(){this.$set(this.pagination,"current",1),this.search.keyword="",this.search.page=1,this.List()},bindFunc:function(t){var e=this;this.request(s["a"].checkTakeEffectTime).then((function(i){if(!i.status)return e.$message.warning(i.msg),!1;e.$refs.BindModel.list(t.id,t.charge_type,t)}))}}},p=u,h=(i("b45e"),i("0c7c")),g=Object(h["a"])(p,a,n,!1,null,null,null);e["default"]=g.exports},bb7e:function(t,e,i){"use strict";i("5d94")},bbce:function(t,e,i){"use strict";i("b65a")},ccc3:function(t,e,i){"use strict";i("f90b")},f90b:function(t,e,i){},fe25:function(t,e,i){}}]);