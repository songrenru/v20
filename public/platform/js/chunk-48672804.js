(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-48672804"],{"0ebe":function(t,e,a){"use strict";a.r(e);var i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("div",{staticClass:"pl-20 pr-20 pt-20 pb-20"},[a("a-row",{staticClass:"text-right"},["category"==t.type?a("a-button",{attrs:{type:"primary"},on:{click:function(e){return t.addCategory()}}},[t._v("添加主分类")]):a("a-button",{attrs:{type:"primary"},on:{click:function(e){return t.addSubCategory()}}},[t._v("添加子分类")])],1)],1),a("div",{staticClass:"pl-20 pr-20 pb-20"},[a("a-table",{staticStyle:{"min-height":"700px"},attrs:{columns:t.columns,"data-source":t.data,rowKey:"cat_id",pagination:t.pagination},scopedSlots:t._u([{key:"cat_fid",fn:function(e,i){return a("span",{},[a("a-button",{attrs:{type:"link"},on:{click:function(e){return t.viewCatOpt(i)}}},[t._v("查看")])],1)}},{key:"cat_sort",fn:function(e,i){return a("span",{},[a("a-input-number",{attrs:{value:e,min:0},on:{change:function(e){return t.sortChange(e,i)}}})],1)}},{key:"cat_status",fn:function(e){return a("span",{},[a("a-button",{staticStyle:{cursor:"default"},attrs:{type:"link"}},[t._v(t._s(1==e?"启用":"关闭"))])],1)}},{key:"action",fn:function(e,i){return a("span",{},[a("a-button",{attrs:{type:"link"},on:{click:function(e){return t.editOpt(i)}}},[t._v("编辑")]),a("a-button",{attrs:{type:"link"},on:{click:function(e){return t.delOpt(i)}}},[t._v("删除")])],1)}}])})],1)])},n=[],o=(a("a9e3"),a("4de4"),a("d3b7"),a("159b"),a("8a11")),c={props:{type:{type:String,default:"category"},cat_id:{type:[String,Number],default:0},refresh:{type:Boolean,default:!1}},data:function(){var t=this;return{columnsData:[{title:"编号",dataIndex:"cat_id",width:"8%",align:"center"},{title:"名称",dataIndex:"cat_name",align:"center"},{title:"短标记",dataIndex:"cat_url",align:"center"},{title:"子分类",dataIndex:"cat_fid",scopedSlots:{customRender:"cat_fid"},align:"center"},{title:"排序",dataIndex:"cat_sort",scopedSlots:{customRender:"cat_sort"},align:"center"},{title:"团购状态",dataIndex:"cat_status",scopedSlots:{customRender:"cat_status"},align:"center"},{title:"操作",dataIndex:"action",scopedSlots:{customRender:"action"},align:"center"}],data:[],pagination:{pageSize:10,total:0,current:1,"show-total":function(t){return"共 ".concat(t," 条记录")},"show-quick-jumper":!0,"show-size-changer":!0,onChange:function(e,a){t.pagination.current=e,t.getList()},onShowSizeChange:function(e,a){t.pagination.pageSize=a,t.getList()}},columns:[]}},watch:{refresh:function(t){console.log(t,"val---groupCategoryTableList"),console.log(this.cat_id,"cat_id---groupCategoryTableList"),t&&("subCategory"==this.type&&(this.$set(this.pagination,"current",1),this.$set(this.pagination,"pageSize",10)),this.getList())}},created:function(){"subCategory"==this.type?this.columns=this.columnsData.filter((function(t){return"cat_fid"!=t.dataIndex})):this.columns=this.columnsData},mounted:function(){this.getList()},methods:{getList:function(){var t=this,e={page:this.pagination.current,pageSize:this.pagination.pageSize,cat_id:this.cat_id};this.pagination.total>0&&Math.ceil(this.pagination.total/this.pagination.pageSize)<e.page&&(this.pagination.current=0,e.page=1),this.request(o["a"].getGroupCategorylist,e).then((function(e){t.data=e.list||[],t.pagination.total=e.count||0}))},viewCatOpt:function(t){console.log(t,"current"),this.$router.push({path:"/group/platform.groupSubCategoryList/index",query:{cat_fid:t.cat_id}})},sortChange:function(t,e){var a=this,i={cat_sort:t,cat_id:e.cat_id};console.log(t,"cat_sort"),console.log(e,"current"),this.request(o["a"].groupCategorySaveSort,i).then((function(i){console.log("修改排序成功"),a.$message.success("操作成功",1,(function(){a.data.forEach((function(i,n){i.cat_id==e.cat_id&&a.$set(a.data[n],"cat_sort",t)}))}))})).catch((function(t){a.getList()}))},editOpt:function(t){"category"==this.type&&this.$router.push({path:"/group/platform.groupCategory/edit",query:{cat_id:t.cat_id,cat_fid:t.cat_fid}}),"subCategory"==this.type&&this.$emit("showModal",{visible:!0,cat_id:t.cat_id,cat_fid:this.cat_id})},delOpt:function(t){var e=this,a={cat_id:t.cat_id};this.$confirm({title:"提示",content:"确定删除该分类？",onOk:function(){e.request(o["a"].delGroupCategory,a).then((function(t){e.$message.success("操作成功",1,(function(){e.getList()}))}))},onCancel:function(){}})},addCategory:function(){this.$router.push({path:"/group/platform.groupCategory/edit",query:{cat_id:0,cat_fid:0}})},addSubCategory:function(){this.$emit("showModal",{visible:!0,cat_id:0,cat_fid:this.cat_id})}}},s=c,r=a("0c7c"),u=Object(r["a"])(s,i,n,!1,null,"af9e214e",null);e["default"]=u.exports},"436a":function(t,e,a){"use strict";a.r(e);var i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"page"},[a("a-page-header",{staticClass:"page-header",attrs:{title:"子分类"}}),a("groupCategoryTableList",{ref:"groupCategoryTableList",attrs:{cat_id:t.$route.query.cat_fid,refresh:t.refresh,type:"subCategory"},on:{showModal:t.showModal}}),a("a-modal",{attrs:{title:0==t.cat_id?"添加子分类":"编辑子分类",visible:t.visible,width:"50%",bodyStyle:{maxHeight:"600px",overflowY:"auto"},destroyOnClose:!0},on:{ok:t.handleOk,cancel:t.handleCancel}},[a("groupCategoryEditForm",{ref:"groupCategoryEditForm",attrs:{type:"subCategory",cat_id:t.cat_id,cat_fid:t.cat_fid,group_content_switch:t.group_content_switch},on:{updateList:t.updateList}})],1)],1)},n=[],o=a("8a11"),c=a("0ebe"),s=a("2c92c"),r={components:{groupCategoryTableList:c["default"],groupCategoryEditForm:s["default"]},data:function(){return{cat_id:0,cat_fid:this.$route.query.cat_fid||0,visible:!1,refresh:!1,group_content_switch:0}},mounted:function(){},activated:function(){this.refresh=!0,this.configGroupCategoryOpt()},deactivated:function(){this.refresh=!1},methods:{configGroupCategoryOpt:function(){var t=this;this.request(o["a"].configGroupCategory,null).then((function(e){t.group_content_switch=e&&e.group_content_switch?e.group_content_switch:0}))},showModal:function(t){this.visible=t.visible||!1,this.cat_id=t.cat_id||0,this.cat_fid=t.cat_fid||0},handleOk:function(){this.$refs.groupCategoryEditForm.submitOpt()},handleCancel:function(){this.visible=!1},updateList:function(){this.$refs.groupCategoryTableList.getList(),this.visible=!1}}},u=r,d=(a("a379"),a("0c7c")),l=Object(d["a"])(u,i,n,!1,null,"5c639afa",null);e["default"]=l.exports},a379:function(t,e,a){"use strict";a("bd0c9")},bd0c9:function(t,e,a){}}]);