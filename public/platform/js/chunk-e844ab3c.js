(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-e844ab3c","chunk-b3cef5c8","chunk-72fdb6a9","chunk-d20649e8","chunk-b3cef5c8","chunk-748b470d"],{"0078":function(t,e,a){"use strict";a("10b3")},"10b3":function(t,e,a){},"2b69":function(t,e,a){"use strict";a.r(e);a("54f8");var r=function(){var t=this,e=t._self._c;return e("div",[e("a-modal",{attrs:{visible:t.dialogVisible,title:"选择店铺",centered:"",maskClosable:!1,width:600},on:{ok:t.chooseStoreOk,cancel:t.chooseStoreCancel}},[[e("a-form-model",{attrs:{layout:"inline",model:t.modalSearchForm,"label-col":{span:2},"wrapper-col":{span:22}}},[e("a-row",[e("a-col",{staticClass:"mr-10",attrs:{span:10}},[e("a-cascader",{attrs:{"field-names":{label:"area_name",value:"area_id",children:"children"},options:t.areaList,placeholder:"请选择省市区"},on:{change:t.onAreaChange},model:{value:t.searchForm.areaList,callback:function(e){t.$set(t.searchForm,"areaList",e)},expression:"searchForm.areaList"}})],1),e("a-col",{staticClass:"mr-20",attrs:{span:10}},[e("a-input",{attrs:{placeholder:"输入店铺名称"},nativeOn:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.selectStoreList()}},model:{value:t.modalSearchForm.keyword,callback:function(e){t.$set(t.modalSearchForm,"keyword",e)},expression:"modalSearchForm.keyword"}})],1),e("a-col",{attrs:{span:2}},[e("a-button",{attrs:{type:"primary"},on:{click:function(e){return t.selectStoreList()}}},[t._v(" 查询 ")])],1)],1)],1),t.modalTableData?[e("a-checkbox",{staticStyle:{"padding-left":"7px",margin:"10px 0 5px"},attrs:{indeterminate:t.indeterminate,checked:t.checkAll},on:{change:function(e){return t.onCheckAllChange(e)}}},[t._v("全选")]),e("a-row",[e("a-col",{staticStyle:{"font-size":"20px","padding-left":"7px"},attrs:{span:24}},t._l(t.modalTableData,(function(a,r){return e("a-col",{key:a.store_id,staticStyle:{"line-height":"40px"},attrs:{span:24}},[a.showRow?e("div",[e("a-checkbox",{key:r,attrs:{value:a.store_id,checked:-1!=t.grouplList1.indexOf(a.store_id)},on:{change:function(e){return t.getStoreId(e,a)}}},[t._v(" "+t._s(a.name)+" ")]),a.package_list&&a.package_list.length?[e("a-col",{attrs:{span:24}},[e("a-radio-group",{attrs:{name:"radioGroup"},on:{change:function(e){return t.onExpandedRowChange(e,a)}},model:{value:t.radio_check,callback:function(e){t.radio_check=e},expression:"radio_check"}},t._l(a.package_list,(function(a){return e("a-radio",{key:a.id,attrs:{value:a.id}},[t._v(" "+t._s(a.name)+" ")])})),1)],1)]:t._e()],2):t._e()])})),1)],1),e("a-row",{staticClass:"text-right"},[[e("a-pagination",{attrs:{total:t.total,"show-less-items":"",hideOnSinglePage:""},on:{change:t.pageChange},model:{value:t.modalSearchForm.page,callback:function(e){t.$set(t.modalSearchForm,"page",e)},expression:"modalSearchForm.page"}})]],2)]:t._e()]],2)],1)},i=[],o=(a("c5cb"),a("08c7"),a("4afa"),a("19f1"),a("cd5d"),a("075f"),a("5079"),a("f597"),a("4b77")),n=a("249b"),s=a("5065"),l={components:{ARow:s["a"],ACol:n["b"]},props:{visible:{type:Boolean,default:!1},storeIdArr:{type:[Array,Object],default:function(){}}},watch:{visible:function(t,e){this.checkAll=!1,this.indeterminate=!1,this.grouplList1=[],this.storeIds=[],this.dialogVisible=t,this.getAllArea(),this.selectStoreList()}},mounted:function(){this.dialogVisible=this.visible,this.getAllArea(),this.selectStoreList()},data:function(){return{checkAll:!0,indeterminate:!0,radio_check:[],total:0,grouplList1:[],showHeader:!1,dialogVisible:!1,areaList:[],searchForm:{storeIdArray:[],areaList:[]},storeIds:[],modalSearchForm:{province_id:"",city_id:"",area_id:"",keyword:"",page:1},columns:[{dataIndex:"name",slots:{title:"name"},align:"center"}],modalTableData:[],curStoreList:[],modalSelectedRowKeys:[],expandedRowKeys:[]}},methods:{onCheckAllChange:function(t){var e=this;t.target.checked?(this.checkAll=!0,this.indeterminate=!0,this.modalTableData.forEach((function(t){t.show=!0,-1==e.grouplList1.indexOf(t.store_id)&&(e.grouplList1.push(t.store_id),e.storeIds.push({store_id:t.store_id,package_id:"",name:t.name}))}))):(this.modalTableData.forEach((function(t){t.show=!1;var a=e.grouplList1.indexOf(t.store_id);a>-1&&(e.grouplList1.splice(a,1),e.storeIds.splice(a,1))})),this.checkAll=!1,this.indeterminate=!1)},pageChange:function(t,e){this.modalSearchForm.page=t,this.modalTableData=this.modalTableDataGet(this.modalTableData,this.modalSearchForm.page)},getStoreId:function(t,e){if(t.target.checked)this.grouplList1.push(t.target.value),this.storeIds.push({store_id:e.store_id,package_id:"",name:e.name}),e.show=!0;else{var a=this.grouplList1.indexOf(t.target.value);a>-1&&(this.grouplList1.splice(a,1),this.storeIds.splice(a,1)),e.show=!1}this.grouplList1.length==this.modalTableData.length?(this.indeterminate=!0,this.checkAll=!0):(this.indeterminate=!1,this.checkAll=!1)},modalTableDataGet:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:10,r=[];if(t&&t.length){var i=(Number(e)-1)*a,o=Number(e)*a-1>this.total?this.total:Number(e)*a-1;r=t.filter((function(t,e){return t.showRow=!1,e>=i&&e<=o&&(t.showRow=!0),t}))}return r},selectStoreList:function(){var t=this,e={province_id:this.modalSearchForm.province_id,city_id:this.modalSearchForm.city_id,area_id:this.modalSearchForm.area_id,keyword:this.modalSearchForm.keyword,page:0};this.request(o["a"].getMerchantStoreList,e).then((function(e){if(e.list&&e.list.length?t.modalTableData=t.modalTableDataGet(e.list,t.modalSearchForm.page):t.modalTableData=[],t.total=e.total,0==t.storeIdArr.length)t.modalTableData.forEach((function(e){var a=t.grouplList1.indexOf(e.store_id);-1==a&&(t.grouplList1.push(e.store_id),t.storeIds.push({store_id:e.store_id,package_id:"",name:e.name}))})),t.checkAll=!0,t.indeterminate=!0;else{var a=0;t.storeIdArr.forEach((function(e){var r=t.grouplList1.indexOf(e.store_id);-1==r&&(t.grouplList1.push(e.store_id),t.storeIds.push({store_id:e.store_id,package_id:e.package_id,name:e.name})),t.modalTableData=t.modalTableData.map((function(t){return e.store_id==t.store_id&&(t.show=!0,a+=1),t}))})),a!=t.modalTableData.length?(t.checkAll=!1,t.indeterminate=!1):(t.checkAll=!0,t.indeterminate=!0)}}))},getAllArea:function(){var t=this;this.request(o["a"].getAllArea).then((function(e){t.areaList=e}))},onAreaChange:function(t){this.modalSearchForm.province_id=t[0],this.modalSearchForm.city_id=t[1],this.modalSearchForm.area_id=t[2],this.selectStoreList()},onExpandedRowChange:function(t,e){var a=e.store_id,r=t.target.value,i=this.storeIds.findIndex((function(t){return t.store_id==a}));i>-1?this.storeIds[i].package_id=r:(this.storeIds.push({store_id:a,package_id:r||"",name:e.name}),this.radio_check.push(r))},chooseStoreOk:function(){this.$set(this.searchForm,"storeIdArray",this.grouplList1);var t=[],e="";this.modalTableData&&this.modalTableData.length?this.storeIds.forEach((function(a){t.push(a.name),e=t.filter((function(t){return t})).join(",")})):this.storeIds=[],this.$emit("submit",{storeName:e,storeIds:this.storeIds}),this.chooseStoreCancel()},chooseStoreCancel:function(){this.modalTableData=[],this.dialogVisible=!1,this.$emit("update:visible",this.dialogVisible),this.$set(this.modalSearchForm,"keyword",""),this.$set(this.modalSearchForm,"page",1),this.$set(this.modalSearchForm,"province_id",""),this.$set(this.modalSearchForm,"city_id",""),this.$set(this.modalSearchForm,"area_id",""),this.$set(this.searchForm,"areaList",[])},onModalSelectChange:function(t){var e=this;this.expandedRowKeys=t,this.storeIds=[],this.modalSelectedRowKeys=t,this.modalSelectedRowKeys.forEach((function(t){e.storeIds.push({store_id:t,package_id:""})}))}}},c=l,m=(a("9469"),a("0b56")),p=Object(m["a"])(c,r,i,!1,null,"6e2d32d5",null);e["default"]=p.exports},4928:function(t,e,a){"use strict";a.r(e);a("54f8");var r=function(){var t=this,e=t._self._c;return e("div",[e("a-form-model-item",{staticClass:"mb-10",attrs:{label:"标签组",labelCol:{span:3}}},[e("a-radio-group",{on:{change:t.goodsTagGroupChange},model:{value:t.labelGroup,callback:function(e){t.labelGroup=e},expression:"labelGroup"}},t._l(t.goodsTagGroupList,(function(a,r){return e("a-radio",{key:r,staticStyle:{"margin-bottom":"20px"},attrs:{value:a.id,disabled:!a.id}},[e("a-input",{staticStyle:{width:"100px"},attrs:{placeholder:"标签名"},on:{blur:function(e){return t.addLabelOpt(e,"1",a)},change:function(e){return t.addLabelChange()}},model:{value:a.name,callback:function(e){t.$set(a,"name",e)},expression:"groupItem.name"}})],1)})),1),e("a-button",{staticClass:"cr-primary",staticStyle:{padding:"0 10px","border-color":"#1890ff"},attrs:{icon:"plus"},on:{click:t.addTagGroup}},[t._v(" 新增 ")])],1),t.showTags?e("a-form-model-item",{attrs:{label:"标签",labelCol:{span:3}}},[e("a-checkbox-group",{on:{change:t.goodsTagChange},model:{value:t.labelIds,callback:function(e){t.labelIds=e},expression:"labelIds"}},t._l(t.goodsTagList,(function(a,r){return e("a-checkbox",{key:r,staticStyle:{"margin-bottom":"20px"},attrs:{value:a.id}},[e("a-input",{staticStyle:{width:"100px"},attrs:{placeholder:"标签名"},on:{blur:function(e){return t.addLabelOpt(e,"2",a)},change:function(e){return t.addLabelChange()}},model:{value:a.name,callback:function(e){t.$set(a,"name",e)},expression:"item.name"}})],1)})),1),e("a-button",{staticClass:"cr-primary",staticStyle:{padding:"0 10px","border-color":"#1890ff"},attrs:{icon:"plus"},on:{click:t.addTag}},[t._v(" 新增 ")])],1):t._e()],1)},i=[],o=(a("c5cb"),a("08c7"),a("7023"),a("4b77")),n={props:{labelInfo:{type:[String,Object],default:""}},data:function(){return{labelGroup:this.labelInfo&&this.labelInfo.labelGroup?this.labelInfo.labelGroup:"",labelIds:this.labelInfo&&this.labelInfo.labelIds?this.labelInfo.labelIds:[],goodsTagGroupList:[],currentTagGroupIndex:0,showTags:!(!this.labelInfo||!this.labelInfo.labelGroup),goodsTagList:[],labelInfoForm:[],checkAddLabelChange:!1}},watch:{labelInfo:{immediate:!0,handler:function(t){t&&(t.labelGroup&&(this.showTags=!0,this.getGoodsTagList()),this.$set(this,"labelGroup",t.labelGroup||""),this.$set(this,"labelIds",t.labelIds||[]))}},labelGroup:{immediate:!0,handler:function(t){t&&this.getGoodsTagList()}}},mounted:function(){this.getLabelList()},methods:{addTagGroup:function(){this.goodsTagGroupList.push({id:"",name:"",child:[]})},addTag:function(){var t=this;this.goodsTagGroupList.length&&this.goodsTagGroupList.forEach((function(e,a){e.id==t.labelGroup&&(e.child||(e.child=[]),e.child.push({id:"",name:""}),t.$set(t.goodsTagGroupList,a,e),t.getGoodsTagList())}))},goodsTagGroupChange:function(t){this.showTags=!0;var e=t.target.value;this.currentTagGroupIndex=e,this.labelInfoForm=this.labelInfoForm?this.labelInfoForm:{},this.$set(this.labelInfoForm,"labelGroup",t.target.value),this.$emit("getLabelGroup",this.labelInfoForm),this.getGoodsTagList()},getGoodsTagList:function(){var t=this;this.goodsTagGroupList.length&&this.goodsTagGroupList.forEach((function(e){e.id==t.labelGroup&&(t.goodsTagList=e.child)}))},goodsTagChange:function(t){console.log(t,"labelIds==labelIds==labelIds"),this.$set(this.labelInfoForm,"labelIds",t),this.$emit("getLabelGroup",this.labelInfoForm)},getLabelList:function(){var t=this;this.request(o["a"].getLabelList).then((function(e){t.goodsTagGroupList=e.list,!t.labelGroup&&t.goodsTagGroupList&&t.goodsTagGroupList.length&&(t.labelGroup=t.goodsTagGroupList[0]["id"],t.getGoodsTagList())}))},addLabelOpt:function(t,e,a){var r=this;if(a.id&&""==t.target.value.trim())return this.$message.error("请输入标签名称"),void this.$emit("checkLabelReslut");if(""!=t.target.value.trim()&&this.checkAddLabelChange){var i={name:t.target.value,fid:"2"==e?this.labelGroup:"",id:a.id};this.request(o["a"].addLabel,i).then((function(t){r.checkAddLabelChange=!1,a.id||r.getLabelList()})).catch((function(t){r.checkAddLabelChange=!1}))}},addLabelChange:function(){this.checkAddLabelChange=!0}}},s=n,l=a("0b56"),c=Object(l["a"])(s,r,i,!1,null,"48b66c74",null);e["default"]=c.exports},"4b77":function(t,e,a){"use strict";var r,i=a("bcc3"),o=(r={addLabel:"/group/merchant.goods/addLabel",getLabelList:"/group/merchant.goods/getLabelList",getMerchantStoreList:"/group/merchant.goods/getMerchantStoreList",getAllArea:"/common/common.area/getAllArea",getGoodsCashingDetail:"/group/merchant.goods/getGoodsCashingDetail",getGroupEditInfo:"/group/merchant.goods/getGroupEditInfo"},Object(i["a"])(r,"getGoodsCashingDetail","/group/merchant.goods/getGoodsCashingDetail"),Object(i["a"])(r,"saveCashingGoods","/group/merchant.goods/submitCashing"),Object(i["a"])(r,"saveNomalGoods","/group/merchant.goods/saveNomalGoods"),Object(i["a"])(r,"getGoodsNormalDetail","/group/merchant.goods/getGoodsNormalDetail"),Object(i["a"])(r,"getGoodsList","/group/merchant.goods/getGoodsList"),Object(i["a"])(r,"courseAppoint","/group/merchant.Goods/courseAppoint"),Object(i["a"])(r,"getCourseAppointDetail","/group/merchant.Goods/getCourseAppointDetail"),Object(i["a"])(r,"setStoreRecommend","/group/merchant.goods/setStoreRecommend"),Object(i["a"])(r,"getStoreRecommend","/group/merchant.goods/getStoreRecommend"),Object(i["a"])(r,"getGoodsOrderList","/group/merchant.goods/getGoodsOrderList"),Object(i["a"])(r,"saveBookingAppoint","/group/merchant.Goods/saveBookingAppoint"),Object(i["a"])(r,"showBookingAppoint","/group/merchant.Goods/showBookingAppoint"),Object(i["a"])(r,"getStoreList","/group/merchant.AppointManage/getStoreList"),Object(i["a"])(r,"getGiftMsg","/group/merchant.AppointManage/getGiftMsg"),Object(i["a"])(r,"updateAppointGift","/group/merchant.AppointManage/updateAppointGift"),Object(i["a"])(r,"getAppointArriveList","/group/merchant.AppointManage/getAppointArriveList"),Object(i["a"])(r,"updateAppointArriveStatus","/group/merchant.AppointManage/updateAppointArriveStatus"),Object(i["a"])(r,"getGoodsOrderDetail","/group/merchant.goods/getGoodsOrderDetail"),Object(i["a"])(r,"orderExportUrl","/group/merchant.goods/exportOrder"),Object(i["a"])(r,"noteInfo","/group/merchant.goods/noteInfo"),Object(i["a"])(r,"orderDetail","/group/merchant.goods/orderDetail"),Object(i["a"])(r,"updateOrderNote","/group/merchant.goods/updateOrderNote"),Object(i["a"])(r,"getRatioList","/group/merchant.goods/getRatioList"),r);e["a"]=o},"4bb5d":function(t,e,a){"use strict";a.d(e,"a",(function(){return l}));var r=a("ea87");function i(t){if(Array.isArray(t))return Object(r["a"])(t)}a("6073"),a("2c5c"),a("c5cb"),a("36fa"),a("02bf"),a("a617"),a("17c8");function o(t){if("undefined"!==typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}var n=a("9877");function s(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function l(t){return i(t)||o(t)||Object(n["a"])(t)||s()}},"7b3f":function(t,e,a){"use strict";var r={uploadImg:"/common/common.UploadFile/uploadImg"};e["a"]=r},9469:function(t,e,a){"use strict";a("c362")},c362:function(t,e,a){},d34b:function(t,e,a){"use strict";a.d(e,"a",(function(){return i}));a("c5cb");function r(t,e,a,r,i,o,n){try{var s=t[o](n),l=s.value}catch(c){return void a(c)}s.done?e(l):Promise.resolve(l).then(r,i)}function i(t){return function(){var e=this,a=arguments;return new Promise((function(i,o){var n=t.apply(e,a);function s(t){r(n,i,o,s,l,"next",t)}function l(t){r(n,i,o,s,l,"throw",t)}s(void 0)}))}}},dff4:function(t,e,a){"use strict";a.d(e,"a",(function(){return i}));a("6073"),a("2c5c"),a("c5cb"),a("36fa"),a("02bf"),a("a617"),a("70b9"),a("25b2"),a("0245"),a("2e24"),a("1485"),a("08c7"),a("54f8"),a("7177"),a("9ae4");var r=a("2396");function i(){
/*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/facebook/regenerator/blob/main/LICENSE */
i=function(){return t};var t={},e=Object.prototype,a=e.hasOwnProperty,o="function"==typeof Symbol?Symbol:{},n=o.iterator||"@@iterator",s=o.asyncIterator||"@@asyncIterator",l=o.toStringTag||"@@toStringTag";function c(t,e,a){return Object.defineProperty(t,e,{value:a,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{c({},"")}catch($){c=function(t,e,a){return t[e]=a}}function m(t,e,a,r){var i=e&&e.prototype instanceof d?e:d,o=Object.create(i.prototype),n=new S(r||[]);return o._invoke=function(t,e,a){var r="suspendedStart";return function(i,o){if("executing"===r)throw new Error("Generator is already running");if("completed"===r){if("throw"===i)throw o;return C()}for(a.method=i,a.arg=o;;){var n=a.delegate;if(n){var s=x(n,a);if(s){if(s===u)continue;return s}}if("next"===a.method)a.sent=a._sent=a.arg;else if("throw"===a.method){if("suspendedStart"===r)throw r="completed",a.arg;a.dispatchException(a.arg)}else"return"===a.method&&a.abrupt("return",a.arg);r="executing";var l=p(t,e,a);if("normal"===l.type){if(r=a.done?"completed":"suspendedYield",l.arg===u)continue;return{value:l.arg,done:a.done}}"throw"===l.type&&(r="completed",a.method="throw",a.arg=l.arg)}}}(t,a,n),o}function p(t,e,a){try{return{type:"normal",arg:t.call(e,a)}}catch($){return{type:"throw",arg:$}}}t.wrap=m;var u={};function d(){}function f(){}function h(){}var _={};c(_,n,(function(){return this}));var g=Object.getPrototypeOf,b=g&&g(g(L([])));b&&b!==e&&a.call(b,n)&&(_=b);var v=h.prototype=d.prototype=Object.create(_);function y(t){["next","throw","return"].forEach((function(e){c(t,e,(function(t){return this._invoke(e,t)}))}))}function D(t,e){function i(o,n,s,l){var c=p(t[o],t,n);if("throw"!==c.type){var m=c.arg,u=m.value;return u&&"object"==Object(r["a"])(u)&&a.call(u,"__await")?e.resolve(u.__await).then((function(t){i("next",t,s,l)}),(function(t){i("throw",t,s,l)})):e.resolve(u).then((function(t){m.value=t,s(m)}),(function(t){return i("throw",t,s,l)}))}l(c.arg)}var o;this._invoke=function(t,a){function r(){return new e((function(e,r){i(t,a,e,r)}))}return o=o?o.then(r,r):r()}}function x(t,e){var a=t.iterator[e.method];if(void 0===a){if(e.delegate=null,"throw"===e.method){if(t.iterator["return"]&&(e.method="return",e.arg=void 0,x(t,e),"throw"===e.method))return u;e.method="throw",e.arg=new TypeError("The iterator does not provide a 'throw' method")}return u}var r=p(a,t.iterator,e.arg);if("throw"===r.type)return e.method="throw",e.arg=r.arg,e.delegate=null,u;var i=r.arg;return i?i.done?(e[t.resultName]=i.value,e.next=t.nextLoc,"return"!==e.method&&(e.method="next",e.arg=void 0),e.delegate=null,u):i:(e.method="throw",e.arg=new TypeError("iterator result is not an object"),e.delegate=null,u)}function k(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function w(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function S(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(k,this),this.reset(!0)}function L(t){if(t){var e=t[n];if(e)return e.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var r=-1,i=function e(){for(;++r<t.length;)if(a.call(t,r))return e.value=t[r],e.done=!1,e;return e.value=void 0,e.done=!0,e};return i.next=i}}return{next:C}}function C(){return{value:void 0,done:!0}}return f.prototype=h,c(v,"constructor",h),c(h,"constructor",f),f.displayName=c(h,l,"GeneratorFunction"),t.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===f||"GeneratorFunction"===(e.displayName||e.name))},t.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,h):(t.__proto__=h,c(t,l,"GeneratorFunction")),t.prototype=Object.create(v),t},t.awrap=function(t){return{__await:t}},y(D.prototype),c(D.prototype,s,(function(){return this})),t.AsyncIterator=D,t.async=function(e,a,r,i,o){void 0===o&&(o=Promise);var n=new D(m(e,a,r,i),o);return t.isGeneratorFunction(a)?n:n.next().then((function(t){return t.done?t.value:n.next()}))},y(v),c(v,l,"Generator"),c(v,n,(function(){return this})),c(v,"toString",(function(){return"[object Generator]"})),t.keys=function(t){var e=[];for(var a in t)e.push(a);return e.reverse(),function a(){for(;e.length;){var r=e.pop();if(r in t)return a.value=r,a.done=!1,a}return a.done=!0,a}},t.values=L,S.prototype={constructor:S,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(w),!t)for(var e in this)"t"===e.charAt(0)&&a.call(this,e)&&!isNaN(+e.slice(1))&&(this[e]=void 0)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var e=this;function r(a,r){return n.type="throw",n.arg=t,e.next=a,r&&(e.method="next",e.arg=void 0),!!r}for(var i=this.tryEntries.length-1;i>=0;--i){var o=this.tryEntries[i],n=o.completion;if("root"===o.tryLoc)return r("end");if(o.tryLoc<=this.prev){var s=a.call(o,"catchLoc"),l=a.call(o,"finallyLoc");if(s&&l){if(this.prev<o.catchLoc)return r(o.catchLoc,!0);if(this.prev<o.finallyLoc)return r(o.finallyLoc)}else if(s){if(this.prev<o.catchLoc)return r(o.catchLoc,!0)}else{if(!l)throw new Error("try statement without catch or finally");if(this.prev<o.finallyLoc)return r(o.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var i=this.tryEntries[r];if(i.tryLoc<=this.prev&&a.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var o=i;break}}o&&("break"===t||"continue"===t)&&o.tryLoc<=e&&e<=o.finallyLoc&&(o=null);var n=o?o.completion:{};return n.type=t,n.arg=e,o?(this.method="next",this.next=o.finallyLoc,u):this.complete(n)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),u},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var a=this.tryEntries[e];if(a.finallyLoc===t)return this.complete(a.completion,a.afterLoc),w(a),u}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var a=this.tryEntries[e];if(a.tryLoc===t){var r=a.completion;if("throw"===r.type){var i=r.arg;w(a)}return i}}throw new Error("illegal catch attempt")},delegateYield:function(t,e,a){return this.delegate={iterator:L(t),resultName:e,nextLoc:a},"next"===this.method&&(this.arg=void 0),u}},t}},f093:function(t,e,a){"use strict";a.r(e);a("54f8"),a("aa48"),a("3446");var r=function(){var t=this,e=t._self._c;return e("div",{staticClass:"page"},[e("a-page-header",{staticClass:"page-header",attrs:{title:"添加商品"}}),e("a-form-model",{ref:"ruleForm",attrs:{model:t.formData,"label-col":t.labelCol,"wrapper-col":t.wrapperCol}},[e("a-tabs",{attrs:{activeKey:t.activeKey},on:{change:t.onTabChange}},[e("a-tab-pane",{key:"1",attrs:{tab:"基本信息"}},[e("a-card",{attrs:{bordered:!1}},[e("a-form-model-item",{attrs:{label:"商品类型",colon:!1,help:"默认一张，最大支持500张"}},[e("a-radio-group",{attrs:{defaultValue:t.formData.tuan_type},model:{value:t.formData.tuan_type,callback:function(e){t.$set(t.formData,"tuan_type",e)},expression:"formData.tuan_type"}},[e("a-radio",{attrs:{value:2}},[t._v(" 实物商品 ")]),e("a-radio",{attrs:{value:0}},[e("span",[t._v("团购券，生成")]),e("a-input-number",{attrs:{min:1,max:500,precision:0},model:{value:t.formData.pass_num,callback:function(e){t.$set(t.formData,"pass_num",e)},expression:"formData.pass_num"}}),e("span",[t._v("份券码")])],1)],1)],1),e("a-form-model-item",{attrs:{label:"商品标题",colon:!1,help:"限100字",prop:"name",rules:[{required:!0,message:"商品标题不能为空",trigger:["blur"]}]}},[e("a-input",{staticStyle:{width:"300px"},attrs:{maxLength:100,placeholder:"请输入商品标题"},model:{value:t.formData.name,callback:function(e){t.$set(t.formData,"name",e)},expression:"formData.name"}})],1),2==t.formData.tuan_type?e("a-form-model-item",{attrs:{label:"是否支持邮寄",colon:!1}},[e("a-radio-group",{attrs:{defaultValue:t.formData.open_express},model:{value:t.formData.open_express,callback:function(e){t.$set(t.formData,"open_express",e)},expression:"formData.open_express"}},t._l(t.mailTypeList,(function(a){return e("a-radio",{key:a.value,attrs:{value:a.value}},[t._v(t._s(a.label))])})),1)],1):t._e(),e("a-form-model-item",{attrs:{label:"商品名称",colon:!1,wrapperCol:{span:6},prop:"s_name",rules:[{required:!0,message:"商品名称不能为空",trigger:["blur"]},{required:!0,message:"商品名称最多20个字符",max:20,trigger:["blur"]}]}},[e("a-input",{attrs:{maxLength:20,placeholder:"请输入商品名称"},model:{value:t.formData.s_name,callback:function(e){t.$set(t.formData,"s_name",e)},expression:"formData.s_name"}})],1),e("a-form-model-item",{attrs:{label:"商品标签",colon:!1,help:"店铺主页中用于切换查看不同商品标签"}},[e("add-goods-tags",{attrs:{labelInfo:{labelGroup:t.formData.label_group||"",labelIds:t.formData.label_ids||[]}},on:{getLabelGroup:t.getLabelId,checkLabelReslut:function(e){t.checkLabelReslut=!1}}})],1),e("a-form-model-item",{attrs:{label:"原价",colon:!1,wrapperCol:{span:6},prop:"old_price",rules:{required:!0,message:"请输入商品原价",trigger:["blur"]}}},[e("a-input-number",{staticStyle:{width:"100%"},attrs:{precision:2,placeholder:"请输入商品原价"},model:{value:t.formData.old_price,callback:function(e){t.$set(t.formData,"old_price",e)},expression:"formData.old_price"}})],1),e("a-form-model-item",{attrs:{label:"团购价",colon:!1,wrapperCol:{span:18},prop:"price",rules:{required:!0,message:"请输入商品团购价",trigger:["blur"]}}},[e("a-row",[e("a-col",{attrs:{span:8}},[e("a-input-number",{staticStyle:{width:"100%"},attrs:{precision:2,placeholder:"请输入商品团购价"},model:{value:t.formData.price,callback:function(e){t.$set(t.formData,"price",e)},expression:"formData.price"}})],1),e("a-col",{attrs:{span:10}},[e("a-radio-group",{staticStyle:{"margin-left":"20px"},attrs:{"default-value":t.formData.is_invoice},model:{value:t.formData.is_invoice,callback:function(e){t.$set(t.formData,"is_invoice",e)},expression:"formData.is_invoice"}},t._l(t.isInvoiceList,(function(a){return e("a-radio",{key:a.value,attrs:{value:a.value}},[t._v(" "+t._s(a.label)+" ")])})),1)],1)],1)],1),e("a-form-model-item",{attrs:{label:"图片",colon:!1,help:"第一张将做为主图片！最多上传5张图片！图片建议为900*500",prop:"image",rules:{required:!0,message:"请上传团购图片",trigger:["blur"]}}},[e("div",{staticClass:"clearfix"},[e("a-upload",{attrs:{name:"reply_pic",action:t.uploadImg,"list-type":"picture-card","file-list":t.imgUploadList,multiple:!0},on:{preview:t.handlePreview,change:t.handleImgChange}},[t.imgUploadList.length<5?e("div",[e("a-icon",{attrs:{type:"plus"}}),e("div",{staticClass:"ant-upload-text"},[t._v("上传图片")])],1):t._e()]),e("a-modal",{attrs:{visible:t.previewVisible,footer:null},on:{cancel:t.handleImgCancel}},[e("img",{staticStyle:{width:"100%"},attrs:{alt:"example",src:t.previewImage}})])],1)]),e("a-form-model-item",{attrs:{label:"团购开始时间",colon:!1,help:"到了团购开始时间，商品才会显示！",prop:"begin_time",rules:{required:!0,message:"请选择团购开始时间",trigger:["blur","change"]}}},[e("a-date-picker",{staticStyle:{width:"280px"},attrs:{placeholder:"请选择时间","show-time":"",format:"YYYY-MM-DD HH:mm:ss",value:t.date_moment(t.formData.begin_time,t.dateFormat),allowClear:!0,"disabled-date":t.disabledStartDate,getCalendarContainer:function(t){return t.parentNode}},on:{change:t.beginTimeChange}})],1),e("a-form-model-item",{attrs:{label:"团购结束时间",colon:!1,help:"超过团购结束时间，商品不再显示售卖！",prop:"end_time",rules:{required:!0,message:"请选择团购结束时间",trigger:["blur","change"]}}},[e("a-date-picker",{staticStyle:{width:"280px"},attrs:{placeholder:"请选择时间","show-time":"",format:"YYYY-MM-DD HH:mm:ss",value:t.date_moment(t.formData.end_time,t.dateFormat),"disabled-date":t.disabledEndDate,allowClear:!0,getCalendarContainer:function(t){return t.parentNode}},on:{change:t.endTimeChange}})],1),e("a-form-model-item",{attrs:{label:"团购券有效期",colon:!1,prop:"deadline_time"}},[e("a-radio-group",{attrs:{defaultValue:t.formData.effective_type},on:{change:function(){t.formData.deadline_time=""}},model:{value:t.formData.effective_type,callback:function(e){t.$set(t.formData,"effective_type",e)},expression:"formData.effective_type"}},[e("a-radio",{staticStyle:{"margin-right":"0"},attrs:{value:0}},[t._v(" 固定时间 ")]),e("a-date-picker",{attrs:{placeholder:"请选择时间","show-time":"",allowClear:!0,format:"YYYY-MM-DD HH:mm:ss",value:0==t.formData.effective_type?t.date_moment(t.formData.deadline_time,t.dateFormat):null,getCalendarContainer:function(t){return t.parentNode}},on:{change:t.deadlineTimeChange}}),e("a-radio",{staticStyle:{"margin-left":"30px"},attrs:{value:1}},[e("span",[t._v("购买后")]),1==t.formData.effective_type?e("a-input-number",{attrs:{min:1,max:999},model:{value:t.formData.deadline_time,callback:function(e){t.$set(t.formData,"deadline_time",e)},expression:"formData.deadline_time"}}):e("a-input-number"),e("span",[t._v("天后到期")])],1)],1)],1),e("a-form-model-item",{attrs:{label:"提前取消设置",colon:!1}},[e("a-radio-group",{attrs:{defaultValue:t.formData.cancel_type},model:{value:t.formData.cancel_type,callback:function(e){t.$set(t.formData,"cancel_type",e)},expression:"formData.cancel_type"}},[e("a-radio",{attrs:{value:0}},[t._v(" 不可取消 ")]),e("a-radio",{attrs:{value:1}},[e("span",[t._v("支持取消，到期前")]),1==t.formData.cancel_type?e("a-input-number",{attrs:{min:1},model:{value:t.formData.cancel_hours,callback:function(e){t.$set(t.formData,"cancel_hours",e)},expression:"formData.cancel_hours"}}):e("a-input-number",{attrs:{min:1}}),e("span",[t._v("小时")])],1),e("a-radio",{attrs:{value:2}},[t._v(" 随时取消 ")])],1)],1),e("a-form-model-item",{attrs:{label:"使用时间限制",colon:!1}},[e("a-select",{staticStyle:{width:"300px"},attrs:{"default-value":t.formData.is_general},model:{value:t.formData.is_general,callback:function(e){t.$set(t.formData,"is_general",e)},expression:"formData.is_general"}},t._l(t.generalList,(function(a){return e("a-select-option",{key:a.value},[t._v(" "+t._s(a.label)+" ")])})),1),e("a-radio-group",{staticStyle:{"margin-left":"20px"},on:{change:t.appointTypeChange},model:{value:t.appoint_type,callback:function(e){t.appoint_type=e},expression:"appoint_type"}},[e("a-radio",{attrs:{value:0}},[t._v(" 无需预约 ")]),e("a-radio",{attrs:{value:1}},[e("span",[t._v("提前预约")]),1==t.appoint_type?e("a-input-number",{attrs:{min:0,max:99},model:{value:t.formData.appoint_time,callback:function(e){t.$set(t.formData,"appoint_time",e)},expression:"formData.appoint_time"}}):t._e(),1==t.appoint_type?e("a-select",{staticStyle:{width:"100px"},model:{value:t.formData.appoint_time_type,callback:function(e){t.$set(t.formData,"appoint_time_type",e)},expression:"formData.appoint_time_type"}},t._l(t.appointTimeTypelist,(function(a){return e("a-select-option",{key:a.value,attrs:{value:a.value}},[t._v(" "+t._s(a.label)+" ")])})),1):t._e()],1)],1)],1),e("a-form-model",{attrs:{model:t.formData,"label-col":t.labelCol,"wrapper-col":t.wrapperCol}},[e("a-form-model-item",{attrs:{label:"适用店铺",colon:!1}},[e("span",[t._v(t._s(t.storeStrName||"未选择店铺"))]),e("span",{staticClass:"cr-primary ml-20 pointer",on:{click:t.selectStore}},[t._v("设置")])])],1),e("choose-store",{attrs:{visible:t.selectStoreVisible,storeIdArr:t.formData.store_ids},on:{"update:visible":function(e){t.selectStoreVisible=e},submit:t.onStoreSelect}}),t.formData.store_ids&&1==t.formData.store_ids.length&&t.store_marketing?e("div",[e("a-form-model-item",{attrs:{label:"调价区间",colon:!1,prop:"price_range",help:"该区间表示，分销员进行分销调价的范围；不填写则表示该商品分销时不支持调价"}},[e("a-input-number",{staticStyle:{margin:"-5px 0"},attrs:{formatter:function(t){return"￥ ".concat(t).replace(/\B(?=(\d{3})+(?!\d))/g,",")},parser:function(t){return t.replace(/\￥\s?|(,*)/g,"")},min:0},model:{value:t.formData.price_range_low,callback:function(e){t.$set(t.formData,"price_range_low",e)},expression:"formData.price_range_low"}}),e("span",{staticClass:"cr-99 ml-10 mr-10"},[t._v("—")]),e("a-input-number",{staticStyle:{margin:"-5px 0"},attrs:{formatter:function(t){return"￥ ".concat(t).replace(/\B(?=(\d{3})+(?!\d))/g,",")},parser:function(t){return t.replace(/\￥\s?|(,*)/g,"")},min:0},model:{value:t.formData.price_range_height,callback:function(e){t.$set(t.formData,"price_range_height",e)},expression:"formData.price_range_height"}})],1),e("a-form-model-item",{attrs:{label:"统一分销比例",colon:!1,wrapperCol:{span:4},prop:"marketing_ratio",help:"分销员统一的分销比例"}},[e("a-input-number",{attrs:{min:0,max:100},model:{value:t.formData.marketing_ratio,callback:function(e){t.$set(t.formData,"marketing_ratio",e)},expression:"formData.marketing_ratio"}}),t._v(" % ")],1),t._l(t.formData.ratio_list,(function(a,r){return e("a-form-model-item",{key:a.id,attrs:{prop:"ratio_list."+r+".id",label:" ",colon:!1}},[e("a-select",{staticStyle:{width:"160px"},attrs:{placeholder:"选择分销员"},model:{value:a.id,callback:function(e){t.$set(a,"id",e)},expression:"item.id"}},t._l(t.getMarketingMemberOptions(a.id),(function(a){return e("a-select-option",{key:a.id},[t._v(" "+t._s(a.name)+" ")])})),1),e("span",{staticClass:"ml-20 mr-10"},[t._v("比例")]),e("a-input-number",{attrs:{min:0,max:100},model:{value:a.ratio,callback:function(e){t.$set(a,"ratio",e)},expression:"item.ratio"}}),t._v(" % ")],1)})),t.marketingMemberList.length&&t.formData.ratio_list.length!=t.marketingMemberList.length?e("a-form-model-item",{attrs:{label:" ",colon:!1}},[e("a-button",{staticStyle:{padding:"0"},attrs:{type:"link"},on:{click:function(e){return t.addRatioList()}}},[t._v("+分销员单独设置")])],1):t._e()],2):t._e(),2!=t.formData.tuan_type?e("a-form-model-item",{attrs:{label:"团购券是否可以转赠",colon:!1}},[e("a-radio-group",{staticStyle:{"margin-left":"20px"},attrs:{defaultValue:t.formData.is_give},model:{value:t.formData.is_give,callback:function(e){t.$set(t.formData,"is_give",e)},expression:"formData.is_give"}},[e("a-radio",{attrs:{value:1}},[t._v(" 是 ")]),e("a-radio",{attrs:{value:0}},[t._v(" 否 ")])],1)],1):t._e(),e("a-form-model-item",{attrs:{label:"商品详情",colon:!1}},[e("span",{staticClass:"cr-primary pointer",on:{click:t.insertTab}},[t._v("插入套餐表格")]),e("rich-text",{attrs:{info:t.formData.content},on:{"update:info":function(e){return t.$set(t.formData,"content",e)}}})],1),e("a-modal",{attrs:{title:"输入插入表格行数",width:400,maskClosable:!1},on:{ok:t.onTableOk,cancel:t.onTableCancel},model:{value:t.modalTable,callback:function(e){t.modalTable=e},expression:"modalTable"}},[e("a-input",{model:{value:t.tableLineNum,callback:function(e){t.tableLineNum=e},expression:"tableLineNum"}})],1)],1)],1),e("a-tab-pane",{key:"2",attrs:{tab:"规格/数量","force-render":""}},[e("a-divider",{staticStyle:{height:"10px","background-color":"#eef0f3",margin:"0"}}),e("a-card",{attrs:{bordered:!1}},[e("p",{staticClass:"fs-16"},[t._v("规格设置")]),e("a-divider",{staticStyle:{margin:"10px 0"}}),e("p",{staticClass:"fs-12"},[t._v(" 说明：可为团购商品的规格设置一个价格、库存、同一ID最多购买数量、同一ID每天最多购买数量、同一ID每次最少购买数量。团购规格适用于普通团购，但是当团购类型为其他的时候、规格失效！ ")]),e("div",{staticClass:"flex justify-center align-center text-center mt-20 fw-bold spec-tab"},t._l(t.specTabList,(function(a,r){return e("div",{key:r,staticStyle:{width:"100%"}},[a.tip?e("a-tooltip",{staticClass:"pointer text-wrap",staticStyle:{"max-width":"120px",display:"inline-block"}},[t._v(" "+t._s(a.title)+" "),e("template",{slot:"title"},[t._v(" "+t._s(a.tip))]),e("a-icon",{attrs:{type:"question-circle"}})],2):e("div",{staticClass:"flex flex-1 justify-center align-center text-wrap",staticStyle:{"max-width":"120px"}},[t._v(" "+t._s(a.title)+" ")])],1)})),0),t.formData.spec_list&&t.formData.spec_list.length?e("div",t._l(t.formData.spec_list,(function(a,r){return e("div",{key:r,staticClass:"flex justify-center align-center text-center",staticStyle:{width:"90%",height:"50px",position:"relative"}},[e("div",{staticClass:"flex-1"},[e("a-input",{staticStyle:{width:"60%"},attrs:{maxLength:6},model:{value:a.specifications_name,callback:function(e){t.$set(a,"specifications_name",e)},expression:"singleSpec.specifications_name"}})],1),e("div",{staticClass:"flex-1"},[e("a-input-number",{staticStyle:{width:"60%"},attrs:{min:0,precision:2},model:{value:a.price,callback:function(e){t.$set(a,"price",e)},expression:"singleSpec.price"}})],1),t.store_marketing?e("div",{staticClass:"flex-1"},[e("a-input-number",{staticStyle:{width:"60%"},attrs:{min:0,precision:2},model:{value:a.price_range_low,callback:function(e){t.$set(a,"price_range_low",e)},expression:"singleSpec.price_range_low"}})],1):t._e(),t.store_marketing?e("div",{staticClass:"flex-1"},[e("a-input-number",{staticStyle:{width:"60%"},attrs:{min:0,precision:2},model:{value:a.price_range_height,callback:function(e){t.$set(a,"price_range_height",e)},expression:"singleSpec.price_range_height"}})],1):t._e(),e("div",{staticClass:"flex-1"},[e("a-input-number",{staticStyle:{width:"60%"},attrs:{min:0,precision:2},model:{value:a.old_price,callback:function(e){t.$set(a,"old_price",e)},expression:"singleSpec.old_price"}})],1),e("div",{staticClass:"flex-1"},[e("a-input-number",{staticStyle:{width:"60%"},attrs:{min:0,precision:0},model:{value:a.count_num,callback:function(e){t.$set(a,"count_num",e)},expression:"singleSpec.count_num"}})],1),e("div",{staticClass:"flex-1"},[e("a-input-number",{staticStyle:{width:"60%"},attrs:{min:0,precision:0},model:{value:a.once_max,callback:function(e){t.$set(a,"once_max",e)},expression:"singleSpec.once_max"}})],1),e("div",{staticClass:"flex-1"},[e("a-input-number",{staticStyle:{width:"60%"},attrs:{min:0,precision:0},model:{value:a.once_max_day,callback:function(e){t.$set(a,"once_max_day",e)},expression:"singleSpec.once_max_day"}})],1),e("div",{staticClass:"flex-1"},[e("a-input-number",{staticStyle:{width:"60%"},attrs:{min:1,precision:0},model:{value:a.once_min,callback:function(e){t.$set(a,"once_min",e)},expression:"singleSpec.once_min"}})],1),e("div",{staticClass:"singleSpecDel pointer",on:{click:function(e){return t.delCurSpec(a,r)}}},[t._v("删除")])])})),0):t._e(),e("div",{staticClass:"flex justify-center align-center",staticStyle:{width:"100%",height:"60px"}},[e("a-button",{staticClass:"cr-primary fs-16",staticStyle:{padding:"0 30px","border-color":"#1890ff"},attrs:{icon:"plus"},on:{click:t.addSpecGroup}},[t._v("新增")])],1)],1),e("a-divider",{staticStyle:{height:"10px","background-color":"#eef0f3"}}),e("a-card",{attrs:{bordered:!1}},[e("span",{staticClass:"fs-16 pb-10 pr-20",staticStyle:{height:"24px"}},[t._v("数量设置")]),e("a-divider",{staticStyle:{margin:"10px 0"}}),e("a-form-model-item",{attrs:{label:"转赠是否受限",colon:!1,labelCol:{span:3},help:"商品券转赠好友是受id购买数量限制，即 若转赠好友id已达购买数量 则无法转赠该好友"}},[e("a-radio-group",{attrs:{defaultValue:t.formData.is_give_limit},model:{value:t.formData.is_give_limit,callback:function(e){t.$set(t.formData,"is_give_limit",e)},expression:"formData.is_give_limit"}},[e("a-radio",{attrs:{value:0}},[t._v(" 否 ")]),e("a-radio",{attrs:{value:1}},[e("span",[t._v("是")])])],1)],1),e("a-form-model-item",{attrs:{label:"商品总数量",colon:!1,labelCol:{span:3},help:"如果设置商品规格，则以规格数量为准"}},[e("a-radio-group",{attrs:{defaultValue:t.count_num_type},on:{change:t.countNumTypeChange},model:{value:t.count_num_type,callback:function(e){t.count_num_type=e},expression:"count_num_type"}},[e("a-radio",{attrs:{value:0}},[t._v(" 不限 ")]),e("a-radio",{attrs:{value:1}},[e("span",[t._v("有限")]),e("a-input-number",{directives:[{name:"show",rawName:"v-show",value:"1"==t.count_num_type,expression:"count_num_type == '1'"}],staticStyle:{"margin-left":"20px",width:"100px"},attrs:{min:1,precision:0,placeholder:"请输入"},model:{value:t.formData.count_num,callback:function(e){t.$set(t.formData,"count_num",e)},expression:"formData.count_num"}})],1)],1)],1),e("a-form-model-item",{attrs:{label:"ID最多购买数量",colon:!1,labelCol:{span:3}}},[e("a-radio-group",{attrs:{defaultValue:t.once_max_type},on:{change:t.onceMaxTypeChange},model:{value:t.once_max_type,callback:function(e){t.once_max_type=e},expression:"once_max_type"}},[e("a-radio",{attrs:{value:0}},[t._v(" 不限 ")]),e("a-radio",{attrs:{value:1}},[e("span",[t._v("有限")]),e("a-input-number",{directives:[{name:"show",rawName:"v-show",value:"1"==t.once_max_type,expression:"once_max_type == '1'"}],staticStyle:{"margin-left":"20px",width:"100px"},attrs:{min:1,precision:0,placeholder:"请输入"},model:{value:t.formData.once_max,callback:function(e){t.$set(t.formData,"once_max",e)},expression:"formData.once_max"}})],1)],1)],1),e("a-form-model-item",{attrs:{label:"ID每天最多购买数量",colon:!1,labelCol:{span:3},help:"一个ID每天最多购买数量，会受“ID最多购买数量”配置项限制"}},[e("a-radio-group",{attrs:{defaultValue:t.once_max_day_type},on:{change:t.onceMaxDayTypeChange},model:{value:t.once_max_day_type,callback:function(e){t.once_max_day_type=e},expression:"once_max_day_type"}},[e("a-radio",{attrs:{value:0}},[t._v(" 不限 ")]),e("a-radio",{attrs:{value:1}},[e("span",[t._v("有限")]),e("a-input-number",{directives:[{name:"show",rawName:"v-show",value:"1"==t.once_max_day_type,expression:"once_max_day_type == '1'"}],staticStyle:{"margin-left":"20px",width:"100px"},attrs:{min:1,precision:0,placeholder:"请输入"},model:{value:t.formData.once_max_day,callback:function(e){t.$set(t.formData,"once_max_day",e)},expression:"formData.once_max_day"}})],1)],1)],1),e("a-form-model-item",{attrs:{label:"一次最少购买数量",colon:!1,labelCol:{span:3},help:"购买数量低于此设定的不允许参团"}},[e("a-radio-group",{attrs:{defaultValue:t.once_min_type},on:{change:t.onceMinTypeChange},model:{value:t.once_min_type,callback:function(e){t.once_min_type=e},expression:"once_min_type"}},[e("a-radio",{attrs:{value:0}},[t._v(" 不限 ")]),e("a-radio",{attrs:{value:1}},[e("span",[t._v("有限")]),e("a-input-number",{directives:[{name:"show",rawName:"v-show",value:"1"==t.once_min_type,expression:"once_min_type == '1'"}],staticStyle:{"margin-left":"20px",width:"100px"},attrs:{min:1,placeholder:"请输入",precision:0},model:{value:t.formData.once_min,callback:function(e){t.$set(t.formData,"once_min",e)},expression:"formData.once_min"}})],1)],1)],1)],1),e("a-divider",{staticStyle:{height:"10px","background-color":"#eef0f3"}}),e("a-card",{attrs:{bordered:!1}},[e("p",{staticClass:"fs-16"},[t._v("库存扣减方式")]),e("a-divider",{staticStyle:{margin:"10px 0"}}),e("a-form-model-item",{attrs:{label:" ",colon:!1,labelCol:{span:3}}},[e("a-radio-group",{attrs:{defaultValue:t.formData.stock_reduce_method},model:{value:t.formData.stock_reduce_method,callback:function(e){t.$set(t.formData,"stock_reduce_method",e)},expression:"formData.stock_reduce_method"}},[e("a-radio",{staticStyle:{margin:"10px 20px 20px 0"},attrs:{value:0}},[t._v(" 支付成功后减库存 ")]),e("span",{staticStyle:{"font-size":"10px"}},[t._v("可能会出现售出的数量大于商品数量")]),e("br"),e("a-radio",{attrs:{value:1}},[t._v(" 下单成功后减库存 ")]),e("span",{staticStyle:{"font-size":"10px"}},[t._v("可能会出现大量下单但是没有支付时库存已经没有了，但是如果20分钟后还是没有买单的话系统自动回滚库存")])],1)],1)],1),e("a-divider",{staticStyle:{height:"10px","background-color":"#eef0f3"}}),e("a-card",{attrs:{bordered:!1}},[e("span",{staticClass:"fs-16 pb-10 pr-20",staticStyle:{height:"24px"}},[t._v("拼团人数设置")]),e("span",{staticClass:"fs-12"},[t._v("拼团开启后，规格属性设置无效")]),e("a-divider",{staticStyle:{margin:"10px 0"}}),e("a-form-model-item",{attrs:{label:"拼团人数设置",colon:!1,labelCol:{span:3},help:"若设置拼团，人数最少两人"}},[e("a-radio-group",{attrs:{defaultValue:t.pin_type,disabled:!!t.formData.is_start},model:{value:t.pin_type,callback:function(e){t.pin_type=e},expression:"pin_type"}},[e("a-radio",{attrs:{value:0}},[t._v(" 不拼团 ")]),e("a-radio",{attrs:{value:1}},[e("span",[t._v("拼团")]),e("a-input-number",{directives:[{name:"show",rawName:"v-show",value:"1"==t.pin_type,expression:"pin_type == '1'"}],staticStyle:{"margin-left":"20px",width:"80px"},attrs:{min:2,precision:0,placeholder:"请输入",disabled:!!t.formData.is_start},model:{value:t.formData.pin_num,callback:function(e){t.$set(t.formData,"pin_num",e)},expression:"formData.pin_num"}})],1)],1)],1),e("a-form-model-item",{attrs:{label:"团购优惠比例",colon:!1,labelCol:{span:3},help:"团长优惠（百分比0-100） 0为免费，100为原价"}},[e("a-input-number",{staticStyle:{width:"100px"},attrs:{min:0,max:100,placeholder:"请输入",disabled:!!t.formData.is_start},model:{value:t.formData.start_discount,callback:function(e){t.$set(t.formData,"start_discount",e)},expression:"formData.start_discount"}}),e("span",[t._v("%")])],1),e("a-form-model-item",{attrs:{label:"团购每次最多可购买数量",colon:!1,labelCol:{span:3},help:"团购每次最多可购买数量，默认是一份"}},[e("a-input-number",{staticStyle:{width:"100px"},attrs:{min:1,precision:0,placeholder:"请输入",disabled:!!t.formData.is_start},model:{value:t.formData.start_max_num,callback:function(e){t.$set(t.formData,"start_max_num",e)},expression:"formData.start_max_num"}})],1),e("a-form-model-item",{attrs:{label:"成团后退款手续费比例",colon:!1,labelCol:{span:3},help:"手续费将按单价百分比（0-100）收取，设置为100（成团前所有参团人也不可退）则不允许退款"}},[e("a-input-number",{staticStyle:{width:"100px"},attrs:{min:0,max:100,placeholder:"请输入"},model:{value:t.formData.group_refund_fee,callback:function(e){t.$set(t.formData,"group_refund_fee",e)},expression:"formData.group_refund_fee"}})],1),e("a-form-model-item",{attrs:{label:"成团有效期",colon:!1,labelCol:{span:3},help:"有效期内未成团团购不能取消订单，单位：小时"}},[e("a-input-number",{staticStyle:{width:"100px"},attrs:{min:0,placeholder:"请输入"},model:{value:t.formData.pin_effective_time,callback:function(e){t.$set(t.formData,"pin_effective_time",e)},expression:"formData.pin_effective_time"}})],1),e("p",{staticStyle:{"margin-left":"100px"}},[t._v(" 拼团人数设置后，团购按拼团的逻辑走，如果当前团购有组团购在进行则不能设置 ")])],1)],1),e("a-tab-pane",{key:"3",attrs:{tab:"其他设置","force-render":""}},[e("a-divider",{staticStyle:{height:"10px","background-color":"#eef0f3",margin:"0"}}),e("a-card",{attrs:{bordered:!1}},[e("span",{staticClass:"fs-16 pb-10 pr-20",staticStyle:{height:"24px"}},[t._v("补充信息")]),e("a-divider",{staticStyle:{margin:"10px 0"}}),e("a-form-model-item",{attrs:{label:"商品简介",colon:!1,labelCol:{span:3},help:"限100字"}},[e("a-input",{staticStyle:{width:"300px"},attrs:{maxLength:100,placeholder:"请输入商品简介"},model:{value:t.formData.intro,callback:function(e){t.$set(t.formData,"intro",e)},expression:"formData.intro"}})],1),e("a-form-model-item",{attrs:{label:"团购专页分类",colon:!1,labelCol:{span:3}}},[e("a-select",{staticStyle:{width:"200px"},attrs:{placeholder:"一级分类"},on:{change:t.handleGroupCategoryChange},model:{value:t.formData.cat_fid,callback:function(e){t.$set(t.formData,"cat_fid",e)},expression:"formData.cat_fid"}},t._l(t.groupCategoryList,(function(a){return e("a-select-option",{key:a.sort_id,attrs:{value:a.sort_id}},[t._v(" "+t._s(a.sort_name)+" ")])})),1),e("a-select",{staticStyle:{width:"200px","margin-left":"20px"},attrs:{placeholder:"二级分类"},model:{value:t.formData.cat_id,callback:function(e){t.$set(t.formData,"cat_id",e)},expression:"formData.cat_id"}},t._l(t.currentGroupCat.children,(function(a){return e("a-select-option",{key:a.sort_id,attrs:{value:a.sort_id}},[t._v(" "+t._s(a.sort_name)+" ")])})),1)],1),e("a-form-model-item",{attrs:{label:"是否支持自动核销",colon:!1,labelCol:{span:3},"wrapper-col":{span:18},help:"选择支持，则用户付款该团购商品后该订单自动核销，无需店员操作核销动作；自动核销只支持团购商品归属为一个店铺，如果归属为多个店铺，则默认核销第一个店铺。"}},[e("a-radio-group",{attrs:{defaultValue:t.formData.auto_check},model:{value:t.formData.auto_check,callback:function(e){t.$set(t.formData,"auto_check",e)},expression:"formData.auto_check"}},[e("a-radio",{attrs:{value:0}},[t._v(" 不支持 ")]),e("a-radio",{attrs:{value:1}},[t._v(" 支持 ")])],1)],1)],1),e("a-divider",{staticStyle:{height:"10px","background-color":"#eef0f3"}}),e("a-card",{attrs:{bordered:!1}},[e("p",{staticClass:"fs-16"},[t._v("会员优惠")]),e("a-divider",{staticStyle:{margin:"10px 0"}}),e("p",{staticClass:"fs-12"},[t._v(" 说明：必须设置一个会员等级优惠类型和优惠类型对应的数值，我们将结合优惠类型和所填的数量来计算该商品会员等级的优惠幅度！ ")]),t._l(t.levelInfoList,(function(a){return e("div",{key:a.lid},[e("a-form-model-item",{attrs:{label:a.lname,colon:!1,labelCol:{span:3}}},[e("span",{staticClass:"mr-10"},[t._v("优惠类型")]),e("a-select",{staticClass:"mr-20",staticStyle:{width:"150px"},attrs:{disabled:t.discount_sync_status},model:{value:a.type,callback:function(e){t.$set(a,"type",e)},expression:"item.type"}},t._l(t.levelList,(function(a){return e("a-select-option",{key:a.type},[t._v(" "+t._s(a.title)+" ")])})),1),e("a-input-number",{staticStyle:{"margin-left":"20px",width:"200px"},attrs:{placeholder:"请输入对应优惠金额",min:0,precision:2,disabled:t.discount_sync_status},model:{value:a.vv,callback:function(e){t.$set(a,"vv",e)},expression:"item.vv"}})],1)],1)}))],2),e("a-divider",{staticStyle:{height:"10px","background-color":"#eef0f3"}}),e("a-card",{attrs:{bordered:!1}},[e("p",{staticClass:"fs-16"},[t._v("其他设置")]),e("a-divider",{staticStyle:{margin:"10px 0"}}),e("a-card",{attrs:{bordered:!1}},[e("span",{staticStyle:{"margin-left":"60px"}},[e("strong",[t._v("套餐设置")])]),e("a-form-model-item",{attrs:{label:"本团购套餐标签",colon:!1,labelCol:{span:3}}},[e("a-input",{staticStyle:{width:"300px"},attrs:{placeholder:"请输入标签名称"},model:{value:t.formData.tagname,callback:function(e){t.$set(t.formData,"tagname",e)},expression:"formData.tagname"}})],1),e("a-form-model-item",{attrs:{label:"选择加入套餐",colon:!1,labelCol:{span:3}}},[e("a-select",{staticStyle:{width:"300px"},on:{change:t.onPackagesChange},model:{value:t.formData.packageid,callback:function(e){t.$set(t.formData,"packageid",e)},expression:"formData.packageid"}},t._l(t.packagesList,(function(a){return e("a-select-option",{key:a.id,attrs:{value:a.id}},[t._v(" "+t._s(a.title)+" ")])})),1)],1)],1),e("a-card",{attrs:{bordered:!1}},[e("span",{staticStyle:{"margin-left":"60px"}},[e("strong",[t._v("运费模板")])]),e("a-form-model-item",{attrs:{label:"选择运费模板",colon:!1,labelCol:{span:3}}},[e("a-select",{staticStyle:{width:"300px"},on:{change:t.onExpTemChange},model:{value:t.formData.express_template_id,callback:function(e){t.$set(t.formData,"express_template_id",e)},expression:"formData.express_template_id"}},t._l(t.expressList,(function(a){return e("a-select-option",{key:a.id,attrs:{value:a.id}},[t._v(" "+t._s(a.name)+" ")])})),1)],1),e("a-form-model-item",{attrs:{label:"其他区域运费",colon:!1,labelCol:{span:3}}},[e("a-input-number",{staticStyle:{width:"300px"},attrs:{placeholder:"请输入运费"},model:{value:t.formData.express_fee,callback:function(e){t.$set(t.formData,"express_fee",e)},expression:"formData.express_fee"}})],1)],1),e("a-card",{attrs:{bordered:!1}},[e("span",{staticStyle:{"margin-left":"60px"}},[e("strong",[t._v("到店自提")])]),e("a-form-model-item",{attrs:{label:"到店自提",colon:!1,labelCol:{span:3}}},[e("a-radio-group",{on:{change:function(e){return t.onPickInStoreChange(t.formData.pick_in_store)}},model:{value:t.formData.pick_in_store,callback:function(e){t.$set(t.formData,"pick_in_store",e)},expression:"formData.pick_in_store"}},[e("a-radio",{attrs:{value:1}},[t._v(" 开启 ")]),e("a-radio",{staticStyle:{"margin-right":"10px"},attrs:{value:0}},[t._v(" 关闭 ")]),e("span",{staticStyle:{"font-size":"10px"}},[t._v("没有设置其他到店自提地点，默认自提点为团购的店铺")])],1)],1)],1),e("a-card",{attrs:{bordered:!1}},[e("span",{staticStyle:{"margin-left":"60px"}},[e("strong",[t._v("绑定插件")])]),e("a-form-model-item",{staticStyle:{"margin-bottom":"10px"},attrs:{label:"绑定插件",colon:!1,labelCol:{span:3}}},[e("a-select",{staticStyle:{width:"300px"},on:{change:t.onTradeTypeChange},model:{value:t.formData.trade_type,callback:function(e){t.$set(t.formData,"trade_type",e)},expression:"formData.trade_type"}},t._l(t.tradeTypeList,(function(a){return e("a-select-option",{key:a.value,attrs:{value:a.value}},[t._v(" "+t._s(a.label)+" ")])})),1)],1),"appoint"==t.formData.trade_type?e("a-form-model-item",{attrs:{label:"选择预约",labelCol:{span:3}}},[e("a-select",{staticStyle:{width:"300px"},on:{change:t.onAppointPlugChange},model:{value:t.formData.appoint_id,callback:function(e){t.$set(t.formData,"appoint_id",e)},expression:"formData.appoint_id"}},t._l(t.appointList,(function(a){return e("a-select-option",{key:a.appoint_id,attrs:{value:a.appoint_id}},[t._v(" "+t._s(a.appoint_name)+" ")])})),1)],1):t._e(),"hotel"==t.formData.trade_type?e("a-form-model-item",{attrs:{label:"绑定分类",labelCol:{span:3}}},[e("a-checkbox-group",{on:{change:t.onHotelPlugChange},model:{value:t.formData.trade_info,callback:function(e){t.$set(t.formData,"trade_info",e)},expression:"formData.trade_info"}},t._l(t.hotelList,(function(a){return e("a-checkbox",{key:a.cat_id,attrs:{value:a.cat_id}},[t._v(" "+t._s(a.cat_name)+" ")])})),1)],1):t._e()],1),e("a-card",{attrs:{bordered:!1}},[e("span",{staticStyle:{"margin-left":"60px"}},[e("strong",[t._v("状态设置")])]),e("a-form-model-item",{attrs:{label:"团购状态",colon:!1,labelCol:{span:3}}},[e("a-radio-group",{attrs:{defaultValue:1},on:{change:function(e){return t.onStatusChange(t.formData.status)}},model:{value:t.formData.status,callback:function(e){t.$set(t.formData,"status",e)},expression:"formData.status"}},[e("a-radio",{attrs:{value:"1"}},[t._v(" 开启 ")]),e("a-radio",{staticStyle:{"margin-right":"10px"},attrs:{value:"0"}},[t._v(" 关闭 ")]),e("span",{staticStyle:{"font-size":"10px"}},[t._v("为了方便用户能查找到以前的订单，团购无法删除！")])],1)],1)],1)],1)],1)],1)],1),e("div",{staticClass:"page-header"},[e("a-button",{staticClass:"ml-20 mt-20 mb-20",attrs:{type:"primary"},on:{click:function(e){return t.submitForm()}}},[t._v(" 保存 ")])],1)],1)},i=[],o=a("8ee2"),n=a("4bb5d"),s=a("dff4"),l=a("d34b"),c=(a("c5cb"),a("08c7"),a("4afa"),a("6e84"),a("19f1"),a("f597"),a("075f"),a("a532"),a("7023"),a("cd5d"),a("5532"),a("0d36"),a("7b3f")),m=a("4b77"),p=a("6ec16"),u=a("2b69"),d=a("4928"),f=a("2f42"),h=a.n(f);function _(t){return new Promise((function(e,a){var r=new FileReader;r.readAsDataURL(t),r.onload=function(){return e(r.result)},r.onerror=function(t){return a(t)}}))}var g={components:{RichText:p["a"],ChooseStore:u["default"],AddGoodsTags:d["default"]},data:function(){return{activeKey:"1",labelCol:{span:4},wrapperCol:{span:14},groupGoodsInfo:"",selectStoreVisible:!1,formData:{group_id:"",tuan_type:2,open_express:0,s_name:"",label_group:"",label_ids:[],pass_num:0,goods_label_group:"",old_price:"",price:"",price_range_low:0,price_range_height:0,marketing_ratio:0,ratio_list:[],is_invoice:1,begin_time:"",end_time:"",effective_type:0,deadline_time:"",cancel_type:0,cancel_hours:"",is_general:0,appoint_time:0,appoint_time_type:0,store_ids:[],content:"",spec_list:[],count_num:"",once_max:"",once_max_day:"",once_min:"",stock_reduce_method:0,pin_num:2,start_discount:0,start_max_num:"1",group_refund_fee:"0",pin_effective_time:"0",name:"",intro:"",auto_check:0,leveloff_list:[],tagname:"",packageid:"",express_template_id:"",express_fee:"",pick_in_store:1,trade_type:"",trade_info:[],appoint_id:"",status:"1",is_give_limit:0,is_give:0},tempData:{count_num:0,once_max:0,once_max_day:0,once_min:0},appoint_type:0,dateFormat:"YYYY-MM-DD HH:mm:ss",currentIndex:0,previewVisible:!1,previewImage:"",imgUploadList:[],uploadImg:"/v20/public/index.php"+c["a"].uploadImg+"?upload_dir=/group",mailTypeList:[{value:0,label:"不支持邮寄"},{value:1,label:"支持邮寄"}],isInvoiceList:[{value:1,label:"提供发票"},{value:0,label:"不提供发票"}],generalList:[{value:0,label:"周末、法定节假日通用"},{value:1,label:"周末不能使用"},{value:2,label:"法定节假日不能使用"},{value:3,label:"周末、法定节假日不能通用"}],appointTimeTypelist:[{value:0,label:"天"},{value:1,label:"小时"}],specTabList:[{title:"规格名称",tip:"仅限6位长度"},{title:"价格",tip:"如果填写规格则必填。最多支持2位小数！"},{title:"调价区间最低价",tip:"选填。"},{title:"调价区间最高价",tip:"选填。"},{title:"原价",tip:"选填。最多支持2位小数"},{title:"库存",tip:"0表示不限制，否则产品会出现“已卖光”状态！"},{title:"同一ID最多购买数量",tip:"同一个ID最多购买数量，0表示不限制！请填写大于等于零的值！"},{title:"同一ID每天最多购买数量",tip:"同一ID每天最多购买数量，0表示不限制！请填写大于等于零的值！"},{title:"同一ID每次最少购买数量",tip:"同一ID每次最少购买数量，购买数量低于此设定的不允许参团！请填写大于等于1的值！"}],count_num_type:0,once_max_type:0,once_max_day_type:0,once_min_type:0,pin_type:0,storeStrName:"",groupCategoryList:[],currentGroupCat:{children:[]},levelInfoList:[],levelList:[{type:0,title:"无优惠"},{type:1,title:"百分比（%）"},{type:2,title:"立减"}],packagesList:[{id:0,title:"不加入任何套餐"}],expressList:[{id:0,name:"不选择运费模板"}],tradeTypeList:[{value:"",label:"不绑定插件"},{value:"appoint",label:"预约模块"},{value:"hotel",label:"酒店模块"}],appointList:[{appoint_name:"请选择",appoint_id:0}],hotelList:[],modalTable:!1,tableLineNum:"",checkLabelReslut:!0,canSave:!0,marketingMemberList:[],store_marketing:!0,discount_sync_status:!1}},watch:{$route:function(t){"/merchant/merchant.group/goodsEdit"==t.path&&(t.query.group_id?this.getGoodsNormalDetail():Object.assign(this.$data,this.$options.data()))}},mounted:function(){this.activeKey="1",this.getGroupEditInfo(),this.onTradeTypeChange(""),this.$route.query.group_id?this.getGoodsNormalDetail():Object.assign(this.$data,this.$options.data())},activated:function(){this.activeKey="1",this.getGroupEditInfo(),this.onTradeTypeChange(""),this.$route.query.group_id?this.getGoodsNormalDetail():Object.assign(this.$data,this.$options.data())},methods:{moment:h.a,onTabChange:function(t){this.activeKey=t},disabledStartDate:function(t){var e=this.formData.end_time;return t&&e?t.valueOf()>e.valueOf():t&&t<h()().subtract(1,"days")},disabledEndDate:function(t){var e=this.formData.begin_time;return e?e.valueOf()>=t.valueOf():t&&t<h()().subtract(1,"days")},date_moment:function(t,e){return t?h()(t,e):null},handleImgCancel:function(){this.previewVisible=!1},handlePreview:function(t){var e=this;return Object(l["a"])(Object(s["a"])().mark((function a(){return Object(s["a"])().wrap((function(a){while(1)switch(a.prev=a.next){case 0:if(t.url||t.preview){a.next=4;break}return a.next=3,_(t.originFileObj);case 3:t.preview=a.sent;case 4:e.previewImage=t.url||t.preview,e.previewVisible=!0;case 6:case"end":return a.stop()}}),a)})))()},handleImgChange:function(t){var e=this,a=Object(n["a"])(t.fileList),r=[];this.imgUploadList=a,a.forEach((function(a,i){if("done"===a.status)if(a.response&&"1000"==a.response.status||a.url){var o="";a.response&&a.response.data?o=a.response.data.full_url:a.url&&(o=a.url),o&&r.push(o),e.$set(e.formData,"image",r),e.formData=JSON.parse(JSON.stringify(e.formData))}else e.imgUploadList.splice(i,1),e.$message.error(a.response.msg||"上传失败！");else"error"===t.file.status&&(e.imgUploadList.splice(i,1),e.$message.error("".concat(t.file.name," 上传失败！")))}))},beginTimeChange:function(t,e){this.formData.begin_time=e},endTimeChange:function(t,e){var a=h()(this.formData.begin_time).valueOf(),r=h()(e).valueOf();r<a?this.$message.error("活动结束时间必须大于活动开始时间！"):this.formData.end_time=e},deadlineTimeChange:function(t,e){var a=h()(this.formData.end_time).valueOf(),r=h()(e).valueOf();r<a&&0==this.formData.effective_type?this.$message.error("团购券有效期必须大于活动结束时间！"):this.formData.deadline_time=e},appointTypeChange:function(t){0==t.target.value&&(this.formData.appoint_time=0)},addSpecGroup:function(){this.currentIndex=this.formData.spec_list.length;var t=this.formData.spec_list||[];t.push({specifications_id:"",specifications_name:"",price:"",price_range_low:0,price_range_height:0,old_price:"",count_num:"",sale_count:"",once_max:"",once_max_day:"",once_min:""}),this.$set(this.formData,"spec_list",t)},delCurSpec:function(t,e){var a=this.formData.spec_list||[];a.length&&a.splice(e,1),this.$set(this.formData,"spec_list",a)},getLabelId:function(t){var e=t.labelGroup,a=t.labelIds;this.formData.label_group=e,this.formData.label_ids=a},getGroupEditInfo:function(){var t=this;this.request(m["a"].getGroupEditInfo).then((function(e){if(e.packages_list&&e.packages_list.length&&(t.packagesList=t.packagesList.concat(e.packages_list),t.$route.query.group_id||t.$set(t.formData,"packageid",t.packagesList[0].id)),e.group_category_list&&e.group_category_list.length){t.groupCategoryList=e.group_category_list;var a=t.formData.cat_fid||"";a||(a=t.groupCategoryList[0].sort_id,t.$set(t.formData,"cat_fid",a)),t.groupCategoryList.length&&t.handleGroupCategoryChange(a)}e.express_list&&e.express_list.length&&(t.expressList=t.expressList.concat(e.express_list),t.$route.query.group_id||t.$set(t.formData,"express_template_id",t.expressList[0].id)),e.appoint_list&&e.appoint_list.length&&(t.appointList=t.appointList.concat(e.appoint_list)),e.hotel_list&&e.hotel_list.length&&(t.hotelList=e.hotel_list),e.user_level&&e.user_level.length&&(t.levelInfoList=e.user_level),t.store_marketing=!!e.store_marketing,t.discount_sync_status=e.discount_sync_status,t.store_marketing||(t.specTabList=[{title:"规格名称",tip:"仅限6位长度"},{title:"价格",tip:"如果填写规格则必填。最多支持2位小数！"},{title:"原价",tip:"选填。最多支持2位小数"},{title:"库存",tip:"0表示不限制，否则产品会出现“已卖光”状态！"},{title:"同一ID最多购买数量",tip:"同一个ID最多购买数量，0表示不限制！请填写大于等于零的值！"},{title:"同一ID每天最多购买数量",tip:"同一ID每天最多购买数量，0表示不限制！请填写大于等于零的值！"},{title:"同一ID每次最少购买数量",tip:"同一ID每次最少购买数量，购买数量低于此设定的不允许参团！请填写大于等于1的值！"}])}))},handleGroupCategoryChange:function(t){for(var e in this.groupCategoryList){var a=this.groupCategoryList[e];if(a.sort_id==t)return this.$set(this.currentGroupCat,"children",a.children),this.currentGroupCat=JSON.parse(JSON.stringify(this.currentGroupCat)),void(a.children&&a.children.length&&!this.formData.cat_id?this.$set(this.formData,"cat_id",a.children[0].sort_id):this.$set(this.formData,"cat_id",this.formData.cat_id?this.formData.cat_id:void 0))}},onPackagesChange:function(t){this.formData.packageid=t},onExpTemChange:function(t){this.formData.express_template_id=t},onPickInStoreChange:function(t){this.formData.pick_in_store=t},onTradeTypeChange:function(t){this.formData.trade_type=t},onAppointPlugChange:function(t){this.formData.appoint_id=t},onHotelPlugChange:function(t){this.formData.trade_info=t},onStatusChange:function(t){this.formData.status=t},selectStore:function(){this.selectStoreVisible=!this.selectStoreVisible},insertTab:function(){this.modalTable=!0},onTableOk:function(){for(var t='<tr class="firstRow">\n                    <td width="102" valign="top" style="word-break: break-all;">套餐内容<br /></td>\n                    <td width="102" valign="top" style="word-break: break-all;">单价<br /></td>\n                    <td width="102" valign="top" style="word-break: break-all;">数量/规格</td>\n                    <td width="102" valign="top" style="word-break: break-all;">小计</td>\n                  </tr>',e='<tr>\n                    <td width="102" valign="top" style="word-break: break-all;">内容1</td>\n                    <td width="102" valign="top" style="word-break: break-all;">￥</td>\n                    <td width="102" valign="top" style="word-break: break-all;">1份</td>\n                    <td width="102" valign="top" style="word-break: break-all;">￥</td>\n                  </tr>',a='<td width="102" valign="top" style="word-break: break-all;" rowspan="1" colspan="4">\n                      <p style="text-align: right;">价值：￥&nbsp; &nbsp;&nbsp; &nbsp;团购价：￥</p>\n                     </td>',r=0;r<this.tableLineNum;r++)t+=e;var i=t+a;this.formData.content&&(i=this.formData.content+t+a),this.$set(this.formData,"content",i),this.modalTable=!1},onTableCancel:function(){this.modalTable=!1},getGoodsNormalDetail:function(){var t=this,e={group_id:this.$route.query.group_id};1*this.$route.query.group_id>0&&this.request(m["a"].getGoodsNormalDetail,e).then((function(e){if(t.formData.is_give=e.is_give,t.formData=Object(o["a"])({},e),t.formData.tuan_type=e.tuan_type,t.formData.pass_num=e.pass_num,t.formData.open_express=e.open_express,t.formData.s_name=e.s_name,t.formData.old_price=Number(e.old_price),t.formData.price=Number(e.price),t.formData.price_range_low=Number(e.price_range_low)||0,t.formData.price_range_height=Number(e.price_range_height)||0,t.formData.marketing_ratio=e.marketing_ratio||0,t.formData.ratio_list=e.ratio_list||[],t.formData.is_invoice=e.is_invoice,t.formData.is_start=e.is_start,t.formData.image=e.image||[],e.image){for(var a=[],r=0;r<e.image.length;r++){var i={uid:r,name:"image_"+r,status:"done",url:e.image[r]};a.push(i)}t.imgUploadList=a}if(t.formData.begin_time=e.begin_time,t.formData.end_time=e.end_time,t.formData.effective_type=e.effective_type,t.formData.deadline_time=e.deadline_time,t.formData.cancel_type=e.cancel_type,1==e.cancel_type&&(t.formData.cancel_hours=e.cancel_hours),0==e.appoint_time?(t.appoint_type=0,t.formData.appoint_time=0):(t.appoint_type=1,t.formData.appoint_time_type=e.appoint_time_type,t.formData.appoint_time=e.appoint_time),e.store.ids){var n=e.store.ids?e.store.ids:[],s=e.store.detail?e.store.detail:[],l=[];n.forEach((function(e){s.forEach((function(a){e.store_id==a.store_id&&(l.push(a.name),e.name=a.name,t.storeStrName=l.join(","))}))})),t.$set(t.formData,"store_ids",n),1==n.length&&t.getMarketingMemberList()}t.formData.spec_list=e.spec_list,0==e.count_num?t.count_num_type=0:t.count_num_type=1,t.tempData.count_num=e.count_num,t.formData.count_num=Number(e.count_num)||0,0==e.once_max?t.once_max_type=0:t.once_max_type=1,t.tempData.once_max=e.once_max,t.formData.once_max=Number(e.once_max)||0,0==e.once_max_day?t.once_max_day_type=0:t.once_max_day_type=1,t.tempData.once_max_day=e.once_max_day,t.formData.once_max_day=Number(e.once_max_day)||0,0==e.once_min?t.once_min_type=0:t.once_min_type=1,t.tempData.once_min=e.once_min,t.formData.once_min=Number(e.once_min)||0,t.formData.stock_reduce_method=e.stock_reduce_method,0==e.pin_num?t.pin_type=0:(t.pin_type=1,t.formData.pin_num=Number(e.pin_num)||2),t.formData.start_discount=e.start_discount,t.formData.start_max_num=e.start_max_num,t.formData.group_refund_fee=e.group_refund_fee,t.formData.pin_effective_time=e.pin_effective_time,t.formData.name=e.name,t.formData.intro=e.intro,e.cat_fid&&(t.formData.cat_fid=e.cat_fid,e.cat_id&&(t.formData.cat_id=e.cat_id,t.handleGroupCategoryChange(t.formData.cat_fid))),t.formData.auto_check=Number(e.auto_check),t.levelInfoList=e.leveloff_list||[],t.formData.tagname=e.tagname,t.formData.packageid=e.packageid,t.formData.express_template_id=e.express_template_id,t.formData.express_fee=e.express_fee,t.formData.pick_in_store=Number(e.pick_in_store),t.formData.trade_type=0==e.trade_type?"":e.trade_type,t.formData.appoint_id=e.appoint_id,t.formData.trade_info=e.trade_info?e.trade_info.split(",").map((function(t){return Number(t)})):[],t.formData.label_group=e.label_group||"",t.formData.label_ids=e.label_ids&&e.label_ids.length?e.label_ids.map((function(t){return Number(t)})):[],t.formData.status=e.status.toString(),t.formData=JSON.parse(JSON.stringify(t.formData)),t.formData.content=decodeURIComponent(e.content)}))},onStoreSelect:function(t){this.selectStoreVisible=!1;var e=t.storeName,a=t.storeIds;this.storeStrName=e,this.formData.store_ids=a,this.$set(this.formData,"ratio_list",[]),this.getMarketingMemberList()},submitForm:function(){var t=this;if(this.canSave){if(2==this.formData.tuan_type&&this.formData.pass_num&&this.$set(this.formData,"pass_num",0),!this.formData.s_name.trim())return this.$message.error("请输入商品名称！"),this.activeKey="1",!1;if(b(this.formData.old_price))return this.$message.error("请输入商品原价！"),this.activeKey="1",!1;if(b(this.formData.price))return this.$message.error("请输入商品团购价！"),this.activeKey="1",!1;if(!b(this.formData.old_price)&&!b(this.formData.price)&&Number(this.formData.price)>Number(this.formData.old_price))return this.$message.error("商品团购价不能大于商品原价！"),this.activeKey="1",!1;if(!this.formData.image||this.formData.image&&!this.formData.image.length)return this.$message.error("请上传图片！"),this.activeKey="1",!1;if(b(this.formData.begin_time))return this.$message.error("请选择团购开始时间！"),this.activeKey="1",!1;if(b(this.formData.end_time))return this.$message.error("请选择团购开始时间！"),this.activeKey="1",!1;if(this.validateDeadlineTime()){if(1==this.formData.cancel_type&&b(this.formData.cancel_hours))return this.$message.error("请输入可提前取消时长！"),this.activeKey="1",!1;if(1==this.appoint_type&&b(this.formData.appoint_time))return this.$message.error("请输入可提前预约时长！"),this.activeKey="1",!1;if(!this.formData.store_ids.length)return this.$message.error("请选择适用店铺！"),this.activeKey="1",!1;if(this.formData.store_ids&&1==this.formData.store_ids.length){if(0!=Number(this.formData.price_range_low)||0!=Number(this.formData.price_range_height)){if(Number(this.formData.price_range_height)<Number(this.formData.price_range_low))return this.$message.error("调价区间最高价不能小于调价区间最低价"),this.activeKey="1",!1;if(Number(this.formData.price)<Number(this.formData.price_range_low))return this.$message.error("价格不能小于调价区间最低价"),this.activeKey="1",!1;if(Number(this.formData.price)>Number(this.formData.price_range_height))return this.$message.error("价格不能大于调价区间最高价"),this.activeKey="1",!1}if(Number(this.formData.marketing_ratio)<0||Number(this.formData.marketing_ratio)>100)return this.$message.error("统一分销比例必须在0-100之间"),this.activeKey="1",!1;var e=this.formData.ratio_list||[];if(e.length){e=e.filter((function(t){return t.id}));var a=e.every((function(t){return Number(t.ratio)>=0&&Number(t.ratio)<=100}));if(!a)return this.$message.error("分销员分销比例必须在0-100之间"),this.activeKey="1",!1}}else this.$set(this.formData,"price_range_low",0),this.$set(this.formData,"price_range_height",0),this.$set(this.formData,"marketing_ratio",0),this.$set(this.formData,"ratio_list",[]);if(!this.checkLabelReslut)return this.activeKey="1",!1;if(this.validateSpecList())return this.formData.leveloff_list=this.levelInfoList,b(this.formData.count_num)&&this.$set(this.formData,"count_num",0),0==this.pin_type&&this.$set(this.formData,"pin_num",0),b(this.formData.name)?(this.$message.error("请输入商品标题！"),this.activeKey="3",!1):!b(this.formData.name)&&this.formData.name.length>100?(this.$message.error("商品标题限100字！"),this.activeKey="3",!1):void this.$refs.ruleForm.validate((function(e){if(!e)return!1;t.canSave=!1;var a={};for(var r in t.formData)a[r]="content"==r?t.formData.content:"ratio_list"==r?t.formData.ratio_list.filter((function(t){return t.id})):t.formData[r];a["group_id"]=t.$route.query.group_id||"",a["trade_info"]=t.formData.trade_info&&t.formData.trade_info.length?t.formData.trade_info.join(","):"",t.request(m["a"].saveNomalGoods,a).then((function(e){t.activeKey="1",t.$route.query.group_id||Object.assign(t.$data,t.$options.data()),t.$message.success("提交成功！",2,(function(){t.$router.push({path:"/merchant/merchant.group/groupList"}),t.$message.destroy(),t.canSave=!0}))})).catch((function(e){t.canSave=!0}))}))}}},validateDeadlineTime:function(){var t=!0;if(""===this.formData.deadline_time)this.$message.error("请选择团购券有效期"),this.activeKey="1",t=!1;else if(0==this.formData.effective_type&&this.formData.end_time){var e=h()(this.formData.end_time).valueOf(),a=h()(this.formData.deadline_time).valueOf();a<e&&(this.$message.error("团购券有效期必须大于活动结束时间"),t=!1,this.activeKey="1")}return t},validateSpecList:function(){var t=!0,e=this.formData.spec_list||[];if(e.length)for(var a=0;a<e.length;a++){var r=e[a].specifications_name.trim()||"",i=Number(e[a].price)||0;if(!r){t=!1,this.$message.error("请输入商品规格名称");break}if(!i){t=!1,this.activeKey="2",this.$message.error("请输入商品规格价格");break}if(Number(e[a].price_range_low)>0){if(Number(e[a].price_range_low)>Number(e[a].price)){t=!1,this.$message.error("调价区间最高价不能小于调价区间最低价");break}if(Number(e[a].price_range_low)>Number(e[a].price)){t=!1,this.$message.error("价格不能小于调价区间最低价");break}if(Number(e[a].price_range_height)<Number(e[a].price)){t=!1,this.$message.error("价格不能大于调价区间最高价");break}}}return t},getMarketingMemberList:function(){var t=this;this.request(m["a"].getRatioList,{store_id:this.formData.store_ids[0].store_id}).then((function(e){e.ratio_list&&Array.isArray(e.ratio_list)&&e.ratio_list.length?t.marketingMemberList=e.ratio_list:t.marketingMemberList=[]}))},addRatioList:function(){var t=this.formData.ratio_list||[];t.push({id:void 0,ratio:Number(this.formData.marketing_ratio)}),this.$set(this.formData,"ratio_list",t)},getMarketingMemberOptions:function(t){var e=this.formData.ratio_list.map((function(t){return t.id}));return e=e.filter((function(e){return e!=t})),this.marketingMemberList.filter((function(t){return!e.includes(t.id)}))},countNumTypeChange:function(t){0==t.target.value?this.formData.count_num=0:this.formData.count_num=0==this.tempData.count_num?1:this.tempData.count_num},onceMaxTypeChange:function(t){0==t.target.value?this.formData.once_max=0:this.formData.once_max=0==this.tempData.once_max?1:this.tempData.once_max},onceMaxDayTypeChange:function(t){0==t.target.value?this.formData.once_max_day=0:this.formData.once_max_day=0==this.tempData.once_max_day?1:this.tempData.once_max_day},onceMinTypeChange:function(t){0==t.target.value?this.formData.once_min=0:this.formData.once_min=0==this.tempData.once_min?1:this.tempData.once_min}}};function b(t){return"undefined"===typeof t||null===t||""===t}var v=g,y=(a("0078"),a("0b56")),D=Object(y["a"])(v,r,i,!1,null,"513ace08",null);e["default"]=D.exports}}]);