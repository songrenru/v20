(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-b2f98228","chunk-2d0a310a"],{"011d":function(t,e,s){"use strict";var o={getSearchHotList:"/mall/platform.MallSearchHot/getSearchHotList",getHotRecord:"/mall/platform.MallSearchHot/getHotRecord",addOrEditSearchHot:"/mall/platform.MallSearchHot/addOrEditSearchHot",getEditSearchHot:"/mall/platform.MallSearchHot/getEditSearchHot",delSearchHot:"/mall/platform.MallSearchHot/delSearchHot",saveSort:"/mall/platform.MallSearchHot/saveSort",getGoodsList:"/mall/platform.MallPlatformGoods/getGoodsList",getMerOrStoreList:"/mall/platform.MallPlatformGoods/getMerOrStoreList",goodsCategoryList:"/mall/platform.MallGoodsCategory/goodsCategoryList",goodsSetSort:"/mall/platform.MallPlatformGoods/setSort",getGoodsListByName:"/mall/platform.MallPlatformGoods/getGoodsListByName",exportGoods:"/mall/platform.MallPlatformGoods/exportGoods",goodsSetIntegral:"/mall/platform.MallPlatformGoods/setIntegral",goodsSetCommission:"/mall/platform.MallPlatformGoods/setCommission",goodsSetVirtual:"/mall/platform.MallPlatformGoods/setVirtual",goodsSetStatus:"/mall/platform.MallPlatformGoods/setStatus",goodsSetFirst:"/mall/platform.MallPlatformGoods/setFirst",merchantGoodsEdit:"/mall/platform.mallPlatformGoods/merchantGoodsEdit",getActivityRecommendList:"/mall/platform.MallActivityRecommend/getActivityRecommendList",getLimitedRecommendList:"/mall/platform.mallActivityRecommend/getLimitedRecommendList",getBargainRecommendList:"/mall/platform.mallActivityRecommend/getBargainRecommendList",getGroupRecommendList:"/mall/platform.mallActivityRecommend/getGroupRecommendList",editLimitedRecommend:"/mall/platform.mallActivityRecommend/editLimitedRecommend",editBargainRecommend:"/mall/platform.mallActivityRecommend/editBargainRecommend",editGroupRecommend:"/mall/platform.mallActivityRecommend/editGroupRecommend",setFirstLimited:"/mall/platform.mallActivityRecommend/setFirstLimited",setFirstBargain:"/mall/platform.mallActivityRecommend/setFirstBargain",setFirstGroup:"/mall/platform.mallActivityRecommend/setFirstGroup",setSortGroup:"/mall/platform.mallActivityRecommend/setSortGroup",setSortLimited:"/mall/platform.mallActivityRecommend/setSortLimited",setSortBargain:"/mall/platform.mallActivityRecommend/setSortBargain",bannerList:"/mall/platform.mallActivityRecommend/bannerList",addOrEditBanner:"/mall/platform.mallActivityRecommend/addOrEditBanner",delBanner:"/mall/platform.mallActivityRecommend/delBanner",getReplyList:"/mall/platform.MallPlatformReply/searchReply",getReplyDetails:"/mall/platform.MallPlatformReply/getReplyDetails",delReply:"/mall/platform.MallPlatformReply/delReply",getOrderList:"/mall/platform.MallOrder/searchOrders",getOrderDetails:"/mall/platform.MallOrder/getOrderDetails",getStores:"/mall/platform.MallOrder/getStores",getMers:"/mall/platform.MallOrder/getMers",loginMer:"/mall/platform.MallOrder/loginMer",loginStore:"/mall/platform.MallOrder/loginStore",getAllArea:"/mall/platform.MallOrder/getAllArea",getDiscount:"/mall/platform.MallOrder/getDiscount",getOrderLog:"/mall/platform.MallOrder/getOrderLog",exportOrder:"/mall/platform.MallOrder/exportOrder",getList:"mall/platform.MallHomeDecorate/getList",getDel:"mall/platform.MallHomeDecorate/getDel",getEdit:"mall/platform.MallHomeDecorate/getEdit",addOrEditDecorate:"mall/platform.MallHomeDecorate/addOrEdit",getSixList:"mall/platform.MallHomeDecorate/getSixList",getSixEdit:"mall/platform.MallHomeDecorate/getSixEdit",addOrEditSixAdver:"mall/platform.MallHomeDecorate/addOrEditSixAdver",delSixAdver:"mall/platform.MallHomeDecorate/delSixAdver",getRecList:"mall/platform.MallHomeDecorate/getRecList",addOrEditRec:"mall/platform.MallHomeDecorate/addOrEditRec",getRecEdit:"mall/platform.MallHomeDecorate/getRecEdit",delRecAdver:"mall/platform.MallHomeDecorate/delRecAdver",recDisplay:"mall/platform.MallHomeDecorate/recDisplay",getActGoods:"mall/platform.MallHomeDecorate/getActGoods",addRelatedGoods:"mall/platform.MallHomeDecorate/addRelatedGoods",getUrlAndRecSwitch:"mall/platform.MallHomeDecorate/getUrlAndRecSwitch",getRelatedList:"mall/platform.MallHomeDecorate/getRelatedList",saveRelatedSort:"/mall/platform.MallHomeDecorate/saveRelatedSort",delOne:"/mall/platform.MallHomeDecorate/delOne",viewLogistics:"/mall/platform.MallOrder/viewLogistics",getPeriodicList:"/mall/platform.MallOrder/getPeriodicList",setRecommend:"/mall/platform.MallPlatformGoods/setRecommend",cancelRecommend:"/mall/platform.MallPlatformGoods/cancelRecommend",isShowReply:"/mall/platform.MallPlatformReply/isShowReply"};e["a"]=o},"6c82":function(t,e,s){},ad75:function(t,e,s){"use strict";s("6c82")},bbbf:function(t,e,s){"use strict";s.r(e);var o=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("a-modal",{staticClass:"dialog",attrs:{title:"选择商品",width:"800",centered:"",visible:t.dialogVisible,destroyOnClose:!0},on:{ok:t.handleOk,cancel:t.handleCancel}},[s("div",{staticClass:"select-goods"},[s("div",{directives:[{name:"show",rawName:"v-show",value:!t.keywords,expression:"!keywords"}],staticClass:"left scroll_content"},[s("a-menu",{attrs:{mode:"inline","open-keys":t.openKeys,selectedKeys:t.selectedSort},on:{openChange:t.onOpenChange,select:t.onSelect}},[t._l(t.sortList,(function(e){return[e.children&&e.children.length?s("a-sub-menu",{key:e.cat_id},[s("span",{attrs:{slot:"title"},slot:"title"},[s("span",[t._v(t._s(e.cat_name))])]),e.children&&e.children.length?[t._l(e.children,(function(e){return[e.children&&e.children.length?[s("a-sub-menu",{key:e.cat_id,attrs:{title:e.cat_name}},t._l(e.children,(function(e){return s("a-menu-item",{key:e.cat_id},[t._v(t._s(e.cat_name)+" ")])})),1)]:[s("a-menu-item",{key:e.cat_id},[t._v(t._s(e.cat_name))])]]}))]:t._e()],2):s("a-menu-item",{key:e.cat_id},[t._v(t._s(e.cat_name))])]}))],2)],1),s("div",{staticClass:"right"},[s("div",{staticClass:"top"},[t.keywords?s("a-icon",{staticClass:"fs-16 pointer",attrs:{type:"left"},on:{click:function(e){return t.backToSort()}}}):t._e(),s("a-input-search",{staticClass:"search",attrs:{placeholder:"商品名称","allow-clear":""},on:{change:t.getGoodsList,search:t.getGoodsList},model:{value:t.keywords,callback:function(e){t.keywords=e},expression:"keywords"}})],1),s("div",{staticClass:"bottom"},[t.isSku?s("a-table",{key:"sku_table",attrs:{"row-selection":t.rowSelection,columns:t.columns,"data-source":t.tableList,rowKey:"goods_id",scroll:{y:500},pagination:!!t.tableList.length},scopedSlots:t._u([{key:"goods_name",fn:function(e,o){return s("span",{},[s("div",{staticClass:"product-info"},[s("div",[s("img",{attrs:{src:o.image}})]),s("div",[t._v(t._s(e))])])])}},{key:"price",fn:function(e,o){return s("span",{},[s("span",[t._v("￥"+t._s(o.min_price)+" ~ ￥"+t._s(o.max_price))])])}},{key:"expandedRowRender",fn:function(e){return t.isSku&&e.sku_info&&e.sku_info.length?s("p",{staticStyle:{margin:"0"}},t._l(e.sku_info,(function(o){return s("span",{key:o.sku_id,staticClass:"flex align-center mb-20 cr-99"},[s("a-checkbox",{attrs:{"default-checked":o.selected,disabled:0==o.can_be_choose||0==o.can_be_choose_2},on:{change:function(s){return t.onSkuGoodsSelect(o.sku_id,e,s)}}}),s("span",{staticClass:"ml-20 mr-20",staticStyle:{width:"245px"}},[t._v(t._s(o.sku_str||"--"))]),s("span",{staticStyle:{width:"200px"}},[t._v("￥"+t._s(o.price))]),s("span",{staticClass:"flex-1"},[t._v(t._s(o.stock_num))])],1)})),0):t._e()}}],null,!0)}):s("a-table",{key:"spu_table",attrs:{"row-selection":t.rowSelection,columns:t.columns,"data-source":t.tableList,rowKey:"goods_id",scroll:{y:500},pagination:!!t.tableList.length},scopedSlots:t._u([{key:"goods_name",fn:function(e,o){return s("span",{},[s("div",{staticClass:"product-info"},[s("div",[s("img",{attrs:{src:o.image}})]),s("div",[t._v(t._s(e))])])])}},{key:"price",fn:function(e,o){return s("span",{},["sku"==o.goods_type?s("span",{key:"sku_goods"},[t._v("￥"+t._s(o.min_price)+" ~ ￥"+t._s(o.max_price))]):s("span",{key:"spu_goods"},[t._v("￥"+t._s(o.price))])])}}])})],1)])])])},l=[],i=(s("a9e3"),s("159b"),s("a434"),s("7db0"),s("d81d"),s("011d")),a={name:"SelectShopGoods",props:{type:{type:String,default:"checkbox"},recordId:{type:[String,Number],default:""},source:{type:String,default:"platform_six"},selectedList:{type:Array,default:function(){return[]}}},data:function(){return{dialogVisible:!1,rootSubmenuKeys:[],openKeys:[],columns:[{title:"商品信息",dataIndex:"goods_name",scopedSlots:{customRender:"goods_name"},width:"300px"},{title:"价格",dataIndex:"price",scopedSlots:{customRender:"price"},width:"200px"},{title:"当前库存",dataIndex:"stock_num"}],menuId:0,hasSelected:[],selectedRowKeys:[],selectedSort:[],sortList:[],keywords:"",tableList:[],oldMenuId:"",sList:[],isSku:!1}},computed:{rowSelection:function(){return this.isSku?null:{selectedRowKeys:this.selectedRowKeys,type:this.type,onSelect:this.onRowSelect,onSelectAll:this.onSelectAll,getCheckboxProps:function(t){return{props:{disabled:0==t.can_be_choose||0==t.can_be_choose_2}}}}}},watch:{selectedList:function(t){this.sList=JSON.parse(JSON.stringify(t))}},methods:{openDialog:function(t,e,s){var o=this;this.rid=t,this.title=e,this.cat_key=s,this.dialogVisible=!0,this.selectedList&&this.selectedList.forEach((function(e){e.id===t&&(o.sList=JSON.parse(JSON.stringify(e.related_goods)))})),this.getSortList()},init:function(){this.rootSubmenuKeys=[],this.openKeys=[],this.selectedSort=[],this.tableList=[],this.keywords="",this.currentPage=1},getSortList:function(){var t=this;this.request(i["a"].goodsCategoryList).then((function(e){e.list&&e.list.length&&(t.sortList=e.list,t.handleDefaultSelect())}))},handleDefaultSelect:function(){var t=this;this.init(),this.sortList.forEach((function(e,s){if(t.rootSubmenuKeys.push(e.cat_id),e.children&&e.children.length){0==s&&t.openKeys.push(e.cat_id);var o=e.children;o.forEach((function(e,o){if(e.children&&e.children.length){0==o&&t.openKeys.push(e.cat_id);var l=e.children;l.forEach((function(e,l){0==s&&0==o&&0==l&&(t.menuId=e.cat_id)}))}else 0==s&&0==o&&(t.menuId=e.cat_id)}))}else 0==s&&(t.menuId=e.cat_id)})),this.selectedSort.push(this.menuId),this.getGoodsList()},onSelect:function(t){var e=t.key;this.selectedSort=[e],this.menuId=e,this.currentPage=1,this.getGoodsList()},getGoodsList:function(){var t=this;this.tableList=[];var e={keyword:this.keywords,source:this.source,record_id:this.rid};this.isSkuGoods(),this.keywords||(e.cat_id=this.menuId),this.request(i["a"].getActGoods,e).then((function(e){e.list&&e.list.length&&(t.tableList=e.list,t.handleList())}))},handleList:function(){var t=this;this.isSku?this.sList.length&&("radio"==this.type&&this.sList.length>1&&(this.sList=this.sList.splice(1),this.$message.warning("只能选择一个商品哦，已自动为您选择已选择列表中的第一个商品")),this.tableList.forEach((function(e){t.sList.forEach((function(s){s.goods_id==e.goods_id?e.sku_info.length==s.sku_info.length?e.sku_info=s.sku_info:e.sku_info.forEach((function(o){s.sku_info.forEach((function(s){s.sku_id==o.sku_id&&(o.selected=!0,"radio"==t.type&&(e.defaultValue=o.sku_id))}))})):"radio"==t.type&&e.sku_info.forEach((function(t){t.can_be_choose_2=0}))}))}))):(this.selectedRowKeys=[],this.sList.length&&("radio"==this.type?(this.sList.length>1&&(this.sList=[this.sList[0]]),this.selectedRowKeys=[this.sList[0].goods_id]):this.sList.forEach((function(e){t.selectedRowKeys.push(e.goods_id)}))),this.selectedRows=this.sList)},handleOk:function(){var t=this,e=this.selectedRowKeys,s=this.sList;this.isSku||(s.length?(this.request(i["a"].addRelatedGoods,{goods_ids:e,id:this.rid,source:this.source}).then((function(e){t.$message.success("添加成功"),t.$emit("backDeal",t.cat_key,t.title)})),this.handleCancel()):this.$message.error("请选择商品"))},handleCancel:function(){this.dialogVisible=!1},onOpenChange:function(t){var e=this,s=t.find((function(t){return-1===e.openKeys.indexOf(t)}));-1===this.rootSubmenuKeys.indexOf(s)?this.openKeys=t:this.openKeys.push(s)},backToSort:function(){this.keywords="",this.getGoodsList()},onRowSelect:function(t,e,s){"radio"==this.type?(this.sList=[t],this.selectedRowKeys=[t.goods_id]):e?(this.sList.push(t),this.selectedRowKeys.push(t.goods_id)):(this.sList.remove(t),this.selectedRowKeys.remove(t.goods_id))},onSelectAll:function(t,e,s){var o=this;t?s.map((function(t){o.selectedRowKeys.push(t.goods_id),o.sList.push(t)})):s.map((function(t){o.sList.remove(t),o.selectedRowKeys.remove(t.goods_id)}))},isSkuGoods:function(){this.isSku=!1},onSkuGoodsSelect:function(t,e,s){var o=s.target.checked;if(console.log("------------this.sList",this.sList),o){var l=!1;this.sList.length&&this.sList.forEach((function(s){s.goods_id==e.goods_id&&(e.sku_info.forEach((function(e){e.sku_id==t&&(e.selected=!0)})),s.sku_info=e.sku_info,l=!0)})),l||(e.sku_info.forEach((function(e){e.sku_id==t&&(e.selected=!0)})),this.sList.push(e),"radio"==this.type&&1==this.sList.length&&(this.tableList.forEach((function(t){t.goods_id!=e.goods_id&&t.sku_info.forEach((function(t){t.can_be_choose_2=0}))})),this.$set(this,"tableList",this.tableList)))}else{var i=!0;e.sku_info.forEach((function(e){e.sku_id==t&&(e.selected=!1),e.selected&&(i=!1)})),i&&(this.sList.remove(e),"radio"!=this.type||this.sList.length||(this.tableList.forEach((function(t){t.goods_id!=e.goods_id&&t.sku_info.forEach((function(t){t.can_be_choose_2=1}))})),this.$set(this,"tableList",this.tableList)))}this.$forceUpdate()},onRadioChange:function(t,e){console.log("----------------",e.target.value);var s=!1;this.sList.length&&this.sList.forEach((function(o){o.goods_id==t.goods_id&&(o.sku_info.forEach((function(t){t.sku_id==e.target.value?(console.log("----------------add sku_id ",t.sku_id),t.selected=!0):t.selected=!1})),s=!0)})),console.log("----------------add",s),s||(t.sku_info.forEach((function(t){t.sku_id==e.target.value?t.selected=!0:t.selected=!1})),this.sList.push(t))}}};Array.prototype.remove=function(t){var e=this.indexOf(t),s=-1;e>-1?this.splice(e,1):(this.map((function(e,o){e.goods_id==t.goods_id&&(s=o)})),s>-1&&this.splice(s,1))};var r=a,n=(s("ad75"),s("2877")),d=Object(n["a"])(r,o,l,!1,null,"3051b40e",null);e["default"]=d.exports}}]);