(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-7765c4be","chunk-d1be9e14"],{"474a":function(t,e,a){"use strict";var i={getShopSeckillIndex:"/common/platform.viewpage.ShopSeckill/getDefaultInfo",getCategoryDetail:"/common/platform.viewpage.ShopSeckill/getCategoryDetail",editCategory:"/common/platform.viewpage.ShopSeckill/editCategory",getCategoryList:"/common/platform.viewpage.ShopSeckill/getCategoryList",delCategory:"/common/platform.viewpage.ShopSeckill/delCategory",getCategoryGoodsList:"/common/platform.viewpage.ShopSeckill/getCategoryGoodsList",editCategoryGoodsSort:"/common/platform.viewpage.ShopSeckill/editCategoryGoodsSort",delCategoryGoods:"/common/platform.viewpage.ShopSeckill/delCategoryGoods",addCategoryGoods:"/common/platform.viewpage.ShopSeckill/addCategoryGoods"};e["a"]=i},5067:function(t,e,a){"use strict";a.r(e);var i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("a-modal",{attrs:{title:t.title,width:640,visible:t.visible,confirmLoading:t.confirmLoading},on:{ok:t.handleSubmit,cancel:t.handleCancel}},[a("div",[a("a-spin",{attrs:{spinning:t.confirmLoading}},[a("a-form",{attrs:{form:t.form}},[a("a-form-item",{attrs:{label:"分类名称",labelCol:t.labelCol,wrapperCol:t.wrapperCol}},[a("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["name",{initialValue:t.detail.name,rules:[{required:!0,message:"请输入分类名称！"}]}],expression:"[\n              'name',\n              { initialValue: detail.name, rules: [{ required: true, message: '请输入分类名称！' }] },\n            ]"}],attrs:{disabled:1==t.detail.cat_id}})],1),a("a-form-item",{attrs:{label:"覆盖城市",labelCol:t.labelCol,wrapperCol:t.wrapperCol}},[1!=t.detail.cat_id?a("a-tree-select",{directives:[{name:"decorator",rawName:"v-decorator",value:["city",{initialValue:t.selectCityList,rules:[{required:!0,message:"请选择覆盖城市！"}]}],expression:"[\n              'city',\n              { initialValue: selectCityList, rules: [{ required: true, message: '请选择覆盖城市！' }] },\n            ]"}],staticStyle:{width:"100%"},attrs:{"tree-data":t.areaList,treeCheckStrictly:!0,"tree-checkable":"","show-checked-strategy":t.SHOW_PARENT,"search-placeholder":"请选择城市",dropdownStyle:{maxHeight:"200px"}},model:{value:t.selectCityList,callback:function(e){t.selectCityList=e},expression:"selectCityList"}}):t._e(),1==t.detail.cat_id?a("label",[t._v("全国")]):t._e()],1),a("a-form-item",{attrs:{label:"排序值",labelCol:t.labelCol,wrapperCol:t.wrapperCol}},[1!=t.detail.cat_id?a("a-input-number",{directives:[{name:"decorator",rawName:"v-decorator",value:["sort",{initialValue:t.detail.sort,rules:[{required:!0,message:"请输入排序值！"}]}],expression:"[\n              'sort',\n              { initialValue: detail.sort, rules: [{ required: true, message: '请输入排序值！' }] },\n            ]"}],staticStyle:{width:"200px"}}):t._e(),1==t.detail.cat_id?a("label",[t._v("默认展示第一排")]):t._e()],1),a("a-form-item",{attrs:{label:"状态",labelCol:t.labelCol,wrapperCol:t.wrapperCol}},[a("a-switch",{directives:[{name:"decorator",rawName:"v-decorator",value:["status",{initialValue:1==t.detail.status,valuePropName:"checked"}],expression:"['status', { initialValue: detail.status == 1 ? true : false, valuePropName: 'checked' }]"}],attrs:{"checked-children":"开启","un-checked-children":"关闭"}})],1)],1)],1)],1)])},o=[],r=(a("98a7"),a("7bec")),n=(a("99af"),a("474a")),s=a("b59a"),l=a("7a6b"),c=a("7b3f"),d=r["a"].SHOW_PARENT,u={components:{CustomTooltip:l["a"]},data:function(){return{title:"新建分类",visible:!1,labelCol:{xs:{span:24},sm:{span:7}},wrapperCol:{xs:{span:24},sm:{span:13}},confirmLoading:!1,uploadImg:"/v20/public/index.php"+c["a"].uploadImg+"?upload_dir=/group/group_combine",form:this.$form.createForm(this),shareImageFileList:[],headers:{authorization:"authorization-text"},detail:{cat_id:0,name:""},areaList:[],selectCityList:[],SHOW_PARENT:d}},mounted:function(){},methods:{add:function(){this.visible=!0,this.id="0",this.detail={cat_id:0,name:"",sort:0},this.title="新建分类",this.selectCityList=[],this.getSelectProvinceAndCity()},edit:function(t){this.visible=!0,this.cat_id=t,this.selectCityList=[],this.getSelectProvinceAndCity(),this.getEditInfo(),this.cat_id>0?this.title="编辑分类":this.title="新建分类"},getEditInfo:function(){var t=this;this.request(n["a"].getCategoryDetail,{cat_id:this.cat_id}).then((function(e){t.detail=e,t.selectCityList=e.city_list}))},getSelectProvinceAndCity:function(){var t=this;this.request(s["a"].getSelectProvinceAndCity,{cat_id:this.cat_id}).then((function(e){t.areaList=[{title:"全部",value:"all",key:"all"}],t.areaList=t.areaList.concat(e)}))},handleSubmit:function(){var t=this,e=this.form.validateFields;this.confirmLoading=!0,e((function(e,a){if(e)t.confirmLoading=!1;else{if(a.cat_id=t.cat_id,a.city_list=t.selectCityList,0==t.selectCityList.length&&1!=t.detail.cat_id)return t.$message.error("请选择覆盖城市"),void(t.confirmLoading=!1);t.request(n["a"].editCategory,a).then((function(e){t.cat_id>0?t.$message.success("编辑成功"):t.$message.success("添加成功"),setTimeout((function(){t.form=t.$form.createForm(t),t.visible=!1,t.confirmLoading=!1,t.$emit("handleUpdate",a)}),1500)})).catch((function(e){t.confirmLoading=!1}))}}))},handleCancel:function(){this.visible=!1,this.cat_id="0",this.form=this.$form.createForm(this)}}},m=u,g=a("2877"),h=Object(g["a"])(m,i,o,!1,null,null,null);e["default"]=h.exports},"60ab":function(t,e,a){"use strict";a.r(e);var i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{attrs:{id:"components-layout-demo-basic"}},[a("a-card",[a("div",{staticStyle:{display:"flex","justify-content":"space-between","align-items":"center","margin-bottom":"20px"}},[a("div",[t._v("需给每个分类下添加限时秒杀商品后，前端才可正常显示")]),a("div",[a("a-button",{attrs:{type:"primary"},on:{click:function(e){return t.$refs.shopSeckillCategoryEditModal.add()}}},[a("a-icon",{attrs:{type:"plus"}}),t._v("新建分类 ")],1)],1)]),a("a-table",{attrs:{columns:t.columns,"data-source":t.categoryList,pagination:t.pagination,rowKey:"cat_id",scroll:{y:this.clientHeight-330},loading:t.loading},on:{change:t.tableChange},scopedSlots:t._u([{key:"goods_count",fn:function(e,i){return a("router-link",{attrs:{to:{path:"/common/platform.viewpage/ShopSeckillCategoryGoods",query:{cat_id:i.cat_id}}}},[t._v(" "+t._s(e)+"个 "),a("a-button",[t._v("去管理")])],1)}},{key:"status",fn:function(e,i){return a("span",{},[1==e?a("a-badge",{attrs:{color:"green",text:"开启"}}):t._e(),0==e?a("a-badge",{attrs:{color:"grey",text:"关闭"}}):t._e()],1)}},{key:"sort",fn:function(e,i){return a("span",{},[t._v(" "+t._s(1==i.cat_id?"默认展示第一排":e)+" ")])}},{key:"action",fn:function(e,i){return a("span",{},[i.edit?a("a",{on:{click:function(e){return t.$refs.shopSeckillCategoryEditModal.edit(i.cat_id)}}},[t._v("编辑")]):t._e(),i.edit?t._e():a("a",{staticStyle:{color:"#747b8b"},attrs:{href:"#"}},[t._v("编辑")]),1!=i.cat_id?a("a-divider",{attrs:{type:"vertical"}}):t._e(),1!=i.cat_id?a("a-popconfirm",{staticClass:"ant-dropdown-link",attrs:{title:"确认删除?","ok-text":"确定","cancel-text":"取消"},on:{confirm:function(e){return t.deleteCate(i.cat_id)},cancel:t.cancel}},[a("a",{staticStyle:{color:"#747b8b"},attrs:{href:"#"}},[t._v("删除")])]):t._e()],1)}}])})],1),a("shop-seckill-category-edit",{ref:"shopSeckillCategoryEditModal",on:{handleUpdate:t.handleUpdate}})],1)},o=[],r=a("5530"),n=(a("d81d"),a("474a")),s=a("5067"),l=[],c={name:"goodsList",components:{ShopSeckillCategoryEdit:s["default"]},data:function(){return this.cacheData=l.map((function(t){return Object(r["a"])({},t)})),{form:this.$form.createForm(this),pagination:{pageSize:10,total:1,current:1,"show-total":function(t){return"共 ".concat(t," 条记录")}},detail:{},queryParam:{page:1},columns:[{title:"分类名称",dataIndex:"name",width:"15%"},{title:"排序值",dataIndex:"sort",width:"12%",scopedSlots:{customRender:"sort"}},{title:"涵盖城市",width:"18%",dataIndex:"city_name"},{title:"包含商品",dataIndex:"goods_count",width:"12%",scopedSlots:{customRender:"goods_count"}},{title:"最后操作时间",dataIndex:"update_time",width:"12%",scopedSlots:{customRender:"update_time"}},{title:"状态",dataIndex:"status",width:"12%",scopedSlots:{customRender:"status"}},{title:"操作",dataIndex:"action",width:"12%",scopedSlots:{customRender:"action"}}],data:l,categoryList:[],clientHeight:0,oldSort:0,loading:!1}},created:function(){console.log(this.$route.query.store_id)},filters:{},beforeRouteLeave:function(t,e,a){this.queryParam.page="1",this.pagination.current=1,a()},mounted:function(){var t=this;this.clientHeight=window.document.body.clientHeight,window.onresize=function(){t.clientHeight=window.document.body.clientHeight},this.getCategoryList()},computed:{hasSelected:function(){}},methods:{getCategoryList:function(){var t=this;this.loading=!0,this.request(n["a"].getCategoryList,this.queryParam).then((function(e){t.categoryList=e.list,t.pagination.total=e.total?e.total:0,t.loading=!1}))},tableChange:function(t){t.current&&t.current>0&&(this.queryParam["page"]=t.current,this.$set(this.pagination,"current",t.current),console.log(this.queryParam["page"],"page"),this.getCategoryList())},addCategory:function(){if(0==this.sortList.length)return this.$message.error("请先添加分类"),!1;this.$refs.editGoodsModal.add(this.queryParam.store_id,this.queryParam.sort_id)},handleUpdate:function(){this.getCategoryList()},deleteCate:function(t){var e=this;this.request(n["a"].delCategory,{cat_id:t}).then((function(t){e.$message.success("删除成功"),e.getCategoryList()})).catch((function(t){e.confirmLoading=!1}))},cancel:function(){}}},d=c,u=a("2877"),m=Object(u["a"])(d,i,o,!1,null,"10ab781f",null);e["default"]=m.exports},"7b3f":function(t,e,a){"use strict";var i={uploadImg:"/common/common.UploadFile/uploadImg"};e["a"]=i},b59a:function(t,e,a){"use strict";var i={getSelectProvince:"/common/platform.area.area/getSelectProvince",getSelectCity:"/common/platform.area.area/getSelectCity",getSelectArea:"/common/platform.area.area/getSelectArea",getSelectPropertyProvince:"/merchant/merchant.system.area/getProvinceList",getSelectPropertyCity:"/merchant/merchant.system.area/getCityList",getSelectPropertyArea:"/merchant/merchant.system.area/getAreaList",getSelectStreet:"/common/platform.area.area/getSelectStreet",getSelectProvinceAndCity:"/common/platform.area.area/getSelectProvinceAndCity"};e["a"]=i}}]);