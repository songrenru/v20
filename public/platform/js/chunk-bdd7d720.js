(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-bdd7d720","chunk-2d0b6a79","chunk-2d0b6a79"],{"03f7":function(e,t,a){"use strict";a("b13c")},"1da1":function(e,t,a){"use strict";a.d(t,"a",(function(){return s}));a("d3b7");function i(e,t,a,i,s,n,r){try{var o=e[n](r),l=o.value}catch(c){return void a(c)}o.done?t(l):Promise.resolve(l).then(i,s)}function s(e){return function(){var t=this,a=arguments;return new Promise((function(s,n){var r=e.apply(t,a);function o(e){i(r,s,n,o,l,"next",e)}function l(e){i(r,s,n,o,l,"throw",e)}o(void 0)}))}}},"2a14":function(e,t,a){"use strict";a.r(t);var i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"mt-10 mb-20 pt-20 pl-20 pr-20 pb-20 bg-ff br-10"},[a("a-row",{staticClass:"center",attrs:{type:"flex",align:"middle"}},[a("div",[a("a-input",{staticStyle:{width:"300px"},attrs:{allowClear:"",placeholder:"请输入停车场名称"},model:{value:e.keywords,callback:function(t){e.keywords=t},expression:"keywords"}}),a("a-button",{staticStyle:{margin:"10px 20px"},attrs:{type:"primary"},on:{click:e.search}},[e._v(e._s(e.L("搜索")))])],1),a("div",{staticClass:"btn_list"},[a("a-button",{staticStyle:{margin:"10px 20px"},attrs:{type:"primary"},on:{click:e.addClick}},[e._v(e._s(e.L("新建")))]),a("a-button",{staticStyle:{margin:"10px 20px"},attrs:{type:"danger"},on:{click:e.deleltClick}},[e._v(e._s(e.L("删除")))])],1)]),a("a-table",{staticStyle:{background:"#ffffff"},attrs:{columns:e.columns,rowKey:"car_park_id","data-source":e.dataList,pagination:e.pagination,rowSelection:{selectedRowKeys:e.selectedRowKeys,onChange:e.onParkingChange}},scopedSlots:e._u([{key:"price",fn:function(t,i){return a("span",{},[1==i.is_sku?a("span",[e._v(e._s(i.min_price)+"~"+e._s(i.max_price))]):a("span",[e._v(e._s(t))])])}},{key:"icon",fn:function(e){return a("span",{},[a("img",{staticStyle:{width:"60px",height:"60px"},attrs:{src:e,alt:""}})])}},{key:"local_name",fn:function(t,i){return a("span",{},[a("span",{attrs:{title:i.local_name?i.local_name:i.long+","+i.lat}},[e._v(e._s(i.local_name?i.local_name:i.long+","+i.lat))])])}},{key:"status",fn:function(t,i){return a("span",{},[a("a-switch",{attrs:{"checked-children":"开","un-checked-children":"关",checked:1==i.status},on:{change:function(t){return e.switchOnChange(t,i)}}})],1)}},{key:"old_price",fn:function(t,i){return a("span",{},[1==i.is_sku?a("span",[e._v("--")]):a("span",[e._v(e._s(t))])])}},{key:"audit_status_text",fn:function(t,i){return a("span",{style:[{color:"1"==i.audit_status?"green":"2"==i.audit_status?"red":"rgb(250, 173, 20)"}]},[e._v(e._s(t))])}},{key:"action",fn:function(t,i){return a("span",{},[a("a",{staticClass:"inline-block",staticStyle:{"margin-right":"10px"},on:{click:function(t){return e.EditTicket(i)}}},[e._v(e._s(e.L("编辑")))]),a("a",{staticClass:"inline-block",staticStyle:{color:"red"},on:{click:function(t){return e.delPackage(i)}}},[e._v(e._s(e.L("删除")))])])}}])}),a("a-modal",{attrs:{maskClosable:!1,destroyOnClose:"",width:"60%",title:e.titles},on:{ok:e.handleOk},model:{value:e.visible,callback:function(t){e.visible=t},expression:"visible"}},[a("div",{staticClass:"newBox"},[a("a-form",{attrs:{form:e.form,"label-col":{span:5},"wrapper-col":{span:12}}},[a("a-form-item",{attrs:{label:"停车场名称"}},[a("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["name",{rules:[{required:!0,message:"请输入停车场名称"}]}],expression:"['name', { rules: [{ required: true, message: '请输入停车场名称' }] }]"}],attrs:{placeholder:"请输入停车场名称"}})],1),a("a-form-item",{attrs:{label:"营业时间"}},[a("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["business_hours",{rules:[{required:!0,message:"请输入营业时间"}]}],expression:"['business_hours', { rules: [{ required: true, message: '请输入营业时间' }] }]"}],attrs:{placeholder:"请输入营业时间"}})],1),a("a-form-item",{attrs:{label:"展示价格"}},[a("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["price"],expression:"['price']"}],attrs:{placeholder:"请输入展示价格"}})],1),a("a-form-item",{attrs:{label:"车位数量"}},[a("a-input-number",{directives:[{name:"decorator",rawName:"v-decorator",value:["cars_num",{initialValue:0}],expression:"['cars_num', { initialValue: 0 }]"}],attrs:{min:0,max:99999}})],1),a("a-form-item",{attrs:{label:"停车场详细位置"}},[a("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["local_name"],expression:"['local_name']"}],attrs:{placeholder:"请输入停车场详细位置"}})],1),a("a-form-item",{attrs:{label:"停车场经纬度"}},[a("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["longlat",{rules:[{required:!0,message:"请输入停车场经纬度"}]}],expression:"['longlat', { rules: [{ required: true, message: '请输入停车场经纬度' }] }]"}],staticStyle:{width:"200px"},attrs:{readonly:!0,placeholder:"请选择位置"}}),a("a",{staticStyle:{"margin-left":"5px"},on:{click:e.mapPointClick}},[e._v("地图选点")])],1),a("a-form-item",{attrs:{label:"上传停车场图标"}},[a("a-upload",{directives:[{name:"decorator",rawName:"v-decorator",value:["icon",{valuePropName:"fileList",getValueFromEvent:e.normFile1,rules:[{required:!0,message:"请上传停车场图标"}]}],expression:"[\n              'icon',\n              {\n                valuePropName: 'fileList',\n                getValueFromEvent: normFile1,\n                rules: [{ required: true, message: '请上传停车场图标' }],\n              },\n            ]"}],attrs:{action:"/v20/public/index.php/common/common.UploadFile/uploadPictures",name:"reply_pic",data:e.updateDataCover,"list-type":"picture-card"},on:{preview:e.handlePreviewCover}},[0==e.fileListCover.length?a("div",[a("a-icon",{attrs:{type:"plus"}}),a("div",{staticClass:"ant-upload-text"},[e._v("上传图片")])],1):e._e()]),a("div",{staticClass:"ant-form-explain"},[e._v("推荐尺寸: 1 : 1")])],1),a("a-form-item",{attrs:{label:"上传停车场图片"}},[a("a-upload",{directives:[{name:"decorator",rawName:"v-decorator",value:["pic",{valuePropName:"fileList",getValueFromEvent:e.normFile2}],expression:"[\n              'pic',\n              {\n                valuePropName: 'fileList',\n                getValueFromEvent: normFile2,\n              },\n            ]"}],attrs:{action:"/v20/public/index.php/common/common.UploadFile/uploadPictures",name:"reply_pic",data:e.updateData,"list-type":"picture-card"},on:{preview:e.handlePreviewCover}},[e.fileList.length<3?a("div",[a("a-icon",{attrs:{type:"plus"}}),a("div",{staticClass:"ant-upload-text"},[e._v("上传图片")])],1):e._e()]),a("div",{staticClass:"ant-form-explain"},[e._v("请上传png/jpg/jpge类型图片")])],1),a("a-form-item",{attrs:{label:"停车公告"}},[a("div",{staticClass:"textarea-wrapper"},[a("a-textarea",{directives:[{name:"decorator",rawName:"v-decorator",value:["notice"],expression:"['notice']"}],staticClass:"m-textarea",attrs:{maxLength:500,showWordLimit:!0,placeholder:"请输入停车公告","auto-size":{minRows:3,maxRows:22}},on:{change:e.textareaChange}}),a("div",{staticClass:"m-count"},[e._v(e._s(e.textLength)+"/500")])],1)]),e.scenicList.length>0?a("a-form-item",{attrs:{label:"绑定景区"}},[a("a-select",{directives:[{name:"decorator",rawName:"v-decorator",value:["scenic"],expression:"['scenic']"}],attrs:{mode:"multiple",placeholder:"点击绑定景区"}},e._l(e.scenicList,(function(t){return a("a-select-option",{key:t.tools_id,attrs:{value:t.tools_id}},[e._v(" "+e._s(t.title)+" ")])})),1)],1):e._e(),e.peclassList.length>0?a("a-form-item",{attrs:{label:"绑定体育馆/课程"}},[a("a-select",{directives:[{name:"decorator",rawName:"v-decorator",value:["ids_arr"],expression:"['ids_arr']"}],attrs:{mode:"multiple",placeholder:"点击绑定体育馆/课程"}},e._l(e.peclassList,(function(t){return a("a-select-option",{key:t.tools_id,attrs:{value:t.tools_id}},[e._v(" "+e._s(t.title)+" ")])})),1)],1):e._e(),a("a-form-item",{attrs:{label:"是否开启"}},[a("a-switch",{directives:[{name:"decorator",rawName:"v-decorator",value:["status",{initialValue:!0,valuePropName:"checked"}],expression:"['status', { initialValue: true, valuePropName: 'checked' }]"}],attrs:{"checked-children":"是","un-checked-children":"否"}})],1)],1)],1)]),a("map-point",{ref:"mapPointModel",on:{loadRefresh:e.setLongLat}}),a("a-modal",{attrs:{visible:e.previewVisibleCover,footer:null},on:{cancel:function(){e.previewVisibleCover=!1}}},[e.previewImageCover?a("img",{staticStyle:{width:"100%"},attrs:{alt:"example",src:e.previewImageCover}}):e._e()])],1)},s=[],n=a("1da1"),r=(a("96cf"),a("d3b7"),a("159b"),a("d81d"),a("b0c0"),a("ac1f"),a("1276"),a("4d95")),o=a("70e4"),l={components:{mapPoint:o["default"]},data:function(){var e=this;return{visible:!1,previewVisibleCover:!1,previewImageCover:null,tools_id:"",form:this.$form.createForm(this,{name:"coordinated"}),updateDataCover:{upload_dir:"merchant/life_tools/tools"},updateData:{upload_dir:"merchant/life_tools/tools"},fileListCover:[],fileList:[],scenicList:[],peclassList:[],scenicTagList:[],peclassTagList:[],titles:"新建",detail:null,columns:[{title:this.L("停车场名称"),dataIndex:"name",ellipsis:!0,width:300},{title:this.L("图标"),dataIndex:"icon",scopedSlots:{customRender:"icon"}},{title:this.L("营业时间"),dataIndex:"business_hours",ellipsis:!0,width:200,scopedSlots:{customRender:"business_hours"}},{title:this.L("位置"),dataIndex:"local_name",ellipsis:!0,width:300,scopedSlots:{customRender:"local_name"}},{title:this.L("状态"),dataIndex:"status",key:"status",scopedSlots:{customRender:"status"}},{title:this.L("操作"),dataIndex:"ticket_id",key:"ticket_id",scopedSlots:{customRender:"action"}}],dataList:[],keywords:"",pagination:{current:1,total:0,pageSize:10,showSizeChanger:!0,onChange:this.onPageChange,onShowSizeChange:this.onPageSizeChange,showTotal:function(t){return e.L("共X1个停车场",{X1:t})}},audit_status:"",selectedRowKeys:[],textLength:0,pageNum:0}},created:function(){this.getDataList()},methods:{mapPointClick:function(){this.$refs.mapPointModel.selectPoint(),this.$store.state.user&&this.$store.state.user.info.area_name&&this.$refs.mapPointModel.onSearch(this.$store.state.user.info.area_name)},switchOnChange:function(e,t){var a=this;this.request(r["a"].statusCarPark,{id:t.car_park_id,status:e}).then((function(e){a.$message.success("修改状态成功"),a.getDataList()}))},textareaChange:function(e){this.textLength=e.target.value.length},getBase64:function(e){return new Promise((function(t,a){var i=new FileReader;i.readAsDataURL(e),i.onload=function(){return t(i.result)},i.onerror=function(e){return a(e)}}))},getScenicList:function(e){var t=this;this.request(r["a"].getToolsList,{type:e}).then((function(a){1==e?t.scenicList=a:t.peclassList=a}))},getDataList:function(){var e=this,t={page:this.pagination.current,page_size:this.pagination.pageSize,keywords:this.keywords};this.request(r["a"].getCarParkList,t).then((function(t){e.dataList=t.data,e.$set(e.pagination,"total",t.total)}))},onPageChange:function(e,t){this.$set(this.pagination,"current",e),this.getDataList()},onPageSizeChange:function(e,t){this.$set(this.pagination,"current",1),this.$set(this.pagination,"pageSize",t),this.getDataList()},EditTicket:function(e){var t=this;this.titles="编辑",this.request(r["a"].showCarPark,{id:e.car_park_id}).then((function(a){t.detail=a,t.textLength=t.detail.notice.length,t.detail.car_park_id=e.car_park_id,t.visible=!0,t.scenicTagList=[],t.peclassTagList=[],t.fileList=[],t.fileListCover=[],t.detail.scenic.forEach((function(e){t.scenicTagList.push(e.tools_id)})),t.detail.ids_arr.forEach((function(e){t.peclassTagList.push(e.tools_id)})),t.getScenicList(1),t.getScenicList(2);var i=t.detail.pic,s=t.detail.icon;t.detail.icon=[{uid:0,name:"image.png",status:"done",url:s}],s&&(t.fileListCover=[s]),t.detail.pic=i.map((function(e,a){return t.fileList.push(e),{uid:a,name:"image.png",status:"done",url:e}})),t.$nextTick((function(){t.detail&&(t.form.getFieldDecorator("lat",{initialValue:t.detail.lat}),t.form.getFieldDecorator("long",{initialValue:t.detail.long}),t.form.setFieldsValue({business_hours:t.detail.business_hours,cars_num:t.detail.cars_num,icon:t.detail.icon,ids_arr:t.peclassTagList,longlat:t.detail.long+","+t.detail.lat,local_name:t.detail.local_name,name:t.detail.name,notice:t.detail.notice,pic:t.detail.pic,price:t.detail.price,scenic:t.scenicTagList,status:0!=t.detail.status}))}))}))},toSetPage:function(e){var t=Math.ceil((this.pagination.total-(1==e?1:this.dataList.length))/this.pagination.pageSize);this.pagination.current=this.pagination.current>t?t:this.pagination.current,this.pagination.current=this.pagination.current<1?1:this.pagination.current},delPackage:function(e){var t=this;this.$confirm({title:"是否删除该停车场?",centered:!0,onOk:function(){t.request(r["a"].deleteCarPark,{id:[e.car_park_id]}).then((function(e){t.toSetPage(1),t.$message.success("删除成功"),t.getDataList()}))},onCancel:function(){}})},search:function(){this.pagination.current=1,this.getDataList()},onParkingChange:function(e){this.selectedRowKeys=e},addClick:function(){this.titles="新建",this.visible=!0,this.detail=null,this.textLength=0,this.fileListCover=[],this.fileList=[],this.getScenicList(1),this.getScenicList(2)},deleltClick:function(){var e=this;0!=this.selectedRowKeys.length?this.$confirm({title:"是否删除单个或多个停车场?",centered:!0,onOk:function(){e.request(r["a"].deleteCarPark,{id:e.selectedRowKeys}).then((function(t){e.toSetPage(2),e.$message.success("删除成功"),e.getDataList()}))},onCancel:function(){}}):this.$message.warning("请选择单个或多个列表")},handleOk:function(){var e=this;this.form.validateFields((function(t,a){var i=a.pic,s=a.icon;if(s[0]&&"uploading"==s[0].status)throw e.$message.warning("请等待图片上传完成再提交"),new Error("请等待图片上传完成再提交");if(i&&i.length>0&&i.forEach((function(t){if("uploading"==t.status)throw e.$message.warning("请等待图片上传完成再提交"),new Error("请等待图片上传完成再提交")})),!t){var n=a.longlat.split(",");i&&i.length>0?a.pic=i.map((function(e){return e.response?e.response.data:e.url})):a.pic=[],s[0].response?a.icon=s[0].response.data:a.icon=s[0].url,a.long=n[0],a.lat=n[1],e.detail&&e.detail.car_park_id&&(a.car_park_id=e.detail.car_park_id),e.addCarParkEdlt(a)}}))},addCarParkEdlt:function(e){var t=this;this.request(r["a"].addCarPark,e).then((function(e){t.$message.success("操作成功"),t.visible=!1,t.getDataList()}))},setLongLat:function(e){var t=this;this.$nextTick((function(){t.form.setFieldsValue({longlat:e})}))},normFile1:function(e){return this.fileListCover=e.fileList,Array.isArray(e)?e:e&&e.fileList},normFile2:function(e){return this.fileList=e.fileList,Array.isArray(e)?e:e&&e.fileList},handlePreviewCover:function(e){var t=this;return Object(n["a"])(regeneratorRuntime.mark((function a(){return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:if(e.url||e.preview){a.next=4;break}return a.next=3,t.getBase64(e.originFileObj);case 3:e.preview=a.sent;case 4:t.previewImageCover=e.url||e.preview,t.previewVisibleCover=!0;case 6:case"end":return a.stop()}}),a)})))()}}},c=l,u=(a("03f7"),a("0c7c")),d=Object(u["a"])(c,i,s,!1,null,"461037a4",null);t["default"]=d.exports},b13c:function(e,t,a){}}]);