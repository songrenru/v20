(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-196a93ad","chunk-b3cef5c8","chunk-b3cef5c8"],{"060c":function(e,t,r){},3193:function(e,t,r){"use strict";r("060c")},d34b:function(e,t,r){"use strict";r.d(t,"a",(function(){return n}));r("c5cb");function o(e,t,r,o,n,i,a){try{var s=e[i](a),l=s.value}catch(c){return void r(c)}s.done?t(l):Promise.resolve(l).then(o,n)}function n(e){return function(){var t=this,r=arguments;return new Promise((function(n,i){var a=e.apply(t,r);function s(e){o(a,n,i,s,l,"next",e)}function l(e){o(a,n,i,s,l,"throw",e)}s(void 0)}))}}},dff4:function(e,t,r){"use strict";r.d(t,"a",(function(){return n}));r("6073"),r("2c5c"),r("c5cb"),r("36fa"),r("02bf"),r("a617"),r("70b9"),r("25b2"),r("0245"),r("2e24"),r("1485"),r("08c7"),r("54f8"),r("7177"),r("9ae4");var o=r("2396");function n(){
/*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/facebook/regenerator/blob/main/LICENSE */
n=function(){return e};var e={},t=Object.prototype,r=t.hasOwnProperty,i="function"==typeof Symbol?Symbol:{},a=i.iterator||"@@iterator",s=i.asyncIterator||"@@asyncIterator",l=i.toStringTag||"@@toStringTag";function c(e,t,r){return Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{c({},"")}catch(P){c=function(e,t,r){return e[t]=r}}function u(e,t,r,o){var n=t&&t.prototype instanceof p?t:p,i=Object.create(n.prototype),a=new L(o||[]);return i._invoke=function(e,t,r){var o="suspendedStart";return function(n,i){if("executing"===o)throw new Error("Generator is already running");if("completed"===o){if("throw"===n)throw i;return S()}for(r.method=n,r.arg=i;;){var a=r.delegate;if(a){var s=C(a,r);if(s){if(s===d)continue;return s}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if("suspendedStart"===o)throw o="completed",r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);o="executing";var l=h(e,t,r);if("normal"===l.type){if(o=r.done?"completed":"suspendedYield",l.arg===d)continue;return{value:l.arg,done:r.done}}"throw"===l.type&&(o="completed",r.method="throw",r.arg=l.arg)}}}(e,r,a),i}function h(e,t,r){try{return{type:"normal",arg:e.call(t,r)}}catch(P){return{type:"throw",arg:P}}}e.wrap=u;var d={};function p(){}function f(){}function m(){}var g={};c(g,a,(function(){return this}));var v=Object.getPrototypeOf,y=v&&v(v(x([])));y&&y!==t&&r.call(y,a)&&(g=y);var w=m.prototype=p.prototype=Object.create(g);function b(e){["next","throw","return"].forEach((function(t){c(e,t,(function(e){return this._invoke(t,e)}))}))}function _(e,t){function n(i,a,s,l){var c=h(e[i],e,a);if("throw"!==c.type){var u=c.arg,d=u.value;return d&&"object"==Object(o["a"])(d)&&r.call(d,"__await")?t.resolve(d.__await).then((function(e){n("next",e,s,l)}),(function(e){n("throw",e,s,l)})):t.resolve(d).then((function(e){u.value=e,s(u)}),(function(e){return n("throw",e,s,l)}))}l(c.arg)}var i;this._invoke=function(e,r){function o(){return new t((function(t,o){n(e,r,t,o)}))}return i=i?i.then(o,o):o()}}function C(e,t){var r=e.iterator[t.method];if(void 0===r){if(t.delegate=null,"throw"===t.method){if(e.iterator["return"]&&(t.method="return",t.arg=void 0,C(e,t),"throw"===t.method))return d;t.method="throw",t.arg=new TypeError("The iterator does not provide a 'throw' method")}return d}var o=h(r,e.iterator,t.arg);if("throw"===o.type)return t.method="throw",t.arg=o.arg,t.delegate=null,d;var n=o.arg;return n?n.done?(t[e.resultName]=n.value,t.next=e.nextLoc,"return"!==t.method&&(t.method="next",t.arg=void 0),t.delegate=null,d):n:(t.method="throw",t.arg=new TypeError("iterator result is not an object"),t.delegate=null,d)}function k(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function F(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function L(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(k,this),this.reset(!0)}function x(e){if(e){var t=e[a];if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,n=function t(){for(;++o<e.length;)if(r.call(e,o))return t.value=e[o],t.done=!1,t;return t.value=void 0,t.done=!0,t};return n.next=n}}return{next:S}}function S(){return{value:void 0,done:!0}}return f.prototype=m,c(w,"constructor",m),c(m,"constructor",f),f.displayName=c(m,l,"GeneratorFunction"),e.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===f||"GeneratorFunction"===(t.displayName||t.name))},e.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,m):(e.__proto__=m,c(e,l,"GeneratorFunction")),e.prototype=Object.create(w),e},e.awrap=function(e){return{__await:e}},b(_.prototype),c(_.prototype,s,(function(){return this})),e.AsyncIterator=_,e.async=function(t,r,o,n,i){void 0===i&&(i=Promise);var a=new _(u(t,r,o,n),i);return e.isGeneratorFunction(r)?a:a.next().then((function(e){return e.done?e.value:a.next()}))},b(w),c(w,l,"Generator"),c(w,a,(function(){return this})),c(w,"toString",(function(){return"[object Generator]"})),e.keys=function(e){var t=[];for(var r in e)t.push(r);return t.reverse(),function r(){for(;t.length;){var o=t.pop();if(o in e)return r.value=o,r.done=!1,r}return r.done=!0,r}},e.values=x,L.prototype={constructor:L,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(F),!e)for(var t in this)"t"===t.charAt(0)&&r.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=void 0)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var t=this;function o(r,o){return a.type="throw",a.arg=e,t.next=r,o&&(t.method="next",t.arg=void 0),!!o}for(var n=this.tryEntries.length-1;n>=0;--n){var i=this.tryEntries[n],a=i.completion;if("root"===i.tryLoc)return o("end");if(i.tryLoc<=this.prev){var s=r.call(i,"catchLoc"),l=r.call(i,"finallyLoc");if(s&&l){if(this.prev<i.catchLoc)return o(i.catchLoc,!0);if(this.prev<i.finallyLoc)return o(i.finallyLoc)}else if(s){if(this.prev<i.catchLoc)return o(i.catchLoc,!0)}else{if(!l)throw new Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return o(i.finallyLoc)}}}},abrupt:function(e,t){for(var o=this.tryEntries.length-1;o>=0;--o){var n=this.tryEntries[o];if(n.tryLoc<=this.prev&&r.call(n,"finallyLoc")&&this.prev<n.finallyLoc){var i=n;break}}i&&("break"===e||"continue"===e)&&i.tryLoc<=t&&t<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=e,a.arg=t,i?(this.method="next",this.next=i.finallyLoc,d):this.complete(a)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),d},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.finallyLoc===e)return this.complete(r.completion,r.afterLoc),F(r),d}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.tryLoc===e){var o=r.completion;if("throw"===o.type){var n=o.arg;F(r)}return n}}throw new Error("illegal catch attempt")},delegateYield:function(e,t,r){return this.delegate={iterator:x(e),resultName:t,nextLoc:r},"next"===this.method&&(this.arg=void 0),d}},e}},e087:function(e,t,r){"use strict";r.r(t);r("54f8");var o=function(){var e=this,t=e._self._c;return t("a-drawer",{attrs:{title:"添加工单",placement:"right",closable:!1,visible:e.workVisible,width:900},on:{close:e.onClose}},[t("a-form-model",{ref:"ruleForm",attrs:{model:e.workerForm,rules:e.rules,"label-col":e.labelCol,"wrapper-col":e.wrapperCol}},[e.workVisible?t("a-form-model-item",{attrs:{label:"对应位置",prop:"address_id"}},[t("a-select",{staticStyle:{width:"120px"},attrs:{"show-search":"",placeholder:"请选择"},on:{change:function(t){return e.housePositionChange1(t,0)}}},e._l(e.housePositionList,(function(r,o){return t("a-select-option",{attrs:{value:r.name}},[e._v(" "+e._s(r.name)+" ")])})),1),0!=e.positionChild1.length?t("a-select",{staticStyle:{width:"120px"},attrs:{"show-search":"",placeholder:"请选择"},on:{change:function(t){return e.housePositionChange1(t,1)}}},e._l(e.positionChild1,(function(r,o){return t("a-select-option",{attrs:{value:r.name}},[e._v(" "+e._s(r.name)+" ")])})),1):e._e(),0!=e.positionChild2.length?t("a-select",{staticStyle:{width:"120px"},attrs:{"show-search":"",placeholder:"请选择"},on:{change:function(t){return e.housePositionChange1(t,2)}}},e._l(e.positionChild2,(function(r,o){return t("a-select-option",{attrs:{value:r.name}},[e._v(" "+e._s(r.name)+" ")])})),1):e._e(),0!=e.positionChild3.length?t("a-select",{staticStyle:{width:"120px"},attrs:{"show-search":"",placeholder:"请选择"},on:{change:function(t){return e.housePositionChange1(t,3)}}},e._l(e.positionChild3,(function(r,o){return t("a-select-option",{attrs:{value:r.name}},[e._v(" "+e._s(r.name)+" ")])})),1):e._e()],1):e._e(),t("a-form-model-item",{attrs:{label:"工单类目",prop:"cat_fid"}},[t("a-select",{attrs:{value:e.workerForm.cat_fid,placeholder:"请选择工单类目"},on:{change:function(t){return e.handleSelectChange(t,"cat_fid")}}},e._l(e.orderCategory,(function(r,o){return t("a-select-option",{attrs:{value:r.category_id}},[e._v(" "+e._s(r.subject_name)+" ")])})),1)],1),t("a-form-model-item",{attrs:{label:"工单分类",prop:"cat_id"}},[t("a-select",{attrs:{value:e.workerForm.cat_id,placeholder:"请选择工单分类"},on:{change:function(t){return e.handleSelectChange(t,"cat_id")}}},e._l(e.orderClassification,(function(r,o){return t("a-select-option",{attrs:{value:r.cat_id}},[e._v(" "+e._s(r.cate_name)+" ")])})),1)],1),t("a-form-model-item",{attrs:{label:"标签",prop:"label_txt"}},[t("a-transfer",{attrs:{locale:{itemUnit:"【已选】",itemsUnit:"【全部】",notFoundContent:"列表为空",searchPlaceholder:"请输入搜索内容"},"show-search":"",rowKey:function(e){return e.key},"data-source":e.labelList,"list-style":{width:"200px",height:"270px"},render:e.renderItem,"show-select-all":!0,"target-keys":e.targetKeys},on:{change:e.handleTransferChange}})],1),t("a-form-model-item",{attrs:{label:"补充内容",prop:"order_content"}},[t("a-textarea",{staticStyle:{padding:"5px width:200px",height:"100px",resize:"none"},attrs:{placeholder:"请输入"},model:{value:e.workerForm.order_content,callback:function(t){e.$set(e.workerForm,"order_content",t)},expression:"workerForm.order_content"}})],1),e.workVisible?t("a-form-model-item",{attrs:{label:"",prop:"order_imgs"}},[t("a-upload",{staticStyle:{transform:"translateX(140px)"},attrs:{action:"/v20/public/index.php/community/village_api.ContentEngine/uploadFile","list-type":"picture-card","file-list":e.fileList,"before-upload":e.beforeUpload},on:{preview:e.handlePreview,change:e.handleUploadChange}},[e.fileList.length<8?t("div",[t("a-icon",{attrs:{type:"plus"}}),t("div",{staticClass:"ant-upload-text"},[e._v(" Upload ")])],1):e._e()]),t("div",{staticClass:"desc",staticStyle:{transform:"translateX(140px)"}},[e._v(" 已上传"+e._s(e.fileList.length)+"张, 最多可上传8张 ")]),t("a-modal",{attrs:{visible:e.previewVisible,footer:null},on:{cancel:e.handleCancel}},[t("img",{staticStyle:{width:"100%"},attrs:{alt:"example",src:e.previewImage}})])],1):e._e(),e.workVisible?t("a-form-model-item",{attrs:{label:"上门时间",prop:"go_time"}},[t("a-date-picker",{on:{change:e.onDateChange}}),t("a-time-picker",{staticStyle:{"margin-left":"10px"},attrs:{format:"HH:mm"},on:{change:e.onTimeChange}})],1):e._e(),t("a-form-model-item",{attrs:{"wrapper-col":{span:14,offset:4}}},[t("a-button",{attrs:{type:"primary"},on:{click:e.onSubmit}},[e._v(" 提交 ")])],1)],1)],1)},n=[],i=r("dff4"),a=r("d34b"),s=(r("c09d"),r("4380")),l=(r("c5cb"),r("17c8"),r("02bf"),r("da8f"),r("a617"),r("075f"),r("8bbf"),r("a0e0"));function c(e){return new Promise((function(t,r){var o=new FileReader;o.readAsDataURL(e),o.onload=function(){return t(o.result)},o.onerror=function(e){return r(e)}}))}var u={props:{workVisible:{type:Boolean,default:!1}},components:{"a-transfer":s["a"]},data:function(){return{workerForm:{address_id:"",cat_id:"",cat_fid:"",go_time:""},labelCol:{span:4},wrapperCol:{span:14},rules:{cat_fid:[{required:!0,message:"请选择工单类目",trigger:"blur"}],cat_id:[{required:!0,message:"请选择工单类目",trigger:"blur"}],order_content:[{required:!0,message:"请输入补充内容",trigger:"blur"}],address_id:[{required:!1,message:"请选择位置",trigger:"blur"}],go_time:[{required:!1,message:"请选择上门时间",trigger:"blur"}]},previewVisible:!1,previewImage:"",fileList:[],options:[],targetKeys:[],labelList:[],orderCategory:[],orderClassification:[],housePositionList:[],positionChild1:[],positionChild2:[],positionChild3:[],timeStr:""}},mounted:function(){this.getHousePosition(),this.getSubject()},methods:{onTimeChange:function(e,t){this.timeStr=t,console.log("timeString===>",t)},onSubmit:function(){var e=this,t=this;""==t.timeStr||""==t.workerForm.go_time?t.workerForm.go_time="":t.workerForm.go_time=t.workerForm.go_time+" "+t.timeStr,t.$refs.ruleForm.validate((function(r){if(!r)return console.log("error submit!!"),!1;t.request(l["a"].repairOrderAdd,t.workerForm).then((function(r){t.$message.success("添加成功！"),e.clearForm(),e.$refs.ruleForm.resetFields(),e.$emit("closeWorker",!0)}))}))},resetForm:function(){this.clearForm(),this.$refs.ruleForm.resetFields(),this.$emit("closeWorker",!1)},onClose:function(){this.clearForm(),this.$refs.ruleForm.resetFields(),this.$emit("closeWorker",!1)},uniqueKey:function(e){return Array.from(new Set(e))},handleCancel:function(){this.previewVisible=!1},housePositionChange1:function(e,t){var r=this;console.log(e,t),0==t?(r.positionChild1=[],r.positionChild2=[],r.positionChild3=[],r.housePositionList.map((function(o){o.name==e&&"public"!=o.type?(r.workerForm.address_type=o.type,r.workerForm.address_id=o.id,r.getHousePositionChidren(o.id,o.type,t)):o.name==e&&"public"==o.type&&(r.workerForm.address_type=o.type,r.workerForm.address_id=o.id)}))):1==t?(r.positionChild2=[],r.positionChild3=[],r.positionChild1.map((function(o){o.name==e&&"public"!=o.type?(r.workerForm.address_type=o.type,r.workerForm.address_id=o.id,r.getHousePositionChidren(o.id,o.type,t)):o.name==e&&"public"==o.type&&(r.workerForm.address_type=o.type,r.workerForm.address_id=o.id)}))):2==t?(r.positionChild3=[],r.positionChild2.map((function(o){o.name==e&&"public"!=o.type?(r.workerForm.address_type=o.type,r.workerForm.address_id=o.id,r.getHousePositionChidren(o.id,o.type,t)):o.name==e&&"public"==o.type&&(r.workerForm.address_type=o.type,r.workerForm.address_id=o.id)}))):3==t&&r.positionChild3.map((function(t){t.name==e&&(r.workerForm.address_type=t.type,r.workerForm.address_id=t.id)}))},handlePreview:function(e){var t=this;return Object(a["a"])(Object(i["a"])().mark((function r(){return Object(i["a"])().wrap((function(r){while(1)switch(r.prev=r.next){case 0:if(e.url||e.preview){r.next=4;break}return r.next=3,c(e.originFileObj);case 3:e.preview=r.sent;case 4:t.previewImage=e.url||e.preview,t.previewVisible=!0;case 6:case"end":return r.stop()}}),r)})))()},beforeUpload:function(e){var t="image/jpeg"===e.type||"image/png"===e.type;t||this.$message.error("You can only upload JPG file!");var r=e.size/1024/1024<2;return r||this.$message.error("Image must smaller than 2MB!"),t&&r},handleUploadChange:function(e){var t=e.fileList,r=this;r.fileList=t,r.workerForm.order_imgs=[],r.fileList.map((function(e){e.response&&e.response.data&&e.response.data.url&&r.workerForm.order_imgs.push(e.response.data.url)}))},handleSelectChange:function(e,t){this.workerForm[t]=e,this.$forceUpdate(),"cat_fid"==t?(this.workerForm.cat_id="",this.getRepairCate(e)):"cat_id"==t&&(this.labelList=[],this.targetKeys=[],this.getLabel(e))},renderItem:function(e){var t=this.$createElement,r=t("span",{class:"custom-item"},[e.title]);return{label:r,value:e.title}},handleTransferChange:function(e,t,r){this.targetKeys=e,this.workerForm.label_txt=e},clearForm:function(){this.positionChild1=[],this.positionChild2=[],this.positionChild3=[],this.labelList=[],this.workerForm={cat_id:"",cat_fid:"",go_time:""},this.targetKeys=[],this.fileList=[],this.timeStr=""},getLabelList:function(){var e=this;e.request(l["a"].getLabelList,{}).then((function(t){e.labelList=[],t.list.map((function(t){e.labelList.push({key:t.id+"",title:t.label_name})}))}))},getHousePosition:function(){var e=this;e.request(l["a"].getHousePosition,{}).then((function(t){e.housePositionList=t}))},getHousePositionChidren:function(e,t,r){var o=this;o.request(l["a"].getHousePositionChidren,{id:e,type:t}).then((function(e){0==r?o.positionChild1=e:1==r?o.positionChild2=e:2==r&&(o.positionChild3=e)}))},getSubject:function(){var e=this;this.request(l["a"].getSubjectOrders,{}).then((function(t){e.orderCategory=t}))},getRepairCate:function(e){var t=this;this.request(l["a"].getRepairCate,{subject_id:e}).then((function(e){t.orderClassification=e}))},getLabel:function(e){var t=this;this.request(l["a"].getLabel,{cat_id:e}).then((function(e){e.map((function(e){t.labelList.push({key:e.id+"",title:e.name})}))}))},onDateChange:function(e,t){this.workerForm.go_time=t}}},h=u,d=(r("3193"),r("0b56")),p=Object(d["a"])(h,o,n,!1,null,"7de8267d",null);t["default"]=p.exports}}]);