(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-0e887040","chunk-2d0b90cf"],{"30fb":function(t,e,a){"use strict";a.r(e);var i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("a-modal",{attrs:{title:t.title,width:1300,visible:t.visible,maskClosable:!1,confirmLoading:t.confirmLoading,footer:null,centered:!0},on:{cancel:t.handleCancel}},[a("div",{staticClass:"search-box",staticStyle:{"margin-bottom":"10px"}},[a("a-row",{attrs:{gutter:48}},[a("a-col",{attrs:{md:8,sm:24}},[a("a-input-group",{attrs:{compact:""}},[a("a-select",{staticStyle:{width:"30%"},attrs:{"default-value":"name"},model:{value:t.search.select_option,callback:function(e){t.$set(t.search,"select_option",e)},expression:"search.select_option"}},[a("a-select-option",{attrs:{value:"name"}},[t._v(" 姓名 ")]),a("a-select-option",{attrs:{value:"phone"}},[t._v(" 联系方式 ")])],1),a("a-input",{staticStyle:{width:"70%"},model:{value:t.search.con,callback:function(e){t.$set(t.search,"con",e)},expression:"search.con"}})],1)],1),a("a-col",{attrs:{md:2,sm:2}},[a("a-button",{attrs:{type:"primary",icon:"search"},on:{click:function(e){return t.searchList()}}},[t._v(" 查询 ")])],1),a("a-col",{attrs:{md:2,sm:2}},[a("a-button",{on:{click:function(e){return t.resetList()}}},[t._v("重置")])],1)],1)],1),a("a-table",{attrs:{"row-selection":t.rowSelection,rowKey:"worker_id",columns:t.columns,"data-source":t.data,pagination:t.pagination},on:{change:t.handleTableChange},scopedSlots:t._u([{key:"operation",fn:function(e,i){return a("span",{},[0==i.is_exist?a("a-button",{attrs:{type:"primary"},on:{click:function(e){return t.bind(i.worker_id,i.work_name,i.work_phone,i.work_id_card,i.work_addr,i.work_head,1)}}},[t._v("添加")]):a("a-button",{on:{click:function(e){return t.bind(i.worker_id,i.work_name,i.work_phone,i.work_id_card,i.work_addr,i.work_head,2)}}},[t._v("移除")])],1)}}])}),a("choiceGrid",{ref:"choiceModal",on:{change:t.info}}),a("a-button",{attrs:{type:"primary"},on:{click:function(e){return t.bind_all()}}},[t._v("批量添加")])],1)},n=[],o=a("5530"),s=(a("ac1f"),a("841c"),a("567c")),r=a("9aed"),c=[{title:"编号",width:100,dataIndex:"work_num",key:"work_num"},{title:"姓名",width:200,dataIndex:"work_name",key:"work_name"},{title:"手机号码",dataIndex:"work_phone",key:"work_phone",width:150},{title:"职务",dataIndex:"work_job",key:"work_job",width:150},{title:"部门",dataIndex:"organization_txt",key:"organization_txt",width:150},{title:"操作",key:"operation",fixed:"right",width:100,scopedSlots:{customRender:"operation"}}],l=null,d={components:{choiceGrid:r["default"]},data:function(){return{title:"添加",visible:!1,confirmLoading:!1,pagination:{},form:this.$form.createForm(this),search:{page:1,select_option:"name",con:""},columns:c,data:[],selectedRowKeys:[],workers_id_arr:[]}},computed:{hasSelected:function(){return this.selectedRowKeys.length>0},rowSelection:function(){var t=this;return{onChange:function(e,a){console.log("selectedRows: ",a),a!=[]&&(t.workers_id_arr=a)},getCheckboxProps:function(t){return{props:{disabled:1===t.is_exist}}}}}},mounted:function(){l=this},methods:{add:function(){this.visible=!0,this.search.select_option="name",this.search.con="",this.fetch(),this.pagination.page=1},handleTableChange:function(t,e,a){console.log(t);var i=Object(o["a"])({},this.pagination);i.current=t.current,this.pagination=i,this.fetch(Object(o["a"])({results:t.pageSize,page:t.current,sortField:a.field,sortOrder:a.order},e))},fetch:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.loading=!0,this.request(s["a"].getWorkersPage,e).then((function(e){var a=Object(o["a"])({},t.pagination);a.total=e.total,a.pageSize=e.limit,t.loading=!1,t.data=e.list,t.pagination=a}))},searchList:function(){var t=this.search;this.fetch(t)},bind_all:function(){if(""==this.workers_id_arr)return this.$message.error("请选择数据"),!1;this.bindFunc(this.workers_id_arr)},bindFunc:function(t){this.$refs.choiceModal.getList(t)},bind:function(t,e,a,i,n,o,r){var c=this;1==r?this.bindFunc([{worker_id:t,work_name:e,work_phone:a,work_id_card:i,work_addr:n,work_head:o}]):this.request(s["a"].delGridCustom,{workers_id:t}).then((function(t){l.$message.success("操作成功"),c.$emit("reload")}))},handleCancel:function(){var t=this;this.visible=!1,this.$emit("reload"),setTimeout((function(){t.form=t.$form.createForm(t)}),500)},resetList:function(){this.search={select_option:"name",value:"",status:"",date:[],page:1},this.fetch(this.search)},info:function(t,e,a){var i=this;console.log("info===========",t,e,a[0]),e.visible=!1,e.is_show=!1,this.request(s["a"].addGridCustom,{workers_id_arr:t,community_id:a[0]}).then((function(t){i.$message.success("操作成功"),i.$emit("reload")}))}}},u=d,h=a("2877"),f=Object(h["a"])(u,i,n,!1,null,"b60e0b3c",null);e["default"]=f.exports},6116:function(t,e,a){},"6b7b":function(t,e,a){"use strict";a("a0fa")},"721c":function(t,e,a){},"875b":function(t,e,a){"use strict";a.r(e);var i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"package-list ant-pro-page-header-wrap-children-content",staticStyle:{margin:"24px 0 0"}},[a("a-card",{attrs:{bordered:!1}},[a("div",{staticClass:"search-box",staticStyle:{"margin-bottom":"10px"}},[a("a-row",{attrs:{gutter:48}},[a("a-col",{attrs:{md:8,sm:24}},[a("a-input-group",{attrs:{compact:""}},[a("a-select",{staticStyle:{width:"30%"},attrs:{"default-value":"work_name"},model:{value:t.search.select_option,callback:function(e){t.$set(t.search,"select_option",e)},expression:"search.select_option"}},[a("a-select-option",{attrs:{value:"work_name"}},[t._v(" 姓名 ")]),a("a-select-option",{attrs:{value:"work_phone"}},[t._v(" 联系方式 ")])],1),a("a-input",{staticStyle:{width:"70%"},model:{value:t.search.con,callback:function(e){t.$set(t.search,"con",e)},expression:"search.con"}})],1)],1),a("a-col",{attrs:{md:2,sm:2}},[a("a-button",{attrs:{type:"primary",icon:"search"},on:{click:function(e){return t.searchList()}}},[t._v(" 查询 ")])],1),a("a-col",{attrs:{md:2,sm:2}},[a("a-button",{on:{click:function(e){return t.resetList()}}},[t._v("重置")])],1)],1)],1),a("div",{staticClass:"table-operator"},[1!=t.area_type?a("a-button",{attrs:{type:"primary",icon:"plus"},on:{click:function(e){return t.$refs.createModal.add()}}},[t._v("添加")]):t._e()],1),a("a-table",{attrs:{columns:t.columns,"data-source":t.list,pagination:t.pagination},on:{change:t.tableChange},scopedSlots:t._u([{key:"action",fn:function(e,i){return a("span",{},[a("a",{on:{click:function(e){return t.$refs.gridRangeInfoModal.edit(i.id)}}},[t._v("查看")]),a("a",{staticStyle:{"margin-left":"20px"},on:{click:function(e){return t.gridRange(i.id)}}},[t._v("负责网格")]),a("a-popconfirm",{staticClass:"ant-dropdown-link",staticStyle:{"margin-left":"20px"},attrs:{title:"确认删除?","ok-text":"是","cancel-text":"否"},on:{confirm:function(e){return t.deleteConfirm(i.id)},cancel:t.cancel}},[a("a",{attrs:{href:"#"}},[t._v("删除")])])],1)}}])}),a("add-grid-custom",{ref:"createModal",attrs:{height:800,width:1200},on:{ok:t.handleOks,reload:t.reload}}),a("grid-range",{ref:"createRangeModal",attrs:{height:800,width:1200}}),a("grid-info",{ref:"gridRangeInfoModal",attrs:{height:800,width:1200}}),a("a-modal",{attrs:{title:"提示",visible:t.notice,"confirm-loading":t.confirmLoading,footer:null,centered:!0},on:{cancel:t.handleCancel}},[a("div",{staticStyle:{"text-align":"center"}},[t._v("暂无负责区域")])])],1)],1)},n=[],o=(a("ac1f"),a("841c"),a("567c")),s=a("30fb"),r=a("a914"),c=a("f663"),l={inject:["reload"],name:"GridInfo",components:{addGridCustom:s["default"],gridRange:r["default"],gridInfo:c["default"]},data:function(){return{list:[],visible:!1,notice:!1,confirmLoading:!1,sortedInfo:null,pagination:{pageSize:10,total:10},search:{page:1,select_option:"work_name"},page:1,detail:{},area_type:2}},mounted:function(){this.getGridCustomList()},computed:{columns:function(){var t=this.sortedInfo;t=t||{};var e=[{title:"姓名",dataIndex:"name",key:"name"},{title:"手机号码",dataIndex:"phone",key:"phone"},{title:"身份证号",dataIndex:"id_card",key:"id_card"},{title:"住址",dataIndex:"address",key:"address"},{title:"操作",key:"action",dataIndex:"",scopedSlots:{customRender:"action"}}];return e}},created:function(){},methods:{callback:function(t){console.log(t)},getGridCustomList:function(){var t=this;this.search["page"]=this.page,this.request(o["a"].gridCustomList,this.search).then((function(e){console.log("res",e),t.list=e.list,t.pagination.total=e.count?e.count:0,t.pagination.pageSize=e.total_limit?e.total_limit:10,t.area_type=e.area_type}))},onClose:function(){this.visible=!1},getGroupDetail:function(t){var e=this;this.request(o["a"].getGroupDetail,{pigcms_id:t}).then((function(t){console.log("res",t),e.detail=t}))},tableChange:function(t){t.current&&t.current>0&&(this.page=t.current,this.getGridCustomList())},cancel:function(){},deleteConfirm:function(t){var e=this;this.request(o["a"].delGridCustom,{id:t}).then((function(t){e.getGridCustomList(),e.$message.success("删除成功")}))},handleOks:function(){this.getGridCustomList()},searchList:function(){console.log("search",this.search),this.getGridCustomList()},resetList:function(){console.log("search",this.search),console.log("search_data",this.search_data),this.search={select_option:"work_name",value:"",status:"",date:[],page:1},this.search_data=[],this.getGridCustomList()},gridRange:function(t){var e=this;this.request(o["a"].getGridRange,{grid_member_id:t}).then((function(t){""==t.data?e.notice=!0:e.$refs.createRangeModal.add(t.data)}))},handleCancel:function(t){this.notice=!1}}},d=l,u=(a("edcd"),a("2877")),h=Object(u["a"])(d,i,n,!1,null,"dbc1fe98",null);e["default"]=h.exports},a0fa:function(t,e,a){},a914:function(t,e,a){"use strict";a.r(e);var i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[t.visible?a("a-modal",{attrs:{title:"网格",width:940,visible:t.visible,confirmLoading:t.confirmLoading,footer:null,centered:!0,destroyOnClose:!0},on:{cancel:t.handleCancel}},[a("baidu-map",{staticClass:"map",attrs:{zoom:t.zoom,center:t.polygon},on:{ready:t.handler}})],1):t._e()],1)},n=[],o=(a("d81d"),a("ac1f"),a("1276"),a("567c")),s={name:"GridRange",data:function(){return{zoom:15,data:"",visible:!1,polygon:{lng:117.283042,lat:31.86119},confirmLoading:!1,map:"",BMap:""}},mounted:function(){console.log("刷新后"),window.addEventListener("mousewheel",this.handleScroll)},methods:{add:function(t){this.visible=!0,this.data=t,this.getCenterPolygon()},handler:function(t){var e=this,a=t.BMap,i=t.map;this.map=i,this.BMap=a;var n=new Array;this.data.map((function(t,a){n=new Array,t.manage_range_polygon.map((function(t,a){var i=new Array;i=t.split(","),n[a]=new e.BMap.Point(i[0],i[1])})),e.$forceUpdate();var i=new e.BMap.Polygon(n,{strokeColor:"#2681f3",strokeWeight:2,strokeOpacity:.8,fillColor:"#2681f3",strokeStyle:"dashed"});e.map.addOverlay(i)}))},handleCancel:function(){this.zoom=15,this.visible=!1,this.polygon={lng:117.283042,lat:31.86119},this.map="",this.BMap=""},handleScroll:function(t){t=t||window.event;t.wheelDelta>0?(this.zoom=this.zoom+1,this.zoom>19&&(this.zoom=19)):(this.zoom=this.zoom-1,this.zoom<4&&(this.zoom=4))},getCenterPolygon:function(){var t=this;this.request(o["a"].getStreetAreaInfo,{}).then((function(e){t.polygon.lng=e.long,t.polygon.lat=e.lat,console.log(t.polygon)}))}}},r=s,c=(a("f951"),a("2877")),l=Object(c["a"])(r,i,n,!1,null,"6b89f4ce",null);e["default"]=l.exports},edcd:function(t,e,a){"use strict";a("6116")},f663:function(t,e,a){"use strict";a.r(e);var i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("a-modal",{attrs:{title:t.title,width:600,visible:t.visible,maskClosable:!1,confirmLoading:t.confirmLoading,footer:null,centered:!0},on:{cancel:t.handleCancel}},[a("div",[a("h3",[t._v("姓名："+t._s(t.detail.name))]),a("h3",[t._v("手机号："+t._s(t.detail.phone))]),a("h3",[t._v("身份证号："+t._s(t.detail.id_card))]),a("h3",[t._v("地址："+t._s(t.detail.address))]),a("h3",[t._v("头像："),a("img",{staticStyle:{width:"50px",height:"50px"},attrs:{src:t.imageUrl}})])])])},n=[],o=a("53ca"),s=a("567c");function r(t,e){var a=new FileReader;a.addEventListener("load",(function(){return e(a.result)})),a.readAsDataURL(t)}var c={data:function(){return{title:"查看",labelCol:{xs:{span:24},sm:{span:7}},wrapperCol:{xs:{span:24},sm:{span:13}},visible:!1,confirmLoading:!1,form:this.$form.createForm(this),detail:{address:"",name:"",phone:"",id_card:"",sex:1,id:0},id:0,imageUrl:"",loading:!1,upload_url:"/v20/public/index.php/"+s["a"].uploadMeeting,img:""}},mounted:function(){},methods:{onSelect:function(t,e){console.log("selected",t,e)},edit:function(t){this.visible=!0,this.id=t,this.getGridCustomInfo()},handleSubmit:function(){var t=this,e=this.form.validateFields;this.confirmLoading=!0,e((function(e,a){var i;e?t.confirmLoading=!1:(a.id=t.id,a.avatar=t.img,i=t.detail.id>0?s["a"].saveGridCustom:s["a"].addGridCustom,t.request(i,a).then((function(e){t.detail.id>0?t.$message.success("编辑成功"):t.$message.success("添加成功"),setTimeout((function(){t.form=t.$form.createForm(t),t.visible=!1,t.confirmLoading=!1,t.$emit("ok",a)}),1500)})).catch((function(e){t.confirmLoading=!1})),console.log("values",a))}))},handleCancel:function(){var t=this;this.visible=!1,setTimeout((function(){t.cat_id="0",t.form=t.$form.createForm(t)}),500)},getGridCustomInfo:function(){var t=this;this.request(s["a"].getGridCustomDetail,{id:this.id}).then((function(e){t.detail={address:"",name:"",phone:"",id_card:"",sex:1},t.checkedKeys=[],"object"==Object(o["a"])(e)&&(t.detail=e,t.imageUrl=e.avatar,t.img=e.avatar),console.log("detail",t.detail),console.log("checkedKeys",t.checkedKeys)}))},handleChange:function(t){var e=this;"uploading"!==t.file.status?"done"===t.file.status&&(r(t.file.originFileObj,(function(t){e.imageUrl=t,e.loading=!1})),1e3===t.file.response.status&&(this.img=t.file.response.data)):this.loading=!0},beforeUpload:function(t){var e="image/jpeg"===t.type||"image/png"===t.type;e||this.$message.error("You can only upload JPG file!");var a=t.size/1024/1024<2;return a||this.$message.error("Image must smaller than 2MB!"),e&&a}}},l=c,d=(a("6b7b"),a("2877")),u=Object(d["a"])(l,i,n,!1,null,"77a85f56",null);e["default"]=u.exports},f951:function(t,e,a){"use strict";a("721c")}}]);