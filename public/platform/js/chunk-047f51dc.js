(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-047f51dc","chunk-9f3dd4d2","chunk-2d0c06af"],{"1ada":function(e,t,a){"use strict";a.r(t);var r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("a-input-group",{attrs:{compact:""}},[e.showProvince?a("a-select",{staticStyle:{width:"115px"},attrs:{"default-value":e.search.provinceId},on:{change:e.handleProvinceChange},model:{value:e.search.provinceId,callback:function(t){e.$set(e.search,"provinceId",t)},expression:"search.provinceId"}},e._l(e.provinceData,(function(t){return a("a-select-option",{key:t.area_id},[e._v(e._s(t.area_name))])})),1):e._e(),e.showCity?a("a-select",{staticStyle:{width:"115px"},on:{change:e.handleCityChange},model:{value:e.search.cityId,callback:function(t){e.$set(e.search,"cityId",t)},expression:"search.cityId"}},e._l(e.cityData,(function(t){return a("a-select-option",{key:t.area_id},[e._v(e._s(t.area_name))])})),1):e._e(),e.showArea?a("a-select",{staticStyle:{width:"115px"},on:{change:e.handleAreaChange},model:{value:e.search.areaId,callback:function(t){e.$set(e.search,"areaId",t)},expression:"search.areaId"}},e._l(e.areaData,(function(t){return a("a-select-option",{key:t.area_id},[e._v(e._s(t.area_name))])})),1):e._e()],1)],1)},o=[],s=(a("ac1f"),a("841c"),a("99af"),a("b59a")),i=[{area_id:"0",area_name:"请选择省份"}],n=[{area_id:"0",area_name:"请选择城市"}],c=[{area_id:"0",area_name:"请选择区域"}],l={data:function(){return{provinceData:i,showProvince:0,cityData:n,showCity:0,areaData:c,showArea:0,search:{provinceId:"0",cityId:"0",areaId:"0"}}},mounted:function(){this.getProvince(),this.getCity(),this.getArea()},methods:{handleProvinceChange:function(e){this.search.provinceId=e,this.search.cityId="0",this.search.areaId="0",this.getCity(),this.$emit("handleSelect",this.search)},handleCityChange:function(e){this.search.cityId=e,this.search.areaId="0",this.getArea(),this.$emit("handleSelect",this.search)},handleAreaChange:function(e){this.search.areaId=e,this.$emit("handleSelect",this.search),console.log(e)},getProvince:function(){var e=this;this.request(s["a"].getSelectProvince).then((function(t){console.log(t),0==t.error?(e.provinceData=[{area_id:"0",area_name:"请选择省份"}],e.provinceData=e.provinceData.concat(t.list),e.showProvince=1,console.log(e.provinceData)):2==t.error&&(e.provinceData=t.list,e.showProvince=1)}))},getCity:function(){var e=this;this.request(s["a"].getSelectCity,{id:this.search.provinceId}).then((function(t){console.log(t),e.cityData=[{area_id:"0",area_name:"请选择城市"}],e.areaData=[{area_id:"0",area_name:"请选择区域"}],0==t.error?(e.cityData=e.cityData.concat(t.list),e.showCity=1):1==t.error?e.showCity=1:2==t.error&&(e.cityData=t.list,e.showCity=1)}))},getArea:function(){var e=this,t={id:this.search.cityId};this.request(s["a"].getSelectArea,t).then((function(t){e.areaData=[{area_id:"0",area_name:"请选择区域"}],0==t.error?(e.areaData=e.areaData.concat(t.list),e.showArea=1):2==t.error&&(e.areaData=t.list,e.showArea=1)}))}}},d=l,h=a("2877"),u=Object(h["a"])(d,r,o,!1,null,null,null);t["default"]=u.exports},3938:function(e,t,a){"use strict";a("bf05")},4261:function(e,t,a){"use strict";a.r(t);var r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("a-button",{directives:[{name:"show",rawName:"v-show",value:!1,expression:"false"}],attrs:{type:"primary"}},[e._v(" Open the message box ")])},o=[],s={downloadExportFile:"/common/common.export/downloadExportFile"},i=s,n="updatable",c={props:{exportUrl:"",queryParam:{}},data:function(){return{file_date:"",file_url:""}},mounted:function(){},methods:{exports:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"加载中,请耐心等待,数量越多时间越长。";this.request(this.exportUrl,this.queryParam).then((function(a){e.$message.loading({content:t,key:n,duration:0}),console.log("添加导出计划任务成功"),e.file_url=i.downloadExportFile+"?id="+a.export_id,e.file_date=a,e.CheckStatus()}))},CheckStatus:function(){var e=this;this.request(this.file_url,{id:this.file_date.export_id}).then((function(t){0==t.error?(e.$message.success({content:"下载成功!",key:n,duration:2}),location.href=t.url):setTimeout((function(){e.CheckStatus(),console.log("重复请求")}),1e3)}))}}},l=c,d=a("2877"),h=Object(d["a"])(l,r,o,!1,null,"dd2f8128",null);t["default"]=h.exports},"6ea1":function(e,t,a){"use strict";var r={getLists:"/foodshop/merchant.FoodshopStore/getStoreList",seeQrcode:"/foodshop/merchant.FoodshopStore/seeQrcode",orderList:"/foodshop/merchant.order/orderList",orderDetail:"/foodshop/merchant.order/orderDetail",orderExportUrl:"/foodshop/merchant.order/export",sortList:"/foodshop/merchant.sort/sortList",changeSort:"/foodshop/merchant.sort/changeSort",geSortDetail:"/foodshop/merchant.sort/geSortDetail",editSort:"/foodshop/merchant.sort/editSort",delSort:"/foodshop/merchant.sort/delSort",selectSortList:"/foodshop/merchant.sort/selectSortList",goodsList:"/foodshop/merchant.goods/goodsList",goodsDetail:"/foodshop/merchant.goods/goodsDetail",editSingleGoods:"/foodshop/merchant.goods/editSingleGoods",editGoods:"/foodshop/merchant.goods/editGoods",addGoods:"/foodshop/merchant.goods/addGoods",goodsDel:"/foodshop/merchant.goods/goodsDel",changeStatus:"/foodshop/merchant.goods/changeStatus",editGoodsBatch:"/foodshop/merchant.goods/editGoodsBatch",getShopDetail:"/foodshop/merchant.FoodshopStore/getShopDetail",shopEdit:"/foodshop/merchant.FoodshopStore/shopEdit",storePrintList:"/foodshop/merchant.print/getStorePrintList",tableTypeList:"/foodshop/merchant.FoodshopStore/tableTypeList",tableList:"/foodshop/merchant.FoodshopStore/tableList",getTableType:"/foodshop/merchant.FoodshopStore/getTableType",saveTableType:"/foodshop/merchant.FoodshopStore/saveTableType",delTableType:"/foodshop/merchant.FoodshopStore/delTableType",getTable:"/foodshop/merchant.FoodshopStore/getTable",saveTable:"/foodshop/merchant.FoodshopStore/saveTable",delTable:"/foodshop/merchant.FoodshopStore/delTable",downloadQrcodeTable:"/foodshop/merchant.FoodshopStore/downloadQrcodeTable",downloadQrcodeStore:"/foodshop/merchant.FoodshopStore/downloadQrcodeStore",getPrintRuleList:"/foodshop/merchant.print/getPrintRuleList",getPrintRuleDetail:"/foodshop/merchant.print/getPrintRuleDetail",editPrintRule:"/foodshop/merchant.print/editPrintRule",delPrintRule:"/foodshop/merchant.print/delPrintRule",getPrintGoodsList:"/foodshop/merchant.print/getPrintGoodsList",getPackageList:"/foodshop/merchant.Package/getPackageList",removePackage:"/foodshop/merchant.Package/delPackage",getPackageDetail:"/foodshop/merchant.Package/getPackageDetail",editPackage:"/foodshop/merchant.Package/editPackage",getPackageDetailList:"/foodshop/merchant.Package/getPackageDetailList",editPackageDetail:"/foodshop/merchant.Package/editPackageDetail",getPackageDetailInfo:"/foodshop/merchant.Package/getPackageDetailInfo",delPackageDetail:"/foodshop/merchant.Package/delPackageDetail",getPackageDetailGoodsList:"/foodshop/merchant.Package/getPackageDetailGoodsList",getPackageGoodsList:"/foodshop/merchant.Package/getPackageGoodsList"};t["a"]=r},b59a:function(e,t,a){"use strict";var r={getSelectProvince:"/common/platform.area.area/getSelectProvince",getSelectCity:"/common/platform.area.area/getSelectCity",getSelectArea:"/common/platform.area.area/getSelectArea",getSelectPropertyProvince:"/merchant/merchant.system.area/getProvinceList",getSelectPropertyCity:"/merchant/merchant.system.area/getCityList",getSelectPropertyArea:"/merchant/merchant.system.area/getAreaList",getSelectProvinceAndCity:"/common/platform.area.area/getSelectProvinceAndCity"};t["a"]=r},bf05:function(e,t,a){},ea67:function(e,t,a){"use strict";a.r(t);var r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"staff-order-list pt-20 pl-20 pr-20 pb-20"},[a("div",{staticClass:"message-suggestions-list-box"},[a("a-form",{ref:"search_header",attrs:{layout:"inline"}},[a("a-row",{attrs:{gutter:24}},[a("a-col",{attrs:{span:12}},[a("a-form-item",{attrs:{label:e.L("下单时间")+":"}},[a("a-range-picker",{staticStyle:{},attrs:{ranges:e.pickerRanges,allowClear:!0},on:{change:e.dateOnChange},model:{value:e.search_data,callback:function(t){e.search_data=t},expression:"search_data"}},[a("a-icon",{attrs:{slot:"suffixIcon",type:"calendar"},slot:"suffixIcon"})],1)],1)],1),a("a-col",{staticClass:"text-right",attrs:{span:12}},[a("a-button",{attrs:{icon:"download"},on:{click:function(t){return e.$refs.ExportAddModal.exports()}}},[e._v(e._s(e.L("导出订单")))])],1)],1),a("a-row",{attrs:{gutter:24}},[a("a-col",{attrs:{span:12}},[a("a-form-item",{attrs:{label:e.L("手动搜索")+":"}},[a("a-select",{staticClass:"selectType",staticStyle:{width:"120px","text-align":"center"},attrs:{"default-value":"queryParam.searchtype"},model:{value:e.queryParam.searchtype,callback:function(t){e.$set(e.queryParam,"searchtype",t)},expression:"queryParam.searchtype"}},e._l(e.search_keyword,(function(t){return a("a-select-option",{key:t.key,attrs:{value:t.key}},[e._v(e._s(t.value))])})),1),a("a-input",{staticStyle:{width:"235px"},attrs:{allowClear:""},model:{value:e.queryParam.keyword,callback:function(t){e.$set(e.queryParam,"keyword",t)},expression:"queryParam.keyword"}})],1)],1),a("a-col",{attrs:{span:12}},[a("a-button",{staticClass:"mr-10",attrs:{type:"primary",icon:"search"},on:{click:function(t){return e.getOrderList()}}},[e._v(e._s(e.L("查询")))])],1)],1)],1),a("div",{staticClass:"mt-10"},[a("a-tabs",{attrs:{activeKey:e.queryParam.order_status},on:{change:e.statusChange}},[a("a-tab-pane",{key:"0",attrs:{tab:e.L("全部")}}),a("a-tab-pane",{key:"1",attrs:{tab:e.L("待付款")}}),a("a-tab-pane",{key:"2",attrs:{tab:e.L("待落座")}}),a("a-tab-pane",{key:"3",attrs:{tab:e.L("就餐中")}}),a("a-tab-pane",{key:"4",attrs:{tab:e.L("已完成")}}),a("a-tab-pane",{key:"5",attrs:{tab:e.L("已取消")}})],1)],1),a("a-table",{attrs:{columns:e.columns,"data-source":e.data,pagination:e.pagination,rowKey:"order_id",loading:e.loading,scroll:{x:!0,y:e.tableContentHeight}},on:{change:e.tableChange},scopedSlots:e._u([{key:"order_status",fn:function(t,r){return a("span",{},[a("a-badge",{attrs:{status:e._f("statusFilter")(r.order_status),text:t}})],1)}},{key:"order_type",fn:function(t,r){return a("span",{},[1==t?a("a-tag",{attrs:{color:"pink"}},[e._v(e._s(e.L("预订单")))]):e._e(),1==r.is_self_take?a("a-tag",{attrs:{color:"purple"}},[e._v(e._s(e.L("自取单")))]):e._e(),0==r.is_self_take&&0==t?a("a-tag",{attrs:{color:"cyan"}},[e._v(e._s(e.L("堂食单")))]):e._e()],1)}},{key:"action",fn:function(t,r){return[a("a",{staticClass:"mr-10 mt-10 mb-10 inline-block no-wrap",on:{click:function(t){return e.look(r)}}},[e._v(e._s(e.L("查看")))]),Number(r.order_status)>2&&Number(r.order_status)<6&&5!=Number(r.order_status)?a("a",{staticClass:" inline-block ",staticStyle:{"margin-left":"10px"},on:{click:function(t){return e.print(r)}}},[e._v(" "+e._s(e.L("打印"))+" ")]):e._e()]}}])}),a("a-drawer",{staticClass:"detail-content",attrs:{width:"520",title:e.L("订单详情"),placement:"right",closable:!1,visible:e.visible},on:{"after-visible-change":e.afterVisibleChange,close:e.onClose}},[a("order-detail",{ref:"OrderDetailModal",attrs:{detail:e.detail},on:{look:e.look,closeOpt:e.onClose,updateList:e.getOrderList}})],1)],1),a("export-add",{ref:"ExportAddModal",attrs:{exportUrl:"/foodshop/storestaff.order/export",queryParam:e.queryParam}}),a("a-modal",{attrs:{title:e.L("请选择打印类型"),centered:"",width:450,destroyOnClose:""},on:{ok:e.handlePrintOk,cancel:e.handlePrintCancel},model:{value:e.printmodalVisiable,callback:function(t){e.printmodalVisiable=t},expression:"printmodalVisiable"}},[a("div",{staticClass:"print"},[a("a-checkbox-group",{attrs:{options:e.plainOptions},on:{change:e.onPrintTypeChange},model:{value:e.checkedList,callback:function(t){e.checkedList=t},expression:"checkedList"}}),a("br"),a("div",{staticClass:"mt-20 pt-10 bt-f1"},[a("a-checkbox",{attrs:{indeterminate:e.indeterminate,checked:e.checkAll},on:{change:e.onPrintCheckAllChange}},[e._v(e._s(e.L("全选")))])],1)],1)])],1)},o=[],s=a("5530"),i=(a("a9e3"),a("d81d"),a("ac1f"),a("5319"),a("8bbf")),n=a.n(i),c=a("c1df"),l=a.n(c),d=a("5988"),h=a("6ea1"),u=a("1ada"),p=a("10a1"),g=a("4261"),m=[],f=["error","error","error","processing","success","default","processing","processing"],_=[],y=["customer_account","menu","pre_account","bill_account"],b={props:{refresh:{type:Number,default:0}},components:{AreaSearch:u["default"],OrderDetail:p["default"],ExportAdd:g["default"]},data:function(){var e=this;return this.cacheData=m.map((function(e){return Object(s["a"])({},e)})),{form:this.$form.createForm(this),loading:!0,mdl:{},visible:!1,statusMap:f,id:1,timeTab:"",orderId:0,detail:{},search_data:[l()().subtract(7,"days"),l()()],exportUrl:d["a"].orderExportUrl,search_keyword:[{key:"real_orderid",value:this.L("订单编号")},{key:"third_id",value:this.L("流水号")},{key:"username",value:this.L("下单人")},{key:"phone",value:this.L("下单人电话")}],queryParam:{searchtype:"real_orderid",show_goods_detail:"1",order_status:"0"},pagination:{pageSize:10,total:10,current:1,"show-total":function(t){return e.L("共 X1 条记录",{X1:t})},"show-size-changer":!0,"show-quick-jumper":!0},columns:[{width:"15%",title:this.L("订单编号"),dataIndex:"real_orderid"},{title:this.L("订单总额"),dataIndex:"total_price",width:"12%",sorter:function(e,t){return e.total_price-t.total_price}},{title:this.L("实际支付"),width:"12%",dataIndex:"pay_price",sorter:function(e,t){return e.pay_price-t.pay_price}},{width:"10%",title:this.L("下单人"),dataIndex:"username"},{title:this.L("下单人电话"),width:"10%",dataIndex:"phone"},{title:this.L("下单时间"),width:"10%",dataIndex:"create_time",sorter:function(e,t){return e.create_time_s-t.create_time_s}},{title:this.L("订单状态"),width:"10%",dataIndex:"order_status_txt",scopedSlots:{customRender:"order_status"},sorter:function(e,t){return e.order_status-t.order_status}},{title:this.L("操作"),width:"15%",dataIndex:"action",scopedSlots:{customRender:"action"}}],data:m,isShow:1,store_id:0,isSystem:1,orderListUrl:"",windowHeight:0,searchHeight:0,tableContentHeight:0,printmodalVisiable:!1,indeterminate:!1,checkAll:!0,checkedList:y,plainOptions:_,modalWidth:450,showFooter:!0,pickerRanges:{}}},watch:{refresh:function(e){console.log("------------1111",e),this.pagination.current=1,this.queryParam={searchtype:"real_orderid",show_goods_detail:"1",order_status:"0"},this.search_data=[],this.getOrderList()}},created:function(){this.$emit("getcurrent","query");var e=n.a.ls.get("storestaff_page_info");this.store_id=e.store_id,this.queryParam.store_id=e.store_id,this.orderListUrl="/foodshop/storestaff.order/orderList",this.exportUrl=h["a"].orderExportUrl,this.isSystem=0,this.pickerRanges[this.L("今日")]=[l()(),l()()],this.pickerRanges[this.L("昨日")]=[l()().subtract(1,"days"),l()().subtract(1,"days")],this.pickerRanges[this.L("近七天")]=[l()().subtract(7,"days"),l()()],this.pickerRanges[this.L("近30天")]=[l()().subtract(30,"days"),l()()],this.plainOptions=[{label:this.L("打印客看单"),value:"customer_account"},{label:this.L("打印后厨单"),value:"menu"},{label:this.L("打印预结单"),value:"pre_account"},{label:this.L("打印结账单"),value:"bill_account"}],this.getOrderList()},mounted:function(){var e=this;this.$nextTick((function(){e.init(),window.onresize=function(){setTimeout((function(){e.init()}),600)}}))},filters:{statusFilter:function(e){var t=["error","error","error","processing","success","default","error","processing"];return t[e]}},methods:{moment:l.a,init:function(){var e=document.body.clientHeight,t=window.getComputedStyle(this.$refs.search_header.$el).height.replace("px","");this.tableContentHeight=e-t-40-55-50-55-10-20},getOrderList:function(){var e=this;this.loading=!0,this.queryParam["page"]=this.pagination.current,this.orderListUrl&&this.request(this.orderListUrl,this.queryParam).then((function(t){e.data=t.list,e.pagination.total=t.total,setTimeout((function(){e.loading=!1}),100)}))},getOrderDetail:function(){},exportOrder:function(){},statusChange:function(e){this.loading||(console.log(e),this.queryParam.order_status=e,this.page=1,this.pagination.current=this.page,this.getOrderList())},resetList:function(){for(var e in this.queryParam)this.queryParam[e]="searchtype"===e?"real_orderid":"";this.timeTab="",this.search_data=[],this.id=this.id+1,this.getOrderList()},handleSelect:function(e){this.queryParam.city_id=e.cityId,this.queryParam.province_id=e.provinceId,this.queryParam.area_id=e.areaId},timeTabChange:function(e){var t=new Date;t.setTime(t.getTime());var a=t.getFullYear()+"-"+(t.getMonth()+1)+"-"+t.getDate();if("today"==e.target.value)var r=a;else if("sevenDay"==e.target.value){t=new Date;t.setTime(t.getTime()-6048e5);r=t.getFullYear()+"-"+(t.getMonth()+1)+"-"+t.getDate()}else if("thirtyDay"==e.target.value){t=new Date;t.setTime(t.getTime()-2592e6);r=t.getFullYear()+"-"+(t.getMonth()+1)+"-"+t.getDate()}this.search_data=[l()(r,"YYYY-MM-DD"),l()(a,"YYYY-MM-DD")],this.queryParam.start_time=r,this.queryParam.end_time=a},dateOnChange:function(e,t){this.queryParam.start_time=t[0],this.queryParam.end_time=t[1]},tableChange:function(e){this.queryParam["pageSize"]=e.pageSize,e.current&&e.current>0&&(this.page=e.current,this.pagination.current=e.current,this.getOrderList())},look:function(e){console.log(e),this.detail=e,this.visible=!0,this.orderId=e.order_id},afterVisibleChange:function(e){console.log("visible",e)},showDrawer:function(){this.visible=!0},onClose:function(){this.visible=!1},print:function(e){e.is_self_take?(_=[{label:this.L("打印结账单"),value:"bill_account"}],y=["bill_account"]):"5"==e.order_from?(_=[{label:this.L("打印后厨单"),value:"menu"},{label:this.L("打印结账单"),value:"bill_account"}],y=["menu","bill_account"]):(_=[{label:this.L("打印客看单"),value:"customer_account"},{label:this.L("打印后厨单"),value:"menu"},{label:this.L("打印预结单"),value:"pre_account"},{label:this.L("打印结账单"),value:"bill_account"}],y=["customer_account","menu","pre_account","bill_account"]),this.checkedList=y,this.plainOptions=_,this.orderId=e.order_id,this.printmodalVisiable=!0},handlePrintOk:function(){var e=this;this.checkedList.length?this.request("/foodshop/storestaff.print/printOrder",{order_id:this.orderId,type:this.checkedList}).then((function(t){e.handlePrintCancel(),e.$message.success(t.msg||e.L("打印成功"))})):this.$message.warning(this.L("请选择打印类型"))},handlePrintCancel:function(){this.printmodalVisiable=!1,this.checkAll=!0,this.indeterminate=!1,this.checkedList=y},onPrintTypeChange:function(e){this.indeterminate=!!e.length&&e.length<this.plainOptions.length,this.checkAll=e.length===this.plainOptions.length},onPrintCheckAllChange:function(e){Object.assign(this,{checkedList:e.target.checked?y:[],indeterminate:!1,checkAll:e.target.checked})}}},v=b,k=(a("3938"),a("2877")),L=Object(k["a"])(v,r,o,!1,null,"c587cd58",null);t["default"]=L.exports}}]);