(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-212caa94","chunk-2d0b6a79","chunk-2d0b6a79"],{"16a3":function(a,t,e){},"1da1":function(a,t,e){"use strict";e.d(t,"a",(function(){return r}));e("d3b7");function s(a,t,e,s,r,o,n){try{var i=a[o](n),l=i.value}catch(c){return void e(c)}i.done?t(l):Promise.resolve(l).then(s,r)}function r(a){return function(){var t=this,e=arguments;return new Promise((function(r,o){var n=a.apply(t,e);function i(a){s(n,r,o,i,l,"next",a)}function l(a){s(n,r,o,i,l,"throw",a)}i(void 0)}))}}},"1f38":function(a,t,e){"use strict";e.r(t);var s=function(){var a=this,t=a.$createElement,e=a._self._c||t;return e("a-layout",[e("a-layout-content",{style:{margin:"24px 16px",padding:"24px",background:"#fff",minHeight:"100px"}},[e("a-tabs",{attrs:{"default-active-key":"1"}},[e("a-tab-pane",{key:"1",attrs:{tab:"推送内容查看"}},[e("a-form",a._b({},"a-form",{labelCol:{span:2},wrapperCol:{span:5}},!1),[e("a-row",[e("a-col",{staticClass:"label-font-size text-center",attrs:{span:2}},[e("a-button",{attrs:{type:"default"},on:{click:function(t){return a.returnBack()}}},[e("a-icon",{attrs:{type:"left"}})],1)],1)],1),e("br"),e("a-row",[e("a-col",{staticClass:"label-font-size text-right",attrs:{span:2}},[a._v(" 基本信息 ")])],1),e("br"),e("a-form-item",{attrs:{label:"所属分类"}},[e("a-select",{attrs:{disabled:""},model:{value:a.formData.category_type,callback:function(t){a.$set(a.formData,"category_type",t)},expression:"formData.category_type"}},[a._l(a.cat_sel,(function(t,s){return e("a-select-option",{key:s,attrs:{value:t.cat_id}},[a._v(" "+a._s(t.cat_name)+" ")])})),e("a-select-option",{attrs:{value:a.mall}},[a._v(" 商城 ")]),e("a-select-option",{attrs:{value:a.maidan}},[a._v(" 买单 ")]),e("a-select-option",{attrs:{value:a.group}},[a._v(" 团购 ")]),e("a-select-option",{attrs:{value:a.foodshop}},[a._v(" 外卖 ")])],2)],1),e("a-form-item",{attrs:{label:"渠道展示","wrapper-col":{span:10},disabled:"true"}},[e("a-row",[e("a-col",{attrs:{span:24}},[e("a-radio-group",{attrs:{disabled:""},model:{value:a.formData.type,callback:function(t){a.$set(a.formData,"type",t)},expression:"formData.type"}},[e("a-radio",{attrs:{value:0}},[a._v(" 全部 ")]),e("a-radio",{attrs:{value:1}},[a._v(" 仅手机系统推送 ")]),e("a-radio",{attrs:{value:2}},[a._v(" 仅消息中心推送 ")])],1)],1)],1)],1),e("a-form-item",{attrs:{label:"推送人群",disabled:"true"}},[e("a-row",[e("a-col",{attrs:{span:24}},[e("a-radio-group",{attrs:{disabled:""},model:{value:a.formData.users,callback:function(t){a.$set(a.formData,"users",t)},expression:"formData.users"}},[e("a-radio",{attrs:{value:0}},[a._v(" 全部 ")]),e("a-radio",{attrs:{value:1}},[a._v(" 指定人群 ")])],1)],1)],1),a.formData.users?[e("a-row",[e("a-col",{attrs:{span:24}},[e("a-col",{attrs:{span:3}},[e("a-checkbox",{attrs:{checked:a.formData.user.area_sel,disabled:""},on:{change:a.onChange}})],1),e("a-col",{attrs:{span:5}},[a._v("地区:")]),e("a-col",{attrs:{span:16}},[e("a-cascader",{attrs:{options:a.options,placeholder:"选择",value:a.formData.user.sel_areas,disabled:""},on:{change:a.onChangeArea}})],1)],1)],1),e("a-row",[e("a-col",{attrs:{span:24}},[e("a-col",{attrs:{span:3}},[e("a-checkbox",{attrs:{checked:a.formData.user.level_sel,disabled:""},on:{change:a.onChange1}})],1),e("a-col",{attrs:{span:5}},[a._v("用户等级:")]),e("a-col",{attrs:{span:16}},[e("a-select",{attrs:{disabled:""},model:{value:a.formData.user.level,callback:function(t){a.$set(a.formData.user,"level",t)},expression:"formData.user.level"}},a._l(a.level_sel,(function(t,s){return e("a-select-option",{key:s,attrs:{value:t.id}},[a._v(" "+a._s(t.lname)+" ")])})),1)],1)],1)],1),e("a-row",[e("a-col",{attrs:{span:24}},[e("a-col",{attrs:{span:3}},[e("a-checkbox",{attrs:{checked:a.formData.user.label_sel,disabled:""},on:{change:a.onChange2}})],1),e("a-col",{attrs:{span:5}},[a._v("用户标签:")]),e("a-col",{attrs:{span:16}},[e("a-select",{staticStyle:{width:"100%"},attrs:{mode:"multiple",placeholder:"请选择店铺分类",value:a.formData.user.label,disabled:""},on:{change:a.handleChange}},a._l(a.label_sel,(function(t){return e("a-select-option",{key:t,attrs:{value:t.id}},[a._v(" "+a._s(t.name)+" ")])})),1)],1)],1)],1)]:a._e()],2),e("a-form-item",{attrs:{label:"推送端口","wrapper-col":{span:17}}},[e("a-row",[e("a-col",{attrs:{span:24}},[e("a-radio-group",{attrs:{disabled:""},model:{value:a.formData.send_port,callback:function(t){a.$set(a.formData,"send_port",t)},expression:"formData.send_port"}},[e("a-radio",{attrs:{value:0}},[a._v(" 全部 ")]),e("a-radio",{attrs:{value:1}},[a._v(" 小程序 ")]),e("a-radio",{attrs:{value:2}},[a._v(" App ")])],1)],1)],1)],1),e("a-form-item",{attrs:{label:"定时推送","wrapper-col":{span:16}}},[e("a-row",[e("a-col",{staticClass:"text-center",attrs:{span:1}},[e("a-checkbox",{attrs:{checked:a.is_set_send_time,disabled:""},on:{change:a.onChange3},model:{value:a.is_set_send_time,callback:function(t){a.is_set_send_time=t},expression:"is_set_send_time"}})],1),e("a-col",{staticClass:"text-left",attrs:{span:2}},[a._v(" 选择推送时间 ")]),a.is_set_send_time?[e("a-col",{attrs:{span:4}},[e("a-date-picker",{attrs:{format:"YYYY-MM-DD","disabled-date":a.disabledStartDate,placeholder:"请选择日期","default-value":a.moment(a.formData.set_send_time_date,"YYYY-MM-DD"),getCalendarContainer:function(a){return a.parentNode},disabled:""},on:{change:a.onDateStartChange}})],1),e("a-col",{attrs:{span:4}},[e("a-time-picker",{attrs:{format:"HH:mm","default-value":a.moment(a.formData.set_send_time_min,"HH:mm"),placeholder:"选择时间",disabled:""},on:{change:a.onChangeTime}})],1)]:a._e(),e("a-col",{staticClass:"font-color",attrs:{span:24}},[a._v("勾选后可设置预约推送时间;否则点击发布按钮立即发布成功")])],2)],1),e("a-row",[e("a-col",{staticClass:"label-font-size text-right",attrs:{span:2}},[a._v(" 内容信息 ")])],1),e("br"),e("a-form-item",{attrs:{label:"主标题:","wrapper-col":{span:7}}},[e("a-row",[e("a-col",{attrs:{span:18}},[e("a-input",{attrs:{placeholder:"请输入消息标题",disabled:""},model:{value:a.formData.title,callback:function(t){a.$set(a.formData,"title",t)},expression:"formData.title"}})],1),e("a-col",{staticClass:"text-left font-color",attrs:{span:4}},[a._v(" 1-15个字符 ")])],1)],1),e("a-form-item",{attrs:{label:"描述","wrapper-col":{span:7},disabled:"true"}},[e("a-row",[e("a-col",{attrs:{span:18}},[e("a-input",{attrs:{placeholder:"请输入消息描述",disabled:""},model:{value:a.formData.desc,callback:function(t){a.$set(a.formData,"desc",t)},expression:"formData.desc"}})],1),e("a-col",{staticClass:"text-left font-color",attrs:{span:4}},[a._v(" 1-50个字符 ")])],1)],1),a.formData.img?e("a-form-item",{attrs:{label:"标题图片"}},[e("a-row",[e("a-input",{attrs:{hidden:""},model:{value:a.formData.img,callback:function(t){a.$set(a.formData,"img",t)},expression:"formData.img"}}),[e("div",{staticClass:"clearfix"},[e("a-upload",{attrs:{disabled:"","list-type":"picture-card","file-list":a.fileList1},on:{preview:a.handlePreview1}}),e("a-modal",{attrs:{visible:a.previewVisible1,footer:null},on:{cancel:a.handleCancel1}},[e("img",{staticStyle:{width:"100%"},attrs:{alt:"example",src:a.previewImage}})])],1)]],2)],1):a._e(),e("a-form-item",{attrs:{label:"信息链接类型:",disabled:"true"}},[e("a-row",[e("a-col",{attrs:{span:24}},[e("a-radio-group",{attrs:{disabled:""},model:{value:a.formData.content_type,callback:function(t){a.$set(a.formData,"content_type",t)},expression:"formData.content_type"}},[e("a-radio",{attrs:{value:0}},[a._v(" 富文本 ")]),e("a-radio",{attrs:{value:1}},[a._v(" 自定义链接 ")])],1)],1)],1)],1),a.formData.content_type?[e("a-form-item",{attrs:{label:"自定义链接","wrapper-col":{span:8}}},[e("a-row",[e("a-col",{attrs:{span:10}},[e("div",{staticClass:"flex"},[e("a-input",{staticStyle:{"max-height":"100px","overflow-y":"auto",resize:"none"},attrs:{placeholder:a.L("功能库选择"),autoSize:"",disabled:""},model:{value:a.formData.content,callback:function(t){a.$set(a.formData,"content",t)},expression:"formData.content"}})],1)]),e("a-col",{attrs:{span:5}})],1)],1)]:[e("a-form-item",{attrs:{label:"富文本","wrapper-col":{span:20}}},[e("a-row",[e("a-col",{attrs:{span:13}},[e("div",{staticClass:"flex"},[e("rich-text",{attrs:{info:a.formData.content,disabled:""},on:{"update:info":function(t){return a.$set(a.formData,"content",t)}}})],1)])],1)],1)]],2)],1)],1)],1)],1)},r=[],o=e("1da1"),n=(e("96cf"),e("d3b7"),e("a9e3"),e("b0c0"),e("a434"),e("290c")),i=e("da05"),l=e("de0b"),c=e("c1df"),d=e.n(c),u=e("2d3d"),m=e("6ec1");function f(a){return new Promise((function(t,e){var s=new FileReader;s.readAsDataURL(a),s.onload=function(){return t(s.result)},s.onerror=function(a){return e(a)}}))}var p={name:"MailEdit",components:{TemplateEdit:u["default"],ACol:i["b"],ARow:n["a"],RichText:m["a"]},props:{mail_id:{type:[String,Number],default:"0"},upload_dir:{type:String,default:""}},data:function(){return{mall:"1-2",maidan:"1-3",group:"1-4",foodshop:"1-5",visible_staff:!0,open2:!1,cat_sel:[],options:[],level_sel:[],label_sel:[],fileList1:[],is_set_send_time:!1,previewVisible1:!1,set_send_time_min:"00:00:00",previewImage:"",action:"/v20/public/index.php/common/common.UploadFile/uploadPictures",uploadName:"reply_pic",queryParam:{id:this.mail_id},formData:{category_type:"",category_id:0,type:0,users:0,send_port:0,set_send_time_date:0,set_send_time_min:"00:00:00",title:"",desc:"",img:"",content_type:0,content:"",user:{area_sel:!1,sel_areas:[],level_sel:!1,level:"",label_sel:!1,label:[]}}}},activated:function(){this.queryParam.id=this.mail_id,this.getLists()},created:function(){this.queryParam.id=this.mail_id,this.getLists()},methods:{moment:d.a,handleChange:function(a){this.formData.user.label=a},onChangeArea:function(a){this.formData.province_id=a[0],this.formData.city_id=a[1],this.formData.user.sel_areas=[a[0],a[1]]},onChange:function(a){this.formData.user.area_sel=a.target.checked},onChange1:function(a){this.formData.user.level_sel=a.target.checked},onChange2:function(a){this.formData.user.label_sel=a.target.checked},onChange3:function(a){this.is_set_send_time=a.target.checked},getLists:function(){var a=this;this.request(l["a"].mailEdit,this.queryParam).then((function(t){if(a.fileList1=[],t.list.img){var e={uid:"logo",name:"logo_1",status:"done",url:t.list.img};a.fileList1.push(e)}a.$set(a,"formData",t.list),a.formData=t.list,t.list.set_send_time>0&&(a.is_set_send_time=!0),a.formData.user=t.list.users_label,a.cat_sel=t.cat_sel,a.options=t.options,a.level_sel=t.level_sel,a.label_sel=t.label_sel}))},disabledStartDate:function(a){},onDateStartChange:function(a,t){this.$set(this.formData,"set_send_time_date",t)},handleClose:function(){this.open2=!1},handlePreview1:function(a){var t=this;return Object(o["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(a.url||a.preview){e.next=4;break}return e.next=3,f(a.originFileObj);case 3:a.preview=e.sent;case 4:t.previewImage=a.url||a.preview,t.previewVisible1=!0;case 6:case"end":return e.stop()}}),e)})))()},handleChange1:function(a){var t=a.fileList;if(t.length>0){var e=t.length-1;this.fileList1=t,"done"==this.fileList1[e].status&&(this.formData.img=this.fileList1[e].response.data,this.fileList1[0].uid="logo_2",this.fileList1[0].name="logo_2",this.fileList1[0].status="done",this.fileList1[0].url=this.fileList1[e].response.data,t.length>1&&this.fileList1.splice(0,e))}},handleCancel1:function(){this.previewVisible1=!1},getLinkUrl:function(){var a=this;this.$LinkBases({source:"platform",type:"h5",source_id:"",handleOkBtn:function(t){console.log("handleOk",t),a.$nextTick((function(){a.$set(a.formData,"content",t.url)}))}})},returnBack:function(){this.$emit("getShow",{})},handleSubmit:function(){var a=this;this.request(l["a"].addData,this.formData).then((function(t){a.$message.success("新增成功"),a.$emit("getShow",{})}))},onChangeTime:function(a,t){this.formData.set_send_time_min=t,this.$set(this.formData,"set_send_time_min",t)}}},_=p,h=(e("de87"),e("2877")),v=Object(h["a"])(_,s,r,!1,null,"5f838a0e",null);t["default"]=v.exports},de0b:function(a,t,e){"use strict";var s={mailList:"/common/platform.user.Mail/mailList",mailEdit:"/common/platform.user.Mail/editMail",delData:"/common/platform.user.Mail/delData",addData:"/common/platform.user.Mail/addData"};t["a"]=s},de87:function(a,t,e){"use strict";e("16a3")}}]);