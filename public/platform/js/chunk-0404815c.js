(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-0404815c"],{"2f26":function(t,e,a){"use strict";a("7271")},5120:function(t,e,a){"use strict";a.r(e);var i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("a-drawer",{attrs:{title:"编辑",width:1400,visible:t.visible,maskClosable:!1,placement:"right"},on:{close:t.handleCancel}},[0==t.currentIndex?a("div",{staticStyle:{"margin-bottom":"20px"}},[a("a-button",{staticStyle:{"margin-right":"30px"},attrs:{type:"primary"},on:{click:function(e){return t.changeXTab(0)}}},[t._v("基本设置")]),a("a-button",{staticStyle:{"margin-right":"30px"},attrs:{type:"default"},on:{click:function(e){return t.changeXTab(1)}}},[t._v("权限设置")])],1):a("div",{staticStyle:{"margin-bottom":"20px"}},[a("a-button",{staticStyle:{"margin-right":"30px"},attrs:{type:"default"},on:{click:function(e){return t.changeXTab(0)}}},[t._v("基本设置")]),a("a-button",{staticStyle:{"margin-right":"30px"},attrs:{type:"primary"},on:{click:function(e){return t.changeXTab(1)}}},[t._v("权限设置")])],1),0==t.currentIndex?a("a-card",[a("a-row",[a("a-col",{attrs:{span:12}},[a("a-form",{attrs:{form:t.form}},[a("a-form-item",{attrs:{label:"登录账号",labelCol:t.labelCol,required:!0}},[a("a-col",{attrs:{span:18}},[a("a-input",{staticStyle:{width:"300px"},attrs:{placeholder:"请输入登录账号",autocomplete:"off",name:"account",disabled:t.accountAisabled},model:{value:t.post.account,callback:function(e){t.$set(t.post,"account",e)},expression:"post.account"}})],1)],1),a("a-form-item",{attrs:{label:"登录密码",labelCol:t.labelCol,required:!0}},[a("a-col",{attrs:{span:18}},[a("a-input-password",{staticStyle:{width:"300px"},attrs:{placeholder:1==t.worker.set_pwd?" 如果不需修改密码则不填写":"请填写登录密码",name:"password",autocomplete:"new-password"},model:{value:t.post.password,callback:function(e){t.$set(t.post,"password",e)},expression:"post.password"}})],1),a("a-col",{attrs:{span:6}})],1),a("a-form-item",{attrs:{label:"姓名",labelCol:t.labelCol,required:!0}},[a("a-col",{attrs:{span:18}},[a("a-input",{staticStyle:{width:"300px"},attrs:{placeholder:"请输入姓名",autocomplete:"off",name:"lxname"},on:{blur:t.validateInput},model:{value:t.post.name,callback:function(e){t.$set(t.post,"name",e)},expression:"post.name"}})],1),a("a-col",{attrs:{span:6}})],1),a("a-form-item",{attrs:{label:"手机号",labelCol:t.labelCol,required:!0}},[a("a-col",{attrs:{span:18}},[a("a-input",{staticStyle:{width:"300px"},attrs:{placeholder:"请输入手机号",autocomplete:"off",name:"phone","max-length":11},on:{blur:t.validateInput},model:{value:t.post.phone,callback:function(e){t.$set(t.post,"phone",e)},expression:"post.phone"}})],1),a("a-col",{attrs:{span:6}})],1),a("a-form-item",{attrs:{label:"备注信息",labelCol:t.labelCol}},[a("a-col",{attrs:{span:20}},[a("a-textarea",{ref:"textareax",staticStyle:{width:"300px","overflow-y":"scroll",resize:"none"},attrs:{rows:8,placeholder:"请输入备注信息",name:"remarks"},model:{value:t.post.remarks,callback:function(e){t.$set(t.post,"remarks",e)},expression:"post.remarks"}})],1),a("a-col",{attrs:{span:6}})],1)],1)],1),a("a-col",{attrs:{span:12}},[a("a-form",{attrs:{form:t.form,"label-col":{span:5},"wrapper-col":{span:12}}},[a("a-form-item",{attrs:{label:"身份证号"}},[a("a-input",{attrs:{readonly:"readonly",disabled:"disabled"},model:{value:t.post.id_card,callback:function(e){t.$set(t.post,"id_card",e)},expression:"post.id_card"}})],1),a("a-form-item",{attrs:{label:"IC卡号"}},[a("a-input",{attrs:{readonly:"readonly",disabled:"disabled"},model:{value:t.post.ic_card,callback:function(e){t.$set(t.post,"ic_card",e)},expression:"post.ic_card"}})],1),t.is_openid?a("div",[a("a-form-item",{attrs:{label:"微信昵称"}},[a("a-input",{attrs:{readonly:"readonly",disabled:"disabled"},model:{value:t.post.nickname,callback:function(e){t.$set(t.post,"nickname",e)},expression:"post.nickname"}})],1),t.is_avatar?a("a-form-item",{attrs:{label:"微信头像"}},[a("img",{attrs:{src:t.is_avatar,width:"80px"}})]):t._e()],1):a("a-form-item",{attrs:{label:"绑定微信"}},[a("a-tag",{staticStyle:{padding:"5px",cursor:"pointer"},attrs:{color:"#1890FF"},on:{click:function(e){return t.getRecognition(t.wid)}}},[t._v(" 点击绑定微信")])],1),a("a-form-item",{attrs:{label:"入职时间"}},[a("a-input",{attrs:{readonly:"readonly",disabled:"disabled"},model:{value:t.post.create_time_str,callback:function(e){t.$set(t.post,"create_time_str",e)},expression:"post.create_time_str"}})],1),a("a-form-item",{attrs:{label:"处理次数"}},[a("a-input",{attrs:{readonly:"readonly",disabled:"disabled"},model:{value:t.post.num,callback:function(e){t.$set(t.post,"num",e)},expression:"post.num"}})],1),a("a-form-item",{attrs:{label:"被评论数"}},[a("a-input",{attrs:{readonly:"readonly",disabled:"disabled"},model:{value:t.post.reply_count,callback:function(e){t.$set(t.post,"reply_count",e)},expression:"post.reply_count"}})],1),a("a-form-item",{attrs:{label:"评分"}},[a("a-input",{attrs:{readonly:"readonly",disabled:"disabled"},model:{value:t.post.score_mean,callback:function(e){t.$set(t.post,"score_mean",e)},expression:"post.score_mean"}})],1),a("a-form-item",{attrs:{label:"职务类型"}},[a("a-input",{attrs:{readonly:"readonly",disabled:"disabled"},model:{value:t.post.type_name,callback:function(e){t.$set(t.post,"type_name",e)},expression:"post.type_name"}})],1)],1)],1)],1)],1):t._e(),1==t.currentIndex?a("a-card",[a("div",{staticClass:"all_menus",attrs:{id:"components_layout_menus"}},[a("a-layout",{staticStyle:{"line-height":"40px"}},[a("a-layout-sider",{staticStyle:{width:"150px",flex:"0 0 150px","max-width":"150px","min-width":"150px"}},[t._v("权限分组")]),a("a-layout-content",[a("a-select",{staticStyle:{width:"300px","margin-top":"5px"},attrs:{placeholder:"权限分组选择","default-value":"0"},on:{change:t.handleSelectChange},model:{value:t.group_id,callback:function(e){t.group_id=e},expression:"group_id"}},[a("a-select-option",{attrs:{value:0}},[t._v("不选择分组")]),t._l(t.group_list,(function(e,i){return a("a-select-option",{key:i,attrs:{value:e.group_id}},[t._v(" "+t._s(e.name)+" ")])}))],2)],1)],1),t.group_id<=0?a("div",[a("a-layout",{staticStyle:{"line-height":"40px","font-size":"25px"}},[a("a-layout-content",[a("a-checkbox",{staticStyle:{"font-size":"18px","pfont-weight":"bold","padding-left":"2px"},attrs:{value:"0",checked:t.all_checked},on:{change:t.checkAll}},[t._v(" 全选 ")])],1)],1),t._l(t.menus,(function(e,i){return a("a-layout",{staticStyle:{"line-height":"40px"}},[a("a-layout-sider",[a("a-checkbox",{ref:e.ckey,refInFor:!0,staticStyle:{"font-size":"18px","pfont-weight":"bold","padding-left":"2px"},attrs:{value:e.id,checked:t.getCval(e.ckey)},on:{change:t.check2All}},[t._v(" "+t._s(e.name)+" ")])],1),a("a-layout",t._l(e.child,(function(i,s){return a("a-layout-content",[a("div",{staticClass:"sub1div"},[a("a-checkbox",{ref:i.ckey,refInFor:!0,attrs:{checked:t.getCval(i.ckey),value:i.id,id:"item0id_"+e.id},on:{change:t.check3All}},[t._v(" "+t._s(i.name)+" ")])],1),t._l(i.child,(function(s,r){return i.child&&i.child.length>0?a("div",{staticClass:"sub2div"},[a("div",{staticClass:"sub2div_1div"},[a("a-checkbox",{ref:s.ckey,refInFor:!0,attrs:{value:s.id,checked:t.getCval(s.ckey),id:"item0id_"+e.id+"-item1id_"+i.id},on:{change:t.check4All}},[t._v(" "+t._s(s.name)+" ")])],1),s.child&&s.child.length>0?a("div",{staticClass:"sub2div_2div",staticStyle:{width:"100%"}},[a("a-row",{staticStyle:{width:"100%",display:"flex","flex-wrap":"wrap"}},t._l(s.child,(function(r,n){return a("a-col",{staticStyle:{width:"33.3%","flex-shrink":"0","margin-bottom":"5px"}},[a("a-checkbox",{ref:r.ckey,refInFor:!0,attrs:{value:r.id,checked:t.getCval(r.ckey),id:"item0id_"+e.id+"-item1id_"+i.id+"-item2id_"+s.id},on:{change:t.onGroupChange}},[t._v(" "+t._s(r.name)+" ")])],1)})),1)],1):t._e()]):t._e()}))],2)})),1)],1)}))],2):t._e()],1)]):t._e(),a("a-card",{staticStyle:{"text-align":"center"},attrs:{bordered:!1}},[a("a-button",{staticStyle:{"margin-top":"20px","margin-right":"15px"},attrs:{type:"primary",loading:t.loading},on:{click:function(e){return t.handleSubmit()}}},[t._v("保存设置")]),a("a-button",{on:{click:function(e){return t.onClose()}}},[t._v(" 关闭当前页 ")])],1),a("a-modal",{attrs:{width:500,title:"扫描二维码绑定微信号",visible:t.visible_img,maskClosable:!1,"confirm-loading":t.confirmLoading},on:{ok:t.handleImgCancel,cancel:t.handleImgCancel}},[a("div",{staticClass:"modal_box"},[a("div",{staticClass:"flex_text_box margin_top_10"},[t.srcUrl?a("img",{attrs:{src:t.srcUrl}}):t._e(),t.img_errmsg?a("p",[t._v(t._s(t.img_errmsg))]):t._e()])])])],1)},s=[],r=(a("7d24"),a("dfae")),n=(a("b0c0"),a("d81d"),a("a15b"),a("ac1f"),a("498a"),a("841c"),a("a0e0")),o=a("c1df"),c=a.n(o),l=null,d=[],u=[],h={name:"houseWorkerEdit",filters:{},components:{"a-collapse":r["a"],"a-collapse-panel":r["a"].Panel},data:function(){return{labelCol:{xs:{span:10},sm:{span:3}},search:{keyword:"",key_val:"name",key_val1:"paytime",page:1},form:this.$form.createForm(this),visible:!1,loading:!1,data:u,columns:d,wid:0,worker:{},currentIndex:0,dateFormat:"YYYY-MM-DD HH:mm:ss",is_set_pwd:0,accountAisabled:!1,is_edit_worker:!0,menus:[],group_list:[],post:{account:"",password:"",name:"",phone:"",remarks:"",nickname:"",create_time_str:"",num:0,reply_count:0,score_mean:0,type_name:"",ic_card:"暂无",id_card:"暂无"},role:{},all_checked:!1,mckeyArr:[],group_id:0,srcUrl:"",img_errmsg:"",visible_img:!1,confirmLoading:!1,is_openid:!1,is_avatar:""}},activated:function(){},methods:{onClose:function(){this.visible=!1},moment:c.a,editAccount:function(t){console.log("record",t),""!=t.openid?this.is_openid=!0:this.is_openid=!1,this.is_avatar=t.avatar,this.visible=!0,this.wid=t.wid,this.worker=t,this.post.account=t.account,this.post.name=t.name,this.post.phone=t.phone,this.is_set_pwd=1*t.set_pwd,this.post.remarks=t.remarks?t.remarks:"",this.post.nickname=t.nickname,this.post.create_time_str=t.create_time_str,this.post.num=t.num,this.post.reply_count=t.reply_count,this.post.score_mean=t.score_mean,this.post.type_name=t.type_name,this.post.id_card=t.id_card,this.post.ic_card=t.ic_card,this.group_id=1*t.group_id,this.mckeyArr=[],this.menus=[],this.all_checked=!1,this.currentIndex=0,t.account&&t.account.length>0?this.accountAisabled=!0:this.accountAisabled=!1,this.is_edit_worker=!0},handleSelectChange:function(t,e){this.group_id=0!=t&&"0"!=t&&t?1*t:0},onGroupChange:function(t){this.group_id=0;var e=t.target.id,a=this.handleIdd(e),i=t.target.checked,s=(t.target.defaultChecked,t.target.value);i?this.setCval(a,!0,3,s):(this.setCval(a,!1,3,s),this.all_checked=!1)},handleIdd:function(t){for(var e=t.split("-"),a=[],i=0;i<e.length;i++){var s=e[i].split("_");a.push({item_id:s["0"],item_id_v:s["1"]})}return a},checkAll:function(t){this.group_id=0;var e=t.target.checked;t.target.defaultChecked,t.target.value;e?(this.all_checked=!0,this.mckeyArr.map((function(t,e){t.cv=!0}))):(this.all_checked=!1,this.mckeyArr.map((function(t,e){t.cv=!1})))},check2All:function(t){this.group_id=0;var e=t.target.checked,a=(t.target.defaultChecked,t.target.value);e?this.setCval(null,!0,0,a):(this.setCval(null,!1,0,a),this.all_checked=!1)},check3All:function(t){this.group_id=0;var e=t.target.id,a=this.handleIdd(e),i=t.target.checked,s=(t.target.defaultChecked,t.target.value);i?this.setCval(a,!0,1,s):(this.setCval(a,!1,1,s),this.all_checked=!1)},check4All:function(t){this.group_id=0;var e=t.target.id,a=this.handleIdd(e),i=t.target.checked,s=(t.target.defaultChecked,t.target.value);i?this.setCval(a,!0,2,s):(this.setCval(a,!1,2,s),this.all_checked=!1)},handleSubmit:function(){var t=this;if(1==this.currentIndex){var e={xtype:1};if(e.wid=this.wid,e.group_id=this.group_id,e.menus="",this.group_id>0)this.group_list.map((function(a,i){a.group_id==t.group_id&&(e.menus=a.group_menus)}));else{var a=[];this.mckeyArr.map((function(t,e){t.cv&&a.push(t.id)})),a.length>0&&(e.menus=a.join(","))}this.loading=!0,this.request(n["a"].saveWorkerEdit,e).then((function(e){t.loading=!1,t.$message.success("保存成功!"),setTimeout((function(){t.form=t.$form.createForm(t),t.visible=!1,t.is_edit_worker=!1,t.record={},t.wid=0,t.menus=[],t.$emit("ok")}),1500)})).catch((function(e){t.loading=!1}))}else{if(!this.post.account||this.post.account.length<1)return this.$message.error("请输入登录账号!"),!1;if(0==this.is_set_pwd&&(!this.post.password||this.post.account.password<1))return this.$message.error("请输入登录密码!"),!1;if(!this.post.phone||this.post.phone.length<1)return this.$message.error("请输入手机号!"),!1;var i=/^1[23456789]\d{9}$/;if(!i.test(this.post.phone))return this.$message.error("手机号格式不正确！"),!1;if(!this.post.name||this.post.name.length<1)return this.$message.error("请输入姓名!"),!1;this.post.wid=this.wid,this.post.xtype=0,this.loading=!0,this.request(n["a"].saveWorkerEdit,this.post).then((function(e){t.loading=!1,e.is_haved_account&&1==e.is_haved_account?(t.accountAisabled=!1,t.$message.error("此账号【"+t.post.account+"】已经存在了，请修改！")):e.is_haved_phone&&1==e.is_haved_phone?t.$message.error("此手机号【"+t.post.phone+"】已经存在了，请修改！"):(t.$message.success("保存成功!"),setTimeout((function(){t.form=t.$form.createForm(t),t.visible=!1,t.is_edit_worker=!1,t.record={},t.wid=0,t.menus=[],t.post={account:"",password:"",name:"",phone:"",remarks:""},t.$emit("ok")}),1500))})).catch((function(e){t.loading=!1}))}},validateInput:function(t){var e=t.target.value,a=t.target.name;if(console.log("name",a),console.log("value",e),e=e.trim(),!this.is_edit_worker)return!1;if(0!=this.currentIndex)return!1;if("account"==a){if(!e||e.length<1)return t.target.focus(),!1;var i=/^[A-Za-z0-9_]+$/;if(!this.accountAisabled&&!i.test(e))return this.$message.error("登录账号必须是英文大小写字母、数字、下划线组成"),t.target.focus(),!1;if(!this.accountAisabled&&e.length<3)return this.$message.error("请保持登录账号长度至少3位以上!"),t.target.focus(),!1;if(!this.accountAisabled&&e.length>90)return this.$message.error("登录账号长度太长了，请小于90个字符！"),t.target.focus(),!1;this.post.account=e}else if("password"==a){if(0==this.is_set_pwd&&(!e||e.length<1))return t.target.focus(),!1;var s=/^[A-Za-z0-9_]+$/;if(e.length>0&&!s.test(e))return this.$message.error("登录密码必须是英文大小写字母、数字、下划线组成"),t.target.focus(),!1;if(e.length>0&&e.length<3)return this.$message.error("请保持登录密码长度至少3位以上!"),t.target.focus(),!1;if(e.length>0&&e.length>32)return this.$message.error("登录密码长度太长了，请小于32个字符！"),t.target.focus(),!1;e&&(this.post.password=e)}else if("lxname"==a){if(!e||e.length<1)return t.target.focus(),!1;if(e.length>10)return this.$message.error("您输入的姓名长度太长了，请小于10个字符！"),t.target.focus(),!1;this.post.name=e}else if("phone"==a){if(!e||e.length<1)return t.target.focus(),!1;var r=/^1[23456789]\d{9}$/;if(!r.test(e))return this.$message.error("请输入正确的手机号格式！"),t.target.focus(),!1;this.post.phone=e}},getRolePermissionMenus:function(){var t=this,e={wid:this.wid};this.request(n["a"].getRolePermissionMenus,e).then((function(e){t.mckeyArr=e.mckeyArr,t.menus=e.menus,t.group_list=e.group_list}))},getCval:function(t){var e=!1;return this.mckeyArr.map((function(a,i){t==a.ckey&&(e=a.cv)})),e},setCval:function(t,e,a,i){var s=this;if(a>=0){var r=a,n="key_"+r+"_"+i,o="",c=-1;this.mckeyArr.map((function(t,a){n==t.ckey&&(t,t.cv=e,void 0!=t.ckey2?(o=t.ckey2,c=2):void 0!=t.ckey1?(o=t.ckey1,c=1):void 0!=t.ckey0&&(o=t.ckey0,c=0)),n==t.ckey2&&(t.cv=e),n==t.ckey1&&(t.cv=e),n==t.ckey0&&(t.cv=e)}));var l=!0;if((!t||null===t||t.length<1)&&(l=!1),a>0&&!e&&this.mckeyArr.map((function(t,e){(2==c&&o==t.ckey2&&t.cv||1==c&&o==t.ckey1&&t.cv||0==c&&o==t.ckey0&&t.cv)&&(l=!1)})),l&&a>0){a-=1;for(var d=function(){var a="item"+u+"id",i=0;t.map((function(t,e){t.item_id==a&&(i=t.item_id_v)}));var r="key_"+u+"_"+i;if(e)s.mckeyArr.map((function(t,a){r==t.ckey&&(t.cv=e)}));else if(0==u){var n=!1;s.mckeyArr.map((function(t,e){r==t.ckey0&&t.cv&&(console.log("tmp_ckey0",t),n=!0)})),n||s.mckeyArr.map((function(t,a){r==t.ckey&&(t.cv=e)}))}else if(1==u){var o=!1;s.mckeyArr.map((function(t,e){r==t.ckey1&&t.cv&&(console.log("tmp_ckey1",t),o=!0)})),o||s.mckeyArr.map((function(t,a){r==t.ckey&&(t.cv=e)}))}else if(2==u){var c=!1;s.mckeyArr.map((function(t,e){r==t.ckey2&&t.cv&&(c=!0)})),c||s.mckeyArr.map((function(t,a){r==t.ckey&&(t.cv=e)}))}},u=a;u>=0;u--)d()}}},changeXTab:function(t){this.currentIndex=t,0==this.currentIndex||this.menus.length<1&&this.getRolePermissionMenus()},handleCancel:function(){var t=this;this.is_edit_worker=!1,this.visible=!1,this.record={},this.wid=0,this.menus=[],this.currentIndex=0,this.post={account:"",password:"",name:"",phone:"",remarks:""},setTimeout((function(){t.form=t.$form.createForm(t)}),500)},date_moment:function(t,e){return t?c()(t,e):""},table_change:function(t){t.current&&t.current>0&&(this.pagination.current=t.current,this.page=t.current)},dateOnChange:function(t,e){this.search.date=e,this.search.begin_time=e["0"],this.search.end_time=e["1"]},handleImgCancel:function(){this.visible_img=!1,this.srcUrl="",clearInterval(l),this.$emit("ok")},getRecognition:function(t){var e=this,a=t+39e8;this.request(n["a"].getRecognition,{qrcode_id:a}).then((function(a){e.visible_img=!0,a.ticket?(e.srcUrl=a.ticket,e.img_errmsg=""):(e.srcUrl="",e.img_errmsg=a.msg),l=setInterval((function(){e.checkWorkOpenid(t)}),1500)}))},checkWorkOpenid:function(t){var e=this;this.request(n["a"].checkWorker0629,{wid:t}).then((function(t){1==t.status&&(e.post.nickname=t.nickname,e.is_avatar=t.avatar,e.is_openid=!0,e.handleImgCancel())}))}}},p=h,m=(a("2f26"),a("0c7c")),f=Object(m["a"])(p,i,s,!1,null,"20b9d5ee",null);e["default"]=f.exports},7271:function(t,e,a){}}]);