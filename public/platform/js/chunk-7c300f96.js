(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-7c300f96"],{"241dd":function(e,t,i){"use strict";i("7993")},7993:function(e,t,i){},a194:function(e,t,i){"use strict";i.r(t);i("54f8");var o=function(){var e=this,t=e._self._c;return t("div",{staticClass:"video_preview"},[e.fullScreen?t("div",{staticClass:"left_menu"},[t("div",{staticClass:"search_con"},[t("a-input",{attrs:{placeholder:"请输入搜索内容"},model:{value:e.searchVal,callback:function(t){e.searchVal=t},expression:"searchVal"}}),t("a-button",{attrs:{icon:"search"},on:{click:e.searchThis}})],1),e._l(e.menuList,(function(i,o){return t("div",{key:o,staticClass:"menu_list",class:e.currentChoose==o?"active":"",on:{click:function(t){return e.chooseVideo(i,o)}}},[e._v(" "+e._s(i.camera_name)+" ")])}))],2):e._e(),t("div",{staticClass:"right_container",style:{width:e.fullScreen?"88vw":"100vw"}},[t("div",{staticClass:"top_tab"},[t("div",{staticClass:"left_view"},[e._l(e.tabList,(function(i,o){return t("div",{key:o,staticClass:"tab_list",class:e.currentIndex==o?"active":"",on:{click:function(t){return e.changeScreen(o)}}},[e._v(e._s(i.name))])})),t("div",{key:99999,staticClass:"tab_list",staticStyle:{"margin-left":"10px"},on:{click:function(t){return e.openScreen()}}},[e._v(" "+e._s(e.fullScreen?"全屏":"取消全屏")+" ")])],2)]),e.reloadVideo?t("div",{staticClass:"bottom_container"},e._l(e.videoList,(function(i,o){return t("div",{key:o,staticClass:"video_list",style:e.styleList[e.currentIndex]},[t("div",{staticClass:"video_msg",staticStyle:{position:"absolute",top:"0",left:"0",color:"#fff","z-index":"999"}},[e._v(" 【设备名】："+e._s(i.camera_name)+"， 【设备状态】："+e._s(i.camera_status_txt)+" ")]),"flv"==i.lookUrlType&&e.reloadVideo?t("video",{staticClass:"videoPlayer",staticStyle:{width:"100%",height:"100%"},attrs:{id:"myVideo"+o,controls:"",autoplay:!0},domProps:{muted:!1}}):"hls"==i.lookUrlType&&e.reloadVideo?t("hlsVideo",{staticStyle:{width:"100%",height:"100%"},attrs:{videoType:i.lookUrlType,videoUrl:i.look_url,videoIndex:o}}):t("div",{staticClass:"no_video",staticStyle:{width:"100%",height:"100%","background-color":"#fff"}})],1)})),0):e._e()])])},n=[],s=(i("075f"),i("4afa"),i("33aa")),a=i.n(s),l=i("d4a4"),c={components:{hlsVideo:l["default"]},data:function(){return{tabList:[{name:"单屏幕",type:1},{name:"四分屏",type:2},{name:"九分屏",type:3},{name:"十六分屏",type:4}],currentIndex:0,videoList:[],styleList:[{width:"100%",height:"100%"},{width:"50%",height:"50%"},{width:"33.3%",height:"33.3%"},{width:"25%",height:"25%"}],videoSrc:"https://flvopen.ys7.com:9188/openlive/daac42b18e4b4bd1826e52d50f84add5.flv",flvPlayer:null,fullScreen:!0,options:{autoplay:!0,muted:!0,preload:"auto",controls:!0},player:null,videoId:"",pageInfo:{page:1,limit:1},totalCount:0,reloadVideo:!0,menuList:[],currentChoose:-1,searchVal:"",frequency:!1}},mounted:function(){this.getLeftMenuList()},beforeDestroy:function(){this.videoSrc&&this.destoryVideo()},methods:{searchThis:function(){var e=this;if(e.frequency)e.$message.warn("请求频繁，请稍后再试");else{e.frequency=!0;var t=setTimeout((function(){e.frequency=!1,clearTimeout(t)}),2e3);e.getLeftMenuList()}},chooseVideo:function(e,t){var i=this;if(t!=i.currentChoose){var o=!1;if(i.videoList.map((function(t,i){e.camera_id==t.camera_id&&(o=!0)})),o)i.$message.warn("当前视频已在预览中");else{i.currentChoose=t,i.destoryVideo();var n=[];i.videoList.map((function(e){n.push(e)})),n.splice(0,1),n.push(e),i.videoList=[],setTimeout((function(){i.reloadVideo=!0,i.videoList=n,i.$nextTick((function(){i.videoList.map((function(e,t){"flv"==e.lookUrlType&&i.createVideo(e,t)}))}))}),500)}}else console.log("重复")},openScreen:function(){this.fullScreen=!this.fullScreen},getVideoList:function(){var e=this;e.request("/community/village_api.CameraDevice/cameraDeviceLinks",e.pageInfo).then((function(t){e.totalCount=t.count,e.reloadVideo=!1,e.destoryVideo(),setTimeout((function(){e.reloadVideo=!0,e.videoList=t.list,e.$nextTick((function(){e.videoList.map((function(t,i){"flv"==t.lookUrlType&&e.createVideo(t,i)}))}))}),500)}))},getLeftMenuList:function(){var e=this;e.request("/community/village_api.CameraDevice/cameraDeviceLinks",{page:-1,name:e.searchVal}).then((function(t){e.menuList=t.list,e.videoList.length>0||(e.videoList=[t.list[0]],e.reloadVideo=!0,e.destoryVideo(),e.$nextTick((function(){t.list.length>0&&e.createVideo(t.list[0],0)})))}))},changeScreen:function(e){var t=this;t.currentIndex!=e?(t.currentIndex=e,t.videoList=[],t.destoryVideo(),setTimeout((function(){t.reloadVideo=!0,t.menuList.map((function(i,o){o<(e+1)*(e+1)&&t.videoList.push(i)})),t.$nextTick((function(){t.videoList.map((function(e,i){"flv"==e.lookUrlType&&t.createVideo(e,i)}))}))}),500)):console.log("重复")},createVideo:function(e,t){var i=this;if(a.a.isSupported()){var o=document.getElementById("myVideo"+t);if(this.flvPlayer=a.a.createPlayer({type:"flv",isLive:!0,hasAudio:!1,url:e.look_url}),!this.flvPlayer)return;this.flvPlayer.attachMediaElement(o),this.flvPlayer.load(),this.flvPlayer.play(),this.flvPlayer.on(a.a.Events.ERROR,(function(e,t){i.flvPlayer&&i.destoryVideo()}))}},destoryVideo:function(){this.flvPlayer&&(this.flvPlayer.pause(),this.flvPlayer.unload(),this.flvPlayer.detachMediaElement(),this.flvPlayer.destroy(),this.flvPlayer=null)}}},r=c,d=(i("241dd"),i("0b56")),u=Object(d["a"])(r,o,n,!1,null,"85fd2436",null);t["default"]=u.exports}}]);