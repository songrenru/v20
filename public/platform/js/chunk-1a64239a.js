(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-1a64239a"],{4031:function(e,t,a){"use strict";var r={getLists:"/mall/merchant.MerchantStoreMall/getStoreList",perfectedStore:"/mall/merchant.MerchantStoreMall/perfectedStore",getStoreConfigList:"/mall/merchant.MerchantStoreMall/getStoreConfigList",getShippingList:"/mall/merchant.MallShipping/getShippingList",updateShipping:"/mall/merchant.MallShipping/addShipping",changeState:"/mall/merchant.MallShipping/changeState",removeShipping:"/mall/merchant.MallShipping/del",getShippingInfo:"/mall/merchant.MallShipping/edit",getMerchantSort:"/mall/merchant.MallGoods/getMerchantSort",getMallGoods:"/mall/merchant.MallGoods/getMallGoodsSelect",getGiveList:"/mall/merchant.MallGive/getGiveList",giveAdd:"/mall/merchant.MallGive/addGive",giveChangeState:"/mall/merchant.MallGive/changeState",giveDel:"/mall/merchant.MallGive/del",getGiveInfo:"/mall/merchant.MallGive/edit",getPlatSort:"/mall/merchant.MallGoods/getPlatformSort",getStoreSort:"/mall/merchant.MallGoods/getMerchantSort",getPrepareList:"/mall/merchant.MallPrepare/getPrepareList",updatePrepare:"/mall/merchant.MallPrepare/addPrepare",prepareChangeState:"/mall/merchant.MallPrepare/changeState",removePrepare:"/mall/merchant.MallPrepare/del",getPrepareInfo:"/mall/merchant.MallPrepare/edit",getReachedList:"/mall/merchant.MallReached/getReachedList",updateReachedList:"/mall/merchant.MallReached/addReached",getReachedInfo:"/mall/merchant.MallReached/edit",reachedChangeState:"/mall/merchant.MallReached/changeState",reachedDel:"/mall/merchant.MallReached/del",addRobot:"/mall/merchant.MallGroup/addRobot",delRobot:"/mall/merchant.MallGroup/delRobot",getRobotList:"/mall/merchant.MallGroup/getRobotList",getRobotName:"/mall/merchant.MallGroup/getRobotName",getUploadImages:"/common/common.UploadFile/getUploadImages",getGoodsSort:"/mall/merchant.MallGoods/getMerchantSort",getGoodsStatus:"/mall/merchant.MallGoods/getNumbers",getGoodsList:"/mall/merchant.MallGoods/getGoodsList",changeGoodsStatus:"/mall/merchant.MallGoods/setStatusLot",setVirtualSales:"/mall/merchant.MallGoods/setVirtualSales",changeGoodsSort:"/mall/merchant.MallGoods/setSort",getGoodsSkuPrice:"/mall/merchant.MallGoods/getGoodsSkuInfo",changeGoodsPrice:"/mall/merchant.MallGoods/setGoodsSkuInfo",getPlatProps:"/mall/merchant.MallGoods/getPlatformProperties",getFreightList:"/mall/merchant.MallGoods/getfreightList",getServiceList:"/mall/merchant.MallGoods/dealService",removeGoods:"/mall/merchant.MallGoods/delGoods",updateGoods:"/mall/merchant.MallGoods/addOrEditGoods",exportGoods:"/mall/merchant.MallGoods/exportGoods",getGoodsInfo:"/mall/merchant.MallGoods/getEditGoods",getGroupList:"/mall/merchant.MallGroup/getGroupList",groupAdd:"/mall/merchant.MallGroup/addGroup",groupChangeState:"/mall/merchant.MallGroup/changeState",groupDel:"/mall/merchant.MallGroup/del",getGroupInfo:"/mall/merchant.MallGroup/editDetail",getPeriodicList:"/mall/merchant.MallPeriodic/getPeriodicList",updatePeriodic:"/mall/merchant.MallPeriodic/addPeriodic",periodicChangeState:"/mall/merchant.MallPeriodic/changeState",removePeriodic:"/mall/merchant.MallPeriodic/del",getPeriodicInfo:"/mall/merchant.MallPeriodic/edit",getBargainList:"/mall/merchant.MallBargain/getBargainList",bargainAdd:"/mall/merchant.MallBargain/addBargain",bargainChangeState:"/mall/merchant.MallBargain/changeState",bargainDel:"/mall/merchant.MallBargain/del",getBargainInfo:"/mall/merchant.MallBargain/editDetail",getMinusDiscountList:"/mall/merchant.MallFullMinusDiscount/getFullMinusDiscountList",updateMinusDiscount:"/mall/merchant.MallFullMinusDiscount/addFullMinusDiscount",minusDiscountChangeState:"/mall/merchant.MallFullMinusDiscount/changeState",removeMinusDiscount:"/mall/merchant.MallFullMinusDiscount/del",getMinusDiscountInfo:"/mall/merchant.MallFullMinusDiscount/edit",getLimitedList:"/mall/merchant.MallLimited/getLimitedList",updateLimited:"/mall/merchant.MallLimited/addLimited",limitedChangeState:"/mall/merchant.MallLimited/changeState",removeLimited:"/mall/merchant.MallLimited/del",getLimitedInfo:"/mall/merchant.MallLimited/edit",getGoodsSortList:"/mall/merchant.MallGoodsSort/getSortList",delGoodsSort:"/mall/merchant.MallGoodsSort/delSort",editGoodsSort:"/mall/merchant.MallGoodsSort/addOrEditSort",getEditSort:"/mall/merchant.MallGoodsSort/getEditSort",editSort:"/mall/merchant.MallGoodsSort/saveSort",saveStatus:"/mall/merchant.MallGoodsSort/saveStatus",getAllGoodsSort:"/mall/merchant.MallGoodsSort/getSort",getStoreList:"/mall/merchant.MallMerchantReply/getStores",getReplyList:"/mall/merchant.MallMerchantReply/searchReply",addComment:"/mall/merchant.MallMerchantReply/merchantReply",getReplyDetails:"/mall/merchant.MallMerchantReply/getReplyDetails",getShowHomePage:"/mall/merchant.MallMerchantReply/getShowHomePage",getQualityReviews:"/mall/merchant.MallMerchantReply/getQualityReviews",getShowHomePageCancel:"/mall/merchant.MallMerchantReply/getShowHomePageCancel",getQualityReviewsCancel:"/mall/merchant.MallMerchantReply/getQualityReviewsCancel",getOrderList:"/mall/merchant.MallOrder/searchOrders",getOrderDetails:"/mall/merchant.MallOrder/getOrderDetails",getCollect:"/mall/merchant.MallOrder/getCollect",getDiscount:"/mall/merchant.MallOrder/getDiscount",exportOrder:"/mall/merchant.MallOrder/exportOrder ",deleteJudge:"/mall/merchant.MallGoods/deleteJudge ",getTemplateList:"/mall/merchant.ExpressTemplate/index",getTemplateAreaList:"/mall/merchant.ExpressTemplate/ajax_area",getTemplateAreaNameList:"/mall/merchant.ExpressTemplate/get_area_name",addTemplate:"/mall/merchant.ExpressTemplate/save",editTemplate:"/mall/merchant.ExpressTemplate/edit",delTemplate:"/mall/merchant.ExpressTemplate/delete",goodsBatch:"/mall/merchant.MallGoods/goodsBatch",viewLogistics:"/mall/merchant.MallOrder/viewLogistics",orderPrintTicket:"/mall/merchant.MallOrder/printOrder",getExpress:"/mall/merchant.MallOrder/getExpress",deliverGoodsByExpress:"/mall/merchant.MallOrder/deliverGoodsByExpress"};t["a"]=r},"5f66":function(e,t,a){"use strict";var r={getOrderList:"/mall/storestaff.MallOrder/getOrderList",exportOrder:"/mall/storestaff.MallOrder/exportOrder",orderTaking:"/mall/storestaff.MallOrder/orderTaking",deliverGoodsByHouseman:"/mall/storestaff.MallOrder/deliverGoodsByHouseman",staffVerify:"/mall/storestaff.MallOrder/staffVerify",postponeDelivery:"/mall/storestaff.MallOrder/postponeDelivery",agreeRefund:"/mall/storestaff.MallOrder/AgreeRefund",getExpress:"/mall/storestaff.MallOrder/getExpress",deliverGoodsByExpress:"/mall/storestaff.MallOrder/deliverGoodsByExpress",viewLogistics:"/mall/storestaff.MallOrder/viewLogistics",refuseRefund:"/mall/storestaff.MallOrder/RefuseRefund",clerkDiscount:"/mall/storestaff.MallOrder/clerkDiscount",getOrderDetails:"/mall/storestaff.MallOrder/getOrderDetails",clerkNotes:"/mall/storestaff.MallOrder/clerkNotes",getPeriodicList:"/mall/storestaff.MallOrder/getPeriodicList",downExcel:"/mall/storestaff.MallOrder/downExcel",downFailExcel:"/mall/storestaff.MallOrder/downFailExcel",uploadUrl:"/common/common.UploadFile/uploadFile",uploadExcel:"/mall/storestaff.MallOrder/uploadFile",getList:"/mall/storestaff.MallOrder/shopGoodsBatchLogList",getOrderListCopy:"/mall/storestaff.MallOrder/getOrderListCopy",getOrderDetailsCopy:"/mall/storestaff.MallOrder/getOrderDetailsCopy",orderPrintTicket:"/mall/storestaff.MallOrder/printOrder"};t["a"]=r},"93f2":function(e,t,a){"use strict";a.r(t);var r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("a-modal",{attrs:{title:e.title,visible:e.visible,maskClosable:!1,destroyOnClose:!0,width:"60%",bodyStyle:{maxHeight:"70vh",overflowY:"auto"}},on:{cancel:e.handleCancel}},[a("a-form-model",{attrs:{model:e.formData,"label-col":e.labelCol,"wrapper-col":e.wrapperCol}},e._l(e.formData.extra_delivery,(function(t,r){return a("div",{key:t.key},[a("a-form-model-item",{attrs:{label:"快递"}},[a("div",{staticClass:"flex"},[a("a-select",{staticStyle:{width:"80%"},attrs:{placeholder:"请选择"},on:{change:function(t){return e.hanleChange(t,r)}},model:{value:t.express_id,callback:function(a){e.$set(t,"express_id",a)},expression:"item.express_id"}},e._l(e.expressOptions,(function(t){return a("a-select-option",{key:t.id},[e._v(" "+e._s(t.name)+e._s("1"==t.is_singface?"（电子面单）":"")+" ")])})),1),0!=r?a("a-button",{staticClass:"ml-10",attrs:{type:"danger"},on:{click:function(t){return e.handleExpress("del",r)}}},[e._v("删除")]):e._e()],1)]),a("a-form-model-item",{attrs:{label:"快递单号"}},[a("a-input",{staticStyle:{width:"80%"},attrs:{placeholder:"请输入快递单号"},model:{value:t.express_no,callback:function(a){e.$set(t,"express_no",a)},expression:"item.express_no"}})],1),a("a-form-model-item",{attrs:{label:"发货商品",help:"不选择，为空表示发货所有商品。"}},[a("a-select",{staticStyle:{width:"80%"},attrs:{mode:"multiple",placeholder:"请选择"},model:{value:t.order_detail_ids,callback:function(a){e.$set(t,"order_detail_ids",a)},expression:"item.order_detail_ids"}},e._l(e.goodsList,(function(t){return a("a-select-option",{key:t.id,attrs:{value:t.id}},[e._v(" "+e._s(t.show_name)+" ")])})),1)],1)],1)})),0),a("template",{slot:"footer"},[a("div",{staticClass:"flex justify-center align-center"},[a("a-button",{key:"add",staticClass:"mr-20",on:{click:function(t){return e.handleExpress("add")}}},[e._v(" 添加快递 ")]),a("a-button",{key:"back",staticClass:"mr-20",on:{click:function(t){return e.btnOpt(2)}}},[e._v(" 普通发货 ")]),a("a-button",{key:"submit",attrs:{type:"primary",disabled:e.isCanSingface},on:{click:function(t){return e.btnOpt(1)}}},[e._v(" 电子面单发货 ")])],1)])],2)},l=[],s=a("5530"),i=(a("a9e3"),a("d81d"),a("ac1f"),a("1276"),a("d3b7"),a("159b"),a("b0c0"),a("a15b"),a("5f66")),o=a("4031"),n={props:{visible:Boolean,title:String,order:Object,nowPeriodicItem:{type:Object,default:{}},fh_type:[String,Number],pageType:{type:String,default:"storestaff"}},data:function(){return{labelCol:{span:4},wrapperCol:{span:16},formData:{order_id:"",activity_type:"",periodic_order_id:"",current_periodic:"",periodic_count:"",express_type:"",express_no:"",express_id:"",express_name:"",fh_type:"1",extra_delivery:[{express_id:void 0,express_name:"",express_no:"",order_detail_ids:[],is_singface:0,key:0}]},expressOptions:[]}},computed:{goodsList:function(){var e=this.order.children||[];return e.length&&(e=e.map((function(e){return e.show_name=e.goods_name,e.sku_info&&(e.show_name=e.show_name+"(".concat(e.sku_info,")")),e}))),e},isCanSingface:function(){var e=!1;return(2==this.fh_type||this.formData.extra_delivery.length>1||1!=this.formData.extra_delivery[0]["is_singface"])&&(e=!0),e}},created:function(){this.getExpress()},methods:{getExpress:function(){var e=this,t={merchant:o["a"].getExpress,storestaff:i["a"].getExpress};this.request(t[this.pageType],{}).then((function(t){e.expressOptions=t||[],e.handleExtraDelivery()}))},handleExtraDelivery:function(){if(2==this.fh_type){this.$set(this.formData,"express_id",this.order.express_id||""),this.$set(this.formData,"express_no",this.order.express_num||""),this.$set(this.formData,"express_name",this.order.express_name||"");var e=[];if(e="periodic"==this.order.goods_activity_type&&this.nowPeriodicItem?this.nowPeriodicItem.delivery||[]:this.order.delivery||[],Array.isArray(e)&&e.length){var t=e.map((function(e,t){var a=e.order_detail_ids?e.order_detail_ids.split(","):[];return a.length&&(a=a.map((function(e){return e-0}))),{express_id:e.express_id,express_name:e.express_name,express_no:e.express_num,order_detail_ids:a,key:t}}));this.$set(this.formData,"extra_delivery",t)}else if("periodic"!=this.order.goods_activity_type&&this.order.express_id){var a=[{express_id:this.order.express_id,express_name:this.order.express_name,express_no:this.order.express_num,order_detail_ids:[],key:0}];this.$set(this.formData,"extra_delivery",a)}}console.log("this.formData",this.formData)},hanleChange:function(e,t){var a=this.formData.extra_delivery[t];a.express_id=e,this.expressOptions.forEach((function(t){t.id==e&&(a.express_name=t.name,a.is_singface=t.is_singface)})),this.$set(this.formData.extra_delivery,t,a)},btnOpt:function(e){var t=this;this.$set(this.formData,"express_type",e);var a=this.formData.extra_delivery.some((function(e){return!e.express_id}));if(a)this.$message.error("请选择快递");else{if(2==e){if(this.formData.extra_delivery.some((function(e){return!e.express_no})))return void this.$message.error("请输入快递单号");var r=/[\u4e00-\u9fa5]/;if(this.formData.extra_delivery.some((function(e){return r.test(e.express_no)})))return void this.$message.error("不能输入中文")}var l=this.formData.extra_delivery.map((function(e){return{express_id:e.express_id,express_no:e.express_no,order_detail_ids:e.order_detail_ids.length?e.order_detail_ids.join(","):"",express_name:e.express_name}})),n=this.order,d=n.order_id,m=n.goods_activity_type,c=n.order_type,h=n.current_periodic,p=n.periodic_count,g=this.nowPeriodicItem&&this.nowPeriodicItem.purchase_order_id?this.nowPeriodicItem.purchase_order_id:"";this.$set(this.formData,"order_id",d),this.$set(this.formData,"activity_type",m),"periodic"==c&&(this.$set(this.formData,"periodic_order_id",g),this.$set(this.formData,"current_periodic",h),this.$set(this.formData,"periodic_count",p)),this.$set(this.formData,"fh_type",this.fh_type);var f=Object(s["a"])(Object(s["a"])({},this.formData),{},{express_id:l[0].express_id,express_no:l[0].express_no,express_name:l[0].express_name,extra_delivery:2==e?l:[],store_id:this.order.store_id||""}),u={merchant:o["a"].deliverGoodsByExpress,storestaff:i["a"].deliverGoodsByExpress};this.request(u[this.pageType],f).then((function(e){var a="1"==t.fh_type?"订单发货成功":"快递更改成功";t.$message.success(a),t.handleCancel(),t.$emit("updateList")}))}},handleCancel:function(){this.$emit("handleCancel"),this.formData={order_id:"",activity_type:"",periodic_order_id:"",current_periodic:"",periodic_count:"",express_type:"",express_no:"",express_id:"",express_name:"",fh_type:"1",extra_delivery:[{express_id:void 0,express_name:"",express_no:"",order_detail_ids:[],is_singface:0,key:0}]}},handleExpress:function(e,t){if("add"==e){var a=this.formData.extra_delivery;a.push({express_id:void 0,express_name:"",express_no:"",order_detail_ids:[],is_singface:0,key:a.length}),this.$set(this.formData,"extra_delivery",a)}"del"==e&&this.$delete(this.formData.extra_delivery,t)}}},d=n,m=a("2877"),c=Object(m["a"])(d,r,l,!1,null,"3648c2eb",null);t["default"]=c.exports}}]);