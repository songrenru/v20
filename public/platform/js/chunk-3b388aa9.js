(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-3b388aa9","chunk-b3cef5c8","chunk-b3cef5c8"],{2760:function(t,e,i){"use strict";i.r(e);i("54f8");var r=function(){var t=this,e=t._self._c;return e("div",{staticClass:"mt-10 mb-20 pt-20 pl-20 pr-20 pb-20 bg-ff br-10"},[e("a-row",[e("a-col",{attrs:{span:16}},[e("a-input-search",{staticStyle:{width:"300px"},attrs:{placeholder:t.L("请输入")},on:{search:t.onSearch},model:{value:t.queryParams.name,callback:function(e){t.$set(t.queryParams,"name",e)},expression:"queryParams.name"}}),e("a-button",{staticClass:"m-10",attrs:{type:"primary"},on:{click:t.onSearch}},[t._v(" "+t._s(t.L("搜索"))+" ")])],1),e("a-col",{staticStyle:{"text-align":"right"},attrs:{span:8}},[e("a-button",{staticClass:"m-10",attrs:{type:"danger"},on:{click:t.onDelete}},[t._v(" "+t._s(t.L("删除"))+" ")]),e("a-button",{staticClass:"m-10",attrs:{type:"primary"},on:{click:t.onAdd}},[t._v(" "+t._s(t.L("新建"))+" ")])],1)],1),e("a-table",{attrs:{columns:t.columns,rowKey:"id","data-source":t.list,"row-selection":{selectedRowKeys:t.selectedRowKeys,onSelect:t.onSelect,onSelectAll:t.onSelectAll},pagination:t.pagination},scopedSlots:t._u([{key:"cover",fn:function(i,r){return e("span",{},[e("img",{staticClass:"img pointer",attrs:{src:r.cover},on:{click:function(e){return t.handlePreview({url:r.cover})}}})])}},{key:"material_url",fn:function(i,r){return e("span",{staticClass:"pointer cr-primary no-wrap",on:{click:function(e){return t.viewItem(r)}}},[t._v(" "+t._s(t.L("点击播放"))+" ")])}},{key:"action",fn:function(i,r){return e("span",{},[e("a-button",{attrs:{type:"link"},on:{click:function(e){return t.delItem(r)}}},[t._v(t._s(t.L("删除")))]),e("a-button",{attrs:{type:"link"},on:{click:function(e){return t.editItem(r)}}},[t._v(t._s(t.L("编辑")))])],1)}}])}),e("a-modal",{attrs:{visible:t.modalVisible,title:t.modalTitle,destroyOnClose:!0,width:"60%",bodyStyle:{maxHeight:"650px",overflowY:"auto"},footer:"viewVideo"==t.modalType?null:void 0},on:{cancel:t.handleCancel,ok:t.handleOk}},["viewVideo"==t.modalType?e("section",[e("video",{staticStyle:{width:"100%","max-height":"400px"},attrs:{src:t.modalForm.material_url,controls:"",autoplay:""}})]):e("section",[e("a-form-model",{attrs:{model:t.modalForm,"label-col":{span:4},"wrapper-col":{span:16}}},["addVideo"==t.modalType?e("section",[e("a-form-model-item",{attrs:{label:t.L("视频名称"),required:""}},[e("a-input",{attrs:{"allow-clear":"",placeholder:t.L("请输入")},model:{value:t.modalForm.material_name,callback:function(e){t.$set(t.modalForm,"material_name",e)},expression:"modalForm.material_name"}})],1),e("a-form-model-item",{staticClass:"videos",attrs:{label:t.L("上传视频"),help:t.L("视频上传不可以大于100M，必须是MP4文件"),required:""}},[t.modalForm.material_url?e("div",[e("video",{staticStyle:{width:"60%","max-height":"200px"},attrs:{src:t.modalForm.material_url,controls:""}})]):t._e(),e("a-upload",{attrs:{name:"video",action:"/v20/public/index.php/common/common.UploadFile/uploadVideos","file-list":t.videoUploadList,multiple:!1,showUploadList:!t.modalForm.material_url,"before-upload":t.beforeUploadFile,data:{upload_dir:"/douyin/video"}},on:{change:t.handleChangeVideo}},[e("div",[e("a-button",[e("a-icon",{attrs:{type:"upload"}}),t._v(" "+t._s(t.L("上传视频"))+" ")],1)],1)])],1),e("a-form-model-item",{attrs:{label:t.L("上传封面"),help:t.L("封面未设置则默认读取视频第一帧作为封面图")}},[e("a-upload",{attrs:{action:"/v20/public/index.php/common/common.UploadFile/uploadPictures",name:"reply_pic","list-type":"picture-card",data:{upload_dir:""},"file-list":t.videoCoverList},on:{preview:t.handlePreview,change:function(e){return t.handleUploadImgChange(e,"cover","videoCoverList")}}},[e("div",[e("a-icon",{attrs:{type:"plus"}}),e("div",{staticClass:"ant-upload-text"},[t._v(t._s(t.L("上传封面")))])],1)])],1),e("a-form-model-item",{attrs:{label:t.L("转发文案"),required:""}},[e("a-textarea",{attrs:{"allow-clear":"",placeholder:t.L("请输入"),autoSize:{minRows:2,maxRows:6}},model:{value:t.modalForm.share_desc,callback:function(e){t.$set(t.modalForm,"share_desc",e)},expression:"modalForm.share_desc"}})],1),e("a-form-model-item",{attrs:{label:t.L("话题"),help:t.L("多个话题请以英文分号隔开")}},[e("a-input",{attrs:{"allow-clear":"",placeholder:t.L("请输入")},model:{value:t.modalForm.topic,callback:function(e){t.$set(t.modalForm,"topic",e)},expression:"modalForm.topic"}})],1)],1):t._e()])],1)]),e("a-modal",{attrs:{width:"60%",bodyStyle:{maxHeight:"650px",overflowY:"auto"},visible:t.previewVisible,footer:null},on:{cancel:function(e){t.previewVisible=!1}}},[e("img",{staticClass:"mt-20",staticStyle:{width:"100%",height:"auto"},attrs:{src:t.previewImage}})])],1)},o=[],n=i("dff4"),a=i("d34b"),s=i("8ee2"),l=(i("f597"),i("5079"),i("075f"),i("6e84"),i("cd5d"),i("c5cb"),i("5532"),i("0d36"),i("4afa"),i("e49a")),c={data:function(){return{queryParams:{name:""},list:[],columns:[{title:this.L("名称"),dataIndex:"material_name"},{title:this.L("封面"),dataIndex:"cover",scopedSlots:{customRender:"cover"}},{title:this.L("视频"),dataIndex:"material_url",scopedSlots:{customRender:"material_url"}},{title:this.L("创建时间"),dataIndex:"create_time"},{title:this.L("操作"),key:"action",scopedSlots:{customRender:"action"}}],pagination:{pageSize:10,total:0,current:1,showSizeChanger:!0,showQuickJumper:!0,onChange:this.onPageChange,onShowSizeChange:this.onPageSizeChange,showTotal:function(t){return"共 ".concat(t," 条记录")}},selectedRowKeys:[],modalVisible:!1,modalType:"",modalTitle:"",modalForm:"",fileloading:!1,videoUploadList:[],videoCoverList:[],previewVisible:!1,previewImage:""}},mounted:function(){this.getList()},methods:{getList:function(){var t=this,e={name:this.queryParams.name,page:this.pagination.current,pageSize:this.pagination.pageSize};this.request(l["a"].getSourceMaterialLists,e).then((function(e){t.list=e.data,t.$set(t.pagination,"total",e.total)}))},onSearch:function(){this.$set(this.pagination,"current",1),this.getList()},onAdd:function(){this.modalType="addVideo",this.modalTitle=this.L("添加视频"),this.modalForm={id:"",material_name:"",material_url:"",material_type:"video",cover:"",share_desc:"",topic:""},this.modalVisible=!0},onDelete:function(){var t=this;this.selectedRowKeys.length?this.$confirm({title:this.L("确定要删除列表吗？"),centered:!0,onOk:function(){t.request(l["a"].delSourceMaterial,{ids:t.selectedRowKeys.join(",")}).then((function(e){t.$message.success(t.L("操作成功！")),t.selectedRowKeys=[],t.getList()}))},onCancel:function(){}}):this.$message.error(this.L("请选择要删除的列表"))},onSelect:function(t,e,i,r){var o=this.selectedRowKeys;if(e)o.push(t.id);else if(o.length){var n=o.findIndex((function(e){return e==t.id}));-1!=n&&this.$delete(o,n)}this.selectedRowKeys=JSON.parse(JSON.stringify(o))},onSelectAll:function(t,e,i){var r=i.map((function(t){return t.id})),o=this.selectedRowKeys;o=t?o.concat(r):o.concat(r).filter((function(t){return!r.includes(t)})),this.selectedRowKeys=JSON.parse(JSON.stringify(o))},onPageChange:function(t,e){this.$set(this.pagination,"current",t),this.getList()},onPageSizeChange:function(t,e){this.$set(this.pagination,"pageSize",e),this.getList()},viewItem:function(t){this.modalType="viewVideo",this.modalTitle=this.L("视频查看"),this.modalForm={material_url:t.material_url},this.modalVisible=!0},editItem:function(t){this.modalType="addVideo",this.modalTitle=this.L("视频编辑"),this.modalForm=Object(s["a"])(Object(s["a"])({},t),{},{image_full_url:t.cover,video_full_url:t.material_url}),t.video_url&&(this.videoUploadList=[{uid:"video_url",name:t.material_url,status:"done",url:t.material_url}]),t.cover&&(this.videoCoverList=[{uid:"video_cover",name:t.cover,status:"done",url:t.cover}]),this.modalVisible=!0},delItem:function(t){var e=this;this.$confirm({title:this.L("确定要删除该条数据吗？"),centered:!0,onOk:function(){e.request(l["a"].delSourceMaterial,{ids:t.id}).then((function(i){if(e.$message.success(e.L("操作成功！")),e.selectedRowKeys.length){var r=e.selectedRowKeys.findIndex((function(e){return e==t.id}));-1!=r&&e.$delete(e.selectedRowKeys,r)}e.getList()}))},onCancel:function(){}})},beforeUploadFile:function(t){var e=t.type.toLowerCase();if(this.fileloading)return this.$message.warning(this.L("当前还有文件上传中，请等候上传完成!")),!1;if(-1==e.indexOf("mp4"))return this.$message.error(this.L("仅支持mp4文件上传!")),!1;var i=t.size/1024/1024<100;return i?void 0:(this.$message.error("视频上传最大支持100MB!"),!1)},handleChangeVideo:function(t){if(t.file&&!t.file.status&&this.fileloading)return!1;if(this.modalForm.material_url="","uploading"===t.file.status){if(this.fileloading)return!1;this.fileloading=!0,this.videoUploadList=[t.file]}if("uploading"!==t.file.status&&(this.fileloading=!1),t.file&&t.file.response){var e=t.file.response;1e3===e.status?(this.videoUploadList=[],this.modalForm=Object(s["a"])(Object(s["a"])({},this.modalForm),{},{material_url:e.data.video_url,cover:this.modalForm.cover||e.data.video_image}),this.videoUploadList=[{uid:"video_url",name:this.modalForm.material_url,status:"done",url:this.modalForm.material_url}],this.$message.success(this.L("上传成功"))):(this.videoUploadList=[],e.msg&&this.$message.error(e.msg))}},handleCancel:function(){this.modalVisible=!1,this.videoUploadList=[],this.videoCoverList=[],this.modalType="",this.modalTitle="",this.modalForm={}},handleOk:function(){"addVideo"==this.modalType&&this.addVideo()},addVideo:function(){var t=this;if(this.modalForm.material_name)if(this.modalForm.material_url)if(this.modalForm.share_desc){var e={id:this.modalForm.id,material_name:this.modalForm.material_name,material_url:this.modalForm.material_url,material_type:this.modalForm.material_type,cover:this.modalForm.cover,share_desc:this.modalForm.share_desc,topic:this.modalForm.topic};this.request(l["a"].saveSourceMaterial,e).then((function(e){t.$message.success(t.L("操作成功")),t.getList(),t.handleCancel()}))}else this.$message.error(this.L("请输入转发文案"));else this.$message.error(this.L("请上传视频"));else this.$message.error(this.L("请输入视频名称"))},handleUploadImgChange:function(t,e,i){var r=t.fileList;if(this[i]=r,r.length>0){var o=r.length-1;if("done"==this[i][o].status){var n=this[i][o].response.data;this.$set(this.modalForm,e,n),this[i][0].uid=e,this[i][0].name=n,this[i][0].status="done",this[i][0].url=n,r.length>1&&this[i].splice(0,1)}}else this.$set(this.modalForm,e,"")},handlePreview:function(t){var e=this;return Object(a["a"])(Object(n["a"])().mark((function i(){return Object(n["a"])().wrap((function(i){while(1)switch(i.prev=i.next){case 0:if(t.url||t.preview){i.next=4;break}return i.next=3,u(t.originFileObj);case 3:t.preview=i.sent;case 4:e.previewImage=t.url||t.preview,e.previewVisible=!0;case 6:case"end":return i.stop()}}),i)})))()}}};function u(t){return new Promise((function(e,i){var r=new FileReader;r.readAsDataURL(t),r.onload=function(){return e(r.result)},r.onerror=function(t){return i(t)}}))}var d=c,h=(i("35d9"),i("fb3b"),i("0b56")),m=Object(h["a"])(d,r,o,!1,null,"2d50c8d0",null);e["default"]=m.exports},"35d9":function(t,e,i){"use strict";i("f40b")},"3e0e":function(t,e,i){},d34b:function(t,e,i){"use strict";i.d(e,"a",(function(){return o}));i("c5cb");function r(t,e,i,r,o,n,a){try{var s=t[n](a),l=s.value}catch(c){return void i(c)}s.done?e(l):Promise.resolve(l).then(r,o)}function o(t){return function(){var e=this,i=arguments;return new Promise((function(o,n){var a=t.apply(e,i);function s(t){r(a,o,n,s,l,"next",t)}function l(t){r(a,o,n,s,l,"throw",t)}s(void 0)}))}}},dff4:function(t,e,i){"use strict";i.d(e,"a",(function(){return o}));i("6073"),i("2c5c"),i("c5cb"),i("36fa"),i("02bf"),i("a617"),i("70b9"),i("25b2"),i("0245"),i("2e24"),i("1485"),i("08c7"),i("54f8"),i("7177"),i("9ae4");var r=i("2396");function o(){
/*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/facebook/regenerator/blob/main/LICENSE */
o=function(){return t};var t={},e=Object.prototype,i=e.hasOwnProperty,n="function"==typeof Symbol?Symbol:{},a=n.iterator||"@@iterator",s=n.asyncIterator||"@@asyncIterator",l=n.toStringTag||"@@toStringTag";function c(t,e,i){return Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{c({},"")}catch(O){c=function(t,e,i){return t[e]=i}}function u(t,e,i,r){var o=e&&e.prototype instanceof m?e:m,n=Object.create(o.prototype),a=new F(r||[]);return n._invoke=function(t,e,i){var r="suspendedStart";return function(o,n){if("executing"===r)throw new Error("Generator is already running");if("completed"===r){if("throw"===o)throw n;return C()}for(i.method=o,i.arg=n;;){var a=i.delegate;if(a){var s=_(a,i);if(s){if(s===h)continue;return s}}if("next"===i.method)i.sent=i._sent=i.arg;else if("throw"===i.method){if("suspendedStart"===r)throw r="completed",i.arg;i.dispatchException(i.arg)}else"return"===i.method&&i.abrupt("return",i.arg);r="executing";var l=d(t,e,i);if("normal"===l.type){if(r=i.done?"completed":"suspendedYield",l.arg===h)continue;return{value:l.arg,done:i.done}}"throw"===l.type&&(r="completed",i.method="throw",i.arg=l.arg)}}}(t,i,a),n}function d(t,e,i){try{return{type:"normal",arg:t.call(e,i)}}catch(O){return{type:"throw",arg:O}}}t.wrap=u;var h={};function m(){}function f(){}function p(){}var v={};c(v,a,(function(){return this}));var y=Object.getPrototypeOf,g=y&&y(y(k([])));g&&g!==e&&i.call(g,a)&&(v=g);var w=p.prototype=m.prototype=Object.create(v);function L(t){["next","throw","return"].forEach((function(e){c(t,e,(function(t){return this._invoke(e,t)}))}))}function b(t,e){function o(n,a,s,l){var c=d(t[n],t,a);if("throw"!==c.type){var u=c.arg,h=u.value;return h&&"object"==Object(r["a"])(h)&&i.call(h,"__await")?e.resolve(h.__await).then((function(t){o("next",t,s,l)}),(function(t){o("throw",t,s,l)})):e.resolve(h).then((function(t){u.value=t,s(u)}),(function(t){return o("throw",t,s,l)}))}l(c.arg)}var n;this._invoke=function(t,i){function r(){return new e((function(e,r){o(t,i,e,r)}))}return n=n?n.then(r,r):r()}}function _(t,e){var i=t.iterator[e.method];if(void 0===i){if(e.delegate=null,"throw"===e.method){if(t.iterator["return"]&&(e.method="return",e.arg=void 0,_(t,e),"throw"===e.method))return h;e.method="throw",e.arg=new TypeError("The iterator does not provide a 'throw' method")}return h}var r=d(i,t.iterator,e.arg);if("throw"===r.type)return e.method="throw",e.arg=r.arg,e.delegate=null,h;var o=r.arg;return o?o.done?(e[t.resultName]=o.value,e.next=t.nextLoc,"return"!==e.method&&(e.method="next",e.arg=void 0),e.delegate=null,h):o:(e.method="throw",e.arg=new TypeError("iterator result is not an object"),e.delegate=null,h)}function x(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function S(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function F(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(x,this),this.reset(!0)}function k(t){if(t){var e=t[a];if(e)return e.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var r=-1,o=function e(){for(;++r<t.length;)if(i.call(t,r))return e.value=t[r],e.done=!1,e;return e.value=void 0,e.done=!0,e};return o.next=o}}return{next:C}}function C(){return{value:void 0,done:!0}}return f.prototype=p,c(w,"constructor",p),c(p,"constructor",f),f.displayName=c(p,l,"GeneratorFunction"),t.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===f||"GeneratorFunction"===(e.displayName||e.name))},t.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,p):(t.__proto__=p,c(t,l,"GeneratorFunction")),t.prototype=Object.create(w),t},t.awrap=function(t){return{__await:t}},L(b.prototype),c(b.prototype,s,(function(){return this})),t.AsyncIterator=b,t.async=function(e,i,r,o,n){void 0===n&&(n=Promise);var a=new b(u(e,i,r,o),n);return t.isGeneratorFunction(i)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},L(w),c(w,l,"Generator"),c(w,a,(function(){return this})),c(w,"toString",(function(){return"[object Generator]"})),t.keys=function(t){var e=[];for(var i in t)e.push(i);return e.reverse(),function i(){for(;e.length;){var r=e.pop();if(r in t)return i.value=r,i.done=!1,i}return i.done=!0,i}},t.values=k,F.prototype={constructor:F,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(S),!t)for(var e in this)"t"===e.charAt(0)&&i.call(this,e)&&!isNaN(+e.slice(1))&&(this[e]=void 0)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var e=this;function r(i,r){return a.type="throw",a.arg=t,e.next=i,r&&(e.method="next",e.arg=void 0),!!r}for(var o=this.tryEntries.length-1;o>=0;--o){var n=this.tryEntries[o],a=n.completion;if("root"===n.tryLoc)return r("end");if(n.tryLoc<=this.prev){var s=i.call(n,"catchLoc"),l=i.call(n,"finallyLoc");if(s&&l){if(this.prev<n.catchLoc)return r(n.catchLoc,!0);if(this.prev<n.finallyLoc)return r(n.finallyLoc)}else if(s){if(this.prev<n.catchLoc)return r(n.catchLoc,!0)}else{if(!l)throw new Error("try statement without catch or finally");if(this.prev<n.finallyLoc)return r(n.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc<=this.prev&&i.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var n=o;break}}n&&("break"===t||"continue"===t)&&n.tryLoc<=e&&e<=n.finallyLoc&&(n=null);var a=n?n.completion:{};return a.type=t,a.arg=e,n?(this.method="next",this.next=n.finallyLoc,h):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),h},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var i=this.tryEntries[e];if(i.finallyLoc===t)return this.complete(i.completion,i.afterLoc),S(i),h}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var i=this.tryEntries[e];if(i.tryLoc===t){var r=i.completion;if("throw"===r.type){var o=r.arg;S(i)}return o}}throw new Error("illegal catch attempt")},delegateYield:function(t,e,i){return this.delegate={iterator:k(t),resultName:e,nextLoc:i},"next"===this.method&&(this.arg=void 0),h}},t}},e49a:function(t,e,i){"use strict";var r={getActivityList:"/douyin/merchant.DouyinActivity/getActivityList",setActivityStatus:"/douyin/merchant.DouyinActivity/setActivityStatus",delActivity:"/douyin/merchant.DouyinActivity/delActivity",getStoreList:"/douyin/merchant.DouyinActivity/getStoreList",getCouponList:"/douyin/merchant.DouyinActivity/getCouponList",addOrEditActivity:"/douyin/merchant.DouyinActivity/addOrEditActivity",getActivityDetail:"/douyin/merchant.DouyinActivity/getActivityDetail",getSourceMaterialLists:"/douyin/merchant.DouyinActivity/getSourceMaterialLists",saveSourceMaterial:"/douyin/merchant.DouyinActivity/saveSourceMaterial",delSourceMaterial:"/douyin/merchant.DouyinActivity/delSourceMaterial"};e["a"]=r},f40b:function(t,e,i){},fb3b:function(t,e,i){"use strict";i("3e0e")}}]);