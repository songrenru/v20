(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-71ece296"],{"90bc":function(e,t,a){"use strict";a("c1d4")},c1d4:function(e,t,a){},c5bf:function(e,t,a){"use strict";var r={getCardList:"/employee/merchant.EmployeeCard/getCardList",editCard:"/employee/merchant.EmployeeCard/editCard",saveCard:"/employee/merchant.EmployeeCard/saveCard",getCouponList:"/employee/merchant.EmployeeCard/getCouponList",editCoupon:"/employee/merchant.EmployeeCard/editCoupon",saveCoupon:"/employee/merchant.EmployeeCard/saveCoupon",delCoupon:"/employee/merchant.EmployeeCard/delCoupon",getUserCardList:"/employee/merchant.EmployeeCardUser/getUserCardList",exportUserCardList:"/employee/merchant.EmployeeCardUser/exportUserCardList",editCardUser:"/employee/merchant.EmployeeCardUser/editCardUser",saveCardUser:"/employee/merchant.EmployeeCardUser/saveCardUser",delData:"/employee/merchant.EmployeeCardUser/delData",findUser:"/employee/merchant.EmployeeCardUser/findUser",loadExcel:"/employee/merchant.EmployeeCardUser/loadExcel",orderList:"/employee/merchant.EmployeeCardUser/orderList",cardLogList:"/employee/merchant.EmployeeCard/cardLogList",cardLogStorestaffList:"/employee/storestaff.EmployeeCardOrder/cardLogList",paymentScan:"/employee/storestaff.EmployeePayCode/deductions",cardLogExport:"/employee/merchant.EmployeeCard/export",employLableList:"/employee/merchant.EmployeeCardUser/employLableList",employLableAddOrEdit:"/employee/merchant.EmployeeCardUser/employLableAddOrEdit",employLableDel:"/employee/merchant.EmployeeCardUser/employLableDel",dataStatistics:"/employee/merchant.EmployeeCardLog/dataStatistics",getStoreConsumerList:"/employee/merchant.EmployeeCardLog/getStoreConsumerList",dataRechargeStatistics:"/employee/merchant.EmployeeCardOrder/getEmployeeOrderStatistics",dataRechargeStatisticsExport:"/employee/merchant.EmployeeCardOrder/getEmployeeOrderStatisticsExport",dataRechargeOrderExport:"/employee/merchant.EmployeeCardOrder/getEmployeeOrderExport",paymentMode:"/employee/merchant.EmployeeCardOrder/getPayType",getOrderList:"/employee/merchant.EmployeeCardOrder/getEmployeeOrderList",refundMoney:"/employee/merchant.EmployeeCardOrder/employeeOrderRefund",employeeCouponRefund:"/employee/merchant.EmployeeCardLog/employeeCouponRefund",isOpenUseMoney:"/employee/merchant.EmployeeCard/isOpenUseMoney",getLabelList:"/employee/merchant.EmployeeCardUser/getLabelList",getSendCouponDateList:"/employee/merchant.EmployeeCard/getSendCouponDateList",getCalcDateList:"/employee/merchant.EmployeeCard/getCalcDateList",getStaffDataStatistics:"/employee/storestaff.EmployeeCardLog/dataStatistics",delUserCard:"/employee/merchant.EmployeeCardUser/delUserCard",openUserCard:"/employee/merchant.EmployeeCardUser/openUserCard",closeUserCard:"/employee/merchant.EmployeeCardUser/closeUserCard",getClearScoreList:"/employee/merchant.EmployeeCard/getClearScoreList",staffRefundMoney:"/employee/storestaff.EmployeeCardOrder/employeeOrderRefund",openOrCloseUserCard:"/employee/merchant.EmployeeCardUser/openOrCloseUserCard",getStoreList:"/employee/merchant.EmployeeCardUser/getStoreList",lableBindStore:"/employee/merchant.EmployeeCardUser/lableBindStore"};t["a"]=r},e653:function(e,t,a){"use strict";a.r(t);var r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"mt-10 mb-20 pt-20 pl-20 pr-20 pb-20 bg-ff br-10"},[a("a-row",[a("div",{staticClass:"card_tab"},[a("router-link",{attrs:{to:"/merchant/merchant.life_tools/employee_card"}},[a("span",[e._v("商家员工卡列表")])])],1),a("div",{staticClass:"card_tab"},[a("span",{staticClass:"on"},[e._v("核销列表")])]),a("div",{staticClass:"card_tab"},[a("router-link",{attrs:{to:"/merchant/merchant.life_tools/employeeCardRechargeList"}},[a("span",[e._v("充值记录")])])],1),a("div",{staticClass:"card_tab"},[a("router-link",{attrs:{to:"/merchant/merchant.life_tools/employeeBillList"}},[a("span",[e._v("财务报表")])])],1),a("div",{staticClass:"card_tab"},[a("router-link",{attrs:{to:"/merchant/merchant.life_tools/employeeClearScoreList"}},[a("span",[e._v("积分清零记录")])])],1)]),a("a-row",{staticStyle:{"margin-top":"10px"}},[a("a-col",{attrs:{span:24}},[a("a-input-group",{attrs:{compact:""}},[a("a-select",{staticStyle:{width:"100px"},attrs:{value:e.queryParams.search_by},on:{change:e.selectSearchBy}},e._l(e.searchBy,(function(t,r){return a("a-select-option",{key:t.key},[e._v(" "+e._s(t.value)+" ")])})),1),a("a-input",{staticStyle:{width:"220px"},attrs:{placeholder:"请输入"+e.searchByMap[e.queryParams.search_by],value:e.queryParams.keywords},on:{change:e.keywordsChange}}),a("label",{staticStyle:{"line-height":"30px","margin-left":"15px"}},[e._v("选择日期：")]),a("a-range-picker",{on:{change:e.selectDate}}),"coupon"==e.queryParams.type?a("label",{staticStyle:{"line-height":"30px","margin-left":"15px"}},[e._v("核销类型：")]):e._e(),"coupon"==e.queryParams.type?a("a-select",{staticStyle:{width:"100px"},attrs:{value:e.queryParams.verify_type},on:{change:e.verifyTypeChange}},e._l(e.verifyType,(function(t,r){return a("a-select-option",{key:t.key},[e._v(" "+e._s(t.value)+" ")])})),1):e._e(),a("a-button",{staticStyle:{width:"80px","margin-left":"10px"},attrs:{type:"primary"},on:{click:e.searchBtn}},[e._v("搜索")]),a("a-button",{staticStyle:{width:"80px","margin-left":"10px",float:"right"},attrs:{type:"primary",icon:"download"},on:{click:function(t){return e.exportTable(e.exportUrl,e.queryParams)}}},[e._v("导出")])],1)],1)],1),a("a-row",{staticStyle:{"margin-top":"15px"}},[a("a-tabs",{attrs:{"active-key":e.queryParams.type},on:{change:e.changeTabs}},e._l(e.typeList,(function(t){return a("a-tab-pane",{key:t.key,attrs:{tab:t.title}},[a("a-table",{staticStyle:{background:"#ffffff"},attrs:{columns:e.columns,rowKey:"pigcms_id","data-source":e.dataList,pagination:e.pagination},on:{change:e.changePage},scopedSlots:e._u([{key:"num",fn:function(t,r){return a("span",{},[a("span",[e._v(e._s("coupon"==r.type?r.num:""))])])}},{key:"score",fn:function(t,r){return a("span",{},[a("span",[e._v(e._s("score"==r.type?r.num:""))])])}},{key:"type",fn:function(t,r){return a("span",{},["overdue"==r.type?a("span",[e._v("自动转积分"),1==r.is_refund?a("span",{staticStyle:{color:"red"}},[e._v("（已退款）")]):e._e()]):"score"==r.type?a("span",[e._v("积分消费"),1==r.is_refund?a("span",{staticStyle:{color:"red"}},[e._v("（已退款）")]):e._e()]):"to_score"==r.type?a("span",[e._v("手动转积分"),1==r.is_refund?a("span",{staticStyle:{color:"red"}},[e._v("（已退款）")]):e._e()]):"money"==r.type?a("span",[e._v("余额消费"),1==r.is_refund?a("span",{staticStyle:{color:"red"}},[e._v("（已退款）")]):e._e()]):a("span",[e._v("食堂消费券"),1==r.is_refund?a("span",{staticStyle:{color:"red"}},[e._v("（已退款）")]):e._e()])])}},{key:"action",fn:function(t,r){return a("span",{},[0==r.is_refund?a("a",{staticClass:"inline-block",on:{click:function(t){return e.refund(r.pigcms_id)}}},[e._v(e._s(e.L("退款")))]):[a("a-popover",{attrs:{title:"退款原因",placement:"topLeft"}},[a("template",{slot:"content"},[a("p",[e._v(e._s(r.refund_remark))])]),a("a",{staticClass:"inline-block"},[e._v(e._s(e.L("退款原因")))])],2)]],2)}}],null,!0)})],1)})),1)],1),a("a-modal",{attrs:{title:"退款"},on:{ok:e.handleRefund},model:{value:e.refund_visible,callback:function(t){e.refund_visible=t},expression:"refund_visible"}},[a("a-textarea",{attrs:{value:e.refundParams.refund_remark,placeholder:"请输入退款备注","auto-size":{minRows:3,maxRows:5}},on:{change:e.refundRemark}})],1)],1)},s=[],n=a("c5bf"),i={data:function(){return{exportUrl:n["a"].cardLogExport,queryParams:{search_by:2,keywords:"",start_date:"",end_date:"",type:"coupon",verify_type:1},refundParams:{refund_remark:"",pigcms_id:0},searchBy:[{key:2,value:"员工姓名"},{key:3,value:"员工电话"},{key:4,value:"消费券名称"},{key:5,value:"会员身份"},{key:6,value:"会员部门"}],verifyType:[{key:0,value:"全部"},{key:1,value:"正常核销"},{key:2,value:"自动转积分"},{key:3,value:"手动转积分"}],searchByMap:{2:"员工姓名",3:"员工电话",4:"消费券名称",5:"会员身份",6:"会员部门"},typeList:[{title:"消费券",key:"coupon"},{title:"余额",key:"money"},{title:"积分",key:"score"},{title:"未核销",key:"overdue"}],dataList:[],pagination:{pageSize:10,total:0,current:1,page:1},columns:[{title:this.L("会员名称"),dataIndex:"card_user.name"},{title:this.L("会员卡号"),dataIndex:"card_user.card_number"},{title:this.L("会员身份"),dataIndex:"card_user.identity"},{title:this.L("会员部门"),dataIndex:"card_user.department"},{title:this.L("会员手机号"),dataIndex:"user.phone"},{title:this.L("店铺名称"),dataIndex:"store.name"},{title:this.L("消费券名称"),dataIndex:"coupon_name"},{title:this.L("补助"),dataIndex:"grant_price"},{title:this.L("个人消费"),dataIndex:"num"},{title:this.L("总计消费"),dataIndex:"coupon_price"},{title:this.L("状态"),dataIndex:"type",key:"type",scopedSlots:{customRender:"type"}},{title:this.L("转积分"),dataIndex:"add_score_num"},{title:this.L("转积分扣除余额"),dataIndex:"deduct_money"},{title:this.L("核销时间"),dataIndex:"create_time"},{title:this.L("操作"),dataIndex:"sort_id",key:"sort_id",scopedSlots:{customRender:"action"}}],refund_visible:!1}},created:function(){this.getData()},methods:{keywordsChange:function(e){this.queryParams.keywords=e.target.value},getData:function(){var e=this;this.refund_visible=!1,this.queryParams.pageSize=this.pagination.pageSize,this.queryParams.page=this.pagination.current,this.request(n["a"].cardLogList,this.queryParams).then((function(t){e.pagination.total=t.total,e.dataList=t.data}))},changePage:function(e,t){this.pagination.current=e.current,this.getData()},selectDate:function(e,t){this.queryParams.start_date=t[0],this.queryParams.end_date=t[1]},searchBtn:function(){this.getData()},selectSearchBy:function(e){this.queryParams.search_by=e},verifyTypeChange:function(e){this.queryParams.verify_type=e},changeTabs:function(e){"coupon"==e?(this.searchBy=[{key:2,value:"员工姓名"},{key:3,value:"员工电话"},{key:4,value:"消费券名称"},{key:5,value:"会员身份"},{key:6,value:"会员部门"}],this.columns=[{title:this.L("会员名称"),dataIndex:"card_user.name"},{title:this.L("会员卡号"),dataIndex:"card_user.card_number"},{title:this.L("会员身份"),dataIndex:"card_user.identity"},{title:this.L("会员部门"),dataIndex:"card_user.department"},{title:this.L("会员手机号"),dataIndex:"user.phone"},{title:this.L("店铺名称"),dataIndex:"store.name"},{title:this.L("消费券名称"),dataIndex:"coupon_name"},{title:this.L("补助"),dataIndex:"grant_price"},{title:this.L("个人消费"),dataIndex:"num"},{title:this.L("总计消费"),dataIndex:"coupon_price"},{title:this.L("状态"),dataIndex:"type",key:"type",scopedSlots:{customRender:"type"}},{title:this.L("转积分"),dataIndex:"add_score_num"},{title:this.L("转积分扣除余额"),dataIndex:"deduct_money"},{title:this.L("核销时间"),dataIndex:"create_time"},{title:this.L("操作"),dataIndex:"sort_id",key:"sort_id",scopedSlots:{customRender:"action"}}]):"overdue"==e?(this.searchBy=[{key:2,value:"员工姓名"},{key:3,value:"员工电话"},{key:4,value:"消费券名称"},{key:5,value:"会员身份"},{key:6,value:"会员部门"}],this.columns=[{title:this.L("会员名称"),dataIndex:"card_user.name"},{title:this.L("会员卡号"),dataIndex:"card_user.card_number"},{title:this.L("会员身份"),dataIndex:"card_user.identity"},{title:this.L("会员部门"),dataIndex:"card_user.department"},{title:this.L("会员手机号"),dataIndex:"user.phone"},{title:this.L("过期时间"),dataIndex:"create_time"},{title:this.L("消费券名称"),dataIndex:"coupon_name"},{title:this.L("未核销原因"),dataIndex:"description"}]):"money"==e?(4==this.queryParams.search_by&&(this.queryParams.search_by=2),this.searchBy=[{key:2,value:"员工姓名"},{key:3,value:"员工电话"},{key:5,value:"会员身份"},{key:6,value:"会员部门"}],this.columns=[{title:this.L("会员名称"),dataIndex:"card_user.name"},{title:this.L("会员卡号"),dataIndex:"card_user.card_number"},{title:this.L("会员身份"),dataIndex:"card_user.identity"},{title:this.L("会员部门"),dataIndex:"card_user.department"},{title:this.L("会员手机号"),dataIndex:"user.phone"},{title:this.L("店铺名称"),dataIndex:"store.name"},{title:this.L("消费金额"),dataIndex:"num"},{title:this.L("核销时间"),dataIndex:"create_time"},{title:this.L("状态"),dataIndex:"type",key:"type",scopedSlots:{customRender:"type"}},{title:this.L("备注"),dataIndex:"remark"},{title:this.L("操作"),dataIndex:"sort_id",key:"sort_id",scopedSlots:{customRender:"action"}}]):(4==this.queryParams.search_by&&(this.queryParams.search_by=2),this.searchBy=[{key:2,value:"员工姓名"},{key:3,value:"员工电话"},{key:5,value:"会员身份"},{key:6,value:"会员部门"}],this.columns=[{title:this.L("会员名称"),dataIndex:"card_user.name"},{title:this.L("会员卡号"),dataIndex:"card_user.card_number"},{title:this.L("会员身份"),dataIndex:"card_user.identity"},{title:this.L("会员部门"),dataIndex:"card_user.department"},{title:this.L("会员手机号"),dataIndex:"user.phone"},{title:this.L("店铺名称"),dataIndex:"store.name"},{title:this.L("消费积分"),dataIndex:"num"},{title:this.L("核销时间"),dataIndex:"create_time"},{title:this.L("状态"),dataIndex:"type",key:"type",scopedSlots:{customRender:"type"}},{title:this.L("备注"),dataIndex:"remark"},{title:this.L("操作"),dataIndex:"sort_id",key:"sort_id",scopedSlots:{customRender:"action"}}]),this.queryParams.type=e,this.getData()},refund:function(e){this.refund_visible=!0,this.refundParams.pigcms_id=e},refundRemark:function(e){this.refundParams.refund_remark=e.target.value},handleRefund:function(){var e=this;return""==this.refundParams.refund_remark?(this.$message.error("请输入退款备注"),!1):""==this.refundParams.pigcms_id?(this.$message.error("退款id不存在"),!1):(this.request(n["a"].employeeCouponRefund,this.refundParams).then((function(t){e.refundParams.refund_remark="",e.refundParams.pigcms_id=0,e.$message.success("操作成功"),e.getData()})),void(this.refund_visible=!1))},exportTable:function(e,t){this.request(e,t).then((function(e){var t=e.file_url;t&&window.open(t)}))}}},d=i,o=(a("90bc"),a("2877")),l=Object(o["a"])(d,r,s,!1,null,null,null);t["default"]=l.exports}}]);